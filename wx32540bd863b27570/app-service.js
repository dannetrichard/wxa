	var __wxAppData = {}; 	var __wxRoute; 	var __wxRouteBegin; 	var __wxAppCode__ = {};	var global = {};	var __wxAppCurrentFile__; 	var Component = Component || function(){};	var Behavior = Behavior || function(){};
		define("common/activity_utils.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../constants/event_constant"),a=e(require("./data_util")),r=e(require("./std_format")),i=e(require("./object_util"));exports.default={getLotteryRules:function(e,o){function u(e){function t(e){return e<10&&(e="0"+e),e}var r=e.getMonth()+1,i=e.getDate(),o=t(e.getHours()),u=t(e.getMinutes());return a.default.formatByPos("{0}月{1}日{2}:{3}",r,i,o,u)}var d=new Date(1e3*e.start_time),l=new Date(1e3*e.end_time);o=o||e.rule||i.default.assign({},t.Rules.LuckyDraw);var s=u(d),n=u(l),f=e.name,m=e.goods_quantity,c=r.default.price(e.coupons_value,100),y=void 0,_=void 0;switch(_=e.shipping_time?new Date(1e3*e.shipping_time):new Date(1e3*(e.end_time+86400)),y=a.default.formatByPos("{0}月{1}日",_.getMonth()+1,_.getDate()),o.time=a.default.formatByPos(o.time,s,n),o.key){case"LuckyDraw":o.detail=[o.detail[0],a.default.formatByPos(o.detail[1],f,m,c),a.default.formatByPos(o.detail[2],y)];break;case"FreeTrial":o.detail=[a.default.formatByPos(o.detail[0],m,f),a.default.formatByPos(o.detail[1],y),o.detail[2]];break;case"DepositeGroup":o.detail=[a.default.formatByPos(o.detail[0],m,f),a.default.formatByPos(o.detail[1],c),o.detail[2],a.default.formatByPos(o.detail[3],y),o.detail[4]]}return o}}; 
 			}); 
		define("common/buy_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e(require("../storage/ram_manager")),a=e(require("../components/sku_selector/sku_selector_v2")),t=(e(require("../constants/tracking/goods")),e(require("./navigation"))),u=(e(require("../configs/api")),require("../common/index")),l=e(require("../controller/formid_controller")),n={LANG_SHOULD_BUY_IN_APP:"该商品在拼多多app中才能购买",LANG_NOT_SUPPORT_BUY:"在小程序中暂不支持购买该类商品",LANG_LOTTERY_CANNOT_SINGLE_BUY:"抽奖活动暂不支持单独购买",LANG_FREE_TRIAL_CANNOT_SINGLE_BUY:"免费试用活动暂不支持单独购买",LANG_CAPITAL_CANNOT_SINGLE_BUY:"团长送礼活动暂不支持单独购买"},s={getPriceRange:function(e,r){var o={normal:[r.minOnsaleNormalPrice],group:[r.minOnsaleGroupPrice]};return r.minOnsaleNormalPrice!==r.maxOnsaleNormalPrice&&o.normal.push(r.maxOnsaleNormalPrice),r.minOnsaleGroupPrice!==r.maxOnsaleGroupPrice&&o.group.push(r.maxOnsaleGroupPrice),e.requireNum>1?o.group:o.normal},showSkuSelector:function(e){try{var t=o.default.CPPage,u=t.data.goodsInfo,l=t.$pageName;if(!u)return;var n=t.data.selectedGroup||u.groupTypes[1],s=u.hdThumbUrl||u.thumbUrl,i="object"===r(t.data.currentSelect)?JSON.parse(JSON.stringify(t.data.currentSelect)):{},d={discount:u.discount,goodsId:u.goodsId,eventType:u.eventType,hasLocalGroup:u.hasLocalGroup?"1":"0",skus:u.skus,defaultImg:s,priceRange:t.getPriceRange(n,u),selectedGroup:n,orderLimit:n.orderLimit,lastSelectSku:i,lastSelectGoodsNumber:t.data.goodsNumber||1,isGroupBuy:n.requireNum>1,pageName:l,localGroupOrderId:e};a.default.load(d)}catch(e){console.error(e)}},groupBuy:function(e){var r=o.default.CPPage,t=r.data.goodsInfo;t&&t.isOnSale&&(t.isApp?r.$showToast(n.LANG_SHOULD_BUY_IN_APP):(r.referPageElement="open_btn",r.setData({selectedGroup:t.groupTypes[1],selectedLocalGroupOrderId:null}),r.hasSkuSelector?r.showSkuSelector():a.default.confirmOrder(),e&&e.detail&&e.detail.formId&&l.default.uploadFormIdToSH(e.detail.formId,!1),t.isLottery?s.clickTracking("going_draw"):s.clickTracking("open_btn")))},singleBuy:function(e){var r=o.default.CPPage,t=r.data.goodsInfo;t&&t.isOnSale&&(t.isApp?r.$showToast(n.LANG_SHOULD_BUY_IN_APP):t.isLottery?r.$showToast(n.LANG_LOTTERY_CANNOT_SINGLE_BUY):t.isFreeTrial?r.$showToast(n.LANG_FREE_TRIAL_CANNOT_SINGLE_BUY):t.isCapitalGift||t.isCapitalGiftLottery?r.$showToast(n.LANG_CAPITAL_CANNOT_SINGLE_BUY):(r.referPageElement="single_buy",r.setData({selectedGroup:t.groupTypes[0],selectedLocalGroupOrderId:null}),r.hasSkuSelector?r.showSkuSelector():a.default.confirmOrder(),e&&e.detail&&e.detail.formId&&l.default.uploadFormIdToSH(e.detail.formId,!1),s.clickTracking("single_buy")))},clickTracking:function(e){var r=o.default.CPPage.data.goodsInfo||{},a={op:"click",page_section:"bottom_bar",page_element:e,goods_id:r.goodsId,event_type:r.eventType,has_local_group:r.hasLocalGroup?"1":"0",sku_num:r.skus.length};(0,u.TrackingRecord)(a)},groupBuyOrPromptShare:function(e){var r=o.default.CPPage,a=r.goodsBottomBarData;if(a&&a.inGroup){var u=r.$urlQueryObj.group_order_id;if(u){var l=getCurrentPages();return void(l.length>=2&&"pages/group/group"==l[l.length-2].__route__?t.default.back():t.default.forward("/pages/group/group?group_order_id="+u))}}r.groupBuy&&r.groupBuy()}};exports.default=s; 
 			}); 
		define("common/data_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=function(r){return r&&r.__esModule?r:{default:r}}(require("../configs/app_config")),t={isArray:function(r){return"[object Array]"===Object.prototype.toString.call(r)},transToCamel:function(r){if(r)return r.replace(/_(\w)/g,function(r,t){return t.toUpperCase()})},formatByPos:function(r){for(var t=[],e=1;e<arguments.length;++e)t.push(arguments[e]);return r.replace(/{(\d+)}/g,function(r,e){return null==t[e]?r:t[e]})},getLogId:function(){return[Date.now(),this.getRandomString(16)].join("")},getRandomString:function(r){r=r||32;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=t.length,n="",a=0;a<r;a++)n+=t.charAt(Math.floor(Math.random()*e));return n},getStringCharLength:function(r){for(var t=0,e=0;e<r.length;e++)r.charCodeAt(e)<0||r.charCodeAt(e)>255?t+=2:t+=1;return t},formatMobile:function(r){for(var t="",e=r.length,n=0;n<e;n++)r.charCodeAt(n)<255&&(t+=r.substr(n,1));return t.replace(/\s|\-/g,"").replace(/^\+86/,"")},dealWithAvatarURL:function(t){return null==t||""==t?r.default.logo:"/0"==t.substr(-2)?t.slice(0,-1)+"132":t},getLotteryRule:function(r){var t=this.getResultByScene(UserGrade.Scene.LotteryRule);return 0===t?r&&r.isFreeTrial?"免费试用规则":"抽奖规则":1===t?"规则":""},trans36To10:function(r){r=r||"";var t="0123456789abcdefghijklmnopqrstuvwxyz",e=t.length,n=0,a=1;if(r.length>0)for(var o=r.length-1;o>=0;o--)n+=t.indexOf(r[o])*a,a*=e;return n},formatSpecs:function(r){var t=null;try{t=JSON.parse(r)}catch(r){t=[]}return t&&Array.isArray(t)?t.map(function(r,t){return r.spec_key&&r.spec_value?r.spec_key+":"+r.spec_value:""}):[]},detectReqDataIsError:function(r,t,e){return e=e||{},!!r.error_code&&("function"==typeof t&&t(r.error_msg),!0)},objectArrayDuplicateRemove:function(r,t,e){var n=[],a={},o=!0,c=!1,i=void 0;try{for(var u,l=r[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var f=u.value;(t?a[f[t]]:a[f])||("function"==typeof e&&e(f)||(n.push(f),t?a[f[t]]=!0:a[f]=!0))}}catch(r){c=!0,i=r}finally{try{!o&&l.return&&l.return()}finally{if(c)throw i}}return n},removeItemByKey:function(r,t,e){return!Array.isArray(r)&&(r=[]),r.filter(function(r){return r[t]!=e})},ObjectArrToStringArr:function(r,t,e){return r.map(function(r){return r[e]})},checkByKey:function(r,t,e){if(!Array.isArray(r))return{};var n=!0,a=!1,o=void 0;try{for(var c,i=r[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var u=c.value;if(u[e]==t)return u}}catch(r){a=!0,o=r}finally{try{!n&&i.return&&i.return()}finally{if(a)throw o}}return{}},checkIndexByKey:function(r,t,e){if(Array.isArray(r)){var n=void 0;return r.forEach(function(r,a){r[e]==t&&(n=a)}),n}},accAdd:function(r,t){var e,n,a,o;try{e=r.toString().split(".")[1].length}catch(r){e=0}try{n=t.toString().split(".")[1].length}catch(r){n=0}if(o=Math.abs(e-n),a=Math.pow(10,Math.max(e,n)),o>0){var c=Math.pow(10,o);e>n?(r=Number(r.toString().replace(".","")),t=Number(t.toString().replace(".",""))*c):(r=Number(r.toString().replace(".",""))*c,t=Number(t.toString().replace(".","")))}else r=Number(r.toString().replace(".","")),t=Number(t.toString().replace(".",""));return(r+t)/a},accSub:function(r,t){var e,n,a,o;try{e=r.toString().split(".")[1].length}catch(r){e=0}try{n=t.toString().split(".")[1].length}catch(r){n=0}return a=Math.pow(10,Math.max(e,n)),o=e>=n?e:n,((r*a-t*a)/a).toFixed(o)},accMul:function(r,t){var e=0,n=r.toString(),a=t.toString();try{e+=n.split(".")[1].length}catch(r){}try{e+=a.split(".")[1].length}catch(r){}return Number(n.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,e)},accDiv:function(r,t){var e,n,a=0,o=0;try{a=r.toString().split(".")[1].length}catch(r){}try{o=t.toString().split(".")[1].length}catch(r){}return e=Number(r.toString().replace(".","")),n=Number(t.toString().replace(".","")),e/n*Math.pow(10,o-a)},isObject:function(r){return r&&"[object Object]"===r.toString()&&Object.keys(r).length>0}};exports.default=t; 
 			}); 
		define("common/event_queue.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(require("./util")),r=function(){function r(e){t(this,r),this.handlerArr=[],this.handlerStatue={},this.context=e}return e(r,[{key:"triggerHandler",value:function(t){if(!isNaN(this.handlerStatue[t])&&this.handlerStatue[t]>0){var e=this.handlerArr.shift();return"function"==typeof e&&(e.apply(this.context,[]),this.handlerStatue[t]--),this}if(!t){var n=this.handlerArr.shift();"function"==typeof n&&n()}return this}},{key:"pushHandler",value:function(t,e){var r=this.context;if("string"==typeof t&&"function"==typeof r[t]&&this.handlerArr.push(r[t]),"string"==typeof e&&"function"==typeof r[e]){if(isNaN(this.handlerStatue[e]))return r[e]=n.default.wrapFunc(n.default.bind(this.triggerHandler,this,e),r[e]),void(this.handlerStatue[e]=1);this.handlerStatue[e]++}}}]),r}();exports.default=r; 
 			}); 
		define("common/filter_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../constants/goods")),d=e(require("../constants/groups")),T={filter:function(e,T){e=parseInt(e,10),T=parseInt(T,10);var E=[t.default.GoodsType.DEFAULT,t.default.GoodsType.IMPORTS,t.default.GoodsType.OVERSEAS_TRANSSHIP,t.default.GoodsType.OVERSEAS_DM,t.default.GoodsType.MOBILE_DATA,t.default.GoodsType.MOBILE_FARE,t.default.GoodsType.TRADE_COUPON,t.default.GoodsType.QQ_COIN,t.default.GoodsType.OIL_CARD],u=[d.default.EventType.DEFAULT,d.default.EventType.SPIKE,d.default.EventType.FREE_GROUP,d.default.EventType.SUPER_SPIKE,d.default.EventType.FREE_TRIAL,d.default.EventType.LUCKY_DRAW,d.default.EventType.NEW_USER_GROUP,d.default.EventType.LIMIT_TIME_FREE,d.default.EventType.MORE_THAN_ONE_DISCOUNT,d.default.EventType.LIMIT_TIME_DISCOUNT,d.default.EventType.LIMIT_COUNT_DISCOUNT];return E.indexOf(T)>=0&&u.indexOf(e)>=0}};exports.default=T; 
 			}); 
		define("common/gotop_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var o=e(require("./system_info")),t=e(require("./logger")),s={showGoTopBtn:function(e,t){t&&!isNaN(e)&&(t.winHeight||(t.winHeight=o.default.getWindowHeightSync()),e>t.winHeight?t.data.goTopClass||t.setData({goTopClass:!0}):t.data.goTopClass&&t.setData({goTopClass:!1}))},goTop:function(e){wx.pageScrollTo&&wx.pageScrollTo({scrollTop:0}),e||t.default.send({op:"click",event:"pop_btn_clk",page_section:"pop_list",page_element:"top_btn"})}};exports.default=s; 
 			}); 
		define("common/image_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var n=e(require("../constants/image")),t=e(require("../storage/webp_test_storage")),s=e(require("../configs/app_config")),i={getCDNImgURL:function(e,n){var e="http://pinduoduoimg.yangkeduo.com/"+e;return(n=n||{}).doCompress&&(e=this.cdnCompress(e,n.type,n.webpEnable)),e},cdnCompress:function(e,s,i){var o=t.default.isWebpEnable();return(e=e||"").indexOf("!")>=0||e.indexOf("@")>=0?e:(e.indexOf("upaiyun.com")>0?(s=s||"750",e.indexOf("weishoptest")>0?e+="!640":e+="!"+s):(e.indexOf("img-cn-shanghai.aliyuncs.com")>0||e.indexOf("img.yangkeduo.com")>=0)&&(s=s||n.default.CompressPipe.Default,e+="@"+(s+=i||o?".webp":".src")),e)},getAvatarURL:function(e,n){return n=n||100,null==e||""==e?s.default.logo:e.indexOf("avatar.yangkeduo.com")>=0?[e.split("?")[0],"x-oss-process=image/resize,w_"+n].join("?"):"/0"==e.substr(-2)?e.slice(0,-1)+"132":e}};exports.default=i; 
 			}); 
		define("common/index.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PddPage=exports.ActivityUtils=exports.PageUtil=exports.Share=exports.MonitorRecord=exports.TrackingRecord=exports.StorageUtil=exports.Util=exports.User=exports.UrlUtil=exports.TimeUtil=exports.SystemInfo=exports.StdFormat=exports.Request=exports.Payment=exports.ObjectUtil=exports.Navigation=exports.Logger=exports.ImageUtil=exports.FilterUtil=exports.DataUtil=void 0;var t=e(require("./data_util")),r=e(require("./filter_util")),i=e(require("./image_util")),o=e(require("./logger")),s=e(require("./navigation")),u=e(require("./object_util")),l=e(require("./payment")),a=e(require("./request")),p=e(require("./std_format")),x=e(require("./system_info")),d=e(require("./time_util")),f=e(require("./url_util")),n=e(require("./user")),U=e(require("./util")),g=e(require("./share")),q=e(require("./page_util")),c=e(require("./activity_utils")),_=e(require("./storage_util")),m=e(require("./pdd_page"));exports.DataUtil=t.default,exports.FilterUtil=r.default,exports.ImageUtil=i.default,exports.Logger=o.default,exports.Navigation=s.default,exports.ObjectUtil=u.default,exports.Payment=l.default,exports.Request=a.default,exports.StdFormat=p.default,exports.SystemInfo=x.default,exports.TimeUtil=d.default,exports.UrlUtil=f.default,exports.User=n.default,exports.Util=U.default,exports.StorageUtil=_.default,exports.TrackingRecord=function(e,t){o.default.send(e,t)},exports.MonitorRecord=function(e){o.default.sendMonitor(e)},exports.Share=g.default,exports.PageUtil=q.default,exports.ActivityUtils=c.default,exports.PddPage=m.default; 
 			}); 
		define("common/logger.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("./data_util")),r=e(require("./url_util")),n=e(require("../configs/app_config")),o=e(require("./object_util")),i=e(require("./system_info")),a=e(require("./request")),s=e(require("../storage/ram_manager")),d=e(require("../libs/co/we-index")),u=e(require("../libs/regenerator-runtime/runtime")),g=require("./message"),f=e(require("./logger_util")),c=e(require("../storage/user_storage")),l=e(require("./visitor_logger")),_={monitorLogArray:[],isMonitorSending:!1,failedMonitorLogs:[],trackLogArray:[],isTrackSending:!1,failedTrackLogs:[],addMsgObserver:function(){var e=this;g.Message.on(g.KEYS.MONITOR_FROM_REQUEST,function(t){e.sendMonitor(t)}),g.Message.on(g.KEYS.SOCKET_OPEN,function(t){t=o.default.assign({socket_type:"SOCKET_OPEN",record_type:"WEB_SOCKET"},t),e.sendMonitor(t)}),g.Message.on(g.KEYS.SOCKET_ERROR,function(t){t=o.default.assign({socket_type:"SOCKET_ERROR",record_type:"WEB_SOCKET"},t),e.sendMonitor(t)}),g.Message.on(g.KEYS.SOCKET_CLOSED,function(t){t=o.default.assign({socket_type:"SOCKET_CLOSED",record_type:"WEB_SOCKET"},t),e.sendMonitor(t)}),g.Message.on(g.KEYS.AUTH_OK,function(t){t=o.default.assign({auth_type:"AUTH_OK",record_type:"WEB_SOCKET"},t),e.sendMonitor(t)}),g.Message.on(g.KEYS.UNDEFINED_EVENT_TYPE,function(t){t=o.default.assign({event_type:"UNDEFINED",record_type:"EVENT_TYPE"},t),e.sendMonitor(t)}),g.Message.on(g.KEYS.AUTH_FAIL,function(t){t=o.default.assign({auth_type:"AUTH_FAIL",record_type:"WEB_SOCKET"},t),e.sendMonitor(t)}),g.Message.on(g.KEYS.STORAGE_FAIL,function(t){t=o.default.assign({record_type:"LOCAL_STORAGE"},t),e.sendMonitor(t)}),g.Message.on(g.KEYS.ORDER_CHECKOUT_PAY,function(t){"requestPayment:ok"!==t.errorMsg&&(t=o.default.assign({record_type:"PAY_FAILED"},t),e.sendMonitor(t))})},send:function(e,t){if(e){var o=this;(0,d.default)(u.default.mark(function i(){var d,g;return u.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e=f.default.getData(e),s.default.openId&&(e.openId=s.default.openId),d=r.default.buildQuery(e),(g=s.default.logginURL)||(g=n.default.logginURL),a.default.apiRequest("POST",g,d,!0,{dontAddUidAndFlag:!0}).then(function(e){},function(t){o.trackLogArray.push(e)}),"function"==typeof t&&t();case 7:case"end":return i.stop()}},i,this)}))}},canReport:function(e){var t=e.request_url||"",r=e.status||"FAILED";if(t.indexOf("p.gif")>=0)return!1;if(t.indexOf("t.gif")>=0&&"SUCCESS"==r)return!1;var n=s.default.blockLevel,o=!0;return-1==n?o=!1:0==n?o=!0:1==n?"WEB_SOCKET"==e.record_type&&(o=!1):2==n?"WEB_SOCKET"!=e.record_type&&"PAGE_INIT_TIME"!=e.record_type||(o=!1):o=3!=n||"NETWORK_TIME"==e.record_type,o},sendMonitor:function(e){if(e&&this.canReport(e)){var r=i.default.getSystemInfoSync(),a={screen_width:r.screenWidth,screen_height:r.screenHeight,dpr:r.pixelRatio,app_version:n.default.version,time:Date.now()+s.default.timeDiff,scene_id:s.default.sceneId,mobile_model:r.model,mobile_platform:r.platform,mobile_system:r.system,wx_version:r.version,sdk_version:r.SDKVersion||"sdk_version is empty",network_type:s.default.networkType,log_id:t.default.getLogId(),user_id:"LOCAL_STORAGE"==e.record_type?"user_id is empty":c.default.getUserId()||"user_id is empty",trace_id:"LOCAL_STORAGE"==e.record_type?"trace_id is empty":l.default.getVisitorLocalInfo().xcxTraceId||"trace_id is empty"};e=o.default.assign({},a,e),this.monitorLogArray.push(e),this.monitorLogArray.length+this.failedMonitorLogs.length>=10&&this.execSendMonitorLog()}},triggerSendMutiLog:function(){this.execSendTrackLog(),this.execSendMonitorLog()},execSendMonitorLog:function(){var e=this;try{var t=s.default.monitorUrl;if(e.isMonitorSending||!t)return;var n=e.monitorLogArray;if(e.failedMonitorLogs.length>0&&(n=e.monitorLogArray.concat(e.failedMonitorLogs),e.failedMonitorLogs=[]),e.monitorLogArray=[],0==n.length)return;var o=n.map(function(e){return r.default.buildQuery(e)}).join("\n");o.indexOf("t.gif")>0&&(t+="?has_log_error=1"),e.isMonitorSending=!0,a.default.apiRequest("POST",t,o,!0).then(function(t){e.isMonitorSending=!1,e.monitorLogArray.length+e.failedMonitorLogs.length>=10&&e.execSendMonitorLog()},function(t){e.isMonitorSending=!1,e.failedMonitorLogs=n})}catch(t){e.isMonitorSending=!1,console.error(t)}},execSendTrackLog:function(){function e(e){t.isTrackSending=!1,e?t.trackLogArray.length>0&&t.execSendTrackLog():t.failedTrackLogs=o}var t=this;if(!this.isTrackSending){var o=this.trackLogArray.concat(this.failedTrackLogs);if(this.trackLogArray=[],this.failedTrackLogs=[],!(o.length<=0)){var i=o.map(function(e){return r.default.buildQuery(e)}).join("\n");t.isTrackSending=!0;var d=s.default.logginURL;d||(d=n.default.logginURL),a.default.apiRequest("POST",d,i,!0,{dontAddUidAndFlag:!0}).then(function(){return e(!0)},function(){return e(!1)})}}}};exports.default=_; 
 			}); 
		define("common/logger_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("./data_util")),a=e(require("../storage/user_storage")),t=e(require("../configs/app_config")),n=e(require("./object_util")),f=require("../constants/tracking/keys"),u=e(require("../constants/tracking/refer")),i=e(require("../constants/tracking/coupon_msg")),d=e(require("./system_info")),s=e(require("./page_util")),l=e(require("./visitor_logger")),g=e(require("../storage/ram_manager")),o=d.default.getSystemInfoSync(),p={screen_width:o.screenWidth||o.windowWidth,screen_height:o.screenHeight||o.windowHeight,dpr:o.pixelRatio,app_version:t.default.version,app:"pdd",page:"",platform:"wxapp",manufacture:o.brand,model:o.model,sdk_version:o.SDKVersion},c={convertNetwork:function(e){return"wifi"==e?1:"2g"==e?2:"3g"==e?3:"4g"==e?4:0},getData:function(e){var r=(s.default.getCurPage().__route__||"").split("/");r.length>0&&(p.page=r[r.length-1]);var t=a.default.getUserLocalInfo();return t&&(p.gender=t.gender||"0",p.province=t.province||"0",p.city=t.city||"0"),p.network=this.convertNetwork(g.default.networkType),e.user_id=a.default.getUserId()||"",e.withoutCompleteOpts?(delete e.withoutCompleteOpts,n.default.assign({},p,e)):n.default.assign({},p,this.completeOpts(e))},completeOpts:function(e){var d=s.default.getCurPageQueryObj();e.page&&-1===e.page.indexOf(p.page)&&-1===p.page.indexOf(e.page)&&(e.page=p.page+"."+e.page),e.log_id=e.log_id||r.default.getLogId(),e.token=e.token||a.default.getAccessToken()||"",e.app_id=e.app_id||t.default.appId||"",e.time=e.time||e.log_id.substring(0,13);var o=g.default.timeDiff;e.time=parseInt(e.time)+o+"",e.page_name=e.page_name?e.page_name:s.default.getCurPageName(),e.page_id=g.default.CPPage.pageId||"";var c=s.default.getKeyParams();for(var _ in c)e[_]||(e[_]=c[_]);g.default.referPageName&&(e.refer_page_name=g.default.referPageName,e.refer_page_id=g.default.referPageId),g.default.referPageSn&&(e.refer_page_sn=g.default.referPageSn),g.default.pddUserType&&(e.pdd_user_type=g.default.pddUserType),g.default.ncTest&&(e.nc_test=g.default.ncTest),g.default.rpTest&&(e.gs_test=g.default.rpTest),g.default.rpShareTest&&(e.refer_rp_share_test=g.default.rpShareTest),["pv","click"].indexOf(e.op)>=0&&f.TrackingChannels.forEach(function(r){var a="refer_channel_"+r,t=e[a]||d[r];t&&"null"!==t&&(e[a]=t)});var v=l.default.getVisitorLocalInfo();if(v&&(e.xcx_trace_id=v.xcxTraceId),"pv"===e.op){if(function(){var e=!1;for(var r in f.ReferShareKeys){var a=f.ReferShareKeys[r];if((d[a]||d[a.slice(6)])&&g.default.carryReferShare){e=!0;break}}return e}()&&(f.ReferShareKeys.forEach(function(r){var a=d[r]||d[r.slice(6)];e[r]=a}),g.default.carryReferShare=!1),d[i.default.QueryKey]===i.default.QueryValue){var m=i.default.EventValueByPageName[e.page_name];m&&(e.event=m)}g.default.carrySceneId?(e.scene_id=g.default.sceneId,g.default.carrySceneId=!1):e.scene_id=null,e.event="page_show","1"===d.is_back&&(e.is_back="1")}for(var h in u.default.PV)e["refer_"+h]=u.default.PV[h];var y={},P=s.default.getCurPageQueryObj()||{};if(s.default.getCurPage().$carryRefer){var k=this.getPageRefer()||{};e=n.default.assign(e,k);for(var w in P)w&&P.hasOwnProperty(w)&&0!==w.indexOf("refer_")&&P[w]&&"null"!==P[w]&&(e["refer_"+w]=P[w],w.indexOf("xcx_campaign_id")>=0&&(y[w]=P[w]))}return n.default.assign(u.default.PV,y),e.refer_channel_msgid=e.refer_channel_msgid||d.msgid,g.default.sourceId&&(e.refer_source_id=g.default.sourceId),e},getPageRefer:function(){var e={},r=s.default.getCurPageQueryObj();if(r)for(var a in r)r.hasOwnProperty(a)&&0===a.indexOf("refer_")&&null!=r[a]&&(e[a]=r[a]);return e}};exports.default=c; 
 			}); 
		define("common/message.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KEYS=exports.Message=void 0;var E=new(function(E){return E&&E.__esModule?E:{default:E}}(require("./pubsub")).default),_={PAGE_MAIN_REQUEST_FINISHED:"PAGE_MAIN_REQUEST_FINISHED",TRACKING_FROM_REQUEST:"TRACKING_FROM_REQUEST",MONITOR_FROM_REQUEST:"MONITOR_FROM_REQUEST",REQUEST_NEED_LOGIN:"REQUEST_NEED_LOGIN",LC_ENTRY_GET_OPEN_GID:"LC_ENTRY_GET_OPEN_GID",LC_DRAW_GET_OPEN_GID:"LC_DRAW_GET_OPEN_GID",PROMOTION_MAIN_GET_OPEN_GID:"PROMOTION_MAIN_GET_OPEN_GID",OPEN_ENVELOPE_GET_OPEN_GID:"OPEN_ENVELOPE_GET_OPEN_GID",SOCKET_OPEN:"SOCKET_OPEN",SOCKET_ERROR:"SOCKET_ERROR",SOCKET_CLOSED:"SOCKET_CLOSED",AUTH_OK:"AUTH_OK",AUTH_FAIL:"AUTH_FAIL",STORAGE_FAIL:"STORAGE_FAIL",BUBBLE_MESSAGE:"BUBBLE_MESSAGE",UNREAD_MESSAGE_COUNT:"UNREAD_MESSAGE_COUNT",CUSTOM_SERVICE_MESSAGE:"CUSTOM_SERVICE_MESSAGE",RECONNECT_ERROR:"RECONNECT_ERROR",WAIT_FOR_SPIKE_SHOW:"WAIT_FOR_SPIKE_SHOW",ORDERCHECKOUT_CHOOSE_ADDRESS:"ORDERCHECKOUT_CHOOSE_ADDRESS",LOCAL_MANAGE_ORDERS:"LOCAL_MANAGE_ORDERS",AUTO_CREATE_ORDER_CHECKOUT_PAY:"AUTO_CREATE_ORDER_CHECKOUT_PAY",ORDER_CHECKOUT_PAY:"ORDER_CHECKOUT_PAY",REQUEST_TOKEN_INVALID:"REQUEST_TOKEN_INVALID",USER_LOGIN_FINISHED:"USER_LOGIN_FINISHED",NO_ORDER_USER_CHECK_FINISHED:"NO_ORDER_USER_CHECK_FINISHED",UNDEFINED_EVENT_TYPE:"UNDEFINED_EVENT_TYPE"};exports.Message=E,exports.KEYS=_; 
 			}); 
		define("common/navigation.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e){var r=e.split("?"),t="";r.length>1&&(t=r[1]);var n=i.default.parseUrlQueryStr(t),o=r[0]+"?"+i.default.buildQuery(u.default.assign({},n,{}));return a.default.removePageInfo(o.slice(1)),o}function t(e){for(var r=0;r<d.length;r++)if(e.indexOf(d[r])>=0)return!0;for(var t=["goods","order","group","selfMessageProgress_detail"],a=0;a<t.length;a++)if(s.default.isLastPageService&&e.indexOf(t[a])>=0)return s.default.isLastPageService=!1,!0;return!1}Object.defineProperty(exports,"__esModule",{value:!0});var a=e(require("./page_util")),i=e(require("./url_util")),u=e(require("./object_util")),n=e(require("./util")),o=e(require("./preload")),s=e(require("../storage/ram_manager")),d=["/addresses"],f={route:function(e,a,i){a=a||"forward",i=i||{},"switchTab"!==a&&"back"!==a&&(e=r(e)),"forward"===a&&getCurrentPages().length>=(t(e)?5:4)&&(a="redirect");var u=e;if(e&&e.indexOf("?")>=0&&(u=e.split("?")[0]||""),"forward"===a||"redirect"===a){if(!this.canContinue(e))return;s.default.inTransitionPage=u,s.default.transitionStartTime=Date.now()}switch(o.default.preloadData(null,e),a){case"forward":return n.default.promisifyAPI(wx.navigateTo)({url:e});case"redirect":return n.default.promisifyAPI(wx.redirectTo)({url:e});case"switchTab":return n.default.promisifyAPI(wx.switchTab)({url:e});case"back":var d=i.backNum||1;setTimeout(function(){wx.navigateBack({delta:d})},300)}},forward:function(e,r,t){this.route(e,"forward")},redirectForward:function(e,r,t){this.route(e,"redirect")},back:function(e){this.route("","back",{backNum:e})},canContinue:function(e){var r=e.split("?")[0]||"";return!r||r!=s.default.inTransitionPage},toIndexPage:function(){this.route("/pages/index/index","switchTab")}};exports.default=f; 
 			}); 
		define("common/object_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={assign:function(e){if("function"!=typeof Object.assign){if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var r=arguments[t];if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}return Object.assign.apply(Object,arguments)}};exports.default=e; 
 			}); 
		define("common/order_utils.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e&&e.__esModule?e:{default:e}}(require("../constants/order")),t=e.default.LotteryStatus,d={getOrderCombinedStatus:function(d,u,r,n,a){var i=a&&a.eventType;if(u==e.default.PaymentStatus.RefundApplied&&i!=e.default.EVENT_TYPE.LUCKY_DRAW&&i!=e.default.EVENT_TYPE.FREE_TRIAL&&(u=e.default.PaymentStatus.Payed),n>t.Start&&d==e.default.OrderStatus.Unconfirmed){if(u==e.default.PaymentStatus.Payed)return e.default.OrderCombinedStatus.Expired;if(u==e.default.PaymentStatus.RefundApplied)return e.default.OrderCombinedStatus.UnconfirmedRefunding;if(u==e.default.PaymentStatus.Refunded)return e.default.OrderCombinedStatus.UnconfirmedRefunded}if(u==e.default.PaymentStatus.Unpayed)return d==e.default.OrderStatus.Cancelled||n>t.Start?e.default.OrderCombinedStatus.Cancelled:e.default.OrderCombinedStatus.Unpayed;if(u==e.default.PaymentStatus.Payed)if(r==e.default.ShipmentStatus.Unshipped){if(d==e.default.OrderStatus.Unconfirmed)return e.default.OrderCombinedStatus.Unconfirmed;if(d==e.default.OrderStatus.Confirmed)return e.default.OrderCombinedStatus.Confirmed}else{if(r==e.default.ShipmentStatus.Shipping)return e.default.OrderCombinedStatus.Shipping;if(r==e.default.ShipmentStatus.Received)return e.default.OrderCombinedStatus.Received}else if(u==e.default.PaymentStatus.RefundApplied){if(d==e.default.OrderStatus.Unconfirmed)return e.default.OrderCombinedStatus.UnconfirmedRefunding;if(r==e.default.ShipmentStatus.Unshipped)return e.default.OrderCombinedStatus.UnshippedRefunding;if(r==e.default.ShipmentStatus.Shipping||r==e.default.ShipmentStatus.Received)return e.default.OrderCombinedStatus.ShippingRefunding}else if(u==e.default.PaymentStatus.Refunded)return d==e.default.OrderStatus.Unconfirmed?e.default.OrderCombinedStatus.UnconfirmedRefunded:r==e.default.ShipmentStatus.Unshipped?e.default.OrderCombinedStatus.UnshippedRefunded:e.default.OrderCombinedStatus.ShippingRefunded;return null},getOrderCombinedStatusDescription:function(d,u,r,n){switch(d){case e.default.OrderCombinedStatus.Unpayed:return u>t.Start?"交易已取消":"待支付";case e.default.OrderCombinedStatus.Unconfirmed:return"拼团中";case e.default.OrderCombinedStatus.Confirmed:return u===t.Complete?r?"一等奖，待发货":"二等奖，已退款并送券":u===t.Start?"已成团，待抽奖":null!=u?"开奖中":"已成团，待发货";case e.default.OrderCombinedStatus.Shipping:return u===t.Complete&&r?"一等奖，待收货":"待收货";case e.default.OrderCombinedStatus.Received:var a="已签收";return"1"==n?a="待评价":"0"==n&&(a="已评价"),u===t.Complete&&r?"一等奖，"+a:a;case e.default.OrderCombinedStatus.Cancelled:return"交易已取消";case e.default.OrderCombinedStatus.UnshippedRefunding:return u!==t.Complete||r?"未发货，退款处理中":"二等奖，退款中";case e.default.OrderCombinedStatus.UnshippedRefunded:return u!==t.Complete||r?"未发货，退款成功":"二等奖，已退款并送券";case e.default.OrderCombinedStatus.ShippingRefunding:return"已发货，退款处理中";case e.default.OrderCombinedStatus.ShippingRefunded:return"已发货，退款成功";case e.default.OrderCombinedStatus.Expired:return"拼团失败";case e.default.OrderCombinedStatus.UnconfirmedRefunding:return"未成团，退款处理中";case e.default.OrderCombinedStatus.UnconfirmedRefunded:return"未成团，退款成功";default:return""}}};exports.default=d; 
 			}); 
		define("common/page_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=require("../constants/page"),u=e(require("./data_util")),n=e(require("./url_util")),a=e(require("./object_util")),o={};exports.default={getCurPage:function(){var e=getCurrentPages(),t={};return e.length>0&&(t=e[e.length-1]||{}),t},getKeyParamsFromQuery:function(e){e||(e=this.getCurPage());var u=e.$urlQueryObj||{},n=this.getCurPageKey(),a={};return(((r.PageInfo[n]||{}).pv||{}).keys||[]).forEach(function(e){var r=void 0,n=void 0;"string"==typeof e?n=u[r=e]:"object"===(void 0===e?"undefined":t(e))&&(r=e.key,null==(n=u[r])&&null!=e.default&&(n=e.default)),null!=r&&null!=n&&(a[r]=n)}),a},getKeyParams:function(){var e=this.getCurPage(),t=e.$trackingKeyParams||{},r=this.getKeyParamsFromQuery(e)||{};return a.default.assign(r,t)},getCurPageName:function(){var e=this.getCurPageKey()||"";return(r.PageInfo[e]||{}).pageName||e},getCurPageKey:function(){var e="",t=this.getCurPageRoute().split("/");return t.length>0&&(e=t[t.length-1]),this.specialProcessPageKey(e)},specialProcessPageKey:function(e){var t=this.getCurPage();return"spike"===e&&"HAITAO_SPIKE"===(t.$urlQueryObj.type||"SPIKE")&&(e="haitao_spike"),e},getCurPageFullPath:function(){var e=this.getCurPage();return(e.__route__||"")+"?"+n.default.buildQuery(e.$urlQueryObj||{})},getCurPageQueryObj:function(){return this.getCurPage().$urlQueryObj||{}},getCurPageRoute:function(){return(this.getCurPage()||{}).__route__||""},getPageInfo:function(e){return o[e]||(o[e]={}),o[e]},getPageId:function(e){var t=this.getCurPageName();e=e||this.getCurPageFullPath();var r=this.getPageInfo(e);return r.pageId||(r.pageId=[t||"",Date.now(),u.default.getRandomString(10)].join("_")),r.pageId},removePageInfo:function(e){delete o[e]}}; 
 			}); 
		define("common/payment.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e(require("../configs/app_config")),n=e(require("./request")),r=e(require("../configs/api")),u=e(require("./url_util")),i=e(require("../constants/payment")),c={onSuccess:null,onFail:null,onComplete:null,handlePayError:function(e){var t=e.err_code||e.error_code||-1,o=e.err_desc||e.errMsg||e.error_msg;"47001"==t&&(o="支付失败，限时折扣活动已结束"),"function"==typeof this.onFail&&this.onFail({errorCode:t,errorMsg:o}),"function"==typeof this.onComplete&&this.onComplete({errorCode:t,errorMsg:o})},pay:function(e,t,c,a){var f=this;this.onSuccess=t,this.onFail=c,this.onComplete=a;var s=o.default.payAppId,l=r.default.prePay+"?"+u.default.buildQuery({order_sn:e,app_id:s});n.default.apiRequest("POST",l,null).then(function(t){try{wx.requestPayment({timeStamp:t.timeStamp.toString(),nonceStr:t.nonceStr,package:t.package,signType:t.signType,paySign:t.paySign,complete:function(t){i.default.isCancelPay(t.errMsg)?f.unLockOrder(e,t,f.onComplete):("function"==typeof f.onComplete&&f.onComplete(t),f.afterPay(e,t))}})}catch(t){"function"==typeof f.onComplete&&f.onComplete({errMsg:"wx.requestPayment try-catch exception",orderSn:e})}},function(e){f.handlePayError(e)})},unLockOrder:function(e,t,o){var u=r.default.unLockOrder+"?order_sn="+e;n.default.apiRequest("POST",u).then(function(){"function"==typeof o&&o(t)},function(){"function"==typeof o&&o(t)})},afterPay:function(e,o){var n=this;!function(e){return"object"==(void 0===e?"undefined":t(e))&&e.errMsg==i.default.WECHAT_PAY_SUCCESS_MSG}(o)?this.unLockOrder(e,o,function(e){n.handlePayError(e)}):"function"==typeof this.onSuccess&&this.onSuccess()}};exports.default=c; 
 			}); 
		define("common/pdd_app.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(){l.default.addMsgObserver(),o.default.doStartupJobs(),wx.getNetworkType({success:function(e){i.default.networkType=e.networkType}}),wx.onNetworkStatusChange&&wx.onNetworkStatusChange(function(e){i.default.networkType=e.networkType}),w(),g()}function t(){i.default.isFirstFavoritUpdate=!1,l.default.triggerSendMutiLog()}function u(){l.default.triggerSendMutiLog()}function n(e){}Object.defineProperty(exports,"__esModule",{value:!0});var a=e(require("./util")),o=e(require("./user")),s=(e(require("../storage/user_storage")),e(require("./data_util")),e(require("./request"))),l=e(require("./logger")),i=e(require("../storage/ram_manager")),c=e(require("../configs/api")),d=e(require("../libs/co/we-index")),f=e(require("../libs/regenerator-runtime/runtime")),p=(e(require("../constants/storage_keys")),e(require("../controller/user_controller"))),g=d.default.wrap(f.default.mark(function e(){var r;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.default.queryWxOpenId();case 3:r=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}},e,this,[[0,6]])})),w=d.default.wrap(f.default.mark(function e(){var r,t,u;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.default.monitorUrl="https://wxapp.yangkeduo.com/p.gif",e.next=4,s.default.apiRequest("GET",c.default.getConfig,{},!0,{dontAddUidAndFlag:!0,forceUseApiGZ:!0});case 4:(r=e.sent)&&r.result&&(r.result.srv_time&&(t=1e3*r.result.srv_time-Date.now(),i.default.timeDiff=t),r.result.report_url&&(i.default.logginURL=r.result.report_url),r.result.analysis_url&&(i.default.monitorUrl=r.result.analysis_url),u=r.result.analysis_block_level||0,i.default.blockLevel=parseInt(u)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));exports.default=function(e,o){e.onLaunch=e.onLaunch?a.default.wrapFunc(e.onLaunch,r):r,e.onShow=e.onShow?a.default.wrapFunc(e.onShow,t):t,e.onError=e.onError?a.default.wrapFunc(e.onError,n):n,e.onHide=e.onHide?a.default.wrapFunc(e.onHide,u):u,App(e)}; 
 			}); 
		define("common/pdd_page.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("./util")),i=(e(require("./user")),e(require("./url_util"))),a=e(require("./object_util")),r=e(require("./data_util")),s=e(require("./logger_util")),o=e(require("./gotop_util")),n=e(require("./navigation")),u=require("./message"),l=require("../configs/page_configs"),d=e(require("../components/toast/toast.js")),c=e(require("../components/modal_dialog/modal_dialog.js")),h=e(require("../components/user_authorize_modal/user_authorize_modal.js")),f=e(require("../constants/share_info")),_=require("../constants/share"),p=e(require("./logger")),g=e(require("./share")),m=e(require("./page_util")),$=e(require("../storage/ram_manager")),b=e(require("./request")),T=e(require("../configs/api")),v=e(require("../libs/co/we-index")),y=(e(require("../libs/es6-promise.min")),e(require("../storage/user_storage")),e(require("../libs/regenerator-runtime/runtime"))),S=(e(require("./preload")),e(require("../constants/tracking/subjects"))),P=e(require("../common/system_info")),w=e(require("../controller/formid_controller")),I=e(require("../common/scene_route")),k=function(e,t){p.default.send(e,t)},O=function(e){p.default.sendMonitor(e)},D={};exports.default=function(e,M){var q=(M=M||{}).pageName;if(e.notUseCommonPV=M.notUseCommonPV,e.pageSn=M.pageSn,!q)throw new Error("[#[Register]page name("+q+") is invalid!]");return e.$pageName=q,e.$urlQueryObj={},e.$urlQueryStr="",e.$pageId=0,e.$firstTimeTrackRecord={pv:!1,impr:!1},e.$onInitTime=0,e.$onLoadTime=0,e.$onShowTime=0,e.$onReadyTime=0,e.$isRecord=!1,e.$carryRefer=!0,e.onShow=t.default.wrapFunc(e.onShow,function(e){this.$onShowTime=(new Date).getTime();var t=this;if($.default.CPSetData=function(e){t.setData(e)},$.default.CPData=this.data,$.default.CPPage=this,this.checkStayHintModal(),$.default.inTransitionPage.indexOf(q)<0?setTimeout(function(){$.default.inTransitionPage="",$.default.transitionStartTime=0},300):this.$onInitTime=$.default.transitionStartTime,!this.$isRecord){var i=this.$onInitTime;this.$onInitTime||(i=this.$onLoadTime);var a=this.$onShowTime-i,r={record_type:"PAGE_INIT_TIME",page_name:q,begin_time:i,end_time:this.$onShowTime,response_time:a,status:"SUCCESS"};O(r),this.$isRecord=!0}$.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.basePvTracking()}),e.basePvTracking=function(){e.notUseCommonPV||(k({op:"pv"}),this.$firstTimeTrackRecord.pv=!0)},e.onReady=t.default.wrapFunc(e.onReady,function(e){this.$onReadyTime=Date.now(),$.default.inTransitionPage.indexOf(q)>=0&&setTimeout(function(){$.default.inTransitionPage="",$.default.transitionStartTime=0},600)}),e.onLoad=t.default.wrapFunc(e.onLoad,function(e){e.scene&&(e=a.default.assign(e,I.default.sceneMap(e.scene))),this.$pageId=$.default.globalPageId++,this.$onLoadTime=Date.now(),e&&(this.$urlQueryObj=i.default.parseQuery(e),this.$urlQueryStr=i.default.buildQuery(this.$urlQueryObj));var t=this;this.$user_authorize_modal=null,$.default.CPSetData=function(e){t.setData(e)},$.default.CPData=this.data,$.default.CPPage=this,this.$firstShow=!0;var s=q;this.pageId=[s||"",Date.now(),r.default.getRandomString(10)].join("_"),this.basePvTracking(),this.$requestFinishHandler||(this.$requestFinishHandler=function(e){if(e.pageId===t.$pageId){var i=t.$onInitTime;t.$onInitTime||(i=t.$onLoadTime);var a=Date.now();O({record_type:"PAGE_FINISH_RENDING_TIME",page_name:q,begin_time:i,end_time:a,response_time:a-i,status:"SUCCESS"})}}),u.Message.on(u.KEYS.PAGE_MAIN_REQUEST_FINISHED,this.$requestFinishHandler,!0)}),e.$deleteShareInfo=function(){for(var e in this.$urlQueryObj)(e.indexOf("share_id")>=0||e.indexOf("share_uid")>=0||e.indexOf("share_channel")>=0||e.indexOf("share_form")>=0||e.indexOf("share_btn")>=0||e.indexOf("share_cid")>=0)&&delete this.$urlQueryObj[e]},e.$doPageOnExit=function(){this.$deleteShareInfo(),this.$hideUserAuthorizeModal(),this.$firstTimeTrackRecord.pv=!1,this.$firstTimeTrackRecord.impr=!1,$.default.isFromAppOnShow=!1,$.default.referPageName=m.default.getCurPageName(),$.default.referPageId=this.pageId,this.$carryRefer=!1,e.pageSn?$.default.referPageSn=e.pageSn:$.default.referPageSn=null,p.default.triggerSendMutiLog()},e.onUnload=t.default.wrapFunc(e.onUnload,function(e){var t=M.pageName;b.default.abortRequestInPage(this,!0,!0),"string"!=typeof this.route&&"string"!=typeof this.__route__&&"string"!=typeof t||(this.route||(this.route=this.__route__),this.route||(this.route="/"+t+"/"),this.route.match(/\/group\//)||this.route.match(/\/order_checkout\//)||($.default.isLastPagePayPage=!1,$.default.hasPaySucess=!1,$.default.isOrderForbidden=!1,$.default.isLastPageGroupPage=!1)),this.$onInitTime=0,this.$onLoadTime=0,this.$onReadyTime=0,this.$onShowTime=0,this.$isRecord=!1,u.Message.off(u.KEYS.PAGE_MAIN_REQUEST_FINISHED,this.$requestFinishHandler),this.$requestFinishHandler=null,this.$doPageOnExit()}),e.onHide=t.default.wrapFunc(e.onHide,function(e){this.$firstShow=!1,this.$doPageOnExit()}),e.$generateShareContent=function(e){e=e||{};var t=this,a=r.default.getRandomString(),o=e.title||f.default.DefaultTitle,n=e.imageUrl||"",l=e.queries||{},d=e.successCallback,c=e.failCallback,h=e.completeCallback,p=(e.page_name,e.path||m.default.getCurPageRoute()||f.default.IndexPageUrl),S=e.referStr||"top_forward",P=e.imageUrl?"custom_card":"card";l.share_form&&(P=l.share_form),l.share_form=P,l.refer_share_btn=S,$.default.rpTest&&(l.gs_share_test=$.default.rpTest),this.$urlQueryObj.cid&&(l.share_cid=this.$urlQueryObj.cid);var w=p+"?"+i.default.buildQuery(g.default.dealWithSharePathQueries(l,{shareId:a})),I=function(){var t={op:"event",sub_op:"share",event:"share_result",share_id:a,share_channel:_.ShareChannel.AppMessage,share_form:P,refer_share_btn:S,share_url:w};return null!=l.goods_type&&(t.goods_type=l.goods_type),null!=l.event_type&&(t.event_type=l.event_type),null!=l.order_sn&&(t.order_sn=l.order_sn),null!=l.group_order_id&&(t.group_order_id=l.group_order_id),null!=l.goods_price&&(t.goods_price=l.goods_price),null!=l.goods_id&&(t.goods_id=l.goods_id),null!=$.default.rpTest&&(t.gs_share_test=$.default.rpTest),null!=e.pageSn&&(t.page_sn=e.pageSn),null!=e.subjectId&&(t.subject_id=e.subjectId),null!=e.refer_xcx_campaign_d12&&(t.refer_xcx_campaign_d12=e.refer_xcx_campaign_d12),t=s.default.getData(t),t.withoutCompleteOpts=!0,t}();return k(I),{title:o,path:w,imageUrl:n,success:function(i){var a=(0,_.getShareResultByErrMsg)(i.errMsg);I.share_result=a,I.sub_op="share_result",wx.login({success:function(t){wx.getShareInfo&&i&&i.shareTickets&&i.shareTickets[0]?(e.successCallBack&&"function"==typeof e.successCallBack&&e.successCallBack(),wx.getShareInfo({shareTicket:i.shareTickets[0],success:function(e){var i={code:t.code,iv:e.iv,encrypted_data:e.encryptedData};(0,v.default)(y.default.mark(function e(){var t;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.default.apiRequest("POST",T.default.getOpenGid,i);case 3:t=e.sent,I.open_gid=t.open_gid,"promotion_main"===M.pageName&&u.Message.emit(u.KEYS.PROMOTION_MAIN_GET_OPEN_GID,I.open_gid),"open_envelope"===M.pageName&&u.Message.emit(u.KEYS.OPEN_ENVELOPE_GET_OPEN_GID,I.open_gid),k(I),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])}))},fail:function(t){e.failCallBack&&"function"==typeof e.failCallBack&&e.failCallBack(),k(I)}})):(e.failCallBack&&"function"==typeof e.failCallBack&&e.failCallBack(),k(I))},fail:function(){k(I)}}),"function"==typeof d&&d.call(t,{res:i,shareResult:a})},fail:function(e){"function"==typeof c&&c.call(t,e)},complete:function(e){"function"==typeof h&&h.call(t,{res:e})}}},e.$gbSet=function(e,t){return D[e]=t,this},e.$gbGet=function(e,t){var i=D[e];return t||delete D[e],i},e.$createPageCacheKey=function(e){return[e,r.default.getRandomString(10)].join("-")},e.$forward=function(e,t,i){return this.$route("forward",e,t,i)},e.$redirect=function(e,t,i){return this.$route("redirect",e,t,i)},e.$back=function(e){e=e||1,this.$route("back",e)},e.$switchTab=function(e,t,i){return this.$route("switchTab",e,t,i)},e.$route=function(e,t,a,r){switch(r=r||{},e=e||"forward"){case"back":n.default.route(null,"back",{backNum:t||1});break;default:if(!t)throw new Error("[#[route]page name("+t+") is invalid!]");var s=l.pageNameUrlMap[t]||{},o=void 0;if(o=s.path?"/"+s.path:"/"+["pages",t,t].join("/"),s.withTabbar&&(e="switchTab"),a){var u=i.default.buildQuery(a);u.length>0&&(o+="?"+u)}return n.default.route(o,e)}},e.$showToast=function(e,t){if(!this.$toast){var i=this;this.$toast=new d.default({setDataFunc:function(e){i.setData({$toastData:e})}})}e&&this.$toast.setText(e).show(t)},e.$showModal=function(e){if(!this.$modalDialog){var t=this;this.$modalDialog=new c.default({setDataFunc:function(e){t.setData({$modalData:e})}})}e&&this.$modalDialog.show(e)},e.$goToTop=function(e){e.currentTarget.dataset.diy?this.goTop():o.default.goTop(!1)},e.$componentsAddRootFunc=function(e,t){e&&"function"==typeof t&&(this[e]=t)},e.preventTouchMove=function(){},e.$showUserAuthorizeModal=function(e,t){var i=this;this.$user_authorize_modal||(this.$user_authorize_modal=new h.default({setDataFunc:function(e){i.setData({$userAuthorizeModalData:e})}})),this.$user_authorize_modal.show(),this.user_authorize_success_cb=e,this.user_authorize_fail_cb=t,k(S.default.authRecallImprParams)},e.$hideUserAuthorizeModal=function(){this.$user_authorize_modal&&this.$user_authorize_modal.isAuthorizeModalVisible()&&(this.$user_authorize_modal.hide(),"function"==typeof this.user_authorize_fail_cb&&this.user_authorize_fail_cb())},e.$userAuthorizeModelCancelClicked=function(){this.$user_authorize_modal&&this.$user_authorize_modal.hide(),"function"==typeof this.user_authorize_fail_cb&&this.user_authorize_fail_cb(),k(S.default.authRecallRefuseParams)},e.$userAuthorizeModelOkClicked=function(){this.$user_authorize_modal&&this.$user_authorize_modal.hide(),k(S.default.authRecallApproveParams),k(S.default.authPromptParams)},e.$userAuthorizeModelConfirmClicked=function(e){this.$user_authorize_modal&&this.$user_authorize_modal.hide(),e.detail.userInfo?("function"==typeof this.user_authorize_success_cb&&this.user_authorize_success_cb(e.detail),k(S.default.authApproveParams)):("function"==typeof this.user_authorize_fail_cb&&this.user_authorize_fail_cb({wx_deny:!0}),k(S.default.authRefuseParams))},e.$uploadFormId=function(e,t){if(e&&e.detail&&e.detail.formId){var i=void 0===t||t;w.default.uploadFormIdToSH(e.detail.formId,i)}},e.$setTrackingKeyParams=function(e){for(var t in e)e.hasOwnProperty(t)&&null==e[t]&&delete e[t];this.$trackingKeyParams=this.$trackingKeyParams||{},this.$trackingKeyParams=a.default.assign(this.$trackingKeyParams,e)},e.checkStayHintModal=function(){var e=$.default.showUnpaidOrderDialog,t=$.default.isLastPagePayPage,i=$.default.hasPaySucess,a=$.default.isOrderForbidden,r=($.default.lastOrderGoodsData,$.default.isLastPageGroupPage),s=$.default.lastGroupOrderId,o=$.default.lastOrderGoodsId,n=$.default.isLastGroupNotEnough,u=$.default.showNotEnoughGroupDialog,l=$.default.hadGroupShareArray,d=this,c=this.$urlQueryObj.goods_id;e&&t&&!i&&!a&&c==$.default.lastPayGoodsId&&(this.$showModal({title:"确定要放弃付款吗？",content:"你尚未完成支付，喜欢的商品可能会被抢空哦~",cancelText:"暂时放弃",confirmText:"继续支付",success:function(e){if(e.confirm){$.default.showUnpaidOrderDialog=!1;var t=$.default.hasCreatedOrder,i=$.default.lastOrderSn,a=$.default.lastOrderCheckoutOptions;t&&i.length>0?d.$forward("order",{ordersn:i}):d.$forward("order_checkout",a),k({op:"click",event:"paying_btn_click",page_name:q,page_element:"paying_btn",page_section:"unpaid_popup",goods_id:c})}else e.cancel&&($.default.showUnpaidOrderDialog=!1,k({op:"click",event:"give_up_btn_click",page_name:q,page_element:"give_up_btn",page_section:"unpaid_popup",goods_id:c}))}}),k({op:"impr",page_section:"unpaid_popup",goods_id:c})),"goods"===q&&r&&n&&u&&-1===l.indexOf(s)&&c==o&&(this.$showModal({title:"",content:"您有一个未成团的商品，邀请好友参团才能大大提高成团率哦~",cancelText:"关闭",confirmText:"去邀请好友",reportFormId:!0,success:function(e){e.confirm?($.default.showNotEnoughGroupDialog=!1,d.$forward("group",{group_order_id:s}),k({op:"click",event:"invite_popup_click",page_section:"invite_popup",page_name:q,page_element:"invent_btn",goods_id:c})):e.cancel&&($.default.showNotEnoughGroupDialog=!1,k({op:"click",event:"invite_popup_click",page_section:"invite_popup",page_name:q,page_element:"close_btn",goods_id:c}))}}),k({op:"impr",page_name:"goods_detail",page_section:"invite_popup",goods_id:c}))},e.isOverTime=function(e){var t=(new Date).getTime();if(this.imprList[e]){var i=this.imprList[e];return Math.abs(parseInt(t)-parseInt(i))>300&&(this.imprList[e]=t,!0)}return this.imprList[e]=t,!0},e.calcItems=function(e){if(this.isInit){var t=P.default.getWindowHeightSync(),i=this.top-e,a=0,r=0;if(i>0)a=0,r=i;else{var s=Math.abs(i)/this.itemHeight,o=Math.floor(s),n=s-o;n<.25?(a=o*this.columns,r=-Math.ceil(n*this.itemHeight)):(a=(o+1)*this.columns,r=Math.ceil((1-n)*this.itemHeight))}for(var u=new Array,l=0;;){var d=Math.floor(l/this.columns)+1,c=r+this.itemHeight*d,h=a+l;if(c<=t)this.isOverTime(h)&&u.push(h);else{if(!(Math.abs(c-t)/this.itemHeight<.25))break;this.isOverTime(h)&&u.push(h)}l+=1}if(u.length>0){for(var f=new Array,_=0;_<u.length;++_)(function(e,t){for(var i=0;i<e.length;++i)if(e[i]===t)return!0;return!1})(this.lastImprList,u[_])||f.push(u[_]);this.lastImprList=u,"function"==typeof this.callback&&f.length>0&&this.callback(f)}}},e.isInitRect=function(){return this.isInit},e.clearLastImprList=function(){this.lastImprList=[]},e.initRect=function(e,t){if(e&&0!=e.length&&!this.isInit){var i=e[0],a=i.height||0,r=i.top;if(0!==a){for(var s=1,o=1;o<e.length&&e[o].top===r;++o)s+=1;this.top=r,this.itemHeight=a,this.columns=s,this.callback=t,this.isInit=!0,this.imprList={},this.lastImprList=[],this.calcItems(0)}}},e.updateScrollTop=function(e){this.timeOut&&clearTimeout(this.timeOut);var t=this;this.timeOut=setTimeout(function(){t.calcItems(e)},100)},e.$onBubbleClicked=function(e){var t=e.currentTarget.dataset;t&&k({op:"click",event:"bubble_clk",page_element:"bubble",bubble_id:t.groupOrderId})},e.$subjectBtnShowHide=function(e){var t=(e.currentTarget.dataset||{}).setStatus,i=this;this.sucjectBtnLock||(this.sucjectBtnLock=!0,setTimeout(function(){i.sucjectBtnLock=!1},1e3),"hide"===t?this.setData({subjectShareBtnStatus:"show"}):this.setData({subjectShareBtnStatus:"hide"}))},Page(e),e}; 
 			}); 
		define("common/preload.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e(require("../storage/ram_manager")),r=e(require("../libs/co/we-index")),o=e(require("../libs/regenerator-runtime/runtime")),t=(e(require("../storage/user_storage")),e(require("../controller/public"))),d=e(require("./url_util")),l=e(require("./util")),s=e(require("../configs/api")),u=e(require("../common/request")),n=e(require("../common/data_util")),i=require("../constants/subjects"),c=require("./message"),p={preloadRecord:{},preloadData:function(e,r){if(null===e&&r&&r.match(/pages\/([a-zA-Z_]+)\//)&&(e="preload_"+r.match(/pages\/([a-zA-Z_]+)\//)[1]),null===e&&r&&r.match(/package_a\/([a-zA-Z_]+)\//)&&(e="preload_"+r.match(/package_a\/([a-zA-Z_]+)\//)[1]),e&&p[e]&&"function"==typeof p[e]){var o={},t=r.split("?");t.length>1&&(o=d.default.parseUrlQueryStr(t[1])),p.preloadRecord={},p[e](o),a.default.inTransitionPage=t[0],a.default.transitionStartTime=Date.now()}},preloadAjaxLock:function(e,a){p.preloadRecordFn(e,"end"),c.Message.emit("preload_"+e,a),c.Message.on("preload_"+e+"_ajax",function(){c.Message.emit("preload_"+e,a),a=null},!0)},preloadPageLock:function(e,a){c.Message.on("preload_"+e,a,!0),c.Message.emit("preload_"+e+"_ajax")},preloadUnlock:function(e){c.Message.off("preload_"+e),c.Message.off("preload_"+e+"_ajax")},preloadRecordFn:function(e,a){"out"!==a?p.preloadRecord["preload_"+e]=a:delete p.preloadRecord["preload_"+e]},checkpreloadRecord:function(e){return p.preloadRecord["preload_"+e]},preloadPage:function(e,a,r,o,t){var d=p.checkpreloadRecord(e);switch(a=l.default.bind(a,t),r=l.default.bind(r,t),o=l.default.bind(o,t),d){case"start":p.preloadPageLock(e,a),p.preloadPageLock(e+"_error",r),p.preloadRecordFn(e,"out");break;case"end":p.preloadPageLock(e,a),p.preloadRecordFn(e,"out");break;case"error":p.preloadPageLock(e+"_error",r),p.preloadRecordFn(e,"out");break;default:o()}},preload_goods:function(e){var d=e.goods_id;a.default.isFirstFavoritUpdate||t.default.updateLikeGoodsMallsIds(),a.default.isSpikeRemindGoodsIdsUpdate||t.default.updateSpikeRemindGoodsIds(),d&&(p.preloadRecordFn(d,"start"),(0,r.default)(o.default.mark(function e(){var r,t,l,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=s.default.v2GoodsDetail+d,t=u.default.requestDataWithUrl("GET",r,null,!0),l={$pageId:a.default.globalPageId,$pageName:"goods"},e.next=6,u.default.runMainRequestForPage(t,l);case 6:n=e.sent,p.preloadAjaxLock(d,n),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),p.preloadRecordFn(d,"error"),p.preloadAjaxLock(d+"_error",e.t0);case 15:case"end":return e.stop()}},e,this,[[0,10]])})))},preload_mall_page:function(e){a.default.isFirstFavoritUpdate||t.default.updateLikeGoodsMallsIds()},preload_subjects:function(e){var t=e.subjects_id;p.preloadRecordFn(t,"start"),(0,r.default)(o.default.mark(function e(){var r,d,l,c,f,_,g;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=void 0,d=void 0,l=void 0,(c=i.SubjectsSpikeInfo[t]||{}).isSpecialOfferSubjects&&!c.doubleSelect?a.default.isSpecialOfferSubjects=!0:a.default.isSpecialOfferSubjects=!1,f=c.isGenTianType?c.genTianId:t,_=c.hasSpecialUrl?s.default[c.tabUrl]:s.default.promotionCollection,r=c.isSpecialOfferSubjects?_:n.default.formatByPos(_,f),d=u.default.requestDataWithUrl("GET",r,null,!0),g={$pageId:a.default.globalPageId,$pageName:"subjects"},e.next=11,u.default.runMainRequestForPage(d,g);case 11:l=e.sent,p.preloadAjaxLock(t,l),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0),p.preloadRecordFn(t,"error"),p.preloadAjaxLock(t+"_error",e.t0);case 20:case"end":return e.stop()}},e,this,[[0,15]])}))},preload_spike:function(e){a.default.isSpikeRemindGoodsIdsUpdate||t.default.updateSpikeRemindGoodsIds()},preload_haitao_spike:function(e){a.default.isSpikeRemindGoodsIdsUpdate||t.default.updateSpikeRemindGoodsIds()}};exports.default=p; 
 			}); 
		define("common/pubsub.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),t=function(){function t(){e(this,t),this.eventObjs={}}return n(t,[{key:"on",value:function(e,n,t,r){this.eventObjs[e]||(this.eventObjs[e]=[]),this.eventObjs[e].push({handler:n,once:t,context:r});var o=this;return function(){o.off(e,n)}}},{key:"off",value:function(e,n){var t=this;return(e?[e]:[]).forEach(function(e){if(n){var r=[];(t.eventObjs[e]||[]).forEach(function(e){e.handler!==n&&r.push(e)}),t.eventObjs[e]=r}else t.eventObjs[e]=[]}),this}},{key:"emit",value:function(e){var n=Array.prototype.slice.call(arguments,1);(this.eventObjs[e]||[]).forEach(function(e){if(!e.once||!e.called){e.called=!0;try{e.handler&&e.handler.apply(e.context,n)}catch(e){console.error(e.stack||e.message||e)}}})}}]),t}();exports.default=t; 
 			}); 
		define("common/request.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=(e(require("../configs/api")),e(require("../configs/app_config"))),n=e(require("../libs/es6-promise.min")),a=e(require("../storage/user_storage")),o=e(require("../configs/request_errors")),i=e(require("./data_util")),s=e(require("./object_util")),u=e(require("./url_util")),d=(e(require("./logger_util")),e(require("./system_info"))),c=e(require("../storage/ram_manager")),f=(e(require("../libs/co/we-index")),e(require("../libs/regenerator-runtime/runtime")),require("./message")),l=e(require("../libs/md5.min")),g=10,p=[],m={},y=[],q=0,v={},_={isMaxCountSet:!1,runMainRequestForPage:function(e,r){var t=null;if(r&&(t=r.$pageId),r&&null!==t){v[t]||(v[t]={main:[],secondary:[]});var n=v[t].main;e.pageName=r.$pageName,e.pageId=t,e.isSeconary=!1,n.push(e)}return this.runRequest(e)},runSecondaryRequestForPage:function(e,r){var t=void 0;if(r&&(t=r.$pageId),r&&t){v[t]||(v[t]={main:[],secondary:[]});var n=v[t].secondary;e.pageName=r.$pageName,e.pageId=t,e.isSeconary=!0,n.push(e)}return this.runRequest(e)},abortRequestInPage:function(e,r,t){var n=e.$pageId;if(v[n]){var a=[],o=[],i=[];if(v[n].main&&(o=v[n].main),v[n].secondary&&(i=v[n].secondary),r&&(a=a.concat(o)),t&&(a=a.concat(i)),0!=a.length){for(var s=0;s<p.length;s++){var u=p[s];for(var d in a){var c=a[d].requestId;if(u===c){delete p[s],delete m[c];break}}}if(p=p.filter(function(e){return!!e}),wx.canIUse&&wx.canIUse("requestTask.abort"))for(var f=0;f<y.length;f++){var l=y[f];for(var g in a){var q=a[g];if(l===q.requestId&&q.task&&q.task.abort){q.task.abort();break}}}r&&t?(v[n].main=[],v[n].secondary=[]):r?v[n].main=[]:v[n].secondary=[]}}},handleRequestError:function(e,r){e.error_msg=o.default.errors[e.error_code]||e.error_msg,-1==e.error_code?wx.getNetworkType({complete:function(t){"none"==t.networkType&&(e.error_msg="网络不太顺畅哦,请重新加载"),"function"==typeof r&&r(e)}}):"function"==typeof r&&r(e)},isSuccess:function(e){var r=!1;return e.statusCode&&e.statusCode<400&&(r=!0),r},canRetry:function(e){var r=!0,t=0;return e&&e.error_code&&(t=e.error_code),"unknown"==c.default.networkType||"none"==c.default.networkType?r=!1:40001==t||43504==t?r=!1:"request:fail abort"==e.error_msg&&(r=!1),r},changeMaxCount:function(){var e=d.default.getSystemInfoSync().SDKVersion;g=e&&1*e.split(".").join("")>125?10:5},triggerNextRequestStep:function(){if(this.isMaxCountSet||(this.changeMaxCount(),this.isMaxCountSet=!0),0!==p.length&&!(y.length>=g)){var e=this,t=p.shift(),n=m[t];if(t&&n&&n.reqConfig){y.push(t);var o=n.reqConfig;n.needAccessToken&&a.default.getAccessToken()&&(o.header.AccessToken=a.default.getAccessToken());var i=Date.now();o.complete=function(s){function u(){y.splice(y.indexOf(t),1),delete m[t],e.deleteRequestFromMainAndSecondaryMap(n),e.triggerNextRequestStep()}var d=n.reqConfig.url,l=void 0;l=n.needResponseHeader?s:s.data||{};var g=e.isSuccess(s),p=l.error_code||s.statusCode||-1,v=l.error_msg||s.errMsg||"Unknown Error",_=Date.now(),S=_-i,h=0;o.data&&(h=JSON.stringify(o.data).length);var k=JSON.stringify(l).length,T={record_type:"NETWORK_TIME",page_name:n.pageName||"",begin_time:i,end_time:_,response_time:S,status:g?"SUCCESS":"FAILED",request_url:d,code:p,request_size:h,response_size:k,isRetry:n.retried?1:0,is_token_invalid_retry:n.try40001?1:0};if(g||(T.error_msg=v),e.markMonitor(T),g)"function"==typeof n.success&&n.success(l),u();else if("object"!==(void 0===l?"undefined":r(l))&&(l={}),l.error_code=p,l.error_msg=v,!e.canRetry(l)||n.disableRetry||n.retried)e.handleRequestError(l,function(e){40001==p&&i>c.default.autoLoginStartTime&&a.default.clearUserLocalInfo(),40001!=p||n.try40001?("function"==typeof n.fail&&n.fail(e),u()):(q++,c.default.autoLoginStartTime=Date.now(),f.Message.emit(f.KEYS.REQUEST_TOKEN_INVALID,n),n.try40001=!0,f.Message.on(f.KEYS.USER_LOGIN_FINISHED,function(r){if(--q<=0&&(c.default.autoLoginStartTime=0),a.default.getAccessToken()){i=Date.now(),n.reqConfig.header.AccessToken=a.default.getAccessToken();var t=wx.request(o);n.task=t}else"function"==typeof n.fail&&n.fail(e),u()},!0))});else{i=Date.now();var R=wx.request(o);n.task=R,n.retried=!0}};var s=wx.request(o);n.task=s}}},deleteRequestFromMainAndSecondaryMap:function(e){if(e.pageName&&void 0!==e.pageId){var r=[],t=[],n=-1,a=v[e.pageId];r=a.main,t=a.secondary;for(var o in r)if(r[o]===e){n=o;break}-1!=n&&r.splice(n,1),r.length<=0&&f.Message.emit(f.KEYS.PAGE_MAIN_REQUEST_FINISHED,{pageId:e.pageId}),n=-1;for(var i in t)if(t[i]===e){n=i;break}-1!=n&&t.splice(n,1)}},buildRequest:function(e){if(e.needUidAndFlag){var r=e.reqConfig.url,t=r.split("?");r=t[0]+"?"+(t[1]?t[1]+"&":"")+u.default.buildQuery({pdduid:a.default.getUserId(),xcx:"20161201"}),e.reqConfig.url=r}var n=void 0;if(e.needAccessToken&&(n=a.default.getAccessToken())&&(e.reqConfig.header.AccessToken=n),e.needGZToken&&n){var o=(0,l.default)("epcYXQ9JNx34C0hS3GYbR+tJquSSRiecmJDoZD8pwTQ="+a.default.getUserId()+n);e.reqConfig.header.GZToken=o}var s=i.default.getLogId();e.requestId=s,p.push(s),m[s]=e,p.sort(function(e,r){var t=m[e],n=m[r];return t&&n?t.isSeconary-n.isSeconary:0}),this.triggerNextRequestStep()},requestDataWithUrl:function(e,r,n,a,o){o=o||{};var u={};e=e||"GET";var d={"Content-Type":"application/json;charset=UTF-8","Cache-Control":"no-cache"};o&&i.default.isObject(o.reqConfigHeader)&&(d=s.default.assign(d,o.reqConfigHeader));var c=o.forceUseApiV2,f=o.forceUseApiGZ,l=o.limitChallengeAtivity,g=void 0;switch(!0){case c:g=t.default.apiV3Domain;break;case f:g=t.default.apiGZDomain;break;case l:g=t.default.limitChallengeServer;break;default:g=t.default.apiDomain}var p={url:0===r.indexOf("https://")||0===r.indexOf("http://")?r:g+r,method:e,header:d};return n&&(p.data=n),u.reqConfig=p,u.isSeconary=!1,u.needAccessToken=!a,u.needUidAndFlag=!o.dontAddUidAndFlag,u.needResponseHeader=!!o.needResponseHeader,u.needGZToken=!!o.needGZToken,u.disableRetry=!!o.disableRetry,u},apiRequest:function(e,r,t,n,a){var o=this.requestDataWithUrl(e,r,t,n,a);return this.runRequest(o)},runRequest:function(e){var r=this;return new n.default(function(t,n){e.success=t,e.fail=n,e.needAccessToken&&!a.default.getAccessToken()?f.Message.emit(f.KEYS.REQUEST_NEED_LOGIN,e):r.buildRequest(e)})},markMonitor:function(e){f.Message.emit(f.KEYS.MONITOR_FROM_REQUEST,e)}};exports.default=_; 
 			}); 
		define("common/scene_route.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e&&e.__esModule?e:{default:e}}(require("./navigation")),o={gd:"goods_id"},r={route:function(o){if(o){var r=decodeURIComponent(o);if(r){var t=r.split("_");if(t[0]&&"p1001"===t[0]&&t[1]){var d="/pages/goods/goods?goods_id="+t[1];e.default.forward(d)}}}},sceneMap:function(e){var r={},t=decodeURIComponent(e).split("&");for(var d in t)if(t[d]){var i=t[d].split("=");i.length>0&&(o[i[0]]?r[o[i[0]]]=i[1]:r[i[0]]=i[1])}return r}};exports.default=r; 
 			}); 
		define("common/share.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("./object_util")),t=e(require("./data_util")),u=require("../constants/tracking/keys.js"),s=e(require("../storage/user_storage")),a=function(){var e={code:null,from:null,isappinstalled:null,at:null,share_id:null,is_back:null};return u.ReferPageKeys.forEach(function(r){return e[r]=null}),e}();exports.default={dealWithSharePathQueries:function(e,u){return e=e||{},u=u||{},this.userId||(this.userId=s.default.getUserId()),e=e||{},r.default.assign({},e,{_wv:1,refer_share_id:u.shareId||t.default.getRandomString(),refer_share_uid:this.userId,refer_share_channel:"message"},a)}}; 
 			}); 
		define("common/std_format.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t={Cent:100,Yuan:1},r={price:function(r,e){r=parseFloat(r,10)||0,(e=e||t.Yuan)===t.Cent&&(r/=100);var n=(r=r.toString()).indexOf(".");if(n>=0){for(var a=(r=r.slice(0,n+3)).length-1;"0"===r.charAt(a)&&a>0;)a--;"."===(r=r.slice(0,a+1)).charAt(r.length-1)&&(r=r.slice(0,r.length-1))}return r},goodsNameWithPrice:function(t,r,e){return e?t:r+"元 "+t},sales:function(t){if((t=parseInt(t,10)||0)<9999)return t.toString();if(t<=99999){var r=parseInt(t/1e3,10);return parseInt(r/10,10)+"."+r%10+"万"}return parseInt(t/1e4,10).toString()+"万"},timeSpan:function(t,r){var e=Math.max(parseInt(r,10)-parseInt(t,10),0);return e>=86400?Math.floor(e/86400)+"天":e>=3600?Math.floor(e/3600)+"小时":e>=60?Math.floor(e/60)+"分钟":e+"秒"},getDiscount:function(t,r){if(!t||!r)return 0;var e=Math.floor(t/r*100)/10;return e%1==0&&0!==e&&(e=e.toFixed(1)),e},numberSeparator:function(t){for(var r="",e=(t=t.toString()).length-1;e>=0;e--)r=t[e]+r,(t.length-1-e)%3==2&&0!==e&&(r=","+r);return r}};exports.default=r; 
 			}); 
		define("common/storage_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e&&e.__esModule?e:{default:e}}(require("../libs/es6-promise.min")),t=require("./message"),r={getStorage:function(t){return new e.default(function(e,r){wx.getStorage({key:t,success:function(t){e(t.data)},fail:function(t){e(!1)}})})},setStorage:function(t,r){return new e.default(function(e,n){wx.setStorage({key:t,data:r,success:e,fail:e})})},removeStorage:function(t){return new e.default(function(e,r){wx.removeStorage({key:t,success:e,fail:e})})},getStorageSync:function(e){try{return wx.getStorageSync(e)}catch(r){console.error(r),t.Message.emit(t.KEYS.STORAGE_FAIL,{storage_key:e,func_name:"getStorageSync"})}},setStorageSync:function(e,r){try{wx.setStorageSync(e,r)}catch(n){console.error(n),t.Message.emit(t.KEYS.STORAGE_FAIL,{storage_key:e,func_name:"setStorageSync",data:JSON.stringify(r)})}}};exports.default=r; 
 			}); 
		define("common/system_info.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t={sysInfo:null,getSystemInfoSync:function(){var t=this.sysInfo;if(!t)try{t=wx.getSystemInfoSync(),this.sysInfo=t}catch(n){t={}}return t},getWindowWidthSync:function(){return this.getSystemInfoSync().windowWidth||wx.getSystemInfoSync().windowWidth},getWindowHeightSync:function(){var t=wx.getSystemInfoSync(),n=void 0;return t&&(n=t.windowHeight),n},getSDKVersionInt:function(){var t=this.getSystemInfoSync().SDKVersion;return!!t&&1*t.split(".").join("")}};exports.default=t; 
 			}); 
		define("common/time_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={formatTime:function(e,t){t=t||"yyyy/MM/dd hh:mm:ss","number"!=typeof e&&"string"!=typeof e||(e=parseInt(e,10),e=new Date(1e3*e));var r={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var o in r)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?r[o]:("00"+r[o]).substr((""+r[o]).length)));return t},transferToTime:function(e,t){t=t||{};var r=Math.floor(e/1e3),o=Math.floor(r/3600),n=o;if(t.onlyHour)return o;o<10&&(o="0"+o);var a=r%3600,i=Math.floor(a/60),s=i;i<10&&(i="0"+i);var g=a%60,u=g;return g<10&&(g="0"+g),t.removeHours?[i,g].join(":"):t.needMs?[o,i,g,Math.floor(e%1e3)/100].join(":"):t.needObj?{intHours:n,intMinutes:s,intSeconds:u,hours:o,minutes:i,seconds:g}:[o,i,g].join(":")},getPackagedTimeFromTimeBucket:function(e,t){var r=function(e){return(e=e.toString()).length<2&&(e="0"+e),e},o=Math.floor(e/1e3),n=Math.floor(o/60),a=Math.floor(n/60),i=Math.floor(a/24);return i%=365,a%=24,n%=60,o%=60,(t=(t||"").toUpperCase()).indexOf("D")>=0&&(i=r(i)),t.indexOf("H")>=0&&(a=r(a)),t.indexOf("M")>=0&&(n=r(n)),t.indexOf("S")>=0&&(o=r(o)),{days:i.toString(),hours:a.toString(),minutes:n.toString(),seconds:o.toString()}},getTimeMaterialFromTimePoint:function(e){e=parseInt(e,10)||0;var t=new Date(1e3*e);return{year:t.getFullYear().toString(),month:(t.getMonth()+1).toString(),date:t.getDate().toString(),hours:t.getHours().toString(),minutes:t.getMinutes().toString(),seconds:t.getSeconds().toString(),weekDay:t.getDay().toString()}},timeSpan:function(e,t){var r=Math.max(parseInt(t,10)-parseInt(e,10),0);return r>=86400?Math.floor(r/86400)+"天":r>=3600?Math.floor(r/3600)+"小时":r>=60?Math.floor(r/60)+"分钟":r+"秒"},getTodayTime:function(e){var t=(new Date).setHours(0,0,0,0),r=Math.floor(new Date(t).getTime()/1e3);return e&&e.getTomorrow?r+86400:e&&e.getAfterTomorrow?r+172800:e&&e.getBigAfterTomorrow?r+259200:r},checkTimeDay:function(t){var r=e.getTodayTime(),o=r-86400,n=r+86400,a=n+86400;return t<o?0:o<=t&&t<r?1:r<=t&&t<n?2:n<=t&&t<a?3:a<=t&&t<a+86400?4:t>=a+86400?-1:void 0}};exports.default=e; 
 			}); 
		define("common/upload_file.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=e(require("../libs/es6-promise.min")),n=e(require("../libs/co/we-index")),r=e(require("../libs/regenerator-runtime/runtime")),o=e(require("../storage/ram_manager")),u=e(require("../configs/api")),l=e(require("../common/request")),i=e(require("../common/data_util")),c=e(require("./util")),s={uploadFileQueue:[],uploadFileWaitQueue:[],uploadFileLock:!1,chooseUploadImg:function(e,t,a){try{wx.chooseImage({count:e,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){"function"==typeof t&&t(e)},fail:function(e){"function"==typeof a&&a(e),console.error(e)}})}catch(e){"function"==typeof a&&a(),console.error(e)}},uploadImg:function(e,a,o){e.size/1e3>=400?"function"==typeof o&&o("请上传小于400KB的图片"):(0,n.default)(r.default.mark(function n(){var l,i,c,f;return r.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,s.getUploadSign();case 3:return l=n.sent,i={url:u.default.uploadFileUrl+"?sign="+l.signature,filePath:e.path,name:"file"},n.next=7,s.uploadFile(i);case 7:c=n.sent,"object"==(void 0===(f=JSON.parse(c.data))?"undefined":t(f))&&f.url?"function"==typeof a&&a(f):"function"==typeof o&&o("网络出错"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),console.error(n.t0),"function"==typeof o&&o("网络出错");case 16:case"end":return n.stop()}},n,this,[[0,12]])}))},chooseCommentImg:function(e){var t=o.default.CPData.canSelImgsCount-o.default.CPData.commentImgs.length;s.chooseUploadImg(t,function(e){s.chooseCommentImgSuccess(e)})},chooseCommentImgSuccess:function(e){e.tempFilePaths;var a=o.default.CPPage.$showToast;a=c.default.bind(a,o.default.CPPage),s.uploadFileLock?a("上次上传仍在进行中"):(s.uploadFileLock=!0,o.default.CPSetData({loadingVisible:!0}),(0,n.default)(r.default.mark(function n(){var l,i,c,f,d,m,p,g,h,b,C;return r.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.prev=0,l=!0,i=!1,c=void 0,n.prev=4,f=e.tempFiles[Symbol.iterator]();case 6:if(l=(d=f.next()).done){n.next=30;break}if(!((m=d.value).size/1e3>=400)){n.next=13;break}return a("请上传小于400KB的图片"),s.uploadFileLock=!1,o.default.CPSetData({loadingVisible:!1}),n.abrupt("return");case 13:if(!(o.default.CPData.commentImgs.length>=o.default.CPData.canSelImgsCount)){n.next=18;break}return a("请上传不多于"+o.default.CPData.canSelImgsCount+"图片"),s.uploadFileLock=!1,o.default.CPSetData({loadingVisible:!1}),n.abrupt("return");case 18:return n.next=20,s.getUploadSign();case 20:return p=n.sent,g={url:u.default.uploadFileUrl+"?sign="+p.signature,filePath:m.path,name:"file"},n.next=24,s.uploadFile(g);case 24:h=n.sent,"object"==(void 0===(b=JSON.parse(h.data))?"undefined":t(b))&&b.url?((C=o.default.CPData.commentImgs).push(b),o.default.CPSetData({commentImgs:C,imageUploaderShow:C.length<o.default.CPData.canSelImgsCount,commentImgsCount:C.length})):a("网络出错");case 27:l=!0,n.next=6;break;case 30:n.next=36;break;case 32:n.prev=32,n.t0=n.catch(4),i=!0,c=n.t0;case 36:n.prev=36,n.prev=37,!l&&f.return&&f.return();case 39:if(n.prev=39,!i){n.next=42;break}throw c;case 42:return n.finish(39);case 43:return n.finish(36);case 44:o.default.CPSetData({loadingVisible:!1}),s.uploadFileLock=!1,n.next=54;break;case 48:n.prev=48,n.t1=n.catch(0),console.error(n.t1),o.default.CPSetData({loadingVisible:!1}),s.uploadFileLock=!1,a("网络出错");case 54:case"end":return n.stop()}},n,this,[[0,48],[4,32,36,44],[37,,39,43]])})))},getUploadSign:n.default.wrap(r.default.mark(function e(){var t,a;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={bucket_tag:"wx_app"},e.next=4,l.default.apiRequest("POST",u.default.getUploadFileSign,t);case 4:return a=e.sent,e.abrupt("return",a);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),uploadFile:function(e){return new a.default(function(t,a){e.success=t,e.fail=a,wx.uploadFile(e)})},delCommentImg:function(e){var t=e.currentTarget.dataset.index,a=o.default.CPData.commentImgs;a.splice(t,1),o.default.CPSetData({commentImgs:a,imageUploaderShow:!0,commentImgsCount:a.length})},showCommentImg:function(e){var t=e.currentTarget.dataset.imgUrl;wx.previewImage({current:t,urls:i.default.ObjectArrToStringArr(o.default.CPData.commentImgs,"url")})}};exports.default=s; 
 			}); 
		define("common/url_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={buildQuery:function(e){var r={};if(e)for(var n in e){var o=e[n];null!=n&&null!=o&&(r[encodeURIComponent(n)]=encodeURIComponent(o))}var t="";for(var n in r)t.length>0&&(t+="&"),t+=n+"="+r[n];return t},parseQuery:function(e){var r={};if(!e)return e;for(var n in e)r[decodeURIComponent(n)]=decodeURIComponent(e[n]);return r},parseUrlQueryStr:function(e){for(var r={},n=e.split("&"),o=0;o<n.length;++o){var t=n[o].split("=");if(null!=t[0]&&t[0].length>0){var u=t[1]||"";r[decodeURIComponent(t[0])]=decodeURIComponent(u)}}return r}};exports.default=e; 
 			}); 
		define("common/user.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});e(require("../constants/storage_keys"));var t=e(require("../storage/user_storage")),n=e(require("../controller/user_controller")),o=(e(require("./util")),e(require("../constants/grade"))),i=e(require("./request")),s=e(require("../configs/app_config")),r=e(require("../configs/api")),u=require("./message"),a=e(require("./logger")),c=e(require("../constants/tracking/subjects")),f=e(require("../storage/ram_manager")),l=function(e,t){a.default.send(e,t)},d=o.default.ExtraField,g=null,p={isLogining:!1,loginExtraInfo:null,doStartupJobs:function(){var e=this;u.Message.on(u.KEYS.REQUEST_NEED_LOGIN,function(t){t&&(e.hasAccessToken()?i.default.buildRequest(t):e.requireLogin(function(e,n){i.default.buildRequest(t)},function(e,n){i.default.buildRequest(t)}))}),u.Message.on(u.KEYS.REQUEST_TOKEN_INVALID,function(){e.requireLogin()});var n=t.default.getUserLocalInfo(),o=t.default.getUserId();n&&o&&n.openId||t.default.clearUserLocalInfo()},latestLoginExtraInfo:function(){return g},resetLoginExtraInfo:function(){(g={}).useCache=!1,g.isSuccess=!1,g.loginType=0,g.isClickWxAuthBtn=!1,g.isClickWxDenyBtn=!1,g.isClickPddOKBtn=!1,g.isClickPddCancelBtn=!1},requireLogin:function(e,n,o){var a=this;if(!(o&&o.needOpenId&&!this.hasOpenId())&&this.hasAccessToken())return a.resetLoginExtraInfo(),g.isSuccess=!0,g.useCache=!0,"function"==typeof e&&e(a.getUserLocalInfo(),g),void(f.default.pddUserType||(f.default.pddUserType="0"));var c=function(e,n){a.getCompleteUserInfo(function(o){var u={code:o.code,app_id:s.default.appId,encrypted_data:o.encryptedData,iv:o.iv,raw_data:o.rawData,signature:o.signature,has_auth:!0};i.default.apiRequest("POST",r.default.login,u,!0,{disableRetry:!0}).then(function(n){n.nickName=o.nickName,n.avatarUrl=o.avatarUrl,n.createTime=Date.now(),t.default.saveUserInfo(n),"function"==typeof e&&e(n)},function(e){"function"==typeof n&&n(e)})},function(e){"function"==typeof n&&n(e)})};if(this.isLogining)u.Message.on(u.KEYS.USER_LOGIN_FINISHED,function(t){a.hasAccessToken()?"function"==typeof e&&e(t,g):"function"==typeof n&&n(t,g)},!0);else{var d=function(e){l({op:"event",sub_op:"silent_login",is_success:e})};this.isLogining=!0,this.resetLoginExtraInfo(),a.requireSilentLogin(function(n){t.default.saveUserInfo(n),a.isLogining=!1,g.isSuccess=!0,g.useCache=!1,"function"==typeof e&&e(n,g),u.Message.emit(u.KEYS.USER_LOGIN_FINISHED,n),f.default.pddUserType||(f.default.pddUserType="0"),d(1)},function(t){g.useCache=!1,c(function(t){a.isLogining=!1,g.isSuccess=!0,"function"==typeof e&&e(t,g),u.Message.emit(u.KEYS.USER_LOGIN_FINISHED,t)},function(e){a.isLogining=!1,g.isSuccess=!1,"function"==typeof n&&n(e,g),u.Message.emit(u.KEYS.USER_LOGIN_FINISHED,null)}),43504===t.error_code&&(f.default.pddUserType="1"),d(0)})}},requireSilentLogin:function(e,n){g.loginType=0;var o=this;wx.login({success:function(u){if(u.code){var a={code:u.code,has_auth:!1,app_id:s.default.appId};i.default.apiRequest("POST",r.default.silentLogin,a,!0,{disableRetry:!0}).then(function(n){var i=n.user_info||{};n.nickName=i.nick_name,n.avatarUrl=i.avatar_url,n.openId=i.open_id,n.createTime=Date.now(),t.default.saveUserInfo(n),n.user_info&&Object.keys(n.user_info).length>0?"function"==typeof e&&e(n):o.fetchUserInfo(function(){var n=t.default.getUserLocalInfo();"function"==typeof e&&e(n)})},function(e){"function"==typeof n&&n(e)})}else"function"==typeof n&&n(u)},fail:function(e){"function"==typeof n&&n(e)}})},getUserInfo:function(e){var t=this,n=this.getUserLocalInfo();n&&n.nickName?e&&e(!0,n):t.fetchUserInfo(function(){var n=t.getUserLocalInfo(),o=!(!n||!n.nickName);e&&e(o,n)})},hasAccessToken:function(){return null!=t.default.getAccessToken()},hasOpenId:function(){return null!=t.default.getOpenId()},hasLogin:function(){return this.hasAccessToken()},getUserLocalInfo:function(){return t.default.getUserLocalInfo()},saveNickNameAndAvatarUrl:function(e){e&&t.default.setNickNameAndAvatarUrl(e)},logout:function(){t.default.clearUserLocalInfo()},getResultByScene:function(e){var t=this.getGrade();return o.default.Result[t][e]},getShowPortalFreeTrialGoods:function(){return!!(this.getResultByScene(o.default.Scene.PortalFreeTrial)&d.PortalFreeTrial.Goods)},getShowPortalLotteryGoods:function(){return!!(this.getResultByScene(o.default.Scene.PortalLottery)&d.PortalLottery.Goods)},getShowGroupTitlePrefix:function(){return!!this.getResultByScene(o.default.Scene.ShowGroupTitlePrefix)},getShowShareTimeline:function(){return!!this.getResultByScene(o.default.Scene.ShowShareTimeline)},getGroupBuyButtonText:function(){return!!this.getResultByScene(o.default.Scene.GroupBuyButtonText)},getPromoteLotteryIcon:function(){return!!this.getResultByScene(o.default.Scene.LotteryRule)},getLotteryRule:function(e){return this.getResultByScene(o.default.Scene.LotteryRule)?"说明":""},showSharePointer:function(e){return(e=parseInt(e,10)||this.getGrade())!==o.default.Role.BanList},getGrade:function(){var e=t.default.getEgrp();return null==e?(n.default.reqUserAB(),o.default.Role.BanList):e},getCommonUserInfo:function(e,t,n){function o(n){wx.getUserInfo({withCredentials:!1,success:function(t){"function"==typeof e&&e(t.userInfo),n&&l(c.default.authApproveParams)},fail:function(o){wx.openSetting&&!s?i.showUserInfoModal(e,t,{needRetryGetUserInfo:!0,needCompleteUserInfo:!1}):"function"==typeof t&&t(o),n&&l(c.default.authRefuseParams)}})}var i=this,s=!!(n=n||{}).notShowSettingHint,r=!1;wx.canIUse&&wx.canIUse("getUserInfo.object.withCredentials")?wx.getSetting?wx.getSetting({success:function(e){var t=!1;e&&e.authSetting&&(r=e.authSetting["scope.userInfo"]),void 0===r&&(t=!0,l(c.default.authPromptParams)),o(t)},error:function(e){"function"==typeof t&&t(e)}}):o(!1):this.getCompleteUserInfo(e,t)},getCompleteUserInfo:function(e,t,n){function o(n){g.loginType=1,wx.getUserInfo({success:function(o){o&&o.userInfo?(r.nickName=o.userInfo.nickName,r.avatarUrl=o.userInfo.avatarUrl,r.encryptedData=o.encryptedData,r.iv=o.iv,r.rawData=o.rawData,r.signature=o.signature,"function"==typeof e&&e(r)):"function"==typeof t&&t(o),n&&(g.isClickWxAuthBtn=!0,g.isClickWxDenyBtn=!1,l(c.default.authApproveParams))},fail:function(o){wx.openSetting&&!s?i.showUserInfoModal(e,t,{needRetryGetUserInfo:!0,needCompleteUserInfo:!0}):"function"==typeof t&&t(o),n&&(g.isClickWxAuthBtn=!1,g.isClickWxDenyBtn=!0,l(c.default.authRefuseParams))}})}var i=this,s=!!(n=n||{}).notShowSettingHint,r=void 0;wx.login({complete:function(e){e.code?(r={code:e.code},wx.getSetting?wx.getSetting({success:function(e){var t=!1;e.authSetting&&void 0===e.authSetting["scope.userInfo"]&&(t=!0,l(c.default.authPromptParams)),o(t)},error:function(e){"function"==typeof t&&t(e)}}):o(!1)):"function"==typeof t&&t(e)}})},openSetting:function(e,t,n){var o=this;if(n=n||{},wx.openSetting){var i=!!n.needCompleteUserInfo,s=!!n.needRetryGetUserInfo,r={};wx.openSetting({success:function(n){var u=!!(n.authSetting||{})["scope.userInfo"];r.authUserInfo=u,s?u?i?o.getCompleteUserInfo(e,t):o.getCommonUserInfo(e,t):"function"==typeof t&&t(n):"function"==typeof e&&e(r)},fail:function(e){"function"==typeof t&&t(e)}})}else"function"==typeof t&&t({})},showUserInfoModal:function(e,t,n){var o=this;wx.canIUse&&wx.canIUse("button.open-type.getUserInfo")?o.hasLogin()||f.default.CPPage.$showUserAuthorizeModal(function(t){g.isClickWxAuthBtn=!0,g.isClickPddOKBtn=!0,e(t)},function(e){e&&e.wx_deny?(g.isClickWxDenyBtn=!0,g.isClickPddOKBtn=!0):g.isClickPddCancelBtn=!0,t()}):this.showAuthorizeModelDialog("scope.userInfo",e,t,n)},saveImageToPhotosAlbum:function(e){return new Promise(function(t,n){e&&0!=e.length||n(),wx.saveImageToPhotosAlbum?wx.saveImageToPhotosAlbum({filePath:e,success:t,fail:n}):n()})},authorize:function(e,t){return new Promise(function(n,o){e&&0!=e.length&&"string"==typeof e||o(),wx.getSetting&&wx.authorize?wx.getSetting({success:function(o){o.authSetting[e]?n(!0):(void 0===o.authSetting[e]&&"function"==typeof t&&t(),wx.authorize({scope:e,success:function(e){n(!0)},fail:function(e){n(!1)}}))}}):n(!1)})},fetchUserInfo:function(e){this.hasLogin()?i.default.apiRequest("GET",r.default.fetchUserInfo,{},!1).then(function(n){var o=t.default.getUserLocalInfo();n&&(n.nickname&&(o.nickName=n.nickname),n.avatar&&(o.avatarUrl=n.avatar),n.gender&&(o.gender=n.gender),n.address&&(o.country=n.address.country,o.province=n.address.province,o.city=n.address.city),t.default.saveUserLocalInfo(o)),e(!0)}).catch(function(t){e(!1),console.error(t)}):e&&e(!1)},uploadUserInfo:function(e,t){this.hasLogin()?i.default.apiRequest("POST",r.default.updateUserInfo,e,!1).then(function(e){t(e.result)}).catch(function(e){t(!1),console.error(e)}):t&&t(!1)},showAuthorizeModelDialog:function(e,t,n,o){var i={"scope.userInfo":["用户信息","公开信息（昵称、头像等）"],"scope.userLocation":["地理位置","地理位置"],"scope.address":["通讯地址","通讯地址"],"scope.invoiceTitle":["发票抬头","发票抬头"],"scope.werun":["微信运动步数","微信运动步数"],"scope.record":["录音功能","录音功能"],"scope.writePhotosAlbum":["保存到相册","相册（保存图片）"]};if(i.hasOwnProperty(e)){var s="",r=i[e];s=wx.openSetting?"需要访问您的"+r[1]+"，请到小程序的设置中打开"+r[0]+"授权":"需要访问您的"+r[1]+"，请升级微信到最新版本，在小程序的设置中打开"+r[0]+"授权";var u=this;wx.showModal({title:"信息授权提示",confirmText:wx.openSetting?"去设置":"确定",content:s,success:function(e){e.confirm?(u.openSetting(t,n,o),l({op:"click",page_section:"setup_prompt",page_element:"setting"})):("function"==typeof n&&n(e),l({op:"click",page_section:"setup_prompt",page_element:"cancel"}))}}),l({op:"impr",page_section:"setup_prompt"})}else"function"==typeof n&&n()}};exports.default=p; 
 			}); 
		define("common/util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("./system_info")),n=e(require("./object_util")),r=(e(require("../storage/user_storage")),e(require("../storage/ram_manager")),e(require("../constants/tracking/subjects")),e(require("../libs/es6-promise.min"))),i=(e(require("../libs/co/we-index")),{bind:function(e,t){var n=Function.prototype.bind;if(n)return n.apply(e,[].slice.call(arguments,1));var r=[].slice.call(arguments,2);return function(){var n=r.concat([].slice.call(arguments));return e.apply(t,n)}},pxToRpx:function(e){var n=t.default.getWindowWidthSync();return Math.round(750/n*e)},rpxToPx:function(e,n){var r=t.default.getWindowWidthSync();return Math.round(r/750*e)},wrapFunc:function(e,t){return function(){try{t&&t.apply(this,arguments)}finally{e&&e.apply(this,arguments)}}},promisifyAPI:function(e){return function(t){return new r.default(function(r,i){e(n.default.assign({},t,{success:r,fail:i}))})}},downloadFile:function(e){return new r.default(function(t,n){e&&0!=e.length||n(),wx.downloadFile?wx.downloadFile({url:e,success:function(e){e&&e.tempFilePath?t(e.tempFilePath):n()},fail:n}):n()})},checkTel:function(e){var t=/^(([0|4|8]\d{2,3})(-)*)(\d{7,8})((-)*(\d{3,}))?$/;return/^1\d{10}$/.test(e)||t.test(e)},sleep:function(e){for(var t=Date.now();Date.now()-t<=e;);},toWeb:function(e,t){wx.canIUse&&wx.canIUse("web-view")?t.$forward("web",e):t.$showToast("您的微信版本较低，如有问题请在个人中心联系官方客服",{showDuration:3e3})}});exports.default=i; 
 			}); 
		define("common/visitor_logger.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("./data_util")),i=t(require("../constants/storage_keys")),o=t(require("../common/storage_util")),r={visitorInfo:null,generateVisitorInfo:function(){return{xcxTraceId:e.default.getRandomString()}},setVisitorInfo:function(t){t&&(o.default.setStorageSync(i.default.VISITOR_INFO,t),this.visitorInfo=t)},getVisitorLocalInfo:function(){if(this.visitorInfo||(this.visitorInfo=o.default.getStorageSync(i.default.VISITOR_INFO)),!this.visitorInfo){var t=o.default.getStorageSync(i.default.VISITOR_INFO)||this.generateVisitorInfo();this.setVisitorInfo(t)}return this.visitorInfo}};exports.default=r; 
 			}); 
		define("common/wx_socket.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var s=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}(),i=require("./message"),n=(e(require("./logger")),e(require("../storage/user_storage"))),a=e(require("../common/user")),o=0,c=1,u=2,r=3,l=1,h=2,g=new(function(){function e(){t(this,e),this.socketStatus=o,this.authStatus=o,this.reconnectTimes=0,this.uid=0,this.heartbeatHandler=null,this.intervalHandler=null,this.requestId=1,this.toSendMsgList=[],this.sentMsgList=[],this.timeoutMsgList=[],this.isLogining=!1,this.loginSuccessCallback=null;var s=this;wx.onSocketOpen(function(e){s.socketStatus=c,i.Message.emit(i.KEYS.SOCKET_OPEN)}),wx.onSocketError(function(e){s.socketStatus=u,s.isLogining=!1,s.doReconnect(),s.handleSocketError(),i.Message.emit(i.KEYS.SOCKET_ERROR)}),wx.onSocketClose(function(e){s.socketStatus=r,s.isLogining=!1,s.doReconnect(),i.Message.emit(i.KEYS.SOCKET_CLOSED)}),wx.onSocketMessage(function(e){var t=JSON.parse(e.data),a=t.response;switch(s.handleMsgRecieved(t.request_id),a){case"auth":s.isLogining=!1,"ok"===t.result?(s.authStatus=l,s.uid=t.uid,s.reconnectTimes=0,s.handleToSendMsgList(),s.heartbeat(),s.intervalHandler||s.checkTimeoutMsg(),"function"==typeof s.loginSuccessCallback&&(s.loginSuccessCallback(),s.loginSuccessCallback=null),i.Message.emit(i.KEYS.AUTH_OK)):(n.default.clearUserLocalInfo(),s.authStatus=h,s.doReconnect(),i.Message.emit(i.KEYS.AUTH_FAIL));break;case"broadcast":i.Message.emit(i.KEYS.BUBBLE_MESSAGE,t);break;case"unread_msg_count":i.Message.emit(i.KEYS.UNREAD_MESSAGE_COUNT,t);break;default:i.Message.emit(i.KEYS.CUSTOM_SERVICE_MESSAGE,t)}})}return s(e,[{key:"getUid",value:function(){return this.uid}},{key:"enableBubble",value:function(){var e={cmd:"enable_bubble"};this.sendSocketMessage(e),this.reset()}},{key:"disableBubble",value:function(){var e={cmd:"disable_bubble"};this.sendSocketMessage(e),this.reset()}},{key:"reset",value:function(){this.reconnectTimes=0}},{key:"doReconnect",value:function(){this.reconnectTimes>3?i.Message.emit(i.KEYS.RECONNECT_ERROR):(this.reconnectTimes+=1,this.connectToSocket(this.loginSuccessCallback))}},{key:"connectToSocket",value:function(e){if(this.isSocketValid()||this.isLogining)this.isSocketValid()?"function"==typeof e&&e():this.loginSuccessCallback=e;else{this.isLogining=!0,this.loginSuccessCallback=e;var t=this;a.default.requireLogin(function(){if(t.socketStatus===c)wx.closeSocket();else{var e="wss://ws.yangkeduo.com";e+="?access_token="+n.default.getAccessToken(),e+="&role=user&client=wxapp&enable_bubble=true",wx.connectSocket({url:e,success:function(){},fail:function(){}})}},function(){t.isLogining=!1})}}},{key:"isSocketValid",value:function(){return this.socketStatus===c&&this.authStatus===l}},{key:"sendSocketMessage",value:function(e,t){if(!e.request_id||!this.resentMsg(e.request_id,t)){e.request_id=++this.requestId,e.version=2;var s=JSON.stringify(e),i={requestId:e.request_id,msg:s,time:Date.now(),timeoutCallback:t};this.sentMsgList.push(i),this.isSocketValid()?wx.sendSocketMessage({data:s}):this.doReconnect()}}},{key:"heartbeat",value:function(){var e=this;this.heartbeatHandler&&clearTimeout(this.heartbeatHandler),this.heartbeatHandler=setTimeout(function(){e.heartbeatHandler=null;var t={cmd:"heartbeat"};e.sendSocketMessage(t),e.heartbeat()},3e4)}},{key:"checkTimeoutMsg",value:function(){var e=this;this.intervalHandler&&(clearInterval(this.intervalHandler),this.intervalHandler=null),this.intervalHandler=setInterval(function(){for(var t=0;t<e.sentMsgList.length;++t){var s=e.sentMsgList[t];Math.abs(Date.now()-s.time)>15e3&&(e.timeoutMsgList.push(s),e.sentMsgList.splice(t,1),s.timeoutCallback&&s.timeoutCallback())}},1e3)}},{key:"handleMsgRecieved",value:function(e){for(var t=0;t<this.sentMsgList.length;++t)if(this.sentMsgList[t].requestId===e){this.sentMsgList.splice(t,1);break}for(var s=0;s<this.timeoutMsgList.length;++s)if(this.timeoutMsgList[s].requestId===e){this.timeoutMsgList.splice(s,1);break}}},{key:"handleToSendMsgList",value:function(){for(var e=0;e<this.toSendMsgList.length;++e)this.sendSocketMessage(this.toSendMsgList[e]);this.toSendMsgList=[]}},{key:"handleSocketError",value:function(){for(var e=0;e<this.sentMsgList.length;++e){var t=this.sentMsgList[e];this.timeoutMsgList.push(t),t.timeoutCallback&&t.timeoutCallback()}this.sentMsgList=[]}},{key:"resentMsg",value:function(e,t){for(var s=0;s<this.timeoutMsgList.length;++s)if(this.timeoutMsgList[s].requestId===e){var i=this.timeoutMsgList[s];return this.isSocketValid()?(i.timeoutCallback=t,i.time=Date.now(),this.sentMsgList.push(i),this.timeoutMsgList.splice(s,1),wx.sendSocketMessage({data:i.msg})):(this.connectToSocket(this.loginSuccessCallback),t&&t()),!0}return!1}}]),e}());exports.default=g; 
 			}); 
		define("components/big_sales/big_sales.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function i(i){return i&&i.__esModule?i:{default:i}}function a(i,a){if(!(i instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function i(i,a){for(var n=0;n<a.length;n++){var e=a[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(i,e.key,e)}}return function(a,n,e){return n&&i(a.prototype,n),e&&i(a,e),a}}(),e=i(require("../../common/util")),s=i(require("../../storage/ram_manager")),t=require("../../common/index"),o=(i(require("../../configs/api")),i(require("../../libs/co/we-index")),i(require("../../controller/formid_controller"))),l="http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_banner_",u=function(){function i(n){a(this,i),this.dataObj={bigSalesEntranceData:{showBigSalesBanner:!1,homeBannerUrl:null,floatingWindowUrl:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_float_img_12.12.png"}},this.setDataFunc=n.setDataFunc,this.addRootFunc=n.addRootFunc,this.addFunc("toBigSales",this.toBigSales),this.setDataFunc(this.dataObj)}return n(i,[{key:"showBigSalesBanner",value:function(i){var a=this.dataObj.bigSalesEntranceData;if(this.checkInBigSales()){var n=parseInt((Date.now()+s.default.timeDiff)/1e3,10),e=t.TimeUtil.formatTime(n,"MM.dd");a.homeBannerUrl="12.07"==e||"12.08"==e||"12.09"==e||"12.10"==e||"12.11"==e||"12.12"==e||"12.13"==e?l+e+(i||".gif"):l+e+(i||".png"),a.showBigSalesBanner=!0}else a.showBigSalesBanner=!1;this.checkInBigSales(13)?this.dataObj.customClassSuffix="a":this.dataObj.customClassSuffix="",this.dataObj.bigSalesEntranceData=a,this.setDataFunc(this.dataObj)}},{key:"getBigSalesWindowImg",value:function(){var i={12.04:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.04.png",12.05:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.05.png",12.06:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.06.png",12.07:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.07.png",12.08:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.08.png",12.09:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.09.png","12.10":"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.10.png",12.11:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.11.png",12.12:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.12.png",12.13:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.13.png",12.14:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.14.png"},a=parseInt((Date.now()+s.default.timeDiff)/1e3,10),n=t.TimeUtil.formatTime(a,"MM.dd");return i[n]?i[n]:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/big_sales_window_img_12.04.png"}},{key:"checkInBigSales",value:function(i){var a=new Date;a.setFullYear(2017,11,4),a.setHours(0,0,0);var n=new Date;i?n.setFullYear(2017,11,i):n.setFullYear(2017,11,15),n.setHours(0,0,0);var e=parseInt(Date.now()+s.default.timeDiff,10);t.TimeUtil.formatTime(e/1e3),t.TimeUtil.formatTime(a),t.TimeUtil.formatTime(n);return e>a.getTime()&&e<n.getTime()}},{key:"showBigSalesFloat",value:function(){var i=this.dataObj.bigSalesEntranceData,a=this.checkInBigSales();i.showBigSalesFloat=!!a,this.dataObj.bigSalesEntranceData=i,this.setDataFunc(this.dataObj)}},{key:"addFunc",value:function(i,a){"function"==typeof this.addRootFunc&&this.addRootFunc(i,e.default.bind(a,this))}},{key:"toBigSales",value:function(i){s.default.CPPage.$forward("promotion_main",{});var a={op:"click",refer_xcx_campaign_d12:0};"banner"===i.detail.target.dataset.refer?(a.page_element="ir_banner_d12",a.page_section="main"):(a.page_element="float_d12",a.page_section="d12_float"),(0,t.TrackingRecord)(a),i&&i.detail&&i.detail.formId&&o.default.uploadFormIdToSH(i.detail.formId,!0)}}]),i}();exports.default=u; 
 			}); 
		define("components/bubble/bubble.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function s(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,s){for(var a=0;a<s.length;a++){var t=s[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(s,a,t){return a&&e(s.prototype,a),t&&e(s,t),s}}(),t=e(require("../../common/wx_socket")),i=require("../../common/message"),l=(e(require("../../storage/user_storage")),require("../../common/index")),r=(e(require("../../common/user")),new(function(){function e(){s(this,e),this.page=null,this.isSingle=null,this.location=null,this.requestId=null,this.handler=null,this.showHandler=null,this.msgList=[];var a=this;i.Message.on(i.KEYS.BUBBLE_MESSAGE,function(e){if(!(a.msgList.length>=10)){if(a.isSingle){if("ok"===e.result&&e.message_array)for(var s=0;s<e.message_array.length;++s)e.message_array[s].group_order_id="",a.msgList.push(e.message_array[s])}else if("ok"===e.result&&e.message_array&&e.message)for(var t=0;t<e.message_array.length;++t)e.message_array[t].group_order_id=e.message.group_order_id,a.msgList.push(e.message_array[t]);else"ok"===e.result&&e.message&&a.msgList.push(e.message);a.handler||a.handleBubbleList()}})}return a(e,[{key:"init",value:function(e,s,a,i){if(this.page=e,this.isSingle=s,this.location=a,this.requestId=i,e.bubbleIsClosed=!1,e.bubbleLastTime=0,this.msgList=[],this.hideBubble(),this.regImageOnLoad(e),t.default.reset(),t.default.enableBubble(),s){var l={cmd:"handshake",location:a,request_id:i,version:1};t.default.sendSocketMessage(l)}else{var r={cmd:"handshake",location:"pages/index/index",request_id:i,version:1};t.default.sendSocketMessage(r)}}},{key:"close",value:function(e){this.msgList=[],this.page&&(this.page.bubbleIsClosed=!0,this.page.bubbleLastTime=0,this.hideBubble()),this.handler&&(clearTimeout(this.handler),this.handler=null),this.showHandler&&(clearTimeout(this.showHandler),this.showHandler=null),t.default.disableBubble()}},{key:"hideBubble",value:function(){this.page.setData({"bubble.showBubbleCls":"bubble-hide"})}},{key:"regImageOnLoad",value:function(){var e=this;this.page.bubbleImageOnLoad=function(){e.page.pauseBubble||(e.page.setData({"bubble.showBubbleCls":"bubble-show"}),e.handler&&clearTimeout(e.handler),e.handler=setTimeout(function(){e.page.setData({"bubble.showBubbleCls":"bubble-hide"}),e.handler=null,e.handleBubbleList()},5e3))}}},{key:"handleBubbleList",value:function(){var e=this;!this.showHandler&&this.msgList.length>0&&(this.showHandler=setTimeout(function(){if(e.showHandler=null,0!==e.msgList.length){var s=e.msgList.shift();if(s&&e.page&&!e.page.bubbleIsClosed){var a=s.content,t=s.image_url,i=s.group_order_id;e.page.bubbleLastTime=Number(new Date),e.page.setData({"bubble.content":a,"bubble.img":t,"bubble.groupOrderId":i}),(0,l.TrackingRecord)({op:"impr",event:"page_show",page_element:"bubble"})}}},5e3))}}]),e}()));exports.default=r; 
 			}); 
		define("components/component.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,a){for(var n=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),r=0,i=n.length;r<i;++r){var o=n[r];if(!(o in e))return e[o]=a;e=e[o]}return e}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=require("../common/index"),i=function(){function i(e,a){t(this,i),this.target=e,this.ns=a,"function"==typeof e.setData&&(this.page=e),this._mergeLifeCircle()}return n(i,[{key:"_mergeLifeCircle",value:function(){var e=this,t=this,a=["onLoad","onReady","onShow","onHide","onUnload","onPageScroll","onShareAppMessage"],n=!0,r=!1,i=void 0;try{for(var o,s=a[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){(function(){var a=o.value;if(!e[a])return"continue";var n=e.target[a];e.target[a]=function(){return t.page||(t.page=this),n&&n.apply(this,arguments),t[a].apply(t,arguments)}})()}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}}},{key:"_getFuncName",value:function(e){return""+e}},{key:"setData",value:function(e,t){if(!this.page)throw Error("no page object~ ");var a=this.ns,n={};if(t)n=e;else for(var r in e)n[a+"."+r]=e[r];this.page.setData(n)}},{key:"setDataObj",value:function(e,t){if(!this.page)throw Error("no page object~ ");var a=this.ns,n={};if(t)n=e;else for(var i in e)n[a+"."+i]=e[i];this.page.dataObj||(this.page.dataObj={}),this.page.dataObj=r.ObjectUtil.assign(this.page.dataObj,n)}},{key:"addFunc",value:function(t,a){if(this.data[t])throw new Error("function name "+t+" is already exists~ ");var n=this._getFuncName(t);this.page?this.setData(e({},""+t,n)):this.data[t]=n,this.target[n]=a.bind(this)}},{key:"data",get:function(){return a((this.page||this.target).data,this.ns,{})},set:function(e){throw console.log("~~~~~~~~~ set: ",e),Error("cannot set data yet!")}}]),i}();exports.default=i; 
 			}); 
		define("components/edit_address/edit_address.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function i(i){return i&&i.__esModule?i:{default:i}}function t(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function i(i,t){for(var e=0;e<t.length;e++){var s=t[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}return function(t,e,s){return e&&i(t.prototype,e),s&&i(t,s),t}}(),s=i(require("../../common/data_util")),a=i(require("../../common/object_util")),d=(i(require("../../constants/dispatch_type")),i(require("../../controller/addresses_controller"))),r=(i(require("../../constants/addresses")),i(require("../../common/util"))),n=i(require("../../common/system_info")),o=(i(require("../../components/toast/toast.js")),i(require("../../storage/ram_manager"))),c=(i(require("../../controller/formid_controller")),require("../../common/index")),h=(i(require("../../libs/co/we-index")),i(require("../../libs/regenerator-runtime/runtime")),!1),l=function(){function i(){t(this,i),this.nearbyPOIs=[],this.lastValidProviceIndex=0,this.lastValidCityIndex=0,this.lastValidDistrictIndex=0,this.lastValidProvinceId=0,this.lastValidCityId=0,this.lastValidDistrictId=0}return e(i,[{key:"initComponentData",value:function(){var i=this;this.setData({isNameError:!1,isMobileError:!1,isAddressDetailError:!1,inputName:(i.curAddress||{}).name||"",inputMobile:(i.curAddress||{}).mobile||"",inputAddressDetail:(i.curAddress||{}).address||"",provinceIndex:1,cityIndex:1,districtIndex:1,loadingVisible:!1,windowTitle:i.windowTitle,toastData:{toastMessage:""},disabled:!0,districtAddress:"",alreadyChooseDistrict:!!i.curAddress,becomeFocus:!1,showLocationBtn:!1}),this.addFunc("hideEditAddressModule",this.hideEditAddressModule),this.addFunc("saveEditModuleAddress",this.saveEditModuleAddress),this.addFunc("removeEditModuleError",this.removeEditModuleError),this.addFunc("showRegionsPicker",this.showRegionsPicker),this.addFunc("confirmRegionsPicker",this.confirmRegionsPicker),this.addFunc("cancelRegionsPicker",this.cancelRegionsPicker),this.addFunc("hideRegionsPicker",this.hideRegionsPicker),this.addFunc("bindChange",this.bindChange),this.addFunc("bindNameChange",this.bindNameChange),this.addFunc("bindNameChange",this.bindNameChange),this.addFunc("bindMobileChange",this.bindMobileChange),this.addFunc("bindAddressChange",this.bindAddressChange),this.addFunc("didClickLocationBtn",this.didClickLocationBtn),this.addFunc("hideAllPicker",this.hideAllPicker),this.addFunc("didChoosePOI",this.didChoosePOI),this.updateRegionsPicker("111");var t=this.getData();this.inputName=t.inputName,this.inputMobile=t.inputMobile,this.inputAddress=t.inputAddressDetail,this.imprTime=0,this.isAuto=!1,this.isEdit=!1,this.setDistrictAddress();var e="9px";n.default.getSystemInfoSync().platform.indexOf("ios")>=0&&(e="4px"),this.setData({paddingTop:e}),this.setDisableIfNeed(),this.locateUser()}},{key:"locateUser",value:function(){var i=this;i.hasLocationAuth&&wx.getLocation({success:function(t){var e=t.latitude,s=t.longitude;c.Request.apiRequest("GET","api/galen/huygens/location/decoder",{lat:e,lng:s,coord_type:1}).then(function(t){i.nearbyPOIs=t&&t.data,i.processNearbyPOIs()}).catch(function(i){console.error(i)})}})}},{key:"processNearbyPOIs",value:function(){if(this.nearbyPOIs&&!(this.nearbyPOIs.length<=0)){this.setData({nearbyPOIs:this.nearbyPOIs,showLocationBtn:!0});var i=this.nearbyPOIs[0];this.curAddress||(this.provinceId=i.province_id,this.cityId=i.city_id,this.districtId=i.district_id,this.lastValidProvinceId=this.provinceId,this.lastValidCityId=this.cityId,this.lastValidDistrictId=this.districtId,this.updateRegionsPicker("111",{from:"location"}),this.setData({alreadyChooseDistrict:!0}),this.setDistrictAddress())}}},{key:"didChoosePOI",value:function(i){if(i&&i.currentTarget&&i.currentTarget.dataset){var t=i.currentTarget.dataset.index||0,e=this.nearbyPOIs[t];e&&(e.province_id==this.provinceId&&e.city_id==this.cityId&&e.district_id==this.districtId||o.default.CPPage.$showToast("省市区信息已同步修改"),this.provinceId=e.province_id,this.cityId=e.city_id,this.districtId=e.district_id,this.updateRegionsPicker("111"),this.hideAddressPicker(),this.setData({alreadyChooseDistrict:!0,inputAddressDetail:e.thumb_address}),this.inputAddress=e.thumb_address,this.setDistrictAddress(),this.isAuto=!0)}this.setDisableIfNeed()}},{key:"didClickLocationBtn",value:function(){this.hideRegionsPicker(),this.setData({addressSelectVisible:!0,becomeFocus:!1});var i={op:"click",page_section:"address_popup",page_element:"rev_geo"};this.curAddress&&(i.addressId=this.curAddress.addressId),(0,c.TrackingRecord)(i)}},{key:"hideAddressPicker",value:function(){this.setData({addressSelectVisible:!1})}},{key:"addFunc",value:function(i,t){"function"==typeof this.addRootFunc&&this.addRootFunc(i,r.default.bind(t,this))}},{key:"bindNameChange",value:function(i){var t=i.detail.value;this.inputName=t,this.setDisableIfNeed()}},{key:"bindMobileChange",value:function(i){var t=i.detail.value;this.inputMobile=t,this.setDisableIfNeed()}},{key:"bindAddressChange",value:function(i){var t=i.detail.value;this.inputAddress=t,this.setDisableIfNeed(),this.isEdit=!0}},{key:"bindChange",value:function(i){var t=i.detail.value||[],e=parseInt(t[0],10),s=parseInt(t[1],10),a=parseInt(t[2],10);e!=this.getData().provinceIndex?this.updateRegionsPicker("011",{provinceIndex:e,cityIndex:0,districtIndex:0}):s!=this.getData().cityIndex?this.updateRegionsPicker("001",{provinceIndex:e,cityIndex:s,districtIndex:0}):a!=this.getData().districtIndex&&this.updateRegionsPicker("000",{provinceIndex:e,cityIndex:s,districtIndex:a}),this.setDisableIfNeed()}},{key:"hideAllPicker",value:function(){this.hideRegionsPicker(),this.hideAddressPicker()}},{key:"hideRegionsPicker",value:function(){var i=this.getData();i.regionsSelectVisible&&(this.setData({regionsSelectVisible:!1}),i.provinceIndex>0&&i.cityIndex>0&&i.districtIndex>0?(this.setData({alreadyChooseDistrict:!0}),this.setDistrictAddress(),this.lastValidProviceIndex=i.provinceIndex,this.lastValidCityIndex=i.cityIndex,this.lastValidDistrictIndex=i.districtIndex,this.lastValidProvinceId=this.provinceId,this.lastValidCityId=this.cityId,this.lastValidDistrictId=this.districtId):this.setBackAddressInfo())}},{key:"cancelRegionsPicker",value:function(){this.setData({regionsSelectVisible:!1}),this.setBackAddressInfo()}},{key:"setBackAddressInfo",value:function(){this.setData({provinceIndex:this.lastValidProviceIndex,cityIndex:this.lastValidCityIndex,districtIndex:this.lastValidDistrictIndex}),this.provinceId=this.lastValidProvinceId,this.cityId=this.lastValidCityId,this.districtId=this.lastValidDistrictId}},{key:"confirmRegionsPicker",value:function(){this.verfiyAddress(!0)&&this.hideAllPicker()}},{key:"setDistrictAddress",value:function(){var i=void 0,t=this.getData();i=t.alreadyChooseDistrict?t.provinces[t.provinceIndex].regionName+t.cities[t.cityIndex].regionName+t.districts[t.districtIndex].regionName:"地区信息（请选择）",this.setData({districtAddress:i})}},{key:"showRegionsPicker",value:function(){this.setData({regionsSelectVisible:!0,becomeFocus:!1,addressSelectVisible:!1}),this.updateRegionsPicker("111")}},{key:"regionIdInRegionsIndex",value:function(i,t){if(null==t)return-1;for(var e=0;e<t.length;++e)if(t[e].regionId==i)return e;return-1}},{key:"show",value:function(){this.setData({editAddressWindowVisible:!0}),h=!1,this.isAuto=!1,this.isEdit=!1,this.imprTime=Date.now();var i={op:"impr",page_section:"address_popup"};this.curAddress&&(i.addressId=this.curAddress.addressId),(0,c.TrackingRecord)(i)}},{key:"hide",value:function(){this.setData({editAddressWindowVisible:!1}),this.hideAllPicker()}},{key:"setDisableIfNeed",value:function(){var i=!(this.inputName&&this.inputMobile&&this.inputAddress&&this.getData().alreadyChooseDistrict);this.setData({disabled:i})}},{key:"verifyAddressInfoValid",value:function(){return this.verifyName()&&this.verifyMobile()&&this.verfiyAddress()}},{key:"verifyName",value:function(){var i=this.getData().inputName,t=o.default.CPPage;return i.length<=0?(t.$showToast("收货人的名字不能为空"),!1):!(s.default.getStringCharLength(i)>16)||(t.$showToast("名字不能超过8个字"),this.setData({isNameError:!0}),!1)}},{key:"verifyMobile",value:function(){var i=this.getData().inputMobile,t=o.default.CPPage;if(i.length<=0)return t.$showToast("收货人的电话不能为空"),!1;for(var e=/^(\+86)?(1)\d{10}$/,s=i.replace(/\s|\-/g,""),a="",d=0;d<s.length;d++)s.charCodeAt(d)<255&&(a+=s.substr(d,1));return!!e.test(a)||(t.$showToast("请输入正确的手机号"),this.setData({isMobileError:!0}),!1)}},{key:"verfiyAddress",value:function(i){var t=o.default.CPPage;if(!this.provinceId)return t.$showToast("请先选择省份"),!1;if(!this.cityId)return t.$showToast("请先选择城市"),!1;if(!this.districtId)return t.$showToast("请选择地区"),!1;if(!i){var e=this.getData().inputAddressDetail;if(e.length<=0)return t.$showToast("详细地址不能为空"),!1;if(e.match(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g))return t.$showToast("详细地址中不能包含表情符"),!1;if(s.default.getStringCharLength(e)>100)return t.$showToast("地址填写过长"),this.setData({isAddressDetailError:!0}),!1;if(/^[0-9]*$/.test(e))return t.$showToast("详细地址不能全为数字"),this.setData({isAddressDetailError:!0}),!1}return!0}},{key:"btnClickTracking",value:function(i,t){var e={op:"click",page_section:"address_popup",page_element:i,time_length:Math.abs(Date.now()-this.imprTime)};this.curAddress&&(e.addressId=this.curAddress.addressId),t&&(e=a.default.assign(e,t)),(0,c.TrackingRecord)(e)}},{key:"hideEditAddressModule",value:function(){this.hide(),this.btnClickTracking("close_btn")}},{key:"saveEditModuleAddress",value:function(i){if(!h){var t=this;if(this.setData({inputAddressDetail:this.inputAddress,inputMobile:this.inputMobile,inputName:this.inputName}),this.verifyAddressInfoValid()){this.setData({loadingVisible:!0,becomeFocus:!1});var e={name:this.getData().inputName,mobile:this.getData().inputMobile,provinceId:this.provinceId,cityId:this.cityId,districtId:this.districtId,address:this.getData().inputAddressDetail};h=!0,this.curAddress?(e.isDefaultAddress=this.curAddress.isDefaultAddress,e.addressId=this.curAddress.addressId,d.default.modifyAddress(e,function(i){t.setData({loadingVisible:!1}),i.errorCode?o.default.CPPage.$showToast(i.errorMsg):(console.log(i),t.saveAddressCallback&&t.saveAddressCallback(i))})):d.default.createAddress(e,function(i){t.setData({loadingVisible:!1}),i.errorCode?o.default.CPPage.$showToast(i.errorMsg):t.saveAddressCallback&&t.saveAddressCallback(i)});var s=0;this.isAuto&&this.isEdit?s=2:this.isAuto&&!this.isEdit&&(s=1),this.btnClickTracking("save_btn",{auto_add:s})}}}},{key:"removeEditModuleError",value:function(i){var t=i.currentTarget.id;i.detail.value;switch(this.hideAllPicker(),t){case"name":this.getData().isNameError&&this.setData({isNameError:!1});break;case"mobile":this.setData({isMobileError:!1});break;case"addressDetail":this.setData({isAddressDetailError:!1})}}},{key:"formatRegions",value:function(i){var t=[];return i.forEach(function(i){t.push({regionId:i.id,regionName:i.region_name})}),t}},{key:"getData",value:function(){return"function"==typeof this.getDataFunc?this.getDataFunc():{}}},{key:"setData",value:function(i){"function"==typeof this.setDataFunc&&this.setDataFunc(i)}},{key:"updateRegionsPicker",value:function(i,t){t=t||{};var e="111"===i;i=i?i.split(""):[1,1,1];var s={},a=this.getData().provinceIndex,d=this.getData().cityIndex,r=this.getData().districtIndex;if(isNaN(t.provinceIndex)||(a=t.provinceIndex),isNaN(t.cityIndex)||(d=t.cityIndex),isNaN(t.districtIndex)||(r=t.districtIndex),"1"==i[0]){var n=this.getData().provinces||[];n.length<=0&&(n=[{regionName:"选择省份"}].concat(this.formatRegions(this.regionsDatas||[]))),this.provinceId&&e&&(a=this.regionIdInRegionsIndex(this.provinceId,n)),s.provinces=n}if("1"==i[1]){var o=[{regionName:"选择城市"}];if(this.regionsDatas.length>=a&&a>=1){var c=this.regionsDatas[a-1].children;o=o.concat(this.formatRegions(c||[]))}this.cityId&&e&&(d=this.regionIdInRegionsIndex(this.cityId,o)),s.cities=o}if("1"==i[2]){var h=[{regionName:"选择地区"}];if(this.regionsDatas.length>=a&&a>=1&&d>=1){var l=this.regionsDatas[a-1].children[d-1].children;h=h.concat(this.formatRegions(l||[]))}this.districtId&&e&&(r=this.regionIdInRegionsIndex(this.districtId,h)),s.districts=h}s.provinceIndex=a,s.cityIndex=d,s.districtIndex=r,this.setData(s);var u=this;setTimeout(function(){u.setData(s)},500);var I=this.getData().provinces||[],g=this.getData().cities||[],v=this.getData().districts||[];this.provinceId=(I[a]||{}).regionId,this.cityId=(g[d]||{}).regionId,this.districtId=(v[r]||{}).regionId,"location"==t.from&&a>0&&d>0&&r>0&&(this.lastValidProviceIndex=a,this.lastValidCityIndex=d,this.lastValidDistrictIndex=r)}},{key:"load",value:function(i,t,e,s){var a=this;i?(this.curAddress=i,this.provinceId=i.provinceId,this.cityId=i.cityId,this.districtId=i.districtId):(this.curAddress=null,this.provinceId=null,this.cityId=null,this.districtId=null),this.data=s.data,this.setDataFunc=s.setDataFunc,this.getDataFunc=s.getDataFunc,this.addRootFunc=s.addRootFunc,this.windowTitle=s.windowTitle||"",this.regionsDatas=s.regionsDatas||[],this.loadCallback=t,this.saveAddressCallback=e,this.initComponentData(),setTimeout(function(){a.loadCallback()},100)}}]),i}();exports.default=l; 
 			}); 
		define("components/goods_bottom_bar/goods_bottom_bar.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function t(t,e){for(var a=0;a<e.length;a++){var s=e[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,a,s){return a&&t(e.prototype,a),s&&t(e,s),e}}(),s=require("../../common/index"),n=t(require("../../storage/ram_manager")),o=t(require("../../configs/api")),i=t(require("../../libs/co/we-index")),u=t(require("../../libs/regenerator-runtime/runtime")),l=(t(require("../../constants/tracking/goods")),{FIRST:"已加入收藏,可在您的个人中心查看",DEFAULT:"已加入收藏",LIKE_MALL:"收藏店铺成功"}),r=function(){function t(a){e(this,t),this.setDataFunc=a.setDataFunc,this.addRootFunc=a.addRootFunc,this.showToastFunc=a.showToast,this.goodsId=a.goodsId,this.goodsBottomBarData=null,this.addGoodsLikeEvent()}return a(t,[{key:"setData",value:function(t){"function"==typeof this.setDataFunc&&this.setDataFunc(t)}},{key:"initComponentData",value:function(t,e,a){if(t){this.dataObj={hasLiked:!!t.hasLiked,singlePurchaseButton:!0,singleButtonClass:"",singleButtonLabel:"",clickSingleButtonFunc:"",secondButtonClass:"",secondButtonLabel01:"",secondButtonLabel02Class:"",SecondButtonLabel02:""};t.groupbuyDesc;var s=t.groupRoleDesc||"",n=t.normalPrice||"",o=t.groupPrice||"",i=(t.customerNumber,t.totalPrice||""),u=!!t.isOnSale,l=!!t.isFreeTrial,r=!!t.isLottery,d=!!t.spikeComing,c=!!t.lotteryComing,b=t.resultOn||"",h=!!t.hasFreeCoupons,g=!!t.hasAssociatedGroup,B=!!t.hasCaptainCoupons,O=!!t.isCapitalGift,j=!!t.isCapitalGiftLottery,p=!!t.isSpike,L=!!t.isSuperSpike,k=t.resultLabel||"",f=t.lotteryWaitingLabel||"",C=t.eventComingLabel||"",v="￥"+o,y="￥"+i;if(this.dataObj.normalPrice=n,this.dataObj.singlePurchaseButton=!1,this.dataObj.secondButtonClass="goods-group-btn",this.dataObj.secondButtonLabel01="一键开团",this.dataObj.secondButtonLabel02Class="goods-buy-price",this.dataObj.SecondButtonLabel02=v,r||l)c?(this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass="goods-event-coming-btn",this.dataObj.singleButtonLabel=C.join(" "),this.dataObj.clickSingleButtonFunc=""):"on"===b?(this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass="goods-lottery-result-btn",this.dataObj.singleButtonLabel=k,this.dataObj.clickSingleButtonFunc="goDrawLuckyList",this.dataObj.showLotteryConfirmModal=!0):"waiting"===b?(this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass="goods-lottery-waiting-btn",this.dataObj.singleButtonLabel=f,this.dataObj.clickSingleButtonFunc=""):g||j?!g&&j&&(this.dataObj.singlePurchaseButton=!1,this.dataObj.secondButtonClass="goods-group-btn",this.dataObj.secondButtonLabel01="开团送礼",this.dataObj.secondButtonLabel02Class="goods-buy-price",this.dataObj.SecondButtonLabel02=y):r||l?(this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass="goods-lottery-result-btn",this.dataObj.singleButtonLabel=v+(r?" 一键拼":" 申请免费试用"),this.dataObj.clickSingleButtonFunc="groupBuy"):(this.dataObj.singlePurchaseButton=!1,this.dataObj.secondButtonClass="goods-group-btn",this.dataObj.secondButtonLabel01="一键开团",this.dataObj.secondButtonLabel02Class="goods-buy-price",this.dataObj.SecondButtonLabel02=v);else if(p||L){if(d&&!u){this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass=e.reminded?"spike-has-remind-btn":"spike-no-remind-btn",this.dataObj.singleButtonLabel=C.join(" "),this.dataObj.clickSingleButtonFunc="spikeRemind",this.setData(this.dataObj);var m=this,F=e.groupTypes[1].startTime-e.serverTime+3;if(e&&e.groupTypes&&e.groupTypes[1]&&F<=180){var S=Math.floor(F/60),P=F%60;S>0?(S+="分",P<10&&(P="0"+P)):S="";var D="剩余 "+S+P+"秒 即将开抢";m.setData({clickSingleButtonFunc:"",singleButtonClass:"goods-lottery-result-btn",singleButtonLabel:D})}return m.spikeComingInterval&&clearInterval(m.spikeComingInterval),void(m.spikeComingInterval=setInterval(function(){if(--F<180&&F>0){var t=Math.floor(F/60),e=F%60;t>0?(t+="分",e<10&&(e="0"+e)):t="";var s="剩余 "+t+e+"秒 即将开抢";m.setData({clickSingleButtonFunc:"",singleButtonClass:"goods-lottery-result-btn",singleButtonLabel:s})}else F<=0&&(clearInterval(m.spikeComingInterval),a.data.goodsInfo.isOnSale=!0,m.setData({singlePurchaseButton:!1,secondButtonClass:"goods-group-btn",secondButtonLabel01:"一键开团",secondButtonLabel02Class:"goods-buy-price",SecondButtonLabel02:v}))},1e3))}d&&u&&(this.dataObj.singlePurchaseButton=!1,this.dataObj.secondButtonClass="goods-event-coming-s-btn",this.dataObj.secondButtonLabel01=C[0],this.dataObj.secondButtonLabel02Class="g-ec-line2",this.dataObj.SecondButtonLabel02=C[1])}u?g?(this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass="goods-group-buy-button",this.dataObj.singleButtonLabel=s,this.dataObj.clickSingleButtonFunc="groupBuyOrPromptShare"):h?(this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass="goods-group-buy-button",this.dataObj.singleButtonLabel="团长免费开团",this.dataObj.clickSingleButtonFunc="groupBuyOrPromptShare"):B?(this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass="goods-group-buy-button",this.dataObj.singleButtonLabel="一元换购",this.dataObj.clickSingleButtonFunc="groupBuyOrPromptShare"):O&&(this.dataObj.singlePurchaseButton=!1,this.dataObj.secondButtonClass="goods-group-btn",this.dataObj.secondButtonLabel01="开团送礼",this.dataObj.secondButtonLabel02Class="goods-buy-price",this.dataObj.SecondButtonLabel02=y):(p?(this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass="spike-no-remind-btn",this.dataObj.singleButtonLabel="已售罄",this.dataObj.singleButtonLabel02="去店铺看看",this.dataObj.clickSingleButtonFunc="navigationToMallPage"):(this.dataObj.singlePurchaseButton=!0,this.dataObj.singleButtonClass="goods-out-btn",this.dataObj.singleButtonLabel="已售罄",this.dataObj.clickSingleButtonFunc=""),this.setData(this.dataObj)),this.setData(this.dataObj)}}},{key:"doLikeOrCancelLikeGoods",value:function(){return i.default.wrap(u.default.mark(function t(e,a,i,r){var d,c;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a&&!i.likeGoodsRequestLock){t.next=3;break}return t.abrupt("return");case 3:return i.likeGoodsRequestLock=!0,d=e?o.default.doLikeGoods:o.default.unLikeGoods,t.next=7,s.Request.apiRequest("POST",d+a);case 7:(c=t.sent)&&(n.default.likeGoodsIds[a]=e),i.setData({hasLiked:!!n.default.likeGoodsIds[a]}),r||(e?(i.showToastFunc(n.default.isFirstShowLikeHint?l.FIRST:l.DEFAULT),n.default.isFirstShowLikeHint=!1):(n.default.likeGoodsList=s.DataUtil.removeItemByKey(n.default.likeGoodsList,"goodsId",a),i.showToastFunc("取消收藏成功"))),i.likeGoodsRequestLock=!1,t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),console.error(t.t0),i.showToastFunc("加载出错");case 18:case"end":return t.stop()}},t,this,[[0,14]])}))}},{key:"addGoodsLikeEvent",value:function(){var t=this;try{"function"==typeof this.addRootFunc&&this.addRootFunc("goodsLike",function(e,a){var s=t.goodsId;if(s){var o=!n.default.likeGoodsIds[s],l=t;(0,i.default)(u.default.mark(function t(){return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.doLikeOrCancelLikeGoods()(o,s,l,a);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}))}})}catch(t){console.error(t),that.showToastFunc("加载出错")}}},{key:"load",value:function(t,e,a){this.goodsBottomBarData=t,this.initComponentData(t,e,a)}},{key:"unload",value:function(){this.spikeComingInterval&&clearInterval(this.spikeComingInterval)}}]),t}();exports.default=r; 
 			}); 
		define("components/modal_dialog/modal_dialog.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),a=e(require("../../storage/ram_manager")),o=e(require("../../common/util")),i=function(){function e(t){n(this,e),this.setDataFunc=t.setDataFunc}return t(e,[{key:"show",value:function(e){this.setDataFunc&&(e.visible=!0,void 0===e.showCancel&&(e.showCancel=!0),void 0===e.reportFormId&&(e.reportFormId=!1),this.modalData=e,a.default.CPPage.onModalCancel=o.default.bind(this.onModalCancel,this),a.default.CPPage.onModalConfirm=o.default.bind(this.onModalConfirm,this),this.setDataFunc(e))}},{key:"onModalCancel",value:function(){this.hide();var e=this.modalData.success;"function"==typeof e&&e({cancel:!0})}},{key:"onModalConfirm",value:function(){this.hide();var e=this.modalData.success;"function"==typeof e&&e({confirm:!0})}},{key:"hide",value:function(){this.setDataFunc({visible:!1}),a.default.CPPage.onModalCancel=null,a.default.CPPage.onModalConfirm=null}}]),e}();exports.default=i; 
 			}); 
		define("components/navigation_modal/navigation_modal.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function a(a){return a&&a.__esModule?a:{default:a}}function t(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function a(a,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,i.key,i)}}return function(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}}(),i=(a(require("../../common/navigation")),a(require("../../common/request")),a(require("../../common/image_util")),a(require("../../common/std_format")),a(require("../../common/util"))),n=a(require("../../common/user")),o=(a(require("../../configs/api")),a(require("../../libs/co/we-index")),a(require("../../libs/es6-promise.min")),a(require("../../storage/user_storage"))),r=(a(require("../../libs/regenerator-runtime/runtime")),a(require("../../common/time_util")),a(require("../../storage/ram_manager"))),u=[{typeName:"我的足迹",icon:"icon-navigation_foot",navigate:"footprint"},{typeName:"我的收藏",icon:"icon-category-hot",navigate:"likes"},{typeName:"搜索",icon:"icon-wechat_mark_icon_sea",navigate:"classification"},{typeName:"首页",icon:"icon-nav-home-colour",navigate:"index"},{typeName:"海淘",icon:"icon-nav-overseashop-line",navigate:"haitao"},{typeName:"新品",icon:"icon-nav-new-line",navigate:"new_arrivals"}],s=function(){function a(e){t(this,a);for(var n=new Array,o=0;o<e.arr.length;++o)n.push(u[e.arr[o]]);this.dataObj={visible:!1,navigateList:n,showNavigation:!0},e&&(this.setDataFunc=e.setDataFunc,this.addRootFunc=e.addRootFunc,this.addRootFunc("navigateInterceptor",i.default.bind(this.navigateInterceptor,this)),this.addRootFunc("onNavigationItemClicked",i.default.bind(this.onNavigationItemClicked,this)),this.addRootFunc("tapNavigationModalMask",i.default.bind(this.tapNavigationModalMask,this)),this.addRootFunc("navigationModalTouchMove",i.default.bind(this.navigationModalTouchMove,this)),this.addRootFunc("navigationModalPreventTouchMove",i.default.bind(this.navigationModalPreventTouchMove,this)))}return e(a,[{key:"navigateInterceptor",value:function(a){null!=o.default.getAccessToken()?"function"==typeof a&&a():n.default.showUserInfoModal(function(a){})}},{key:"onNavigationItemClicked",value:function(a){var t=r.default.CPPage,e=a.currentTarget.dataset.navigate;if("index"==e||"classification"==e||"haitao"==e||"new_arrivals"==e){t.$switchTab(e);var i=e;"classification"==e?i="search":"new_arrivals"==e&&(i="shangxin"),t.navigationTrackingRecord(i)}else this.navigateInterceptor(function(){t.$forward(e),t.navigationTrackingRecord(e)})}},{key:"tapNavigationModalMask",value:function(a){this.hide()}},{key:"navigationModalTouchMove",value:function(a){this.hide()}},{key:"navigationModalPreventTouchMove",value:function(a){}},{key:"getGoodsId",value:function(){return this.dataObj.goodsId}},{key:"hasLocalGroup",value:function(){return this.dataObj.hasLocalGroup}},{key:"show",value:function(a){this.dataObj.visible=!0,this.dataObj.showNavigation=!1,this.setDataFunc(this.dataObj),this.timeOut&&(clearTimeout(this.timeOut),this.timeOut=null);var t=this;setTimeout(function(){t.dataObj.showNavigation=!0,t.setDataFunc(t.dataObj)},1)}},{key:"hide",value:function(){var a=this;a.dataObj.showNavigation=!1,a.setDataFunc(a.dataObj),this.timeOut=setTimeout(function(){a.dataObj.visible=!1,a.setDataFunc(a.dataObj)},300)}}]),a}();exports.default=s; 
 			}); 
		define("components/new_user_coupon/new_user_coupon.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("../../common/request")),t=e(require("../../configs/api")),a=e(require("../../libs/co/we-index")),n=(e(require("../../libs/es6-promise.min")),e(require("../../libs/regenerator-runtime/runtime"))),s=e(require("../../storage/ram_manager")),u=(require("../../common/message"),e(require("../../common/storage_util"))),o={noOrder:null,shouldShowNewUserPop:a.default.wrap(n.default.mark(function e(){var r,t;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=o.noOrder,t=!1,null!==r){e.next=11;break}return e.next=6,o.fetchUserType();case 6:return e.next=8,o.newUserCouponCheck();case 8:t=e.sent,e.next=14;break;case 11:return e.next=13,o.newUserCouponCheck();case 13:t=e.sent;case 14:return e.abrupt("return",t);case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0);case 20:case"end":return e.stop()}},e,this,[[0,17]])})),newUserCouponCheck:a.default.wrap(n.default.mark(function e(){var t,a,o;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=!1,0!=s.default.pddUserType){e.next=4;break}return e.abrupt("return",!1);case 4:if(a=u.default.getStorageSync("hasDrawCoupon")){e.next=10;break}return e.next=8,r.default.apiRequest("POST","backend/newuser/coupon/pupup",null,!1,{needGZToken:!0,forceUseApiGZ:!0});case 8:(o=e.sent)&&o.success&&(t=o.data);case 10:return e.abrupt("return",t);case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0);case 16:case"end":return e.stop()}},e,this,[[0,13]])})),fetchUserType:a.default.wrap(n.default.mark(function e(){var a,u,c;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.default.apiRequest("GET",t.default.hasOrders,{check_has_normal_order:1});case 3:a=e.sent,u=!1,a&&a.user_tags&&(c=a.user_tags,u=0==c.has_normal_order,"0"===s.default.pddUserType&&u&&(s.default.pddUserType="2"),o.noOrder=u),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}))};exports.default=o; 
 			}); 
		define("components/order_checkout_address/order_checkout_address.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function s(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function e(e,s){for(var t=0;t<s.length;t++){var a=s[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(s,t,a){return t&&e(s.prototype,t),a&&e(s,a),s}}(),a=e(require("../../common/data_util")),d=e(require("../../constants/addresses")),i=e(require("../../configs/api")),n=e(require("../../common/request")),r=(e(require("../../common/navigation")),e(require("../../common/url_util")),e(require("../../common/util"))),o=e(require("../../storage/ram_manager")),l=e(require("../../controller/formid_controller")),u=e(require("../../storage/user_storage")),c=require("../../common/message"),h={Default:"查看配送说明"},f={Default:"当前地址不在配送范围内"},g={Default:"(无法配送至该地址)"},v=function(){function e(){s(this,e),this.addresses=null,this.selectedAddressId=null,this.address=null,this.saleRegions=[],this.setDataFunc=null,this.getDataFunc=null,this.addRootFunc=null,this.addressSelectdispachId=null,this.trackingFunc=null}return t(e,[{key:"updateOrderAddress",value:function(e){e?(this.address=e,e&&e.addressId&&(null==this.address.canReceived&&(this.address.canReceived=this.saleRegions.length<=0||this.saleRegions.indexOf(this.address.provinceId+"")>=0),this.address.notAllowedNotice=f.Default,this.address.notAllowedArrow=h.Default,this.address.cantReceiveHint=g.Default),this.address.getPostage=!0,this.setData({addressInfo:this.address}),this.address.getPostage=!1):this.setData({addressInfo:{addressId:0,provinceId:0,name:"",mobile:"",province:"",city:"",district:"",addressType:"",address:"",canReceived:!0,notAllowedNotice:f.Default,notAllowedArrow:h.Default,cantReceiveHint:g.Default}})}},{key:"initComponentData",value:function(e){this.setData({showWechatAddAddress:!!wx.chooseAddress,addressInfo:{addressId:0,provinceId:0,name:"",mobile:"",province:"",city:"",district:"",addressType:"",address:"",canReceived:!0,notAllowedNotice:f.Default,notAllowedArrow:h.Default,cantReceiveHint:g.Default},regionVisible:!1,saleRegionTips:["",""],notAllowedNotice:f.Default,notAllowedArrow:h.Default,cantReceiveHint:g.Default,regionTipsShow:!1,showLoading:!1}),this.setSelectedAddress(this.addresses,this.selectedAddressId)}},{key:"updateModel",value:function(e){var s;e&&(this.address=e),this.address&&this.address.addressId&&(s={addressId:this.address.addressId,provinceId:this.address.provinceId,name:this.address.name,mobile:this.address.mobile,province:this.address.province,city:this.address.city,district:this.address.district,address:this.address.address,canReceived:this.saleRegions.length<=0||this.saleRegions.indexOf(this.address.provinceId+"")>=0}),s&&this.setData({addressInfo:s})}},{key:"setSelectedAddress",value:function(e,s){if(a.default.isArray(e)){var t=-1,d=-1;if(e.length<=0)this.address=null;else{for(var i=0;i<e.length;i++){var n=e[i];if((n.addressId||"").toString()===s)return d=i,void this.updateModel(n);n.isDefaultAddress&&(t=i)}d<0&&t>=0&&this.updateModel(e[t])}}}},{key:"showRegionTips",value:function(e){0===this.getData().saleRegionTips[0].length?this.setSaleRegionsInfo():this.setData({regionTipsShow:!0})}},{key:"hideRegionTips",value:function(e){this.setData({regionTipsShow:!1})}},{key:"editAddress",value:function(e){c.Message.on(c.KEYS.ORDERCHECKOUT_CHOOSE_ADDRESS,r.default.bind(this.selectAddress,this),!0);var s=u.default.getUserId()%100<50?"1":"0";if(o.default.CPPage.$forward("addresses",{allow_location:s,sel_address_id:this.address.addressId,allowed_regions:this.saleRegions}),e&&e.detail&&e.detail.formId)l.default.scene.common,e.detail.formId;var t="change_address";"cancel_pay_prompt"===e.currentTarget.dataset.refer&&(t="alt_add"),"function"==typeof this.trackingFunc&&this.trackingFunc(t)}},{key:"selectAddress",value:function(e){for(var s=this,t=e||[],a=void 0,d=void 0,r=0;r<t.length;r++){var l=t[r];l.isUsing&&(d=l),l.isDefaultAddress&&(a=l)}var u=this.getData();if(u&&u.disableUserAction){var h={order_sn:s.orderSn,address_id:d.addressId};n.default.apiRequest("POST",i.default.updateOrderAddress,h).then(function(e){var t=d||a;s.updateOrderAddress(t),c.Message.off(c.KEYS.ORDERCHECKOUT_CHOOSE_ADDRESS)}).catch(function(e){o.default.CPPage.$showToast("运费变动，该地址暂不支持修改，请重新下单")})}else{var f=d||a;this.updateOrderAddress(f),c.Message.off(c.KEYS.ORDERCHECKOUT_CHOOSE_ADDRESS)}}},{key:"loadProvince",value:function(e){var s=i.default.regions+"/"+d.default.Region.China;return n.default.apiRequest("GET",s)}},{key:"setSaleRegionsInfo",value:function(){var e=this;e.setData({showLoading:!0,loadingNeedBg:!0});var s,t=e.saleRegions;if(e.getDataFunc){var a=e.getDataFunc();a.addressInfo&&(s=a.addressInfo.addressId)}if(!(!s||s<=0||t.length<1||t[0].toString()===d.default.Region.China)){var i=[],n=[];e.loadProvince().then(function(s){for(var a=0;a<s.length;a++){var d=s[a];t.indexOf(d.region_id+"")>=0?n.push(d.region_name):i.push(d.region_name)}var r="";0===n.length||i.length<=n.length?r=["该商品部分地区暂不支持配送","（港澳台、"+i.join("、")+"）"]:(0===i.length||n.length<=i.length)&&(r=["该商品目前仅支持配送至",n.join("、")+"区域"]),e.setData({saleRegionTips:r,regionTipsShow:!0,showLoading:!1,loadingNeedBg:!1})})}}},{key:"setData",value:function(e){"function"==typeof this.setDataFunc&&this.setDataFunc(e)}},{key:"getData",value:function(){return"function"==typeof this.getDataFunc?this.getDataFunc():{}}},{key:"addFunc",value:function(e,s){"function"==typeof this.addRootFunc&&this.addRootFunc(e,r.default.bind(s,this))}},{key:"load",value:function(e,s,t,a){a=a||{},this.addresses=e,this.selectedAddressId=s,this.saleRegions=t,this.setDataFunc=a.setDataFunc,this.getDataFunc=a.getDataFunc,this.addRootFunc=a.addRootFunc,this.initComponentData(a),this.addFunc("editAddress",this.editAddress),this.addFunc("hideRegionTips",this.hideRegionTips),this.addFunc("showRegionTips",this.showRegionTips)}},{key:"setTrackingFunc",value:function(e){this.trackingFunc=e}}]),e}();exports.default=v; 
 			}); 
		define("components/order_checkout_goods/order_checkout_goods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var s=function(){function t(t,e){for(var o=0;o<e.length;o++){var s=e[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,o,s){return o&&t(e.prototype,o),s&&t(e,s),e}}(),a=t(require("../../constants/groups")),n=t(require("../../common/std_format")),i=t(require("../../common/data_util")),u=(t(require("../../constants/goods")),t(require("../../pages/order_checkout/goods_util"))),l=t(require("../../storage/ram_manager")),r=t(require("../../controller/formid_controller")),d=require("../../common/index"),c=function(){function t(){o(this,t),this.setDataFunc=null,this.getDataFunc=null,this.addRootFunc=null,this.goods=null,this.mallInfo=null,this.goodsNumber=1,this.limitQuantity=null,this.mallCouponText="",this.isCapitalOwner=null,this.selectedGroup=null,this.dataObj={},this.setFinalPayAmount=null,this.couponReceivedSucc=!1}return s(t,[{key:"initComponentData",value:function(t){var o;if(this.goods&&this.mallInfo){this.dataObj=(o={goodsName:this.goods.goodsName,mallName:this.mallInfo.mallName,mallLogo:this.mallInfo.logo,goodsNumber:1,isShowGoodsNumber:!0,isThreeForTwo:!1,totalGoodsNumber:1},e(o,"goodsNumber",1),e(o,"isShowGoodsNumber",!1),e(o,"hasSeletedCoupon",!1),e(o,"goodsNumberUpdate",!1),e(o,"showMinusButton",!this.isCapitalOwner),e(o,"showPlusButton",!this.isCapitalOwner),e(o,"showGoodsTotalPrice",!0),o);var s;if(t){if(this.dataObj.goodsNumber=t.goodsNumber,t.skuId)for(var i=this.goods.skus,u=0;u<i.length;u++)if(t.skuId==i[u].skuId){s=i[u];break}this.dataObj.price=n.default.price(this.selectedSkuPrice,100),this.dataObj.notFormatPrice=this.selectedSkuPrice,this.dataObj.notFormatTotalPrice=this.selectedSkuPrice}s=s||this.goods.skus[0],this.dataObj.thumbUrl=s.thumbUrl||this.goods.thumbUrl,this.dataObj.specs=s.specs||[];var l=this.selectedGroup,r=parseInt(s.quantity,10)||0,d=parseInt(l.orderLimit,10)||0,c=parseInt(s.limitQuantity,10)||0,h=d;h>r&&r>0&&(h=r),h>c&&c>0&&(h=c),this.limitQuantity=h,this.isCapitalOwner?this.dataObj.isShowGoodsNumber=!0:!1===this.isCapitalOwner?this.dataObj.isShowGoodsNumber=!1:this.limitQuantity>1?this.dataObj.isShowGoodsNumber=!0:this.dataObj.isShowGoodsNumber=!1,this.dataObj.isThreeForTwo=this.goods.eventType==a.default.EventType.TWO_FOR_ONE,this.setTotalPrice(),this.initGoodsNumberButton(),this.setTotalGoodsNumber(),this.addBlurGoodsNumberInputEvent(),this.addUpdateGoodsNumberEvent(),this.addClickMallCouponBarEvent()}}},{key:"setupMallCoupons",value:function(){var t=!1,e=this.mallInfo.mallCoupons||[];i.default.isArray(e)&&(e=e.slice(0,3));var o=!0,s=!1,n=!1;if(this.goods.freeCoupon&&this.goods.freeCoupon.length>0&&(s=!0),this.goods.captainCoupon&&this.goods.captainCoupon.length>0&&(n=!0),s||n||this.goods.eventType==a.default.EventType.FREE_TRIAL||7==this.goods.goodsType)o=!1;else if(i.default.isArray(e)&&!(e.length<1)||this.hasCoupons)if(this.goods.isCapitalGift||this.goods.isCapitalGiftLottery)o=!1;else{for(var u=0,l=0;l<e.length;l++)"已抢光"===e[l].couponDisableText&&u++;u!==e.length||this.hasEnableCoupons||(o=!1)}else o=!1,e=[];this.selectedCoupon&&this.selectedCoupon.couponId&&(t=!0),this.needNumber<=0&&!this.hasEnableCoupons&&(o=!1);var r=this.goods.promotionEvents;r&&r.length>0&&(o=!0),"function"==typeof this.setDataFunc&&this.setDataFunc({isShowMallCouponInfo:o,hasSeletedCoupon:t,mallCouponText:this.mallCouponText||"",isSpecialStyle:!!this.isSpecialStyle,promotionEvents:this.promotionEvents})}},{key:"getNeedNumber",value:function(t,e){var o=0;if(!t||!e)return o;if(e.price*e.limitQuantity<t.minAmount)return o;var s=Math.ceil(t.minAmount/e.price);return s>0&&(o=s),o}},{key:"getMallCouponInfo",value:function(){var t=this.goods,e=this.selectedEventId,o=this.couponInfos.mallCoupons,s=this.mallInfo.mallCoupons||[],a=this.selectedCoupon,l=!1,r=!1,d="",c=0,h=!1;o.enableCoupons&&o.enableCoupons.length>0&&(l=!0);var p=this.selectedSkuPrice;s.length>0&&(r=!0,s=(s=(s=s.sort(function(t,e){return parseInt(e.discount,10)-parseInt(t.discount,10)})).sort(function(t,e){return parseInt(t.minAmount,10)-parseInt(e.minAmount,10)})).sort(function(t,e){return t.takenOut&&!e.takenOut?1:!t.takenOut&&e.takenOut?-1:0}),c=this.getNeedNumber({minAmount:100*Math.round(s[0].minAmount)},{price:p,limitQuantity:u.default.getLimitQuantity(t.selectedSku,this.selectedGroup)}));var m=t.promotionEvents?this.goods.promotionEvents:[],f={};if(!a&&m.length>0)for(var b in m){var g=m[b].event_items,v=m[b].discount_type;for(var C in g){var y=g[C];switch(f[y.goods_number]={},v){case 4:f[y.goods_number].discount=this.dataObj.notFormatPrice-y.discount_param;break;case 5:f[y.goods_number].discount=y.discount_param;break;case 6:f[y.goods_number].discount=this.dataObj.notFormatPrice*(1-y.discount_param/100)}}}if(r&&!this.hasCoupons&&c>0){var O=this.getMaxDiscount(s,c,p);d=i.default.formatByPos((this.couponReceivedSucc,"领券满{0}减{1}"),s[0].minAmount,O),h=!0}else!l&&this.hasCoupons&&o.disableCoupons[0].leftNumber>0&&1===o.disableCoupons[0].activated?(d=i.default.formatByPos("领券满{0}减{1}",s[0].minAmount,o.disableCoupons[0].discount),h=!0):d=l&&!a&&(!m||m.length<=0)?"不使用优惠券":l&&a?"- "+a.discount+"元":"无可用";if(!a&&m&&m.length>0&&16!=this.goods.eventType){var N=m[0].event_items?m[0].event_items:[];if(N&&N.length>0){var j=N[0];if(this.dataObj.goodsNumber)if(-1==e)d=j.descountDesc,h=!0;else if(0==e)if(this.dataObj.goodsNumber<j.goods_number)d=d.indexOf("领券满")>-1?j.descountDesc+";"+d:j.descountDesc,h=!0;else{var F=0;for(var b in f)b<=this.dataObj.goodsNumber&&(F+=f[b].discount);d="- "+n.default.price(F,100)+"元",h=!1}else{var I=0;for(var b in f)b<=this.dataObj.goodsNumber&&(I+=f[b].discount);I>0?(d="- "+n.default.price(I,100)+"元",h=!1):(d=j.descountDesc,h=!0)}else d=d=j.descountDesc+";"+d,h=!0}}if((16==this.goods.eventType||18==this.goods.eventType)&&!a&&m&&m.length>0){var _=m[0].discount_type,T=m[0].event_items[0].discount_param;if(2==_){var k="";16==this.goods.eventType?k="限时折扣 ":18==this.goods.eventType&&(k="限量折扣 "),m[0].event_items[0].discount=Math.ceil((100-T)/100*p)*this.dataObj.goodsNumber,m[0].event_items[0].descountDesc=" -"+n.default.price(m[0].event_items[0].discount,100)+"元",-1!=e?(d=k+m[0].event_items[0].descountDesc,h=!1):(d="可用"+k+m[0].event_items[0].descountDesc,h=!0)}}return{text:d,isSpecialStyle:h,hasEnableCoupons:l,needNumber:c,promotionEvents:m}}},{key:"getMaxDiscount",value:function(t,e,o){for(var s=0,a=0;a<t.length;a++)if(!t[a].takenOut){var i=t[a],u=parseInt(i.discount,10)||0;e*o>=100*Math.round(i.minAmount)&&u>s&&(s=u)}return n.default.price(s)}},{key:"addClickMallCouponBarEvent",value:function(){var t=this;"function"==typeof this.addRootFunc&&this.addRootFunc("clickMallCouponBar",function(e){var o=void 0;if("function"==typeof t.getDataFunc&&(o=t.getDataFunc()),o&&o.disableUserAction)l.default.CPPage.$showToast("订单已生成，信息不可更改");else{if(16!=t.goods.eventType&&18!=t.goods.eventType)12==t.goods.eventType?-1==t.selectedEventId||t.selectedEventId>0?"function"==typeof t.selectMallCoupon&&t.selectMallCoupon():"function"==typeof t.showMallCouponsList&&t.showMallCouponsList():!t.hasCoupons&&t.hasMallCoupons&&(!t.selectedEventId||t.selectedEventId<=0)?"function"==typeof t.showMallCouponsList&&t.showMallCouponsList():"function"==typeof t.selectMallCoupon&&t.selectMallCoupon();else{var s=t.couponInfos.mallCoupons,a=!1;s.enableCoupons&&s.enableCoupons.length>0&&(a=!0),t.hasMallCoupons&&!a?"function"==typeof t.showMallCouponsList&&t.showMallCouponsList():"function"==typeof t.selectMallCoupon&&t.selectMallCoupon()}if(l.default.CPPage.getTrackingParams){var n=l.default.CPPage.getTrackingParams(null,"shop_coupon");(0,d.TrackingRecord)(n)}}})}},{key:"addBlurGoodsNumberInputEvent",value:function(){var t=this,e=l.default.CPPage;"function"==typeof this.addRootFunc&&this.addRootFunc("blurGoodsNumberInput",function(o){wx.hideKeyboard();var s=parseInt(o.detail.value.trim(),10);isNaN(s)&&(s=1,t.setTotalGoodsNumber(),e.$showToast("请输入需要的数量")),s<1&&(s=1,e.$showToast("请至少购买1份哦")),null!=t.limitQuantity&&s>t.limitQuantity&&(s=t.limitQuantity,e.$showToast(i.default.formatByPos("很抱歉，该商品当前至多只能购买{0}份",t.limitQuantity))),t.setDataFunc&&(t.dataObj.goodsNumber=s,s===t.dataObj.goodsNumber&&t.setDataFunc({goodsNumber:0}),t.setDataFunc({goodsNumber:s}),"function"==typeof t.setupCouponsFunc&&t.setupCouponsFunc(),t.setTotalGoodsNumber(),t.initGoodsNumberButton())})}},{key:"setTotalGoodsNumber",value:function(){if(this.dataObj.isThreeForTwo){var t=parseInt(this.dataObj.goodsNumber)||1,e=Math.floor(t/2);this.dataObj.totalGoodsNumber=e+t,"function"==typeof this.setDataFunc&&this.setDataFunc(this.dataObj)}else this.dataObj.totalGoodsNumber=this.dataObj.goodsNumber}},{key:"initGoodsNumberButton",value:function(){var t=parseInt(this.dataObj.goodsNumber,10)||1;this.dataObj.reduceDisable=t<=1,t>=this.limitQuantity?this.dataObj.increaseDisable=!0:this.dataObj.increaseDisable=!1,this.isCapitalOwner&&(this.dataObj.goodsNumber=this.selectedGroup.customerNum,this.dataObj.inputDisabled=!0),this.setDataFunc&&this.setDataFunc(this.dataObj)}},{key:"setTotalPrice",value:function(){if(this.setDataFunc){var t=0,e=0;if(this.selectedCoupon&&this.selectedCoupon.discount)t=Math.round(100*this.selectedCoupon.discount);else{var o=this.goods.promotionEvents?this.goods.promotionEvents:[],s={};if(o.length>0){o[0].event_id;for(var a in o){var n=o[a].event_items,i=o[a].discount_type;for(var u in n){var l=n[u];switch(s[l.goods_number]={},i){case 4:s[l.goods_number].discount=this.dataObj.notFormatPrice-l.discount_param;break;case 5:s[l.goods_number].discount=l.discount_param;break;case 6:s[l.goods_number].discount=this.dataObj.notFormatPrice*(1-l.discount_param/100);break;case 2:s[1]={},s[1].discount=Math.ceil((100-l.discount_param)/100*this.selectedSkuPrice)*this.dataObj.goodsNumber}}}}if(-1!=this.selectedEventId){for(var a in s)a<=this.dataObj.goodsNumber&&(e+=s[a].discount);e>0&&(t=e)}}this.dataObj.notFormatTotalPrice=this.dataObj.notFormatPrice*this.dataObj.goodsNumber-t,this.dataObj.mallDiscount=t,(this.goods.isCapitalGift||this.goods.isCapitalGiftLottery)&&(this.isCapitalOwner||(this.dataObj.notFormatTotalPrice=0)),this.setDataFunc&&(this.dataObj.getPostage=!0,this.setDataFunc(this.dataObj),this.dataObj.getPostage=!1)}}},{key:"addUpdateGoodsNumberEvent",value:function(){var t=this,e=l.default.CPPage;"function"==typeof this.addRootFunc&&this.addRootFunc("updateGoodsNumber",function(o){var s=void 0;if("function"==typeof t.getDataFunc&&(s=t.getDataFunc()),s&&s.disableUserAction)e.$showToast("订单已生成，信息不可更改");else{var a=parseInt(o.detail.target.dataset.delta);if(t.setDataFunc&&!(t.dataObj.reduceDisable&&a<0))if(t.dataObj.increaseDisable&&a>0)e.$showToast(i.default.formatByPos("很抱歉，该商品当前至多只能购买{0}份",t.limitQuantity));else if(!(parseInt(t.dataObj.goodsNumber,10)+a<=0)){t.dataObj.goodsNumber=parseInt(t.dataObj.goodsNumber,10)+a;var u=t.selectedCoupon,l=t.selectedSkuPrice,d=(t.selectedEventId,t.goods),c=d.promotionEvents?d.promotionEvents:[];if((16==d.eventType||18==d.eventType)&&!u&&c&&c.length>0){var h=c[0].discount_type,p=c[0].event_items[0].discount_param;2==h&&(c[0].event_items[0].discount=Math.ceil((100-p)/100*l)*t.dataObj.goodsNumber,c[0].event_items[0].descountDesc=" -"+n.default.price(c[0].event_items[0].discount,100)+"元")}if(t.dataObj.promotionEvents=c,t.setDataFunc(t.dataObj),"function"==typeof t.setupCouponsFunc&&t.setupCouponsFunc(),o&&o.detail&&o.detail.formId)r.default.scene.common,o.detail.formId;t.initGoodsNumberButton(),t.setTotalGoodsNumber()}}})}},{key:"load",value:function(t,e,o,s,a){a=a||{},this.goods=t,this.mallInfo=e||{},this.couponInfos=o,this.selectedEventId=s,this.showMallCouponsList=a.showMallCouponsList,this.selectMallCoupon=a.selectMallCoupon,this.selectedGroup=a.selectedGroup,this.selectedSkuPrice=a.selectedSkuPrice,this.setDataFunc=a.setDataFunc,this.getDataFunc=a.getDataFunc,this.addRootFunc=a.addRootFunc,this.isCapitalOwner=a.isCapitalOwner,this.setFinalPayAmount=a.setFinalPayAmount,this.setupCouponsFunc=a.setupCouponsFunc,this.selectedCoupon=a.selectedCoupon,this.couponReceivedSucc=!!a.couponReceivedSucc;var n=(this.couponInfos||{}).mallCoupons||{};this.hasCoupons=!!n.enableCoupons&&n.enableCoupons.length>0||n.disableCoupons.length>0,this.hasMallCoupons=(this.mallInfo.mallCoupons||[]).length>0,this.initComponentData(a);this.couponInfos.mallCoupons;this.mallCouponInfo=this.getMallCouponInfo(),this.hasEnableCoupons=(this.mallCouponInfo||{}).hasEnableCoupons||!1,this.mallCouponText=(this.mallCouponInfo||{}).text||"",this.needNumber=(this.mallCouponInfo||{}).needNumber||0,this.isSpecialStyle=!!(this.mallCouponInfo||{}).isSpecialStyle,this.promotionEvents=(this.mallCouponInfo||{}).promotionEvents||{},this.setupMallCoupons()}}]),t}();exports.default=c; 
 			}); 
		define("components/pdd_action_sheet/pdd_action_sheet.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(require("../component.js")),a=function(a){function r(n){var i=n.page,o=n.ns,a=n.itemList,c=n.success,s=n.fail,u=n.complete;e(this,r);var l=t(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i,o));return i&&(l.page=i,l.success=c,l.fail=s,l.complete=u),l.addFunc("_actionSheetTap",l.tap),l.addFunc("_actionSheetCancel",l.cancel),l.setData({itemList:a}),l}return n(r,o.default),i(r,[{key:"show",value:function(){this.setData({visible:!0});var e=this;setTimeout(function(){e.setData({animationVisible:!0})},50)}},{key:"hide",value:function(){this.setData({visible:!1,animationVisible:!1})}},{key:"tap",value:function(e){this.hide();var t=e.currentTarget.dataset.index;"function"==typeof this.complete&&this.complete(t)}},{key:"cancel",value:function(){this.data.visible&&("function"==typeof this.fail&&this.fail(),"function"==typeof this.complete&&this.complete(this.data.itemList.length),this.hide())}}]),r}();exports.default=a; 
 			}); 
		define("components/promotion_spike/promotion_spike.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}(),r=e(require("../component.js")),s=e(require("../../configs/api")),a=e(require("../../pages/subjects/subjects_spike")),l=(e(require("../../libs/es6-promise.min.js")),e(require("../../libs/co/we-index"))),c=e(require("../../libs/regenerator-runtime/runtime")),u=require("../../common/index"),p=function(e){function p(e){var o=e.page,n=e.ns;t(this,p);var r=i(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,o,n));return r.spikeGoodsScrollLeftPoint=[],r.spikeTimeLineScrollLeft=[],r.timelineItemWidth=u.Util.rpxToPx(242),r.goodsItemWidth=u.Util.rpxToPx(208),r.addFunc("_switchSpikeTimeLine",r.switchSpikeTimeLine),r.addFunc("_spikeMore",r.spikeMore),r.addFunc("_spikeGoodsScroll",r.spikeGoodsScroll),r.addFunc("_spikeGoodsScrollToLower",r.spikeGoodsScrollToLower),r.setCoWrap(),r}return o(p,r.default),n(p,[{key:"setCoWrap",value:function(){this.loadData=l.default.wrap(c.default.mark(function e(){var t,i,o,n,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,e.prev=1,!t.loadingData&&!t.loadAll){e.next=4;break}return e.abrupt("return");case 4:return t.loadingData=!0,t.pageCount=t.pageCount||1,1==t.pageCount&&t.setData({curTimeLineIndex:0}),i=u.DataUtil.formatByPos(s.default.getSpikeActivity,t.pageCount,100),o=u.Request.requestDataWithUrl("GET",i),e.next=11,u.Request.runMainRequestForPage(o,t.target);case 11:n=e.sent,t.loadingData=!1,!n.errorCode&&n.goods&&(n.goods.length<99&&(t.loadAll=!0),t.spikeData=t.spikeData||{goods:[]},t.spikeData.goods=t.spikeData.goods.concat(n.goods),r=a.default.formatData(t.spikeData,!0),t.setData({spikeGoodsList:r.goodsList,timelineList:r.timelineList}),t.pageCount++,t.setSpikeScrollLeftPoint()),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),t.loadingData=!1,console.error(e.t0);case 20:case"end":return e.stop()}},e,this,[[1,16]])}))}},{key:"spikeMore",value:function(){u.Navigation.forward("/pages/spike/spike"),(0,u.TrackingRecord)({op:"click",page_sn:10115,page_el_sn:99303,refer_xcx_campaign_d12:1})}},{key:"setSpikeScrollLeftPoint",value:function(){var e=this.data.timelineList||[],t=0;this.spikeGoodsScrollLeftPoint[0]=0,t+=u.Util.rpxToPx(24);for(var i=0;i<e.length;i++){var o=e[i];t+=o.len*this.goodsItemWidth+(o.len-1)*u.Util.rpxToPx(20),t+=46,this.spikeGoodsScrollLeftPoint[i+1]=t-6,i<2?this.spikeTimeLineScrollLeft[i]=0:i>=2&&(this.spikeTimeLineScrollLeft[i]=(i-1)*this.timelineItemWidth)}}},{key:"switchSpikeTimeLine",value:function(e){var t=this,i=parseInt(e.currentTarget.dataset.index,10),o=this.spikeGoodsScrollLeftPoint||[];isNaN(i)||i===this.data.curTimeLineIndex||i<0||i>=o.length||(this.setData({timeLineLock:!0,curTimeLineIndex:i}),this.setData({spikeGoodsScrollLeft:o[i]||0}),i==this.spikeTimeLineScrollLeft.length-1&&this.loadData(),setTimeout(function(){t.setData({timeLineLock:!1})},1e3))}},{key:"spikeGoodsScroll",value:function(e){for(var t=this,i=parseInt(e.detail.scrollLeft,10),o=this.goodsItemWidth+46,n=this.spikeGoodsScrollLeftPoint||[],r=this.data.curTimeLineIndex,s=1;s<n.length;s++)if(i+o>=n[s-1]&&i+o<n[s]){r=s-1;break}i>=n[n.length-2]&&(r=this.spikeTimeLineScrollLeft.length-1),this.data.timeLineLock||this.data.curTimeLineIndex!=r&&(this.cacheScrollInfo?this.cacheScrollInfo={curTimeLineIndex:r,timeLineScrollLeft:this.spikeTimeLineScrollLeft[r]}:(this.cacheScrollInfo={curTimeLineIndex:r,timeLineScrollLeft:this.spikeTimeLineScrollLeft[r]},setTimeout(function(){t.setData(t.cacheScrollInfo),t.cacheScrollInfo=null},330)))}},{key:"spikeGoodsScrollToLower",value:function(){this.cacheScrollInfo=null,this.setData({curTimeLineIndex:this.spikeGoodsScrollLeftPoint.length-2,timeLineScrollLeft:this.spikeTimeLineScrollLeft[this.spikeTimeLineScrollLeft.length-1]}),this.loadData()}}]),p}();exports.default=p; 
 			}); 
		define("components/screen_shot_share/screen_shot_share.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={listenScreenShot:function(e){e.data.canShowShare&&(e.setData({shareMainClass:"screen-share-main screen-share-main-show",canShowShare:!1}),setTimeout(function(){e.setData({shareMainClass:"screen-share-main screen-share-main-hide",canShowShare:!0})},5e3))}};exports.default=e; 
 			}); 
		define("components/segment/segment.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}(),a=require("../../common/index"),i=function(){function i(e,a){t(this,i);var n=["align-average","align-gap"];if(this.alignType=e.alignType,this.setDataFunc=e.setDataFunc,this.sliderLeft=0,this.segmentData=null,this.gap=e.gap,this.tabsContainerWidth=0,this.gap||(this.gap=20),this.alignType||(this.alignType=n[0]),this.refreshTabsData(e.tabsData),a){var s=this,h=a.didClickSegmentTab;a.didClickSegmentTab=function(t){s.didClickSegmentTab(t),h&&h(t)}}}return e(i,[{key:"$data",value:function(){return this.segmentData}},{key:"refreshTabsData",value:function(t){if(t.length){this.segmentData={$tabsData:t},this.selectIndex=-1,this.animation=null,this.scrollLeft=0;var e=0,i=0,n=a.SystemInfo.getWindowWidthSync();if(0!=(e=t.length)){for(var s=0,h=0,l=0;l<e;l++){for(var r=t[l],d=r.title.trim(),o=0,c=0;c<d.length;c++)d.charCodeAt(c)>255?o+=15:o+=7.5;r.textWidth=o,r.tabWidth=o+this.gap,o>s&&(s=o),h+=r.tabWidth}if("align-average"==this.alignType){(i=s+this.gap)*e<n&&(i=n/e);for(l=0;l<e;l++)t[l].tabWidth=Math.floor(i);this.tabsContainerWidth=i*e}else if(h<n-this.gap){i=Math.max(s,n/e);for(l=0;l<e;l++)t[l].tabWidth=Math.floor(i);this.tabsContainerWidth=i*e}else this.tabsContainerWidth=h;this.data=t,this.selectIndex=-1,this.updateSelectIndex(0)}}}},{key:"didClickSegmentTab",value:function(t){var e=parseInt(t.currentTarget.dataset.index);this.updateSelectIndex(e)}},{key:"setDedDot",value:function(t,e){!self.data||t<0||t>this.data.length-1||(this.data[t].showRedDot=e,this.updateSelectIndex(this.selectIndex))}},{key:"updateSelectIndex",value:function(t){t!=this.selectIndex&&(t<0||t>this.data.count-1||(this.selectIndex=t,this.setSliderAnimation(),this.setScrollLeft(),this.setPageData()))}},{key:"setScrollLeft",value:function(){var t=this.data[this.selectIndex].tabWidth;t*this.data.count<=a.SystemInfo.getWindowWidthSync()||(this.scrollLeft=this.sliderLeft+2*t-a.SystemInfo.getWindowWidthSync()+20,this.scrollLeft<0&&(this.scrollLeft=0))}},{key:"setSliderAnimation",value:function(){this.animation||(this.animation=wx.createAnimation({duration:200,timingFunction:"linear",delay:100}));for(var t=this.data[this.selectIndex],e=t.textWidth,a=t.tabWidth,i=0,n=0;n<this.selectIndex;n++)i+=this.data[n].tabWidth;i+=(a-e)/2,this.sliderLeft=i,this.animation.left(i).width(e).step()}},{key:"setPageData",value:function(){this.data[this.selectIndex];var t={};this.data&&(t.$tabsData=this.data),this.animation&&(t.animationData=this.animation.export()),t.scrollLeft=this.scrollLeft,t.curTabIndex=this.selectIndex,t.tabsContainerWidth=this.tabsContainerWidth,this.segmentData=t}}]),i}();exports.default=i; 
 			}); 
		define("components/share_action_sheet/share_action_sheet.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=function e(t,r,a){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,r,a)}if("value"in o)return o.value;var n=o.get;if(void 0!==n)return n.call(a)},n=e(require("../pdd_action_sheet/pdd_action_sheet")),i=require("../../common/index"),u=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),c=e(require("../../libs/regenerator-runtime/runtime")),p=e(require("../../storage/user_storage.js")),l=e(require("../../configs/api")),f=e(require("../../configs/app_config")),h=function(e){function h(e){var a=e.page,o=e.ns,s=e.success,n=e.fail,i=e.complete,u=e.justSave,c=e.goosId;t(this,h);var p=u?[{title:"保存到相册"}]:[{title:"分享该商品给好友",type:"share"},{title:"生成分享卡片到相册"}],l=r(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,{page:a,ns:o,itemList:p,success:s,fail:n,complete:i}));return l.goosId=c,l.setCowrap(),l}return a(h,n.default),o(h,[{key:"setCowrap",value:function(){var e=this;this.getShareImage=u.default.wrap(c.default.mark(function t(){var r,a,o,s,n,u,h,d,g,_;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={share_id:i.DataUtil.getRandomString(),share_channel:"message",share_form:"bi3ZuH",share_result:"success",refer_share_btn:"share_pic",goods_id:e.goodsId},a=JSON.stringify(r),o={value:a},s=p.default.getUserLocalInfo(),n={user_name:s.nickName,user_avatar:s.avatarUrl,goods_id:e.goosId},t.prev=6,u=f.default.apiGZDomain+l.default.encodeAlias,h=i.Request.requestDataWithUrl("GET",u,o,!0),t.next=11,i.Request.runSecondaryRequestForPage(h,e);case 11:d=t.sent,n.__p=d.toString(),t.next=17;break;case 15:t.prev=15,t.t0=t.catch(6);case 17:return t.next=19,i.Request.apiRequest("POST",l.default.goodsDetailGenerateCard,n,!1,{forceUseApiGZ:!0});case 19:if(!((g=t.sent).result&&g.result.share_pic_url&&g.result.share_pic_url.length>0)){t.next=25;break}return _=g.result.share_pic_url,t.abrupt("return",_);case 25:e.page.$showToast("图片生成失败");case 26:t.next=31;break;case 28:t.prev=28,t.t1=t.catch(0),e.page.$showToast("图片生成失败");case 31:case"end":return t.stop()}},t,this,[[0,28],[6,15]])}))}},{key:"show",value:function(e){this.imageUrl=e,s(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"show",this).call(this)}},{key:"tap",value:function(e){e.target.dataset.index==this.data.itemList.length-1&&this.save(this.imageUrl),s(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"tap",this).call(this,e)}},{key:"save",value:function(e){var t=this;this.page.$showToast("保存图片中"),(0,u.default)(c.default.mark(function r(){var a,o,s;return c.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e.indexOf("https")<0&&(e=e.replace("http","https")),t.setData({loadingVisible:!0},!0),a=!1,r.next=6,i.User.authorize("scope.writePhotosAlbum",function(){(0,i.TrackingRecord)({op:"impr",page_section:"auth_prompt",refer_page_element:"save_pic_btn"}),a=!0});case 6:if(o=r.sent,a&&(0,i.TrackingRecord)({op:"click",page_section:"auth_prompt",page_element:o?"approve":"rufuse",refer_page_element:"save_pic_btn"}),!o){r.next=21;break}if(!t.goosId){r.next=13;break}return r.next=12,t.getShareImage();case 12:e=r.sent;case 13:return r.next=15,i.Util.downloadFile(e);case 15:return s=r.sent,r.next=18,i.User.saveImageToPhotosAlbum(s);case 18:t.page.$showToast("保存成功，可在相册中查看"),r.next=22;break;case 21:i.User.showAuthorizeModelDialog("scope.writePhotosAlbum");case 22:t.setData({loadingVisible:!1},!0),r.next=30;break;case 25:r.prev=25,r.t0=r.catch(0),console.error(r.t0),t.setData({loadingVisible:!1},!0),t.page.$showToast("图片保存失败");case 30:case"end":return r.stop()}},r,this,[[0,25]])}))}}]),h}();exports.default=h; 
 			}); 
		define("components/sku_selector/sku_selector_v2.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../common/index"),a=e(require("../../constants/goods")),u=e(require("../../storage/ram_manager")),s=e(require("../../controller/formid_controller")),r=(e(require("../../configs/api")),{show:"sku-selector-main sku-selector-main-show",focus:"sku-selector-main sku-selector-main-focus",hide:"sku-selector-main sku-selector-main-hide"}),l={free:0,selected:1,disable:2},i=["sku-spec-value","sku-spec-value sku-spec-value-selected","sku-spec-value sku-spec-value-disable"],o={enable:"sku-selector-reduce",disable:"sku-selector-reduce sku-selector-reduce-disable"},n={enable:"sku-selector-increase",disable:"sku-selector-increase sku-selector-increase-disable"},c={LANG_SHOULD_BUY_IN_APP:"该商品在拼多多app中才能购买",LANG_NOT_SUPPORT_BUY:"在小程序中暂不支持购买该类商品",LANG_LOTTERY_CANNOT_SINGLE_BUY:"抽奖活动暂不支持单独购买",LANG_FREE_TRIAL_CANNOT_SINGLE_BUY:"免费试用活动暂不支持单独购买",LANG_CAPITAL_CANNOT_SINGLE_BUY:"团长送礼活动暂不支持单独购买"},d={confirmSku:function(e){var t=d.sourceData||{},a=t.pageName;if(e&&e.detail&&e.detail.formId){var r=e.detail.formId,l={scene:s.default.scene.common,form_id:r};"group"==a?(l.child_scene="group_sku_submit_clk",s.default.uploadFormIdToSH(r,!1)):"goods"==a&&(l.child_scene="goods_sku_submit_clk",e&&e.detail&&e.detail.formId&&s.default.uploadFormIdToSH(e.detail.formId,!1))}d.skuTrackingRecord("click","confirm_btn"),u.default.CPData.selectSku?(d.hide({directHide:!0}),d.confirmOrder({skuId:u.default.CPData.selectSku,goodsNumber:u.default.CPData.goodsNumber,newUserAlertVisible:u.default.CPData.newUserAlertVisible,localGroupOrderId:t.localGroupOrderId})):u.default.CPPage.$showToast(u.default.CPData.specDesc)},confirmOrder:function(e){try{var a=e||{},s=a.skuId,r=a.goodsNumber,l=a.newUserAlertVisible,i=a.localGroupOrderId;r=r||1;var o=u.default.CPData.goodsInfo;if(!o)return;if(!t.FilterUtil.filter(o.eventType,o.goodsType))return void u.default.CPPage.$showToast(c.LANG_NOT_SUPPORT_BUY);var n=o.skus;if(!n)return;var d=void 0;if(1===n.length)d=n[0];else if(n.length>1)for(var f=0;f<n.length;++f)if(n[f].skuId==s){d=n[f];break}if(null!==d){var g=u.default.CPData.selectedGroup||o.groupTypes[1],p=g.groupId,m=g.requireNum,k={sku_id:d.skuId,group_id:p,goods_id:o.goodsId,goods_number:r},y=u.default.CPData.mallInfo||{};u.default.CPPage.transGoodsData={goodsId:o.goodsId,preMallLogo:y.logo,preMallName:y.mallName,preGoodsName:o.goodsName,prePrice:g.price,preThumbUrl:u.default.CPData.currentSkuImg||o.thumbUrl};var P=u.default.CPPage.$urlQueryObj.group_order_id,b=u.default.CPData.selectedLocalGroupOrderId;b&&(P=b),i&&(P=i);var S=u.default.CPPage.openNewGroup;!P||l||S||(k.group_order_id=P),u.default.CPPage.referPageElement&&(k.refer_page_element=u.default.CPPage.referPageElement),m&&(k.group_num=m);var D="/pages/order_checkout/order_checkout?"+t.UrlUtil.buildQuery(k);t.Navigation.forward(D)}}catch(e){console.error(e)}},viewSkuImage:function(e){var t=e.target.dataset,a=void 0;t&&(a=t.url),a&&d.previewImage(a)},goodsNumberFocus:function(e){u.default.CPSetData({mainClass:r.focus})},goodsNumberBlur:function(){var e=u.default.CPData.goodsNumber,a=d.allQuantityCount||1e5,s=u.default.CPData.selectSku,l={};if(l.mainClass=r.show,s){var i=d.skuInfos[s];a=d.getLimitQuantity(i.quantity,i.limitQuantity)}e<1&&(u.default.CPData.goodsNumber=1),e>a?(l.goodsNumber=a,u.default.CPPage.$showToast("数量超出范围")):e<1?l.goodsNumber=1:e>=1&&e<=a&&(l.goodsNumber=e),l=t.ObjectUtil.assign(l,d.setGoodsNumberButton()),u.default.CPSetData(l),d.skuTrackingRecord("click","input",{input_num:e,show_num:l.goodsNumber})},goodsNumberChange:function(e){var t=parseInt(e.detail.value,10);isNaN(t)&&(t=0),t=t||0,u.default.CPData.goodsNumber=t},updateGoodsNumber:function(e){var a=e.currentTarget.dataset,s={};if(a&&a.delta){var r=parseInt(a.delta);if(u.default.CPData.reduceDisable&&r<0)return;if(u.default.CPData.increaseDisable&&r>0)return;s.goodsNumber=u.default.CPData.goodsNumber+=r,s=t.ObjectUtil.assign(s,d.setGoodsNumberButton()),u.default.CPSetData(s),d.skuTrackingRecord("click",r>0?"plus":"minus",{input_num:r,show_num:s.goodsNumber})}},skuContainerDefaultClick:function(){},hideSkuSelector:function(){d.hide(),d.skuTrackingRecord("click","close_btn")},skuTrackingRecord:function(e,a,u){var s=d.sourceData||{},r={op:e,page_section:"sku_popup",goods_id:s.goodsId,event_type:s.eventType,has_local_group:s.hasLocalGroup,sku_num:s.skus.length};a&&(r.page_element=a),u&&(r=t.ObjectUtil.assign(r,u)),(0,t.TrackingRecord)(r)},selectSpec:function(e){var t=e.currentTarget.dataset;if(t){var a=parseInt(t.typeIndex),u=parseInt(t.valueIndex);if(d.styleTypeList&&d.styleValueList&&null!=a&&null!=u){var s=d.styleTypeList[a];if(d.styleValueList[s]){var r=d.styleValueList[s][u];d.selectOneValue(s,r)}}}},previewImage:function(e,t){t=t||[e],wx.previewImage({current:e,urls:t})},initData:function(e){d.skuInfos={},d.styleTypeList=[],d.styleTypeIndex={},d.styleValueList={},d.styleValueIndex={},d.styleHash={},d.hash={},d.skusByType=[],d.dataObj={},d.allQuantityCount=0,d.initSkuData(e)},initSkuData:function(e){for(var s=e.skus,r=[],l={},i=[],o=0;o<s.length;o++){var n=s[o],c=n.skuId+"",f={skuId:c,imgUrl:n.thumbUrl,style:d.collectStyles(n.specs,c),status:n.quantity<=0?a.default.SkuStatus.Unavailable:a.default.SkuStatus.OnSale,quantity:n.quantity,limitQuantity:n.limitQuantity,normalPrice:n.normalPrice,groupPrice:n.groupPrice};e.discount&&(f=t.ObjectUtil.assign(f,{discountNormalPrice:t.DataUtil.accDiv(Math.floor(t.DataUtil.accMul(n.normalPrice,e.discount)),100),discountGroupPrice:t.DataUtil.accDiv(Math.floor(t.DataUtil.accMul(n.groupPrice,e.discount)),100)})),f.status!==a.default.SkuStatus.Unavailable&&r.push(c),d.skuInfos[c]=f,d.allQuantityCount+=d.getLimitQuantity(n.quantity,n.limitQuantity),i.indexOf(n.thumbUrl)<0&&i.push(n.thumbUrl)}if(l.priceRange=e.priceRange,l.isGroupBuy=e.isGroupBuy,l.skusByType=d.skusByType,l.price=d.getPrice(e.priceRange,e.isGroupBuy,u.default.CPData.selectSku),l.disCountPrice=d.getPrice(u.default.CPData.priceRange,u.default.CPData.isGroupBuy,l.selectSku,!0),l.currentSkuImg=e.defaultImg,l.imgUrls=i,d.styleTypeList.forEach(function(e,t){u.default.CPData.currentSelect[e]=null}),d.selectOneSkuValue(),d.sourceData&&d.sourceData.lastSelectSku){var g=d.sourceData.lastSelectSku;for(var p in g)p&&g[p]&&d.selectOneValue(p,g[p],!0)}d.sourceData&&d.sourceData.lastSelectGoodsNumber&&(l.goodsNumber=d.sourceData.lastSelectGoodsNumber),l.buttonStatus=d.updateSkuButtonStatus(),l.specDesc=d.setSpecdesc(),l=t.ObjectUtil.assign(l,d.setGoodsNumberButton()),d.sourceData.orderLimit<=1?l.showSelectorNumber=!1:l.showSelectorNumber=!0,u.default.CPSetData(l)},getPrice:function(e,a,s,r){var l=u.default.CPData.goodsInfo,i=l&&l.discount&&r;i&&(e=e.map(function(e){return t.DataUtil.accDiv(Math.floor(t.DataUtil.accMul(e,l.discount)),100)}));var o=e.join("-");return s&&(o=a?i?d.skuInfos[s].discountGroupPrice:d.skuInfos[s].groupPrice:i?d.skuInfos[s].discountNormalPrice:d.skuInfos[s].normalPrice),o},updateSkuButtonStatus:function(){for(var e=0;e<u.default.CPData.buttonStatus.length;e++)for(var t=0;t<u.default.CPData.buttonStatus[e].length;t++)if(u.default.CPData.buttonStatus[e][t]!=l.selected){var a=d.checkCanSelect(u.default.CPData.currentSelect,e,t);u.default.CPData.buttonStatus[e][t]=a?l.free:l.disable}return u.default.CPData.buttonStatus},getLimitQuantity:function(e,t){var a=d.sourceData.orderLimit;return a>e&&e>0&&(a=e),a>t&&t>0&&(a=t),a},selectOneValue:function(e,a,s){var r=d.styleTypeIndex[e],i=d.styleValueIndex[e][a],o=u.default.CPData.currentSelect,n=u.default.CPData.buttonStatus,c={};if(n[r][i]!==l.disable){if(o[e]!==a||s){var f=d.styleValueIndex[e][o[e]];null!=f&&(n[r][f]=l.free),o[e]=a,n[r][i]=l.selected}else o[e]=null,n[r][i]=l.free;c.currentSelect=o,c.buttonStatus=d.updateSkuButtonStatus();for(var g=[],p=0;p<n.length;p++)for(var m=0;m<n[p].length;m++)n[p][m]===l.selected&&(g[p]=m);var k=d.hash[JSON.stringify(g)];if(null!=k){var y=d.skuInfos[k],P=u.default.CPData.goodsNumber;u.default.CPData.selectSku=k,c.selectSku=k,c.currentSkuImg=y.imgUrl,c.price=d.getPrice(u.default.CPData.priceRange,u.default.CPData.isGroupBuy,c.selectSku),c.disCountPrice=d.getPrice(u.default.CPData.priceRange,u.default.CPData.isGroupBuy,c.selectSku,!0);var b=d.getLimitQuantity(y.quantity,y.limitQuantity)||1;P>b&&(c.goodsNumber=b)}else if(c.selectSku="",c.currentSkuImg=d.sourceData.defaultImg,c.price=d.getPrice(u.default.CPData.priceRange,u.default.CPData.isGroupBuy,c.selectSku),c.disCountPrice=d.getPrice(u.default.CPData.priceRange,u.default.CPData.isGroupBuy,c.selectSku,!0),g.length>0){var S=null;for(var D in d.styleHash){for(var C=d.styleHash[D],v=!0,h=0;h<g.length;h++)if(void 0!==g[h]&&g[h]!==C[h]){v=!1;break}if(v){S=D;break}}S&&d.skuInfos[S]&&(c.currentSkuImg=d.skuInfos[S].imgUrl)}c.buttonStatus=n,c.specDesc=d.setSpecdesc(),c=t.ObjectUtil.assign(c,d.setGoodsNumberButton()),u.default.CPSetData(c)}},checkCanSelect:function(e,t,u){var s={},r=d.styleTypeList[t];for(var l in e)s[l]=l!=r?e[l]:d.styleValueList[l][u];for(var i in d.skuInfos)if(d.skuInfos[i].status!==a.default.SkuStatus.Unavailable){var o=!0,n=d.skuInfos[i].style;for(var c in n)if(null!=s[c]&&s[c]!=n[c]){o=!1;break}if(o)return!0}return!1},collectStyles:function(e,t){for(var a=[],s=[],r=0;r<e.length;r++){var i=e[r];a.push(i.spec_key),s.push(i.spec_value)}for(var o={},n=[],c=0;c<a.length;c++){var f=a[c]||"",g=s[c]||"";if(!(f.length<=0||g.length<=0)){if(o[f]=g,null==d.styleTypeIndex[f]){var p=d.styleTypeList.length;d.styleTypeIndex[f]=p,d.styleTypeList[p]=f,u.default.CPData.buttonStatus[p]=[],d.styleValueList[f]=[],d.styleValueIndex[f]={},d.skusByType.push({type:f,values:[]})}if(null==d.styleValueIndex[f][g]){var m=d.styleTypeIndex[f],k=d.styleValueList[f].length;d.styleValueIndex[f][g]=k,d.styleValueList[f][k]=g,d.skusByType[m].values.push(g),u.default.CPData.buttonStatus[m][k]=l.free}n[d.styleTypeIndex[f]]=d.styleValueIndex[f][g]}}return d.styleHash[t]=n,d.hash[JSON.stringify(n)]=t,o},selectOneSkuValue:function(){for(var e in d.styleTypeIndex)d.styleValueList&&d.styleValueList[e]&&1==d.styleValueList[e].length&&d.selectOneValue(e,d.styleValueList[e][0],!0)},setSpecdesc:function(){var e=d.styleTypeList.length,t=u.default.CPData.currentSelect;if(!(e<=0)){for(var a=[],s=[],r=0;r<e;r++){var l=d.styleTypeList[r];t[l]?s.push(t[l]):a.push(l)}return a.length>0?"请选择 "+a.join(" "):"已选："+s.join(" ")}},setGoodsNumberButton:function(){var e=u.default.CPData.goodsNumber,t=d.allQuantityCount||1e5,a=u.default.CPData.selectSku,s={};if(a){var r=d.skuInfos[a];t=d.getLimitQuantity(r.quantity,r.limitQuantity)}return e<=1?(s.reduceDisable=!0,s.reduceClass=o.disable):(s.reduceDisable=!1,s.reduceClass=o.enable),e>=t?(s.increaseDisable=!0,s.increaseClass=n.disable):(s.increaseDisable=!1,s.increaseClass=n.enable),s},show:function(){u.default.CPData.skuVisible||(u.default.CPSetData({skuVisible:!0}),setTimeout(function(){u.default.CPSetData({mainClass:r.show})},150),d.skuTrackingRecord("impr",null))},hide:function(e){var t=!!(e=e||{}).directHide;u.default.CPData.skuVisible&&(t?u.default.CPSetData({skuVisible:!1,mainClass:r.hide}):(u.default.CPSetData({mainClass:r.hide}),setTimeout(function(){u.default.CPSetData({skuVisible:!1})},500)))},initSkuStatus:{skuVisible:!1,mainClass:r.hide,skusByType:[],selectSku:"",currentSelect:{},skuNum:1,imgUrls:[],currentSkuImg:"",preloadSkuImg:"",price:0,specDesc:"",goodsNumber:1,increaseDisable:!1,reduceDisable:!0,increaseClass:n.enable,reduceClass:o.enable,skuButtonClass:i,buttonStatus:[],priceRange:"",isGroupBuy:!1},load:function(e){u.default.CPData.priceRange=e.priceRange,d.sourceData=e,d.initData(e),d.show()}};exports.default=d; 
 			}); 
		define("components/toast/toast.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}(),e=2e3,i=function(){function i(n){t(this,i),this.dataObj={toastMessage:"",visible:null},this.setDataFunc=null,this.hideToastFunc=null,void 0===n.showCenterInWindow&&(n.showCenterInWindow=!0),this.showCenterInWindow=!!n.showCenterInWindow,this.showDuration=n.showDuration||e,this.topValueInFixedPositon=n.topValueInFixedPositon,this.dataObj.showCenterInWindow=this.showCenterInWindow,this.dataObj.topValueInFixedPositon=this.topValueInFixedPositon,n&&(this.setDataFunc=n.setDataFunc)}return n(i,[{key:"setText",value:function(t){return t&&(this.dataObj.toastMessage=t.toString(),this.setDataFunc&&this.setDataFunc(this.dataObj)),this}},{key:"show",value:function(t){var n=this;t=t||{},this.hideToastFunc=t.hideToastFunc;var e=t.showDuration||this.showDuration;this.dataObj.visible=!0,void 0!==t.showCenterInWindow&&(this.dataObj.showCenterInWindow=t.showCenterInWindow),this.setDataFunc&&this.setDataFunc(this.dataObj),setTimeout(function(){return n.hide()},e)}},{key:"hide",value:function(){this.dataObj.showCenterInWindow=this.showCenterInWindow,this.dataObj.visible=!1,this.setDataFunc&&this.setDataFunc(this.dataObj),"function"==typeof this.hideToastFunc&&(this.hideToastFunc(),this.hideToastFunc=null)}}]),i}();exports.default=i; 
 			}); 
		define("components/user_authorize_modal/user_authorize_modal.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function t(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),e}}(),a=function(){function a(e){t(this,a),this.dataObj={userAuthorizeModal_visible:!1,userAuthorizeModal_src:"http://omsproductionimg.yangkeduo.com/goods/733a8d8950/100/100/22fde6b724e0ec413d91ccb7c813f773.jpg"},e&&(this.setDataFunc=e.setDataFunc)}return e(a,[{key:"show",value:function(t){this.dataObj.userAuthorizeModal_visible=!0,this.setDataFunc&&this.setDataFunc(this.dataObj)}},{key:"hide",value:function(){this.dataObj.userAuthorizeModal_visible=!1,this.setDataFunc&&this.setDataFunc(this.dataObj)}},{key:"isAuthorizeModalVisible",value:function(){return this.dataObj.userAuthorizeModal_visible}}]),a}();exports.default=a; 
 			}); 
		define("configs/api.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={indexGoodsList:"v5/goods",orderGoodsDetail:"v4/goods/{0}",createOrder:"order",prePay:"order/prepay",mallInfo:"mall/{0}/info",mallCategory:"api/turing/mall/query_mall_category?mall_id={0}",mallCatGoods:"api/turing/mall/query_cat_goods?mall_id={0}&category_id={1}&type={2}&page_no={3}&page_size={4}&sort_type={5}",addresses:"addresses",address:"address",deleteAddress:"address/delete",login:"login",userAB:"user/is_ab",regions:"regions",groupOrder:"group_order/{0}?need_white=true",v2GoodsDetail:"v5/goods/",localGroup:"goods/{0}/local_group",v2LocalGroup:"api/leibniz/v3/goods/groups?goods_id={0}",unLockOrder:"order/unlock",classification:"operations",search:"search?q=",rankList:"v2/ranklist",catgoods:"v4/operation/{0}/groups",noV4Catgoods:"operation/{0}/groups",v3CatgoodsList:"v3/operation/{0}/groups",indexPageTopBanner:"api/fiora/bannerindex/query/platform?platform=1",homeOperations:"home_operations",goodsLocalGroups:"goods/local_groups",luckyDrawResult:"lucky_draw_result/",freeCoupons:"goods/{0}/user_event",mallCoupons:"query_merchant_candidate_coupons",platformCoupons:"query_candidate_coupons",takeMerchantCoupon:"take_merchant_coupon",avaCouponsHideFreeCoupons:"query_validity_coupons?page={0}&size={1}&hide_free_coupon=true&fc_version=1",usedCouponsHideFreeCoupons:"api/lisbon/query_used_coupons?page={0}&size={1}&hide_free_coupon=true&fc_version=1",expiredCouponsHideFreeCoupons:"api/lisbon/query_expired_coupons?page={0}&size={1}&hide_free_coupon=true&fc_version=1",avaCoupons:"coupon/v2/query_validity_coupons?page={0}&size={1}&fc_version=1&sort_rule=coupon_end_time",tzfreeCoupons:"coupons/free?fc_version=1",spikeList:"spike_list?page={0}&size={1}",haitaoSpikeList:"spike_haitao?page={0}&size={1}",spikeSelloutList:"spike_list?page={0}&size={1}&nostock=true",haitaoSpikeSelloutList:"spike_haitao?page={0}&size={1}&nostock=true",spikeGoods:"spike/{0}/goods",regionsJson:"regions_json",takeCaptainCoupon:"coupon/take_one_yuan_coupon",cancelOrder:"order/{0}/cancel",subjectCollection:"subject_collection/{0}",promotionCollection:"promotion/collection/{0}",promotionMix:"promotion/{0}/mix",subjectCollectionGoodsApi:"subject/{0}/sorted_goods?sort_type={1}&page={2}&size={3}",subjectGoodsApi:"v2/subject/{0}/goods?page={1}&size={2}",subjectRollMessage:"subject/{0}?roll_message=0",weixinAddress:"address/weixin",likeGoods:"v2/favorite/goods?favorite_update_time={0}&page={1}&size={2}",doLikeGoods:"v2/favorite/like/",unLikeGoods:"v2/favorite/unlike/",likeRecommend:"recommendation/favorite?offset={0}&count={1}",likeMalls:"favorite/mall/list?page={0}&size={1}",likeMallsGoods:"api/fiora/mall/{0}",unLikeMall:"favorite/mall/unlike/",doLikeMall:"favorite/mall/like/",likeGoodsIdsList:"favorite/goods/id/list",likeMallsIdsList:"favorite/mall/id/list",userIdCard:"v2/user/card",submitIdCard:"user/card",haitaoBanner:"haitao_banner",haitaoGoodsList:"v2/haitaov2?page={0}&size={1}",luckyDraw:"lucky_draw/",setFormId:"vino/form_id/set",setRefuseFormId:"api/flow/vino/refuse_form_id/set",ordersv2:"ordersv2/{0}?page={1}&size={2}",reviews:"reviews/",myGroup:"group_orders?page={0}&size={1}",searchHotQuery:"search_hotquery",searchSuggestions:"search_suggest",homeSubject:"home_show",chat_list:"api/rainbow/latest_conversations?page={0}&size={1}",afterSales:"after_sales/list?range={0}&offset={1}&size={2}",moneyPath:"after_sales/refund_trace/{0}?after_sales_id={1}",afterSalesForm:"order/{0}",afterSalesDetail:"after_sales/detail/{0}",afterSalesTrigger:"after_sales/trigger/{0}",afterSalesFormSelect:"after_sales/all/reason?order_sn={0}",afterSalesCreate:"after_sales/create",express_complaint:"express/logistics_complaint_type/list",express_complaint_form:"express/logistics_complaint/create",getUploadFileSign:"file/signature",uploadFileUrl:"https://file.yangkeduo.com/general_file",getOpenGid:"query_open_gid",cancelAfterSales:"after_sales/cancel/{0}",reapplyAfterSales:"after_sales/reapply/{0}",modifyAfterSales:"after_sales/modify/{0}",economicalBrandTabInfo:"famous_brand",economicalBrandGoodsInfo:"famous_brand/{0}/v2/list",brandSubjectBrandDetail:"famous_brand/{0}/brand",brandSubjectGoodsDetail:"famous_brand/{0}",myFootPrint:"footprint/goods/listall",afterSaleAppend:"after_sales/append_content/{0}",silentLogin:"login",fillReturnForm:"after_sales/confirm_delivery/{0}",applyPlatformIntervention:"after_sales/apply_platform_join/{0}",luaApiGateway:"express/express_cost/get_cost?cost_template_id={0}&province_id={1}&goods_item={2}&order_amount={3}&sku_id={4}&goods_id={5}&goods_weight={6}",getGoodsLisbon:"api/lisbon/query_events",getFreeWinnerList:"/free/activity/winner/list",getBlackList:"user/is_ab?group_order_id={0}",getConfig:"access/Configure/GetConfig",getRecommendGoodsData:"recommendation",getChargeHistory:"virtual_goods/get_charge_history",uploadTemplate:"backend/template/upload",getAdSubject:"api/flow/hobbiton/weixin/page?goods_id={0}",getCouponRecommendation:"recommendation/coupon?offset={0}&count={1}&coupon_id={2}",indexQuickEntranceList:"backend/subject_list",getTemplateRimendGoodsId:"backend/template/find",GetCostomImage:"access/Image/GetCustomImage",chatOrders:"orders/online_chat/all?page={0}&size={1}&mall_id={2}&offset={3}",selfServiceTicket:"api/colombo/order/ticket",selfServiceMessage:"api/colombo/ticket",selfServiceTicketList:"api/colombo/ticket/list?page_num={0}&page_size={1}",selfServiceProblems:"api/colombo/problem/list",postSelfServiceMessage:"api/colombo/ticket/{0}",selfServiceOrders:"orders/self_service/{0}?mall_id={1}&page={2}&size={3}&offset={4}",chatOnlineOrders:"orders/online_chat/{0}?mall_id={1}&page={2}&size={3}&offset={4}",getGenTianTabData:"api/gentian/{0}/resource_tabs?use_page=true",getGenTianGoodsData:"api/gentian/{0}/resource_goods?tab_id={1}&page={2}&size={3}",promoTabInfo:"api/carnival/sub_promotion_summary/{0}",promoVenueGoods:"api/carnival/promotion_goods/{0}",carnivalPromotion:"api/carnival/special_promotion_list",mainCarnivalPromotion:"api/carnival/main_promotion_list",relayPromotion:"api/carnival/relay_promotion_list",tesla:"api/roewe/query",carnivalImages:"backend/carnival_images",getSpikeGoodsData:"api/spike/v3/list/{0}?type=1&page={1}&size={2}",getBrandSpikeInfo:"api/spike/v3/brand/info?spike_brand_id={0}",getBrandSpikeGoods:"api/spike/v3/brand/goods?spike_brand_id={0}&page={1}&size={2}",getSpikeActivity:"spike_activity?page={0}&size={1}",getPreheatGoods:"carnival/get_preheat_goods",reservePreheatGoods:"carnival/reserve_preheat_goods",promotionUserInfo:"backend/double11/userinfo",promotionShare:"backend/double11/share",getIShoppingTabData:"ishopping/tablist",getIShoppingGoddsData:"ishopping/goods?tab_id={0}&page={1}&size={2}",getOpenEnvShareMsg:"backend/redpacket_desc",saveGroupInfo:"backend/usergroup",queryOpenId:"api/galilei/query_open_id",orderPayCheck:"api/aristotle/pay_check",createEnvGroup:"backend/amazon/nile/group/create",getLatestEnvGroup:"backend/amazon/nile/group/get/current",joinGroup:"backend/amazon/nile/group/join",getGroupInfo:"backend/amazon/nile/group/get",getMallGroup:"api/leibniz/mall/groups",checkMerchantCoupon:"api/lisbon/query_usable_merchant_batches",updateOrderAddress:"api/vancouver/update_address",getGotCouponUsers:"backend/amazon/nile/group/bubbles",getCouponState:"api/philo/red_dot",getFriendPayOrderInfo:"order/friend_pay/query/{0}",hasOrders:"api/flow/doom/ext/order/user/me",fetchUserInfo:"user/profile/me",updateUserInfo:"api/apollo/weapp/update/profile",encodeAlias:"backend/conf/alias/format",decodeAlias:"backend/conf/alias/parse",getUnpaidOrder:"api/aristotle/unpaid_order",spikeTodayTextNotification:"api/fiora/roll_messages/normal_spike",goodsDetailGenerateCard:"access/Image/GetGoodsDetailImage",setDefaultAddress:"api/apollo/address_default",modifyAddress:"api/apollo/address_info"};exports.default=e; 
 			}); 
		define("configs/app_config.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o={yangkeduo:{apiDomain:"https://apiv2.pinduoduo.net/",apiV3Domain:"https://apiv3.pinduoduo.net/",apiGZDomain:"https://wxapp.yangkeduo.com/",GZCND:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/",appId:33,payAppId:54,logo:"http://pinduoduo.img-cn-shanghai.aliyuncs.com/base/logo.jpg",logginURL:"https://wxapp.yangkeduo.com/t.gif",version:"v1.3.7",appSecret:"I4ti439IV8Q4ZLxI",appName:"yangkeduo"},hutaojie:{apiDomain:"https://apiproxy.hutaojie.com/",apiV3Domain:"https://apiproxy.hutaojie.com/",apiGZDomain:"https://apiproxy.hutaojie.com/",GZCND:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/",appId:1002,payAppId:1003,logo:"http://pinduoduo.img-cn-shanghai.aliyuncs.com/base/logo.jpg",logginURL:"https://apiproxy.hutaojie.com/t.gif",version:"v1.3.7",appSecret:"shwuankxabs12s",appName:"hutaojie"}};exports.default=o.yangkeduo; 
 			}); 
		define("configs/page_configs.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var a={};["pages/index/index","pages/new_arrivals/new_arrivals","pages/haitao/haitao","pages/classification/classification","pages/personal/personal","package_a/footprint/footprint","package_a/goods_comments/goods_comments","package_a/likes/likes","package_a/promotion_main/promotion_main","package_a/promo_dec_venue/promo_dec_venue"].forEach(function(e,o){var p=e.split("/"),i=p[p.length-1];a[i]={pageName:i,path:e,withTabbar:o<=4}}),exports.pageNameUrlMap=a; 
 			}); 
		define("configs/request_errors.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r={30400:"没有安装QQ客户端",4e4:"错误的请求地址或方法",40001:"非法会话或会话已过期",40002:"服务器忙碌中，请稍等",40003:"错误的请求参数",40004:"微信登录失败",40005:"请求还在处理中",40006:"手机登录验证码错误",40015:"验证码重复请求",40016:"验证码超出当天限制",40017:"今日可发送次数已达上限",40018:"验证码填写错误",40019:"验证码填写超时",40020:"登录失败",40100:"暂未开通该开放平台",41001:"商品不存在",41002:"商品已下架",41003:"商品已售罄",41004:"商品不在同一商店",41005:"该商品当前不在抽奖活动时间",41006:"商品不在可售区域",41101:"抽奖活动暂不支持单独购买",42001:"拼单已满",42002:"该拼单不存在",42003:"拼单已过期",42004:"超过每人购买次数限制",42005:"商品拼团数已满",43001:"用户不存在",43002:"地址错误",43004:"身份证号不存在",43005:"姓名和身份证号不一致",43006:"对不起，您无法获取或更新身份证号",43007:"对不起，您已用完当前最大验证次数，请24小时后再试",43010:"该地址已存在",43011:"该地址无法导入",43013:"一小时内不能重复提交",43015:"只允许微信用户够买",43016:"创建地址失败",43017:"最多只能添加100个收货地址哦~",44001:"优惠券已使用",44002:"优惠券不存在",44003:"优惠券没有达到最小使用金额",44004:"优惠券已过期",44005:"优惠券不属于用户",44006:"优惠券已废弃",44007:"优惠券暂未到使用时间",44008:"优惠券不能在该分类使用",44010:"优惠券已经抢完了，下次早点来哦",44011:"您已经领过该优惠券",44012:"优惠券领取失败",44015:"不是拼主不能使用拼主免单优惠券",44016:"优惠券批次不存在",44025:"已经达到单个用户领券数量的上限！",44020:"正在处理中，请稍后再试!",44026:"该券太火爆，全部已被领完",44027:"活动已结束！",44035:"批次类型错误",44036:"团免券已被领完",44037:"用户已达团免券日领取上限",44038:"您已领取该券",44039:"未找到符合条件的团免券批次",44041:"领取失败",44042:"领取链接已失效，下次早点哦",44043:"不符合领取条件哦",44044:"该优惠券活动不存在",44045:"不在活动时间",44046:"只有无订单的新用户可领取哦",44061:"多件优惠活动结束",44063:"多件优惠已经享受过了",44064:"多件优惠活动暂未开始",44065:"多件优惠活动暂未开始",44066:"多件优惠活动结束",44067:"商家券和多件优惠活动不能同时使用",45001:"该订单不属于您，去别处逛逛吧。",45002:"订单不属于该用户",45003:"订单不能取消",45004:"订单商品不一致",45005:"订单已经收货",45006:"订单还未发货",45007:"海淘订单没有提交身份证",152006:"限量件数已被抢光，请重新选购",45008:"订单已支付",45009:"支付繁忙，请重试",45010:"订单正在支付中",45011:"未找到物流单号",45020:"对不起，您只能评价自己的订单",45021:"对不起，确认收货后才能评价",45022:"对不起，您已经评价过",45208:"价格有变动，请返回上一页查看",46001:"团订单不存在",46002:"无法重复拼单",48001:"图片格式错误",48002:"图片大小超过限制",5e4:"内部服务器错误",45012:"手机充值号码为空",45013:"手机充值号码不支持",45014:"手机充值商品不存在",45016:"获取快递信息失败，请重试",45033:"超过每个手机号码购买次数限制",45034:"抱歉，秒杀尚未开始，请稍候",45023:"正在处理您的退款/售后申诉，无法主动确认收货",45206:"创建订单存在风险",45207:"创建订单验证码非法",45209:"请更换支付方式，花呗分期暂不可用",46502:"活动不存在",46506:"订单已存在",46507:"已参加活动",46508:"创建订单失败",46510:"无有效订单",46513:"活动结束",46514:"本商品不支持该地区发货",47001:"支付失败，限时折扣活动已结束",47010:"限时折扣检查失败",47011:"限时折扣活动已经使用",47012:"限时折扣活动未开启",47013:"限时折扣活动未到开始时间",47014:"限时折扣活动已经结束",47015:"商家券和限时折扣活动不能同时使用",53101:"你的好友数量已达到上限，暂不能再添加哦",53102:"你的好友数量已达到上限，暂不能再添加哦",53103:"对方好友数量已达上限，你暂时不能通过哦",53104:"你已经发出很多好友申请了，暂不能再申请哦",53200:"对方已经是你的好友了",53201:"对方已经是你的好友了",53202:"对方已经不是你的好友了",60005:"用户拒绝",60006:"用户取消",60100:"未安装微信客户端",60110:"未安装微博客户端",60120:"未安装手机QQ",60200:"录制失败",60201:"录音没有权限",60205:"录音时间过短",60210:"上传失败",60220:"播放失败",66001:"活动暂未开奖",70001:"没有大转盘抽奖次数",70002:"用户没有关注",70003:"活动未开始",70004:"请求过于频繁",70005:"没有次数，不推荐关注(vip用户)",70006:"碎片未齐",70007:"活动已结束",70008:"优惠券发送失败",72201:"红包��支付",72202:"生成分享图片失败",72203:"获取红包题目详情失败",72300:"预支付失败",72301:"答题红包创建失败",72302:"答题红包不存在",72303:"答题红包发放失败",72304:"不能回答自己的问题",81001:"上一个红包未拆完",81002:"今天的5个红包已经领完了，请明天再来哦",81003:"已经帮ta拆过了，去帮帮其他人吧",81004:"今天帮拆名额已用完",81005:"参数不合法",81006:"请求过于频繁",81007:"红包不存在",81008:"用户未创建红包",81009:"红包被拆完",152010:"已达到该商品活动期内的最大购买件数，不能再抢了~"},e={success:"领取成功",fail:"领取失败",40003:"网络开了小差，请重试",44001:"优惠券不存在",44004:"优惠券已过期，无法领取",44009:"优惠券已领完",44010:"优惠券已领完",44011:"不能领取更多了，去看看别的券吧",44012:"领取失败，请重试",44016:"优惠券不存在",44020:"网络开了小差，请重试",44025:"不能领取更多了，去看看别的券吧",44026:"优惠券已领完",44043:"优惠券已领完"},o=function(){var e={};for(var o in r)e[o]={code:parseInt(o,10),message:r[o]};return e}();exports.default={errors:r,errorInfos:o,GroupCompleted:o[42001],CouponTakenOut:o[44026],NoNameIDBefore:o[43006],LimitDiscountError:o[47014],LimitQuantityDiscountError:o[152006],couponErrorHint:e,messageFromCode:function(r){var e=o[r.toString()];return null==e?"":e.message}}; 
 			}); 
		define("constants/addresses.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={AddressClass:{Default:"1",Common:"0"},Region:{China:"1"}};exports.default=e; 
 			}); 
		define("constants/app_constant.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="http://pinduoduoimg.yangkeduo.com/",a={CDNImgHostName:e,Upaiyun:{DefaultImg:e+"test/default.jpg",DefaultImgSquare:e+"test/default_square.jpg",BaseAvatar:e+"base/avatar_4_64.png",ShareImg:e+"base/share_logo.jpg"}};exports.default=a; 
 			}); 
		define("constants/bottomTab.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={bottomTab:[{url:"/pages/index/index",class:"icon-nav-home-line",text:"首页"},{url:"/pages/new_arrivals/new_arrivals",class:"icon-nav-new-line",text:"新品"},{url:"/pages/haitao/haitao",class:"icon-nav-overseashop-line",text:"海淘"},{url:"/pages/classification/classification",class:"icon-nav-category-line",text:"搜索"},{url:"/pages/personal/personal",class:"icon-nav-me-line",text:"个人中心"}]}; 
 			}); 
		define("constants/category_sort.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=[{type:0,name:"综合排序",api:"DEFAULT",track:"PRIORITY"},{type:1,name:"最近热销",api:"GMV",track:"COUNT"},{type:2,name:"价格从低到高",api:"PRICE_ASC",track:"PRICE_ASC"},{type:3,name:"价格从高到低",api:"PRICE_DESC",track:"PRICE_DESC"}];exports.CategorySortTypes=e; 
 			}); 
		define("constants/comment.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={NoComment:0,ReevaluateEnable:1,Reevaluated:2,EvaluateUnable:3,ReevaluatedUnable:4};exports.CommentStatus=e; 
 			}); 
		define("constants/coupons.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={CouponBatchType:{GroupFreeCoupon:7,MallCoupon:8,GoodsCoupon:9,VirtualGoods:13,TZYYCoupon:16,CategoryCoupon:17,superimposedCoupon:18},CouponDisplayType:{Category:18,App:19,AppMobile:20,Anniversary:24,Shuang11:25},CouponStatus:{Disabled:0,Available:1,Locked:2,Used:3}}; 
 			}); 
		define("constants/dispatch_type.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _=function(_){return _&&_.__esModule?_:{default:_}}(require("../libs/key_mirror"));exports.default=(0,_.default)({INDEX_GOODS_LIST:null,ORDER_CHECKOUT_GOODS_DETAIL:null,ORDER_CHECKOUT_ADDRESSES_INFO:null,ORDER_CHECKOUT_MALL_INFO:null,ADDRESSES_PAGE_DELTE_ADDRESS:null,ADDRESSES_EDIT_REGION_DATA:null,ADDRESSES_EDIT_PROVINCES_DATA:null,ADDRESSES_EDIT_CITIES_DATA:null,ADDRESSES_EDIT_DISTRICTS_DATA:null,ADDRESSES_EDIT_SAVE_ADDRESS_DATA:null,ADDRESSES_SET_DEFAULT_ADDRESS:null,ORDERCHECKOUT_CHOOSE_ADDRESS:null,ORDER_CHECKOUT_PAY:null,ORDER_CHECKOUT_GET_ORDER_INFO:null,GROUP_ORDER_INFO:null,GOODS_DETAIL_PAGE_GET_GOODS:null,GOODS_DETAIL_PAGE_GET_MALL:null,GOODS_DETAIL_PAGE_GET_LOCAL_GROUP:null,SEARCH_CLASSIFICATION_INFO:null,SEARCH_RESULT_PAGE_RESULT:null,CATGOODS_PAGE_DATA:null,INDEX_PAGE_TOP_BANNERS:null,GOODS_PAGE_RECOMMEND_GOODS:null,INDEX_PAGE_HOME_OPERATIONS:null,INDEX_PAGE_CAT_GOODS:null,INDEX_PAGE_CAT_GOODS_LOCAL_GROUPS:null,GROUP_PAGE_RECOMMEND_GOODS:null,GROUP_PAGE_REC_GOODS_LOCAL_GROUPS:null,GROUP_PAGE_CAT_GOODS_LOCAL_GROUPS:null,GOODS_PAGE_LUCKY_DRAW_DATA:null,LOTTERY_PAGE_LUCKY_LIST:null,GOODS_PAGE_FREE_COUPONS:null,SEARCH_RESULT_LOCAL_GROUPS:null,ORDER_CHECKOUT_MALL_COUPONS:null,ORDER_CHECKOUT_PLATFORM_COUPONS:null,ORDER_CHECKOUT_TAKE_COUPONS:null,COUPONS_PAGE_GET_COUPONS:null,SPIKE_GOODS_LIST:null,AUTO_CREATE_ORDER_CHECKOUT_PAY:null,SUBJECTS_INFO:null,SUBJECTS_GOODS:null,HAITAO_GOODS_LIST:null,INDEX_CONTENT_GOODS_LIST:null,LOCAL_MANAGE_ORDERS:null}); 
 			}); 
		define("constants/event_constant.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={LuckyDraw:{key:"LuckyDraw",title:"抽奖规则",time:"活动时间: {0}~{1}",detail:["1. 活动结束后将从拼单成功的所有订单中，随机抽取中奖者。","2. 一等奖为{0}（共{1}名），二等奖会全额退款并赠送88元代金券。","3. 中奖的商品预计{0}发放。"]},FreeTrial:{key:"FreeTrial",title:"免费试用团规则",time:"活动时间: {0}~{1}",detail:["1.活动结束后将从拼单成功的所有订单中，随机选取{0}名试用者赠送。","2.试用的商品预计{0}发放。","3.试用者完成试用报告后可以保留试用品。"]},DepositeGroup:{key:"DepositeGroup",title:"免费试用团规则",time:"活动时间: {0}~{1}",detail:["1.活动结束后将从拼单成功的所有订单中，随机选取{0}名试用者赠送。","2.拼团成功后即可获得88元代金券。","3.为进行用户验证，下单时需预付10元押金，成团或24小时内自动全额退还押金。","4.试用的商品预计{0}发放。","5.试用者完成试用报告后可以保留试用品。","6.本活动最终解释权归拼多多所有。"]}};exports.Rules=e; 
 			}); 
		define("constants/goods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={GoodsType:{DEFAULT:1,IMPORTS:2,OVERSEAS_TRANSSHIP:3,OVERSEAS_DM:4,MOBILE_DATA:5,MOBILE_FARE:6,TRADE_COUPON:7,QQ_COIN:8,OIL_CARD:9},GoodsCat:{Fruit:84,Crab:103},SkuStatus:{OnSale:"ONSALE",InStock:"INSTOCK",Unavailable:"UNAVAILABLE"},ChannelSign:{0:{tag:0,title:"限时秒杀",subTitle:"准时抢好品 限量不等人",fontColor:"#E02E24",backgroundColor:"#FDF4F4",iconClass:"icon-mark-alarmclock-"},1:{tag:1,title:"名品折扣",subTitle:"大牌名品低价购",fontColor:"#ffc32a",backgroundColor:"#fffff5",iconClass:"icon-mark-zhe-"},2:{tag:2,title:"爱逛街",subTitle:"时尚抢先 爆款特价",fontColor:"#ff70b0",backgroundColor:"#fff5fa",iconClass:"icon-mark-skirt-"},3:{tag:3,title:"品质水果",subTitle:"全球精选 闪电发货",fontColor:"#1ecd16",backgroundColor:"#f3fff2",iconClass:"icon-mark-fruit-"},4:{tag:4,title:"品牌清仓",subTitle:"放心品质 低价清仓",fontColor:"#fc6cad",backgroundColor:"#fff5fa",iconClass:"icon-mark-bag-"},"-1":{tag:-1,fontColor:"#e02e24",backgroundColor:"#ffffff",iconClass:""}},PromotionEventType:{LIMIT_TIME_DISCOUNT:2,LIMIT_COUNT_DISCOUNT:3}}; 
 			}); 
		define("constants/grade.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var o={LotteryRule:1,PortalLottery:2,GroupModal:6,PortalFreeTrial:7,PortalPromotionSlip:8,ShowShareTimeline:9,ShowGroupTitlePrefix:10,GroupBuyButtonText:11,LaunchAPPTimeLineShare:12},t={BanList:2,Eco:3,ZJ:4,SubEco:5,Other:6},e={PortalLottery:{Goods:1,Icon:2},PortalFreeTrial:{Goods:1,Icon:2}},r={};r[t.BanList]={},r[t.BanList][o.LotteryRule]=0,r[t.BanList][o.PortalLottery]=0,r[t.BanList][o.GroupModal]=0,r[t.BanList][o.PortalFreeTrial]=0,r[t.BanList][o.PortalPromotionSlip]=0,r[t.BanList][o.BirthpetStrategy]=0,r[t.BanList][o.ShowShareTimeline]=0,r[t.BanList][o.ShowGroupTitlePrefix]=1,r[t.BanList][o.GroupBuyButtonText]=0,r[t.BanList][o.LaunchAPPTimeLineShare]=0,r[t.Eco]={},r[t.Eco][o.LotteryRule]=0,r[t.Eco][o.PortalLottery]=0,r[t.Eco][o.GroupModal]=0,r[t.Eco][o.PortalFreeTrial]=0,r[t.Eco][o.PortalPromotionSlip]=0,r[t.Eco][o.BirthpetStrategy]=0,r[t.Eco][o.ShowShareTimeline]=0,r[t.Eco][o.ShowGroupTitlePrefix]=0,r[t.Eco][o.GroupBuyButtonText]=0,r[t.Eco][o.LaunchAPPTimeLineShare]=0,r[t.ZJ]={},r[t.ZJ][o.LotteryRule]=0,r[t.ZJ][o.PortalLottery]=0,r[t.ZJ][o.GroupModal]=0,r[t.ZJ][o.PortalFreeTrial]=0,r[t.ZJ][o.PortalPromotionSlip]=0,r[t.ZJ][o.BirthpetStrategy]=0,r[t.ZJ][o.ShowShareTimeline]=0,r[t.ZJ][o.ShowGroupTitlePrefix]=0,r[t.ZJ][o.GroupBuyButtonText]=0,r[t.ZJ][o.LaunchAPPTimeLineShare]=0,r[t.SubEco]={},r[t.SubEco][o.LotteryRule]=1,r[t.SubEco][o.PortalLottery]=e.PortalLottery.Goods,r[t.SubEco][o.GroupModal]=0,r[t.SubEco][o.PortalFreeTrial]=e.PortalFreeTrial.Goods,r[t.SubEco][o.PortalPromotionSlip]=1,r[t.SubEco][o.BirthpetStrategy]=2,r[t.SubEco][o.ShowShareTimeline]=1,r[t.SubEco][o.ShowGroupTitlePrefix]=0,r[t.SubEco][o.GroupBuyButtonText]=1,r[t.SubEco][o.LaunchAPPTimeLineShare]=0,r[t.Other]={},r[t.Other][o.LotteryRule]=1,r[t.Other][o.PortalLottery]=e.PortalLottery.Goods,r[t.Other][o.GroupModal]=1,r[t.Other][o.PortalFreeTrial]=e.PortalFreeTrial.Goods,r[t.Other][o.PortalPromotionSlip]=1,r[t.Other][o.BirthpetStrategy]=2,r[t.Other][o.ShowShareTimeline]=1,r[t.Other][o.ShowGroupTitlePrefix]=0,r[t.Other][o.GroupBuyButtonText]=1,r[t.Other][o.LaunchAPPTimeLineShare]=1,exports.default={Scene:o,Role:t,Result:r,ExtraField:e}; 
 			}); 
		define("constants/groups.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var T={EventType:{DEFAULT:0,LUCKY_DRAW:1,SPIKE:2,FREE_GROUP:3,TWO_FOR_ONE:4,SUPER_SPIKE:5,NEW_USER_GROUP:6,FREE_TRIAL:7,CAPITAL_GIFT:8,CAPITAL_GIFT_LOTTERY:9,TZYY:10,DEPOSITE_GROUP:11,MORE_THAN_ONE_DISCOUNT:12,LIMIT_TIME_FREE:13,LIMIT_TIME_DISCOUNT:16,LIMIT_COUNT_DISCOUNT:18},GroupRole:{NotInGroup:0,Member:1,Lead:2},GroupStatus:{OnGoing:0,Success:1,Failed:2},GroupOrderType:{Default:0}};exports.default=T; 
 			}); 
		define("constants/image.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={GalleryType:{Top:"1",Detail:"2"},CompressPipe:{Default:"750w_1l_50Q",Notification:"100w_1l_50Q",GroupShare:"434w_0l_90Q"}}; 
 			}); 
		define("constants/index_quick_entrance.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var i=[{name:"限时秒杀",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/time_spike.png",pageSrc:"time_spike",url:"/pages/spike/spike",redPoint:!1,newGif:!0,hitTimes:1},{name:"品牌清仓",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/super_spike.png",pageSrc:"super_spike",url:"/pages/subjects/subjects?subjects_id=14",redPoint:!0,newGif:!1,hitTimes:1},{name:"食品超市",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index/food_store.png",pageSrc:"food",url:"/pages/subjects/subjects?subjects_id=17",redPoint:!1,newGif:!1,hitTimes:1},{name:"品质水果",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/good_fruit.png",pageSrc:"good_fruit",url:"/pages/subjects/subjects?subjects_id=11",redPoint:!1,newGif:!1,hitTimes:1},{name:"爱逛街",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/go_shopping.png",pageSrc:"go_shopping",url:"/pages/subjects/subjects?subjects_id=15",redPoint:!1,newGif:!1,hitTimes:1},{name:"家居优品",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/furniture.png",pageSrc:"furniture",url:"/pages/subjects/subjects?subjects_id=18",redPoint:!1,newGif:!1,hitTimes:1},{name:"电器城",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/electric_city.png",pageSrc:"electric_city",url:"/pages/subjects/subjects?subjects_id=23",redPoint:!1,newGif:!1,hitTimes:1},{name:"时尚穿搭",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/fashion_dress.png",pageSrc:"fashion_dress",url:"/pages/subjects/subjects?subjects_id=22",redPoint:!1,newGif:!1,hitTimes:1},{name:"9块9特卖",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/bargain.png",pageSrc:"bargain",url:"/pages/subjects/subjects?subjects_id=12",redPoint:!1,newGif:!1,hitTimes:1},{name:"名品折扣",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/economical_brand.png",pageSrc:"economical_brand",url:"/pages/economical_brand/economical_brand",redPoint:!1,newGif:!1,hitTimes:1},{name:"一分抽奖",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/lottery.gif",pageSrc:"lottery",url:"/pages/subject/subject?subject_id=2742",redPoint:!1,newGif:!0,hitTimes:1},{name:"手机充值",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/charge_center.png",pageSrc:"charge_center",url:"/pages/subjects/subjects?subjects_id=19",redPoint:!0,newGif:!1,hitTimes:1},{name:"省钱妈咪",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/maternal.png",pageSrc:"maternal",url:"/pages/subjects/subjects?subjects_id=20",redPoint:!1,newGif:!1,hitTimes:1},{name:"新人团",img:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/index_icon_normal/new_user.png",pageSrc:"new_user_group",url:"/pages/subject/subject?subject_id=1243",redPoint:!1,newGif:!0,hitTimes:1}];exports.default=i; 
 			}); 
		define("constants/lottery.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={LotteryStatus:{Start:0,BeforeConfirm:1,Confirm:2,Complete:3}};exports.default=e; 
 			}); 
		define("constants/malls.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={OfficialMallId:{Online:"606",Hutaojie:"40",Weipin:"16"}}; 
 			}); 
		define("constants/order.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={CommentStatus:require("./comment").CommentStatus,AuthorizationType:{SMS:1,Weibo:2,WeChat:3,QQ:4},PaymentType:{AliPay:1,WeChat:2,QQPay:3,ApplePay:4},GroupStatus:{OnGoing:0,Success:1,Failed:2},GroupRole:{NotInGroup:0,Member:1,Lead:2},RegionType:{Province:"1",City:"2",District:"3"},Region:{China:"1"},AddressClass:{Default:"1",Common:"0"},OrderStatus:{Unconfirmed:"0",Confirmed:"1",Cancelled:"2"},PaymentStatus:{Unpayed:"0",Payed:"2",RefundApplied:"3",Refunded:"4"},ShipmentStatus:{Unshipped:"0",Shipping:"1",Received:"2"},rateStatus:{rateEnable:"1",rateUnable:"0"},OrderCombinedStatus:{Unpayed:0,Unconfirmed:1,Confirmed:2,Shipping:3,Received:4,Cancelled:5,UnshippedRefunding:6,UnshippedRefunded:7,ShippingRefunding:8,ShippingRefunded:9,Expired:10,UnconfirmedRefunding:11,UnconfirmedRefunded:12},SkuStatus:{OnSale:"ONSALE",InStock:"INSTOCK",Unavailable:"UNAVAILABLE"},WaterMark:{Default:"!share_v2",WeChatMsg:"!share_v3",Share:"!share",Transparent:"!transparent",None:""},Mall:{NoCS:"此商家暂未开启在线客服功能",NoCSOnline:{NormalMall:"当前没有在线客服，在线客服的服务时间是9:00~20:00。您的话将会变成留言",DefaultMall:"在线客服的服务时间是9:00~18:00。您的话将会变成留言"},PddMall:[1,11],ServiceStart:9,ServiceEnd:{NormalMall:20,DefaultMall:18}},GoodsType:{DEFAULT:1,IMPORTS:2,OVERSEAS_TRANSSHIP:3,OVERSEAS_DM:4,MOBILE_DATA:5,MOBILE_FARE:6,TRADE_COUPON:7},EVENT_TYPE:{DEFAULT:0,LUCKY_DRAW:1,SPIKE:2,TZMD:3,GET_EXTRA_FOR_FREE:4,SUPER_SPIKE:5,NEW_USER_GROUP:6,FREE_TRIAL:7,CAPITAL_GIFT:8,CAPITAL_GIFT_LOTTERY:9,TZYY:10,DEPOSITE_GROUP:11,MULTIPLY_GOODS_DISCOUNT:12,LIMIT_TIME_DISCOUNT:16,LIMIT_COUNT_DISCOUNT:18},OrderType:{All:0,PendingPay:1,Shipping:2,Collecting:3,Evaluating:4},OrderDesc:{Received:"已签收"},ForceContactBound:5,ForceContactHighBound:10,OFFICIAL_MALL_ID:{Online:"606",Hutaojie:"40",Weipin:"16"},PROBLEM_TYPE_DESC:{1:"未收到货",2:"水果破损腐烂",3:"商品少发漏发发错",4:"商品与描述不一致",5:"退款过程遇到问题",0:"其他"},CookieKey:{AccessToken:"PDDAccessToken",WebpEnable:"webp",UA:"ua",AB:"ab",SP:"sp",GP:"gp",UID:"pdd_user_id",UserGrade:"egrp"},LocalStorageKey:{AccessToken:"AccessToken",ShowAlertDelayLoad:"ShowAlertDelayLoad",DelayLoadTimestamp:"DelayLoadTimestamp",UID:"0e4f9612e0fbe579",NewbeeGift:"0a6afe66ccefef54",FreeCouponsIndex:"index_tz",LastGoodsID:"LASTGOODSID",LastVisitGoods:"c3a4ac3acbffadc9",LastGroupOrderID:"LASTGROUPORDERID",LastVisitGroup:"72d02a9490f4271b",GoodsLikeData:"LIKEDATA",SuperSpike:"e4429941e04239f6",WeixinInfo:"weixinInfo",ReloadAddresses:"reloadAddresses",PartnerList:"b493518d3aacfa04",OrderInfoCaches:"ORDER_INFO_CACHES",CheckAppDownload:"e1adaa118ffc8534",AppDownloadUsers:"618bf2394a0be09f",InCacheOrderType:"in_cache_order_type",Speical99:"speical99",OnePurchase:"onePurchase",LastRankIndex:"LAST_RANK_INDEX",LastVisitData:"lastVisitData",SearchHistory:"SEARCH_HISTORY",FreeTrial:"58b303885a50357c",FreeTrialAlert:"freeTrialAlert",LastPaymentType:"LastPaymentType",AfterPayed:"afterpayed",IndexTopTab:"indexTopTab",LastPersonalMsg:"LastPersonalMsg",IphoneResultKey:"LuckyWheelIphoneResult",AB:"ab",SP:"sp",GP:"gp",UserGrade:"egrp"},AlertType:{Alert:{AlertNewUserGroup:"alert_new_user_group",AlertAppDownload:"alert_app_download",AlertOpenAppNotification:"alert_open_app_notification",AlertCouponSend:"alert_coupon_send",AlertFreeTrial:"alert_free_trial",IDCardHint:"ID_card_hint"},Confirm:{ConfirmDefault:"confirm_default",ConfirmShipment:"confirm_shipment",ConfirmAppGroup:"confirm_app_group",ConfimWeChatWapPay:"confirm_wechat_wap_pay",ConfirmAppUpdate:"confirm_app_udpate",ConfirmJSPhotoAppUpdate:"confirm_jsphoto_app_update",ConfirmAfterGroupShare:"confirm_after_group_share"}},ShareChannel:{Unknown:"unknown",AppMessage:"message",Timeline:"timeline",QQ:"qq",QQZone:"qzone",QQWeibo:"qq_weibo",SinaWeibo:"weibo"},BanRegions:["广东 广州","广东 "],APIRetryLimit:3,CDNImgHostName:"http://pinduoduoimg.yangkeduo.com/",ImprTime:1e3,ImprTimeTest:700,CouponBatchType:{GroupFreeCoupon:7,MallCoupon:8,GoodsCoupon:9,VirtualGoods:13},ContactURLType:{LowPrice:1,HighPrice:2},TrackingChannels:["src","from","campaign","cid"],TrackingEvent:{OpenAddress:"open_address",SkipAppGroup:"skip_app_group",AlertAppDownload:{Show:"a_a_d_s",Download:"a_a_d_d",Close:"a_a_d_c"}},LotteryStatus:{Start:0,BeforeConfirm:1,Confirm:2,Complete:3},NativeStorageKey:{CheckUpdateTime:"check_update_time"},AppDownloadUrl:{Default:"download.html",IOS:"https://itunes.apple.com/cn/app/pin-duo-duo/id1044283059?l=zh&mt=8",Android:"http://pinduoduo.oss-cn-shanghai.aliyuncs.com/android/pinduoduo_latest.apk"},QueryTag:{Skip:{AppGroup:"app_group"}},LastVisitDuration:{Goods:864e5,Group:864e5},NoLongerPromptAppDownload:"-1",AppDownloadUsersMaxNum:10,ForceContactUIDThreshold:{minNumber:2,maxNumber:4},GoodsCat:{Fruit:84,Crab:103},PromotionType:{SuperBrand:"super_brand",Event618:"mid_year"},AuthorizeRequest:{Time:"7200000",Length:32},GroupOrderType:{Default:0,ZCJB:1},GroupBannerV2AppID:[1,2,3,25],QRCodeType:{Default:0,Resubscribe:1,GroupBanner:2,NewUserGroup:3,ABAlert:4,LuckyWheel:5,AfterpayAlert:6,GPAlert:7},CompressPipe:{Default:"750w_1l_50Q",Notification:"100w_1l_50Q",GroupShare:"434w_0l_90Q"},ApplePaySupportStatus:{Support:0,NotSupport:1,VersionTooLow:2,NotBindChinaUnionPayCard:3},ShareImgGoods:[],ForceContactAppIDs:[1,2,3,26],TrackingReferKeys:["refer_page_name","refer_page_section","refer_page_element"],QQInvokeScript:"http://imgcache.gtimg.cn/channel/lib/components/adapt/adapt-3.0.js?max_age=86400000&_bid=2106",TabsConstants:[{label:"全部",type:0,url:"all"},{label:"待付款",type:1,url:"unpaid"},{label:"待分享",type:5,url:"grouping"},{label:"待发货",type:2,url:"unshipping"},{label:"待收货",type:3,url:"unreceived"},{label:"待评价",type:4,url:"unrated"}]};exports.default=e; 
 			}); 
		define("constants/order_checkout.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=["本商品为海外直邮商品，根据海关要求，购买跨境商品需要对订购人进行实名认证，错误信息可能导致无法正常清关","身份证号必须与收货人姓名一致","你的身份信息将加密保管，拼多多保证信息安全，绝不对外泄露"];exports.ID_CARD_HINT=e; 
 			}); 
		define("constants/page.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={index:{pv:{}},spike:{pv:{},pageName:"seckill",title:"限时秒杀"},subject:{pv:{keys:["subject_id"]}},free_trial_page:{pv:{},pageName:"free_try",title:"免费试用团"},lottery:{pv:{},title:"抽奖"},catgoods:{pv:{keys:["opt_id","opt_type"]},pageName:"opt"},new_arrivals:{pv:{},pageName:"shangxin"},rank_hot:{pv:{},pageName:"hotcity"},prime_subjects:{pv:{},pageName:"selected_subject"},haitao:{pv:{}},classification:{pv:{},pageName:"search",native:{android:{name:"classification",version:"3.0.0"},ios:{name:"pdd_search",version:"3.0.0"}}},search_result:{pv:{keys:["search_key"]}},personal:{pv:{}},profile:{pv:{},pageName:"friend_profile",requireLogin:!0,title:"个人主页"},my_friends:{pv:{},requireLogin:!0,title:"我的好友"},friends_requests:{pv:{},requireLogin:!0,title:"好友申请",pageName:"requesting_friends"},friends_recommends:{pv:{},requireLogin:!0,title:"好友推荐",pageName:"recommended_friends"},orders:{pv:{keys:["type"]},pageName:"my_order",requireLogin:!0,title:"我的订单",native:{android:{name:"pdd_orders",version:"2.6.0"},ios:{name:"pdd_orders",version:"2.14.0"}}},groups:{pv:{keys:[{key:"status",default:3}]},pageName:"my_group",requireLogin:!0,title:"我的团"},likes:{pv:{keys:["favorite_type"]},requireLogin:!0,title:"我的收藏"},mylottery:{pv:{},pageName:"my_lottery",requireLogin:!0,title:"我的抽奖"},chat_list:{pv:{},requireLogin:!0,title:"我的消息"},coupons:{pv:{},pageName:"my_coupons",requireLogin:!0,title:"我的优惠券"},complaint_list:{pv:{},pageName:"complaint",requireLogin:!0},order:{pv:{keys:["order_sn"]},pageName:"order_detail",requireLogin:!0},group:{pv:{indiv:!1,keys:["group_order_id"]},pageName:"group_detail",requireLogin:!0,tkShareClick:!0},goods:{pv:{keys:["goods_id"]},pageName:"goods_detail",tkShareClick:!0,native:{android:{name:"pdd_goods_detail",version:"3.13.0"},ios:{name:"pdd_goods_detail",version:"3.15.0"}}},order_checkout:{pv:{keys:["goods_id","sku_id","group_id",{key:"goods_number",default:1}]},requireLogin:!0},mall_page:{pv:{keys:["mall_id"]},pageName:"mall",native:{android:{name:"pdd_mall",version:"2.1.0"},ios:{name:"pdd_mall",version:"1.3.0"}}},mall_certificates:{pv:{keys:["mall_id"]},pageName:"mall_certificates",requireLogin:!0,title:"经营证照"},tzfree_list:{pv:{},pageName:"free_group_list"},expiring_coupons:{pv:{keys:["expire_batch_ids"]},pageName:"expired_coupon",requireLogin:!0},coupon_push_someusers:{requireLogin:!0},coupon_event_v2:{pv:{},pageName:"red_packet",requireLogin:!0},chat_detail:{pv:{keys:["mall_id"]},pageName:"talk",requireLogin:!0},chat_detail_friends:{pv:{keys:["other_uid"]},pageName:"chat_detail_friends",requireLogin:!0},additional_comments:{pv:{},requireLogin:!0,native:{android:{name:"pdd_additional_comment",version:"3.20.0"},ios:{name:"pdd_additional_comment",version:"3.20.0"}}},addresses:{pv:{},requireLogin:!0,title:"收货地址"},alipay_callback:{pv:{}},wechat_h5_pay_callback:{pv:{},requireLogin:!0},anniversary:{},app_about:{pv:{}},app:{},authorize:{pv:{},requireLogin:!0},black_friday:{},comments:{pv:{},requireLogin:!0,native:{android:{name:"pdd_comment",version:"3.20.0"},ios:{name:"pdd_comment",version:"3.20.0"}}},complaint_guide:{pv:{}},complaint_old:{pv:{},requireLogin:!0},coupon_recommend:{pv:{},requireLogin:!0},coupon_share:{pv:{keys:["share_code","ownerID"]},pageName:"coupon",requireLogin:!0},deal_made:{pv:{},requireLogin:!0},double11:{},download:{},faq:{pv:{}},goods_comments:{pv:{keys:["goods_id"]}},goods_express:{pv:{keys:["order_sn","goods_id","tracking_number","shipping_id"]},requireLogin:!0},goods_skip:{pv:{keys:["goods_id"]}},login:{pv:{}},lottery_list:{pv:{keys:["lucky_id"]}},setting:{pv:{}},skip:{pv:{}},suggestion:{pv:{},title:"常见问题"},terms:{pv:{}},personal_feedback:{pv:{},title:"意见反馈"},feedback_commit:{pv:{keys:[{key:"type",default:1}]},title:"意见反馈",requireLogin:!0},qqoauth_callback:{},wboauth_callback:{},complaint:{pv:{keys:["order_sn"]},pageName:"complaint_make",requireLogin:!0},complaint_detail:{pv:{keys:["after_sales_id","order_sn"]},requireLogin:!0},haitao_spike:{pv:{},pageName:"haitao_seckill"},app_coupon_popup:{},subjects:{pv:{keys:["subjects_id"]}},fruit:{pv:{},title:"拼好货"},economical_brand:{pv:{},title:"名品折扣"},flash_groups:{},new_year_coupon_square:{title:"年货节领券专区"},new_year:{},express_complaint:{pv:{},title:"物流投诉",requireLogin:!0},one_yuan_purchase:{pv:{},title:"一元团"},womens_day:{pv:{},title:"拼多多女神节"},spring_summer:{pv:{},title:"拼多多换季清仓"},april_promo:{pv:{},title:"拼多多换季上新"},april_new_home:{pv:{},title:"拼多多焕新家"},tuan_success_recommend:{pv:{keys:["goods_id"]},title:"猜你喜欢"},coupon_newbee:{pv:{keys:["coupon_id"]},title:"优惠券适用商品"},coupon_download:{pv:{}},footprint:{pv:{keys:[]},title:"足迹"},detail:{pv:{},title:"商品详情"}};exports.PageInfo=e; 
 			}); 
		define("constants/payment.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default={WECHAT_PAY_SUCCESS_MSG:"requestPayment:ok",WECHAT_PAY_CANCEL_MSG:"requestPayment:cancel",ANDROID_WECHAT_PAY_CANCEL_MSG:"requestPayment:fail cancel",isCancelPay:function(e){return"requestPayment:cancel"==e||"requestPayment:fail cancel"==e}}; 
 			}); 
		define("constants/promotion.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={PromotionType:{SuperBrand:"super_brand",Event618:"mid_year"}}; 
 			}); 
		define("constants/regions.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={IPServer:{Host:"http://ip-service.slb.prod.yiran.com",RegionType:{Province:"province",Region:"region",RegionInfo:"region_info"},BanRegions:["广东 广州","广东 "],BanProvinces:["广东"]},BanRegions:["广东 广州","广东 "]}; 
 			}); 
		define("constants/share.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={Success:"shareAppMessage:ok",Cancel:["shareAppMessage:cancel","shareAppMessage:fail cancel"],Fail:"shareAppMessage:fail"},s={Unknown:"unknown",AppMessage:"message",Timeline:"timeline"},a={Success:"success",Fail:"fail",Cancel:"cancel",Complete:"complete"};exports.ShareChannel=s,exports.ShareResult=a,exports.getShareResultByErrMsg=function(s){var n=s.indexOf(e.Success)>=0,c=s.indexOf(e.Fail)>=0,l=e.Cancel.some(function(e){return s.indexOf(e)>=0});return n?a.Success:l?a.Cancel:c?a.Fail:a.Complete}; 
 			}); 
		define("constants/share_info.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default={IndexPageUrl:"/pages/index/index",DefaultTitle:"拼多多商城",DefaultDesc:"风靡全国的拼团商城，优质商品新鲜直供，快来一起拼多多吧",DefaultShareInfo:{title:"拼多多商城",desc:"风靡全国的拼团商城，优质商品新鲜直供，快来一起拼多多吧",path:"/pages/index/index"}}; 
 			}); 
		define("constants/storage_keys.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var l=(0,function(l){return l&&l.__esModule?l:{default:l}}(require("../libs/key_mirror")).default)({USER_INFO:null,SEARCH_HISTORY:null,GROUP_PLAY_NOTICE:null,WEBP_ENABLE:null,CLASSIFACATION_INFO:null,UID:"0e4f9612e0fbe579",REGIONS:null,LIKE_GOODS_IDS:null,FAVORITE_UPDATE_TIME:null,LIKE_MALL_IDS:null,FAVORITE_MALL_UPDATE_TIME:null,VISITOR_INFO:null,USER_OPEN_PAGE_TIME:null,HOME_OPERATIONS:null,TOP_BANNER:null,GOODS_MALL_COUPON_GOT_ALREADY:null,GOODS_LIKE_DATE:null,GOODS_FROM_LIKE_DATE:null});exports.default=l; 
 			}); 
		define("constants/subjects.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=[{name:"默认排序",sortTypeName:"PRIORITY"},{name:"销量排序",sortTypeName:"COUNT"},{name:"最新上架",sortTypeName:"ID"},{name:"价格从高到低",sortTypeName:"PRICE_DESC"},{name:"价格从低到高",sortTypeName:"PRICE_ASC"}],i={good_fruit:"11",bargain:"12",super_spike:"14",go_shopping:"15",food:"17",furniture:"18",maternal:"20",electric_city:"23"},t={11:{spikeTitle:"每日抢鲜",title:"品质水果",subTitle:"24H闪电发货 闪电退款",spikeUrl:"spike/19/goods"},12:{title:"9块9特卖",isGenTianType:!0,genTianId:"2",hasSpecialUrl:!0,tabUrl:"getGenTianTabData",goodsUrl:"getGenTianGoodsData",noSortTypeName:!0},14:{spikeTitle:"每日疯抢",title:"品牌清仓",subTitle:"每天11点·21点更新",spikeUrl:"spike/6/goods",isGenTianType:!0,genTianId:"11",sortEnable:!1,hasSpecialUrl:!0,tabUrl:"getGenTianTabData",goodsUrl:"getGenTianGoodsData",noSortTypeName:!0},15:{spikeTitle:"每日疯抢",title:"爱逛街",subTitle:"每天10点·20点更新",spikeUrl:"spike_go_shopping",isSpecialOfferSubjects:!0,hasSpecialUrl:!0,doubleSelect:!0,tabUrl:"getIShoppingTabData",goodsUrl:"getIShoppingGoddsData"},16:{title:"特价爆款"},17:{spikeTitle:"每日试吃",title:"美食汇",subTitle:"",spikeUrl:"spike/7/goods"},18:{spikeTitle:"优品速抢",title:"家居优品",subTitle:"一站购齐，买退无优",spikeUrl:"api/spike/spike_list?type=8"},20:{spikeTitle:"每日疯抢",title:"省钱妈咪",subTitle:"每天10点·20点更新",spikeUrl:"spike_mother_baby"},22:{spikeTitle:"每日疯抢",title:"时尚穿搭",subTitle:"每日上新，买手推荐",spikeUrl:"api/spike/spike_list?type=22"},23:{spikeTitle:"品牌限时抢",title:"电器城",subTitle:"七天退换，全国联保",spikeUrl:"spike/18/goods"}};exports.SubjectsNameIndex=i,exports.SortTypeData=e,exports.SubjectsSpikeInfo=t; 
 			}); 
		define("constants/tracking/coupon_msg.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={QueryKey:"event",QueryValue:"coupon_msg_push",EventValueByPageName:{free_group_list:"coupon_msg_tzfree_show",subject:"coupon_msg_subject_show",expired_coupon:"coupon_msg_expire_show",goods_detail:"coupon_msg_goods_show"}}; 
 			}); 
		define("constants/tracking/goods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={MallBtnClick:{op:"click",event:"go_mall_btn_clk",page_name:"goods_detail",page_element:"go_mall_btn",is_new:"1"},JoinBtnClick:{op:"click",event:"join_btn_clk",page_name:"goods_detail",page_element:"join_btn",is_new:"1"},OpenBtnClick:{op:"click",event:"open_btn_clk",page_name:"goods_detail",page_element:"open_btn",is_new:"1"},IconClick:{op:"click",event:"icon_clk",page_name:"goods_detail",page_section:"icon_list",is_new:"1"},PageShare:{op:"event",event:"goods_detail_share",page_name:"goods_detail",is_new:"1"},MallRecommendGoodsClick:{op:"click",page_name:"goods_detail",page_section:"mall_rec_list",page_element:"item"},RecommendGoodsClick:{op:"click",event:"rec_goods_clk",page_name:"goods_detail",page_section:"rec_list",list_width:"2",is_new:"1"},TopGalleryClick:{op:"click",event:"top_banner_clk",page_name:"goods_detail",page_element:"top_banner"},ServicePromiseClick:{op:"click",event:"ser_promise_btn_clk",page_name:"goods_detail",page_element:"ser_promise_btn"},LocalGroupsShow:{op:"impr",page_name:"goods_detail",page_section:"local_group"},ShopAroundClick:{op:"click",event:"go_mall_btn_clk",page_name:"goods_detail",page_element:"go_mall_btn"},GoodsCommentsClick:{op:"click",event:"comment_btn_clk",page_name:"goods_detail",page_element:"comment_btn"},ToTopClick:{op:"click",event:"pop_btn_clk",page_name:"goods_detail",page_section:"pop_list",page_element:"top_btn"}}; 
 			}); 
		define("constants/tracking/keys.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=["src","from","campaign","cid","msgid"],r={OpenAddress:"open_address",SkipAppGroup:"skip_app_group",AlertAppDownload:{Show:"a_a_d_s",Download:"a_a_d_d",Close:"a_a_d_c"}},a=["refer_page_name","refer_page_section","refer_page_element"],_=["refer_share_id","refer_share_uid","refer_share_channel","refer_share_form"];exports.TrackingChannels=e,exports.TrackingEvent=r,exports.ReferPageKeys=a,exports.ReferShareKeys=_; 
 			}); 
		define("constants/tracking/refer.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={PV:{}}; 
 			}); 
		define("constants/tracking/subjects.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={EntryClick:{op:"click",event:"icon_clk",page_name:"index",page_section:"icon_list"},spikeBtnClickParams:{op:"click",event:"seckill_btn_clk",page_section:"goods_list"},viewMoreParams:{op:"click",event:"find_more_no_click",page_element:"more_no_btn"},spikeItemClickParams:{op:"click",event:"seckill_goods_clk",page_section:"goods_list"},selloutOnClickParams:{op:"click",event:"seckill_goods_clk",page_section:"goods_list",page_element:"seckill_no"},haitaoSelloutOnClickParams:{op:"click",event:"haitao_seckill_goods_clk",page_section:"goods_list"},spikePVParams:{op:"pv",event:"seckill_show"},authApproveParams:{op:"click",event:"approve_btn_click",page_section:"auth_prompt",page_element:"approve"},authRefuseParams:{op:"click",event:"refuse_btn_click",page_section:"auth_prompt",page_element:"rufuse"},authPromptParams:{op:"impr",event:"page_show",page_section:"auth_prompt"},authRecallImprParams:{op:"impr",event:"page_show",page_section:"recall_auth_prompt"},authRecallApproveParams:{op:"click",event:"approve_btn_click",page_section:"recall_auth_prompt",page_element:"approve"},authRecallRefuseParams:{op:"click",event:"refuse_btn_click",page_section:"recall_auth_prompt",page_element:"rufuse"}}; 
 			}); 
		define("constants/tracking/subjects_collection.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={VisitSubjectsCollection:{op:"pv",event:"subjects_show",page_name:"subjects"},TopBarClick:{op:"click",event:"subject_tab_clk",page_section:"subject_list",page_element:"subject"},SortTypeClick:{op:"click",event:"sort_btn_clk",page_section:"sort_btn_list",page_element:"sort_btn"},GoodsClick:{op:"click",event:"subject_goods_clk",page_section:"goods_list",page_element:"goods"},SubSubjectClick:{op:"click",page_section:"goods_list",page_element:"subject"},GoodsBuyButtonClick:{op:"click",event:"subject_btn_clk",page_section:"goods_list",page_element:"quick_buy_btn"},GoodsListSlipSeeMore:{op:"click",page_section:"nested_subject_list",page_element:"more"},GoodsListSlipClickGoods:{op:"click",page_section:"nested_subject_list",page_element:"goods"},GoodsListImpr:{op:"impr",page_section:"goods_list",page_element:"goods"}}; 
 			}); 
		define("constants/ui/base64/ArrowsRight.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default="http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/constant/arrow-right.png"; 
 			}); 
		define("constants/ui/base64/pull_down_triangle.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default="url(http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/constant/pull-down-triagle.png)"; 
 			}); 
		define("constants/ui/base64/webp_test.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default="data:image/webp;base64,UklGRlAAAABXRUJQVlA4WAoAAAAQAAAADwAADwAAQUxQSBIAAAABBxAR/Q8ABOH/3EFE/1MDAABWUDggGAAAADABAJ0BKhAAEAACACYlpAADcAD+/PQAAA=="; 
 			}); 
		define("controller/addresses_controller.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("../configs/api")),t=e(require("../common/request")),o=e(require("../common/data_util")),d=(e(require("../common/url_util")),e(require("../storage/regions_storage"))),s=e(require("../models/address")),i=(e(require("../storage/ram_manager")),{regionsDatas:null,getAddressesInfo:function(e){var d=t.default.apiRequest("GET",r.default.addresses);return d.then(function(r){if(r&&o.default.isArray(r)){var t=[];r.forEach(function(e){var r=new s.default(e);t.push(r)}),t=o.default.objectArrayDuplicateRemove(t,"addressId"),"function"==typeof e&&e(t)}},function(r){"function"==typeof e&&e({errorCode:r.error_code,errorMsg:r.error_msg})}),d},setDefaultAddress:function(e,o){var d=r.default.setDefaultAddress+"/"+e.addressId;e.provinceId&&e.cityId&&e.districtId?t.default.apiRequest("POST",d).then(function(e){!0===e.result?o&&o({success:!0}):o&&o({errorCode:41428,errorMsg:"设置失败"})}).catch(function(e){o&&o({errorCode:e.error_code,errorMsg:e.error_msg})}):o({errorCode:41428,errorMsg:"非法地址"})},modifyAddress:function(e,d){var s=r.default.modifyAddress+"/"+e.addressId;if(e.provinceId&&e.cityId&&e.districtId){var i={name:e.name,mobile:o.default.formatMobile(e.mobile),province_id:e.provinceId,city_id:e.cityId,district_id:e.districtId,address:e.address},a=this;t.default.apiRequest("POST",s,i).then(function(r){!0===r.result?a.getAddressDetail(e.addressId,function(e){e.errorCode?d&&d({errorCode:r.error_code,errorMsg:r.error_msg}):d&&d(e)}):d&&d({errorCode:41428,errorMsg:"接口出错了"})}).catch(function(e){d&&d({errorCode:e.error_code,errorMsg:e.error_msg})})}else d({errorCode:41428,errorMsg:"非法地址"})},getAddressDetail:function(e,o){var d=r.default.address+"/"+e;t.default.apiRequest("GET",d).then(function(e){o&&o(new s.default(e))},function(e){o&&o({errorCode:e.error_code,errorMsg:e.error_msg})})},createAddress:function(e,d){var s=r.default.address;if(e.addressId&&(s+="/"+e.addressId),e.provinceId&&e.cityId&&e.districtId){var i={name:e.name,mobile:o.default.formatMobile(e.mobile),province_id:e.provinceId,city_id:e.cityId,district_id:e.districtId,address:e.address,is_default:e.isDefaultAddress?"1":""},a=this;t.default.apiRequest("POST",s,i).then(function(r){var t=r.address_id||e.addressId;a.getAddressDetail(t,function(e){e.errorCode?d&&d({errorCode:r.error_code,errorMsg:r.error_msg}):d&&d(e)})},function(e){d&&d({errorCode:e.error_code,errorMsg:e.error_msg})})}},fetchRegionsJsonData:function(e){if(this.getRegions()&&"function"==typeof e)e();else{var o=d.default.getRegionsLastUpdated(),s=r.default.regionsJson+"/"+(null==o?0:o);t.default.apiRequest("GET",s,null,!0).then(function(r){d.default.saveRegionsData(r),"function"==typeof e&&e()},function(r){"function"==typeof e&&Rammanager.CPPage.$showToast(r.error_msg)})}},getRegions:function(){return this.regionsDatas||(this.regionsDatas=(d.default.getRegionsData()||{}).regions),this.regionsDatas}});exports.default=i; 
 			}); 
		define("controller/coupons_controller.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});e(require("../configs/api")),e(require("../common/request"));var n=e(require("../common/data_util")),t=(e(require("../common/url_util")),e(require("../common/std_format"))),o=e(require("../common/time_util")),a=e(require("../common/object_util")),u=(e(require("../constants/coupons")),e(require("../models/format/coupons_format")),{getLeftNumber:function(e,n){var t=0;if(!e||!n)return t;if(n.price*n.limitQuantity<e.min_amount)return t;var o=Math.ceil(e.min_amount/n.price-n.goodsNumber);return o>0&&(t=o),t},formatCouponsData:function(e,i){var r=[],s={},m=[],l=[],c=[],_=e.serverTime||0;n.default.isArray(e.enableCoupons)||(e.enableCoupons=[]),n.default.isArray(e.disableCoupons)||(e.disableCoupons=[]);for(var d=function(e){return{couponId:e.coupon_id,batchName:e.batch_name,discount:t.default.price(e.discount,100),minAmount:t.default.price(e.min_amount,100),startTime:o.default.formatTime(new Date(1e3*e.start_time),"yyyy.M.d"),endTime:o.default.formatTime(new Date(1e3*e.end_time),"yyyy.M.d")}},p=void 0,f=e.enableCoupons.length,b=0;b<f;b++)(p=e.enableCoupons[b]).min_amount===p.discount&&p.min_amount++,r.push(d(p));e.enableSuperpositionCoupons&&e.enableSuperpositionCoupons.max_available_num&&(s=function(e){return{batchName:e.batch_name,discount:t.default.price(e.discount,100),startTime:o.default.formatTime(new Date(1e3*e.start_time),"yyyy.M.d"),endTime:o.default.formatTime(new Date(1e3*e.end_time),"yyyy.M.d"),rulesDesc:e.rules_desc,maxAvailableNum:e.max_available_num,selectedNum:e.max_available_num,selectedCertainNum:e.max_available_num,reduceSuperDisable:1==e.max_available_num,increaseSuperDisable:!0,showSuperEditBtn:!1,usable:e.usable,couponId:"101010"}}(e.enableSuperpositionCoupons));for(var A=e.disableCoupons.length,y=[],I=0;I<A;I++)if("COUPON_AVAILABLE_FOR_APP_ONLY"!=(p=e.disableCoupons[I]).unusable_reason_code){p.coupon_info.min_amount===p.coupon_info.discount&&p.coupon_info.min_amount++;var C=a.default.assign({leftNumber:u.getLeftNumber(p,i)+"",disableReason:"",activated:1},d(p.coupon_info));_>0&&_<p.start_time&&(C.activated=0,C.disableReason="未到使用时间"),"CATEGORY_IS_UNAVAILABLE"==p.unusable_reason_code||p.unusable_reason_code.indexOf("COUPON_UNAVAILABLE_FOR")>-1?(C.disableReason="当前商品所属品类不可用",c.push(C)):"ORDER_AMOUNT_BELOW_LIMITATION"==p.unusable_reason_code?(C.disableReason="ORDER_AMOUNT_BELOW_LIMITATION",l.push(C)):c.push(C),_>0&&_<p.start_time?y.push(C):m.push(C)}return l.length>0&&(l=(l=l.sort(function(e,n){return parseInt(n.discount,10)-parseInt(e.discount,10)})).sort(function(e,n){return parseInt(e.minAmount,10)-parseInt(n.minAmount,10)})),c.length>0&&(c=(c=c.sort(function(e,n){return parseInt(n.discount,10)-parseInt(e.discount,10)})).sort(function(e,n){return parseInt(e.minAmount,10)-parseInt(n.minAmount,10)})),m=l.concat(c).concat(y),{enableCoupons:r,enableSuperpositionCoupons:s,disableCoupons:m}}});exports.default=u; 
 			}); 
		define("controller/custom_service.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SelfService=exports.CustomServiceController=void 0;var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),s=(require("../common/message"),e(require("../common/wx_socket")),e(require("../storage/user_storage")),e(require("../constants/order")),e(require("../common/order_utils"))),a=(e(require("../configs/api")),e(require("../pages/order/complaint_const"))),n=require("../common/index"),u=e(require("../libs/co/we-index")),o=e(require("../libs/regenerator-runtime/runtime")),i=a.default.flowType,c=function(){function e(){t(this,e),this.mallInfoList={},this.requestMallIds=[]}return r(e,[{key:"getMallInfos",value:function(e,t,r){var s=this;this.requestMallIds=e;for(var a=[],i=0;i<e.length;++i)this.mallInfoList[e[i]]||a.push(e[i]);if(a.length>0)(0,u.default)(o.default.mark(function e(){var u,i,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u="malls?mall_ids[]="+a.map(function(e){return e}).join("&mall_ids[]="),e.next=4,n.Request.apiRequest("GET",u,null,!0);case 4:i=e.sent,s.cacheMallInfo(i),"function"==typeof t&&(c=s.getCacheMallInfos(s.requestMallIds),"function"==typeof t&&t(c)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),"function"==typeof r&&r();case 12:case"end":return e.stop()}},e,this,[[0,9]])}));else{var c=this.getCacheMallInfos(e);"function"==typeof t&&t(c)}}},{key:"cacheMallInfo",value:function(e){for(var t=0;t<e.length;++t){var r=e[t].mall_id;this.mallInfoList[r]=e[t]}}},{key:"getMallInfo",value:function(e){return this.mallInfoList[e]}},{key:"getCacheMallInfos",value:function(e){for(var t=[],r=0;r<e.length;++r){var s=this.getMallInfo(e[r]);s&&t.push(s)}return t}}]),e}(),l={inRequest:[],requestOrders:u.default.wrap(o.default.mark(function e(t){var r,s,a,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,e.prev=1,!this.inRequest[t]){e.next=4;break}return e.abrupt("return");case 4:return this.inRequest[t]=!0,e.next=7,n.Request.apiRequest("GET",t);case 7:return s=e.sent,a=l.formatordersList(s),delete this.inRequest[t],u={data:s,formatData:a},e.abrupt("return",u);case 14:return e.prev=14,e.t0=e.catch(1),delete this.inRequest[t],console.error(e.t0),e.abrupt("return",null);case 19:case"end":return e.stop()}},e,this,[[1,14]])})),formatordersList:function(e){if(e.total<=0)return[];var t=[],r=e.orders;e.server_time||parseInt(Date.now()/1e3,10);return r.forEach(function(e){var r=e.order_status,a=e.pay_status,u=e.event_type,o=e.shipping_status,i=e.lucky_status>=0?e.lucky_status:null,c=1==e.lucky_result,_=s.default.getOrderCombinedStatus(r,a,o,i,{eventType:u});e.order_status_desc=s.default.getOrderCombinedStatusDescription(_,i,c,e.rate_status),e.goods_price=n.StdFormat.price(e.goods_price,100),e.hasOwnProperty("after_sales_status")&&(e.complaintStatus=l.getComplaintStatus(e),3==e.complaintStatus?e.order_status_desc="退款成功":4==e.complaintStatus||5==e.complaintStatus?e.order_status_desc="退款关闭":0==e.complaintStatus?e.order_status_desc="退款处理中":1==e.complaintStatus&&(e.order_status_desc="退款中")),t.push(e)}),t},getComplaintStatus:function(e){switch(e.after_sales_status){case i.COMPLAINT_NULL_M1:return-1;case i.COMPLAINT_INIT_0:case i.COMPLAINT_SALES_DEALING_1:case i.COMPLAINT_SERVICE_INIT_2:case i.COMPLAINT_SERVICE_DEALING_3:case i.COMPLAINT_WAIT_SALES_SEND_COMFIRM_11:return 0;case i.COMPLAINT_REFUNDING_4:return 1;case i.COMPLAINT_REFUNDED_SUCC_5:return 3;case i.COMPLAINT_CANCELED_6:case i.COMPLAINT_FAILED_7:case i.COMPLAINT_FAIL_EXPIRE_13:return 4;case i.COMPLAINT_END_8:return 2;case i.COMPLAINT_WAIT_USER_DEAL_9:case i.COMPLAINT_WAIT_USER_SEND_10:return 0;case i.COMPLAINT_FAIL_12:return 5}return 2}},_=new c;exports.CustomServiceController=_,exports.SelfService=l; 
 			}); 
		define("controller/formid_controller.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("../common/request")),t=e(require("../configs/api")),a=(e(require("../storage/user_storage")),e(require("../storage/ram_manager"))),o=e(require("../common/user")),u=e(require("../common/object_util")),n=e(require("../libs/co/we-index")),s=(e(require("../libs/es6-promise.min")),e(require("../libs/regenerator-runtime/runtime"))),i={upload:n.default.wrap(s.default.mark(function e(a,n,i){var c,d,p;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=o.default.getUserLocalInfo()||{},d=c.openId,a=u.default.assign(a,{open_id:d}),e.next=5,r.default.apiRequest("POST",t.default.uploadTemplate,a,!1,{needGZToken:!0,forceUseApiGZ:!0});case 5:(p=e.sent).success?"function"==typeof n&&n(p):"function"==typeof i&&i(p),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),"function"==typeof i&&i(e.t0),console.error(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,9]])})),uploadFormIdToSH:function(e,r){if(o.default.hasAccessToken())this.uploadFormIdToSHWithUserId(e,r);else{var t=a.default.openId;t&&this.uploadFormIdToSHWithOpenId(t,e,!0)}},uploadFormIdToSHWithUserId:n.default.wrap(s.default.mark(function e(a,o){var u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.default.apiRequest("POST",t.default.setFormId,{form_id:a,market:o});case 3:return u=e.sent,e.abrupt("return",u);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])})),uploadFormIdToSHWithOpenId:n.default.wrap(s.default.mark(function e(a,o,u){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.default.apiRequest("POST",t.default.setRefuseFormId,{form_id:o,open_id_string:a,market:u},!0);case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])})),scene:{common:"0",spikeRemind:"1"}};exports.default=i; 
 			}); 
		define("controller/goods_bottom_bar.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});e(require("../common/std_format"));var t=e(require("../common/time_util")),r=e(require("../configs/app_config")),i=e(require("../constants/groups")),o={default:"更多￥0.01抢好货",freeTrial:"更多￥0.01抢好货"},s={default:"待公布抽奖结果",freeTrial:"免费试用活动已结束"},a=function(e,t){for(var r=(t=t||2)-(e=(e||"").toString()).length,i=0;i<r;i++)e="0"+e;return e},u=function(e,r,i){var o=[];if(e>=r)return o;var s=t.default.getTimeMaterialFromTimePoint(e),u=t.default.getTimeMaterialFromTimePoint(r),l=[s.year,a(s.month),a(s.date)].join(""),n=[u.year,a(u.month),a(u.date)].join("");return l===n?r-e>=180&&(o[0]=[u.hours,a(u.minutes)].join(":")):o[0]=n-l==1?"明日 "+[u.hours,a(u.minutes)].join(":"):u.month+"月"+u.date+"日 "+[u.hours,a(u.minutes)].join(":"),o[1]=i,o};exports.default=function(e,t){var a=r.default.logo,l=(t=t||{}).status,n=t.group_role,p=t.show_sku_selector,m={goodsId:e.goodsId,goodsName:e.goodsName,thumbUrl:e.thumbUrl,normalPrice:e.minOnsaleNormalPrice,groupPrice:e.minOnsaleGroupPrice,totalPrice:e.groupTypes?e.groupTypes[1].totalPrice:"",soldQuantity:e.sales+"",customerNumber:e.groupTypes?e.groupTypes[1].requireNum:"",guestAvatar:a,guestName:"游客",luckyId:e.luckyId,luckyStatus:e.luckyStatus,isOnSale:!1,isFreeTrial:!1,isLottery:!1,spikeComing:!1,lotteryComing:!1,resultOn:"",resultLabel:"",lotteryWaitingLabel:"",eventComingLabel:"",canContact:!1,hasFreeCoupons:!1,hasCaptainCoupons:!1,hasAssociatedGroup:!1,isCapitalGift:!1,isCapitalGiftLottery:!1,isSpike:!1,isSuperSpike:!1,groupbuyDesc:"",inGroup:!1,showSkuSelector:!1,hasLocalGroup:e.hasLocalGroup?"1":"0",eventType:e.eventType};if(m.isOnSale=e.isOnSale,m.isFreeTrial=e.isFreeTrial,m.isLottery=e.isLottery||e.isCapitalGiftLottery,m.isSpike=e.isSpike,m.isSuperSpike=e.isSuperSpike,m.isCapitalGift=e.isCapitalGift,m.isCapitalGiftLottery=e.isCapitalGiftLottery,(e.isSpike||e.isSuperSpike)&&e.eventComing&&(m.spikeComing=!0,e.groupTypes&&e.groupTypes[1]))if(e.groupTypes[1].startTime-e.serverTime>177){var g=e.reminded?"开抢 已设置提醒":"提醒我";m.eventComingLabel=u(e.serverTime,e.groupTypes[1].startTime,g)}else m.eventComingLabel=[];return(m.isLottery||m.isFreeTrial)&&e.eventComing&&(m.lotteryComing=!0,m.eventComingLabel=u(e.serverTime,e.luckyStartTime,"开团购买")),e.isGroupFree&&e.freeCoupon&&e.freeCoupon.length>0&&(m.hasFreeCoupons=!0),e.isTZYY&&(m.hasCaptainCoupons=!0),e.isFreeTrial?(m.resultLabel=o.freeTrial,m.lotteryWaitingLabel=s.freeTrial):(m.resultLabel=o.default,m.lotteryWaitingLabel=s.default),(m.isFreeTrial||m.isLottery)&&e.luckyEndTime<e.serverTime&&(2===e.luckyStatus||3===e.luckyStatus?m.resultOn="on":m.resultOn="waiting"),m.groupbuyDesc="开团购买",e.isFreeTrial?m.groupbuyDesc="开团购买":e.isCapitalGift||e.isCapitalGiftLottery?m.groupbuyDesc="开团送礼":m.groupbuyDesc="开团购买",l==i.default.GroupStatus.OnGoing?(m.hasAssociatedGroup=!0,n==i.default.GroupRole.Member||n==i.default.GroupRole.Lead?(m.inGroup=!0,m.groupRoleDesc="邀请好友参团"):(m.groupRoleDesc="立即参团",m.isOnSale&&(m.showSkuSelector=!0))):(m.hasAssociatedGroup=!1,l!=i.default.GroupStatus.Success&&l!=i.default.GroupStatus.Failed&&"1"!==p||!m.isOnSale||"on"==m.resultOn||"waiting"==m.resultOn||(m.showSkuSelector=!0)),m}; 
 			}); 
		define("controller/group.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("../configs/api")),t=e(require("../common/request")),u=(e(require("../models/group_proxy")),e(require("../common/data_util"))),a=e(require("../libs/co/we-index")),n=e(require("../libs/regenerator-runtime/runtime")),s={loadLocalGroups:a.default.wrap(n.default.mark(function e(a,s,o){var i,l,c,d,p;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((a=a||[]).length<=0)){e.next=3;break}return e.abrupt("return");case 3:if(e.prev=3,u.default.isArray(a)&&!(a.length<=0)){e.next=6;break}return e.abrupt("return");case 6:return i=t.default.requestDataWithUrl("POST",r.default.goodsLocalGroups,{goods_ids:a},!0),e.next=9,t.default.runSecondaryRequestForPage(i,o);case 9:l=e.sent,c=s||{};for(d in l)l.hasOwnProperty(d)&&(isNaN(parseInt(d,10))||((p=l[d]).list=p.list.reverse(),c[d]=p));return e.abrupt("return",c);case 15:e.prev=15,e.t0=e.catch(3),console.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[3,15]])}))};exports.default=s; 
 			}); 
		define("controller/order_checkout.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("../configs/api")),o=e(require("../common/data_util")),d=(e(require("../common/util")),e(require("../common/url_util"))),u=e(require("../common/request")),n=require("../common/index"),a=e(require("../common/payment")),t=e(require("../configs/app_config")),i=e(require("../constants/payment")),p=e(require("../storage/ram_manager")),s=e(require("../configs/request_errors")),_=require("../common/message"),g={doPay:function(e,r){e&&a.default.pay(e,function(){_.Message.emit(r,{orderSn:e})},function(o){_.Message.emit(r,{errorCode:o.errorCode,errorMsg:o.errorMsg,orderSn:e})},function(o){i.default.isCancelPay(o.errMsg)&&_.Message.emit(r,{errorCode:"-1",errorMsg:o.errMsg,orderSn:e})})},createOrder:function(e,a){var i=this,g=e.logId||o.default.getLogId(),c=e.addressId,m=e.skuId,f=e.skuNumber||1,l={address_id:c,goods:[{sku_id:m,sku_number:f,goods_id:e.goodsId}],merchant_coupon_id:e.mallCouponId,app_id:t.default.appId};e.platformCouponId&&(l.coupon_id=e.platformCouponId),e.couponNumber&&(l.coupon_number=e.couponNumber),e.groupId&&(l.group_id=e.groupId),e.groupOrderId&&(l.group_order_id=e.groupOrderId),e.phoneNumber&&(l.charge_mobile=e.phoneNumber),e.groupCaptainCoupon&&e.groupCaptainCoupon.couponId>0&&(l.coupon_id=e.groupCaptainCoupon.couponId),e.groupFreeCoupon&&e.groupFreeCoupon.couponId>0&&(l.coupon_id=e.groupFreeCoupon.couponId),e.eventId&&e.eventId>0&&(l.event_id_list=[e.eventId]);var I=r.default.createOrder+"?"+d.default.buildQuery({log_id:g}),C={op:"event",sub_op:"create_order",page_name:"order_checkout",goods_id:e.goodsId,goods_type:e.goodsType,event_type:e.eventType,group_id:e.groupId,goods_number:f,group_num:e.groupNum,sku_id:m,order_amount:parseInt(e.orderAmount,10),auto_group:e.isAutoGroup?"1":"0",log_id:g,app_id:t.default.appId,friend_pay:e.friendPay};p.default.isReadBigSales&&(C.refer_xcx_campaign_d12=1),u.default.apiRequest("POST",I,l).then(function(r){C.group_order_id=r.group_order_id;var o;r.order_sn&&(o=r.order_sn),C.order_sn=o,(0,n.TrackingRecord)(C),o&&(p.default.hasCreatedOrder=!0,p.default.lastOrderSn=o,p.default.hasPaySucess=!1,0==e.finalPrice||e.friendPay?_.Message.emit(a,{orderSn:o}):i.doPay(o,a))},function(e){e&&e.error_code&&s.default.errorInfos[e.error_code]&&(p.default.isOrderForbidden=!0),_.Message.emit(a,{errorCode:e.error_code,errorMsg:e.error_msg})})}};exports.default=g; 
 			}); 
		define("controller/public.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../storage/ram_manager")),r=e(require("../common/request")),a=e(require("../configs/api")),s=e(require("../libs/co/we-index")),u=(e(require("../libs/es6-promise.min")),e(require("../libs/regenerator-runtime/runtime"))),d=e(require("../storage/user_storage"));exports.default={updateLikeGoodsIds:s.default.wrap(u.default.mark(function e(){var s,d;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.default.apiRequest("GET",a.default.likeGoodsIdsList);case 3:return s=e.sent,(d=s.goods_id_list||[]).forEach(function(e){t.default.likeGoodsIds[e]=!0}),t.default.favoriteUpdateTime=s.favorite_goods_update_time||0,e.abrupt("return");case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])})),updateLikeMallsIds:s.default.wrap(u.default.mark(function e(){var s,d;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.default.apiRequest("GET",a.default.likeMallsIdsList);case 3:return s=e.sent,(d=s.mall_id_list||[]).forEach(function(e){t.default.likeMallsIds[e]=!0}),t.default.favoriteMallUpdateTime=s.favorite_mall_update_time||0,e.abrupt("return");case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])})),updateSpikeRemindGoodsIds:s.default.wrap(u.default.mark(function e(){var s;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.default.isSpikeRemindGoodsIdsUpdate=!0,e.prev=1,e.next=4,r.default.apiRequest("POST",a.default.getTemplateRimendGoodsId,{scene:1},!1,{forceUseApiGZ:!0,needGZToken:!0});case 4:return s=e.sent,t.default.spikeRemindGoodsIds=s.data||[],e.abrupt("return");case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}},e,this,[[1,9]])})),updateLikeGoodsMallsIds:function(){null!=d.default.getAccessToken()&&(this.updateLikeGoodsIds(),this.updateLikeMallsIds(),t.default.isFirstFavoritUpdate=!0)}}; 
 			}); 
		define("controller/spike_controller.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../common/index"),a=e(require("../storage/ram_manager")),o=e(require("./formid_controller")),s={setRemind:function(e,t,o){this.isSettingRemind=!1;var s=e.goodsId;e.goodsIndex;!0===o.data||!0===o.success?(this.$showToast("已设提醒，开抢前3分钟自动提醒，请您留意微信消息"),a.default.spikeRemindGoodsIds.push(s.toString()),this.setData(t)):o.error_code&&"2000101"===o.error_code&&this.$showToast("商品即将开抢，请点击商品前往抢购")},goodsRemindSetup:function(e,s,r,i,n){var d=e.detail&&e.detail.formId,c=e.currentTarget&&e.currentTarget.dataset||{},u=c.buttonType,l=c.goodsId,m=s,f=(t.User.getUserLocalInfo()||{}).nickName,g=void 0;switch(u){case"on":r.forwardGoods(e,"btn");break;case"off":return;case"remind":if(!m)return;switch(g=t.DataUtil.accMul(m.startTime,1e3),!0){case g-Date.parse(new Date)<0:return void r.$showToast("商品限时抢购中，请点击商品前往抢购");case g-Date.parse(new Date)<18e4:return void r.$showToast("商品即将开抢，请点击商品前往抢购")}r.$showToast("已设提醒，开抢前3分钟自动提醒，请您留意微信消息");break;case"coming":if(r.isSettingRemind||a.default.spikeRemindGoodsIds.indexOf(l.toString())>=0||!m)return;switch(g=t.DataUtil.accMul(m.startTime,1e3),!0){case g-Date.parse(new Date)<0:return void r.$showToast("商品限时抢购中，请点击商品前往抢购");case g-Date.parse(new Date)<18e4:return void r.$showToast("商品即将开抢，请点击商品前往抢购")}var h={scene:1,form_id:d,template_info:{nick_name:f,goods_id:l,goods_name:m.goodsName,original_price:t.DataUtil.accMul(m.marketPrice,100),discount_price:t.DataUtil.accMul(m.salePrice,100),start_time:g}};r.isSettingRemind=!0,o.default.upload(h,t.Util.bind(this.setRemind,r,m,i),function(){r.$showToast("设置失败，请稍后重试")}),"function"==typeof n&&n()}}};exports.default=s; 
 			}); 
		define("controller/user_controller.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("../common/request")),i=e(require("../storage/user_storage")),n=e(require("../configs/api")),t=(e(require("../libs/co/we-index")),e(require("../libs/es6-promise.min"))),u=(e(require("../libs/regenerator-runtime/runtime")),e(require("../storage/ram_manager"))),a=e(require("../configs/app_config")),o=e(require("../libs/md5.min")),s=e(require("../common/storage_util"));e(require("../common/util"));exports.default={isQuerying:!1,callbackArray:[],reqUserAB:function(){var e=this;if(!this.hasReqUserAB){this.hasReqUserAB=!0;var t=r.default.apiRequest("GET",n.default.userAB);return t.then(function(r){e.hasReqUserAB=!1,i.default.setEgrp(r.egrp)},function(r){e.hasReqUserAB=!1}),t}return null},queryWxOpenId:function(){function e(e){i.callbackArray.length>0&&(i.callbackArray.forEach(function(r){r&&r(e)}),i.callbackArray=[])}var i=this;if(i.isQuerying){var l=void 0,c=void 0;return i.callbackArray.push(function(e){"string"==typeof e&&e?l&&l(e):c&&c("")}),new t.default(function(e,r){l=e,c=r})}return new t.default(function(t,l){u.default.openId||(u.default.openId=s.default.getStorageSync("USER_OPENID_KEY")),u.default.openId?t(u.default.openId):(i.isQuerying=!0,wx.login({complete:function(c){if(c&&c.code){var f=a.default.appSecret+c.code;r.default.apiRequest("POST",n.default.queryOpenId,{code:c.code,app_key:"weapp",sign:(0,o.default)(f)},!0).then(function(r){if(i.isQuerying=!1,r&&r.open_id){var n=r.open_id;s.default.setStorageSync("USER_OPENID_KEY",n),u.default.openId=n,e(n),t(n)}else e(""),l("")},function(r){i.isQuerying=!1,e(""),l("")})}else i.isQuerying=!1,e(""),l("")}}))})}}; 
 			}); 
		define("libs/co/index.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){var r=this,e=f.call(arguments,1);return new Promise(function(o,c){function i(n){var r;try{r=t.next(n)}catch(t){return c(t)}f(r)}function a(n){var r;try{r=t.throw(n)}catch(t){return c(t)}f(r)}function f(t){if(t.done)return o(t.value);var e=n.call(r,t.value);return e&&u(e)?e.then(i,a):a(new TypeError('You may only yield a function, promise, generator, array, or object, but the following object was passed: "'+String(t.value)+'"'))}if("function"==typeof t&&(t=t.apply(r,e)),!t||"function"!=typeof t.next)return o(t);i()})}function n(n){return n?u(n)?n:i(n)||c(n)?t.call(this,n):"function"==typeof n?r.call(this,n):Array.isArray(n)?e.call(this,n):a(n)?o.call(this,n):n:n}function r(t){var n=this;return new Promise(function(r,e){t.call(n,function(t,n){if(t)return e(t);arguments.length>2&&(n=f.call(arguments,1)),r(n)})})}function e(t){return Promise.all(t.map(n,this))}function o(t){for(var r=new t.constructor,e=Object.keys(t),o=[],c=0;c<e.length;c++){var i=e[c],a=n.call(this,t[i]);a&&u(a)?function(t,n){r[n]=void 0,o.push(t.then(function(t){r[n]=t}))}(a,i):r[i]=t[i]}return Promise.all(o).then(function(){return r})}function u(t){return"function"==typeof t.then}function c(t){return"function"==typeof t.next&&"function"==typeof t.throw}function i(t){var n=t.constructor;return!!n&&("GeneratorFunction"===n.name||"GeneratorFunction"===n.displayName||c(n.prototype))}function a(t){return Object==t.constructor}var f=Array.prototype.slice;module.exports=t.default=t.co=t,t.wrap=function(n){function r(){return t.call(this,n.apply(this,arguments))}return r.__generatorFunction__=n,r}; 
 			}); 
		define("libs/co/we-index.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function n(n){var r=this,e=f.call(arguments,1);return new l(function(o,c){function i(t){var r;try{r=n.next(t)}catch(n){return c(n)}f(r)}function a(t){var r;try{r=n.throw(t)}catch(n){return c(n)}f(r)}function f(n){if(n.done)return o(n.value);var e=t.call(r,n.value);return e&&u(e)?e.then(i,a):a(new TypeError('You may only yield a function, promise, generator, array, or object, but the following object was passed: "'+String(n.value)+'"'))}if("function"==typeof n&&(n=n.apply(r,e)),!n||"function"!=typeof n.next)return o(n);i()})}function t(t){return t?u(t)?t:i(t)||c(t)?n.call(this,t):"function"==typeof t?r.call(this,t):Array.isArray(t)?e.call(this,t):a(t)?o.call(this,t):t:t}function r(n){var t=this;return new l(function(r,e){n.call(t,function(n,t){if(n)return e(n);arguments.length>2&&(t=f.call(arguments,1)),r(t)})})}function e(n){return l.all(n.map(t,this))}function o(n){for(var r=new n.constructor,e=Object.keys(n),o=[],c=0;c<e.length;c++){var i=e[c],a=t.call(this,n[i]);a&&u(a)?function(n,t){r[t]=void 0,o.push(n.then(function(n){r[t]=n}))}(a,i):r[i]=n[i]}return l.all(o).then(function(){return r})}function u(n){return"function"==typeof n.then}function c(n){return"function"==typeof n.next&&"function"==typeof n.throw}function i(n){var t=n.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName||c(t.prototype))}function a(n){return Object==n.constructor}var f=Array.prototype.slice,l=require("../es6-promise.min").Promise;module.exports=n.default=n.co=n,n.wrap=function(t){function r(){return n.call(this,t.apply(this,arguments))}return r.__generatorFunction__=t,r}; 
 			}); 
		define("libs/es6-promise.min.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(e,n){"object"==("undefined"==typeof exports?"undefined":t(exports))&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.ES6Promise=n()}(void 0,function(){function e(e){return"function"==typeof e||"object"==(void 0===e?"undefined":t(e))&&null!==e}function n(t){return"function"==typeof t}function r(){return void 0!==D?function(){D(i)}:o()}function o(){var t=setTimeout;return function(){return t(i,1)}}function i(){for(var t=0;t<F;t+=2)(0,G[t])(G[t+1]),G[t]=void 0,G[t+1]=void 0;F=0}function s(t,e){var n=arguments,r=this,o=new this.constructor(c);void 0===o[I]&&x(o);var i=r._state;return i?function(){var t=n[i-1];L(function(){return j(i,o,t,r._result)})}():w(r,o,t,e),o}function u(e){var n=this;if(e&&"object"==(void 0===e?"undefined":t(e))&&e.constructor===n)return e;var r=new n(c);return _(r,e),r}function c(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function a(){return new TypeError("A promises callback cannot return that same promise.")}function l(t){try{return t.then}catch(t){return V.error=t,V}}function h(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function p(t,e,n){L(function(t){var r=!1,o=h(n,e,function(n){r||(r=!0,e!==n?_(t,n):m(t,n))},function(e){r||(r=!0,b(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,b(t,o))},t)}function d(t,e){e._state===Q?m(t,e._result):e._state===R?b(t,e._result):w(e,void 0,function(e){return _(t,e)},function(e){return b(t,e)})}function v(t,e,r){e.constructor===t.constructor&&r===s&&e.constructor.resolve===u?d(t,e):r===V?b(t,V.error):void 0===r?m(t,e):n(r)?p(t,e,r):m(t,e)}function _(t,n){t===n?b(t,f()):e(n)?v(t,n,l(n)):m(t,n)}function y(t){t._onerror&&t._onerror(t._result),g(t)}function m(t,e){t._state===J&&(t._result=e,t._state=Q,0!==t._subscribers.length&&L(g,t))}function b(t,e){t._state===J&&(t._state=R,t._result=e,L(y,t))}function w(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+Q]=n,o[i+R]=r,0===i&&t._state&&L(g,t)}function g(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?j(n,r,o,i):o(i);t._subscribers.length=0}}function A(){this.error=null}function S(t,e){try{return t(e)}catch(t){return X.error=t,X}}function j(t,e,r,o){var i=n(r),s=void 0,u=void 0,c=void 0,f=void 0;if(i){if((s=S(r,o))===X?(f=!0,u=s.error,s=null):c=!0,e===s)return void b(e,a())}else s=o,c=!0;e._state!==J||(i&&c?_(e,s):f?b(e,u):t===Q?m(e,s):t===R&&b(e,s))}function E(t,e){try{e(function(e){_(t,e)},function(e){b(t,e)})}catch(e){b(t,e)}}function T(){return Z++}function x(t){t[I]=Z++,t._state=void 0,t._result=void 0,t._subscribers=[]}function M(t,e){this._instanceConstructor=t,this.promise=new t(c),this.promise[I]||x(this.promise),q(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?m(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&m(this.promise,this._result))):b(this.promise,P())}function P(){return new Error("Array Methods must be provided an Array")}function C(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function O(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function k(t){this[I]=T(),this._result=this._state=void 0,this._subscribers=[],c!==t&&("function"!=typeof t&&C(),this instanceof k?E(this,t):O())}var Y=void 0,q=Y=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},F=0,D=void 0,K=void 0,L=function(t,e){G[F]=t,G[F+1]=e,2===(F+=2)&&(K?K(i):H())},N="undefined"!=typeof window?window:void 0,U=N||{},W=U.MutationObserver||U.WebKitMutationObserver,z="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),B="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,G=new Array(1e3),H=void 0;H=z?function(){return process.nextTick(i)}:W?function(){var t=0,e=new W(i),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():B?function(){var t=new MessageChannel;return t.port1.onmessage=i,function(){return t.port2.postMessage(0)}}():void 0===N&&"function"==typeof require?function(){try{var t=require("vertx");return D=t.runOnLoop||t.runOnContext,r()}catch(t){return o()}}():o();var I=Math.random().toString(36).substring(16),J=void 0,Q=1,R=2,V=new A,X=new A,Z=0;return M.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===J&&n<t;n++)this._eachEntry(e[n],n)},M.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===u){var o=l(t);if(o===s&&t._state!==J)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===k){var i=new n(c);v(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},M.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===J&&(this._remaining--,t===R?b(r,n):this._result[e]=n),0===this._remaining&&m(r,this._result)},M.prototype._willSettleAt=function(t,e){var n=this;w(t,void 0,function(t){return n._settledAt(Q,e,t)},function(t){return n._settledAt(R,e,t)})},k.all=function(t){return new M(this,t).promise},k.race=function(t){var e=this;return new e(q(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})},k.resolve=u,k.reject=function(t){var e=new this(c);return b(e,t),e},k._setScheduler=function(t){K=t},k._setAsap=function(t){L=t},k._asap=L,k.prototype={constructor:k,then:s,catch:function(t){return this.then(null,t)}},k.polyfill=function(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=k},k.Promise=k,k}); 
 			}); 
		define("libs/key_mirror.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.default=function(r){var e,t={};if(!(r instanceof Object)||Array.isArray(r))throw new Error("keyMirror(...): Argument must be an object.");for(e in r)r.hasOwnProperty(e)&&(r[e]?t[e]=r[e]:t[e]=e);return t}; 
 			}); 
		define("libs/md5.min.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(){function Md5(t){if(t)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var e=new ArrayBuffer(68);this.buffer8=new Uint8Array(e),this.blocks=new Uint32Array(e)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=0,this.finalized=this.hashed=!1,this.first=!0}var ERROR="input is invalid type",WINDOW="object"==("undefined"==typeof window?"undefined":_typeof(window)),root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==("undefined"==typeof self?"undefined":_typeof(self)),NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==("undefined"==typeof process?"undefined":_typeof(process))&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module.exports,AMD="function"==typeof define&&define.amd,ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}(root.JS_MD5_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var createOutputMethod=function(t){return function(e){return new Md5(!0).update(e)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Md5},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var r=OUTPUT_TYPES[e];t[r]=createOutputMethod(r)}return t},nodeWrap=function nodeWrap(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(t){if("string"==typeof t)return crypto.createHash("md5").update(t,"utf8").digest("hex");if(null===t||void 0===t)throw ERROR;return t.constructor===ArrayBuffer&&(t=new Uint8Array(t)),Array.isArray(t)||ArrayBuffer.isView(t)||t.constructor===Buffer?crypto.createHash("md5").update(new Buffer(t)).digest("hex"):method(t)};return nodeMethod};Md5.prototype.update=function(t){if(!this.finalized){var e="string"!=typeof t;if(e){if(null===t||void 0===t)throw ERROR;t.constructor===root.ArrayBuffer&&(t=new Uint8Array(t))}var r=t.length;if(e&&("number"!=typeof r||!Array.isArray(t)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(t))))throw ERROR;for(var o,i,s=0,h=this.blocks,f=this.buffer8;r>s;){if(this.hashed&&(this.hashed=!1,h[0]=h[16],h[16]=h[1]=h[2]=h[3]=h[4]=h[5]=h[6]=h[7]=h[8]=h[9]=h[10]=h[11]=h[12]=h[13]=h[14]=h[15]=0),e)if(ARRAY_BUFFER)for(i=this.start;r>s&&64>i;++s)f[i++]=t[s];else for(i=this.start;r>s&&64>i;++s)h[i>>2]|=t[s]<<SHIFT[3&i++];else if(ARRAY_BUFFER)for(i=this.start;r>s&&64>i;++s)128>(o=t.charCodeAt(s))?f[i++]=o:2048>o?(f[i++]=192|o>>6,f[i++]=128|63&o):55296>o||o>=57344?(f[i++]=224|o>>12,f[i++]=128|o>>6&63,f[i++]=128|63&o):(o=65536+((1023&o)<<10|1023&t.charCodeAt(++s)),f[i++]=240|o>>18,f[i++]=128|o>>12&63,f[i++]=128|o>>6&63,f[i++]=128|63&o);else for(i=this.start;r>s&&64>i;++s)128>(o=t.charCodeAt(s))?h[i>>2]|=o<<SHIFT[3&i++]:2048>o?(h[i>>2]|=(192|o>>6)<<SHIFT[3&i++],h[i>>2]|=(128|63&o)<<SHIFT[3&i++]):55296>o||o>=57344?(h[i>>2]|=(224|o>>12)<<SHIFT[3&i++],h[i>>2]|=(128|o>>6&63)<<SHIFT[3&i++],h[i>>2]|=(128|63&o)<<SHIFT[3&i++]):(o=65536+((1023&o)<<10|1023&t.charCodeAt(++s)),h[i>>2]|=(240|o>>18)<<SHIFT[3&i++],h[i>>2]|=(128|o>>12&63)<<SHIFT[3&i++],h[i>>2]|=(128|o>>6&63)<<SHIFT[3&i++],h[i>>2]|=(128|63&o)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[e>>2]|=EXTRA[3&e],e>=56&&(this.hashed||this.hash(),t[0]=t[16],t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.bytes<<3,this.hash()}},Md5.prototype.hash=function(){var t,e,r,o,i,s,h=this.blocks;this.first?(t=h[0]-680876937,t=(t<<7|t>>>25)-271733879<<0,o=(-1732584194^2004318071&t)+h[1]-117830708,o=(o<<12|o>>>20)+t<<0,r=(-271733879^o&(-271733879^t))+h[2]-1126478375,r=(r<<17|r>>>15)+o<<0,e=(t^r&(o^t))+h[3]-1316259209,e=(e<<22|e>>>10)+r<<0):(t=this.h0,e=this.h1,r=this.h2,o=this.h3,t+=(o^e&(r^o))+h[0]-680876936,t=(t<<7|t>>>25)+e<<0,o+=(r^t&(e^r))+h[1]-389564586,o=(o<<12|o>>>20)+t<<0,r+=(e^o&(t^e))+h[2]+606105819,r=(r<<17|r>>>15)+o<<0,e+=(t^r&(o^t))+h[3]-1044525330,e=(e<<22|e>>>10)+r<<0),e=((e+=((t=((t+=(o^e&(r^o))+h[4]-176418897)<<7|t>>>25)+e<<0)^(r=((r+=(e^(o=((o+=(r^t&(e^r))+h[5]+1200080426)<<12|o>>>20)+t<<0)&(t^e))+h[6]-1473231341)<<17|r>>>15)+o<<0)&(o^t))+h[7]-45705983)<<22|e>>>10)+r<<0,e=((e+=((t=((t+=(o^e&(r^o))+h[8]+1770035416)<<7|t>>>25)+e<<0)^(r=((r+=(e^(o=((o+=(r^t&(e^r))+h[9]-1958414417)<<12|o>>>20)+t<<0)&(t^e))+h[10]-42063)<<17|r>>>15)+o<<0)&(o^t))+h[11]-1990404162)<<22|e>>>10)+r<<0,e=((e+=((t=((t+=(o^e&(r^o))+h[12]+1804603682)<<7|t>>>25)+e<<0)^(r=((r+=(e^(o=((o+=(r^t&(e^r))+h[13]-40341101)<<12|o>>>20)+t<<0)&(t^e))+h[14]-1502002290)<<17|r>>>15)+o<<0)&(o^t))+h[15]+1236535329)<<22|e>>>10)+r<<0,e=((e+=((o=((o+=(e^r&((t=((t+=(r^o&(e^r))+h[1]-165796510)<<5|t>>>27)+e<<0)^e))+h[6]-1069501632)<<9|o>>>23)+t<<0)^t&((r=((r+=(t^e&(o^t))+h[11]+643717713)<<14|r>>>18)+o<<0)^o))+h[0]-373897302)<<20|e>>>12)+r<<0,e=((e+=((o=((o+=(e^r&((t=((t+=(r^o&(e^r))+h[5]-701558691)<<5|t>>>27)+e<<0)^e))+h[10]+38016083)<<9|o>>>23)+t<<0)^t&((r=((r+=(t^e&(o^t))+h[15]-660478335)<<14|r>>>18)+o<<0)^o))+h[4]-405537848)<<20|e>>>12)+r<<0,e=((e+=((o=((o+=(e^r&((t=((t+=(r^o&(e^r))+h[9]+568446438)<<5|t>>>27)+e<<0)^e))+h[14]-1019803690)<<9|o>>>23)+t<<0)^t&((r=((r+=(t^e&(o^t))+h[3]-187363961)<<14|r>>>18)+o<<0)^o))+h[8]+1163531501)<<20|e>>>12)+r<<0,e=((e+=((o=((o+=(e^r&((t=((t+=(r^o&(e^r))+h[13]-1444681467)<<5|t>>>27)+e<<0)^e))+h[2]-51403784)<<9|o>>>23)+t<<0)^t&((r=((r+=(t^e&(o^t))+h[7]+1735328473)<<14|r>>>18)+o<<0)^o))+h[12]-1926607734)<<20|e>>>12)+r<<0,e=((e+=((s=(o=((o+=((i=e^r)^(t=((t+=(i^o)+h[5]-378558)<<4|t>>>28)+e<<0))+h[8]-2022574463)<<11|o>>>21)+t<<0)^t)^(r=((r+=(s^e)+h[11]+1839030562)<<16|r>>>16)+o<<0))+h[14]-35309556)<<23|e>>>9)+r<<0,e=((e+=((s=(o=((o+=((i=e^r)^(t=((t+=(i^o)+h[1]-1530992060)<<4|t>>>28)+e<<0))+h[4]+1272893353)<<11|o>>>21)+t<<0)^t)^(r=((r+=(s^e)+h[7]-155497632)<<16|r>>>16)+o<<0))+h[10]-1094730640)<<23|e>>>9)+r<<0,e=((e+=((s=(o=((o+=((i=e^r)^(t=((t+=(i^o)+h[13]+681279174)<<4|t>>>28)+e<<0))+h[0]-358537222)<<11|o>>>21)+t<<0)^t)^(r=((r+=(s^e)+h[3]-722521979)<<16|r>>>16)+o<<0))+h[6]+76029189)<<23|e>>>9)+r<<0,e=((e+=((s=(o=((o+=((i=e^r)^(t=((t+=(i^o)+h[9]-640364487)<<4|t>>>28)+e<<0))+h[12]-421815835)<<11|o>>>21)+t<<0)^t)^(r=((r+=(s^e)+h[15]+530742520)<<16|r>>>16)+o<<0))+h[2]-995338651)<<23|e>>>9)+r<<0,e=((e+=((o=((o+=(e^((t=((t+=(r^(e|~o))+h[0]-198630844)<<6|t>>>26)+e<<0)|~r))+h[7]+1126891415)<<10|o>>>22)+t<<0)^((r=((r+=(t^(o|~e))+h[14]-1416354905)<<15|r>>>17)+o<<0)|~t))+h[5]-57434055)<<21|e>>>11)+r<<0,e=((e+=((o=((o+=(e^((t=((t+=(r^(e|~o))+h[12]+1700485571)<<6|t>>>26)+e<<0)|~r))+h[3]-1894986606)<<10|o>>>22)+t<<0)^((r=((r+=(t^(o|~e))+h[10]-1051523)<<15|r>>>17)+o<<0)|~t))+h[1]-2054922799)<<21|e>>>11)+r<<0,e=((e+=((o=((o+=(e^((t=((t+=(r^(e|~o))+h[8]+1873313359)<<6|t>>>26)+e<<0)|~r))+h[15]-30611744)<<10|o>>>22)+t<<0)^((r=((r+=(t^(o|~e))+h[6]-1560198380)<<15|r>>>17)+o<<0)|~t))+h[13]+1309151649)<<21|e>>>11)+r<<0,e=((e+=((o=((o+=(e^((t=((t+=(r^(e|~o))+h[4]-145523070)<<6|t>>>26)+e<<0)|~r))+h[11]-1120210379)<<10|o>>>22)+t<<0)^((r=((r+=(t^(o|~e))+h[2]+718787259)<<15|r>>>17)+o<<0)|~t))+h[9]-343485551)<<21|e>>>11)+r<<0,this.first?(this.h0=t+1732584193<<0,this.h1=e-271733879<<0,this.h2=r-1732584194<<0,this.h3=o+271733878<<0,this.first=!1):(this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+r<<0,this.h3=this.h3+o<<0)},Md5.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,o=this.h3;return HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,o=this.h3;return[255&t,t>>8&255,t>>16&255,t>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255,255&o,o>>8&255,o>>16&255,o>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(16),e=new Uint32Array(t);return e[0]=this.h0,e[1]=this.h1,e[2]=this.h2,e[3]=this.h3,t},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var t,e,r,o="",i=this.array(),s=0;15>s;)t=i[s++],e=i[s++],r=i[s++],o+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[63&(t<<4|e>>>4)]+BASE64_ENCODE_CHAR[63&(e<<2|r>>>6)]+BASE64_ENCODE_CHAR[63&r];return t=i[s],o+=BASE64_ENCODE_CHAR[t>>>2]+BASE64_ENCODE_CHAR[t<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&define(function(){return exports}))}(); 
 			}); 
		define("libs/regenerator-runtime/runtime.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(e){function r(t,e,r,n){var i=e&&e.prototype instanceof o?e:o,a=Object.create(i.prototype),c=new h(n||[]);return a._invoke=f(t,r,c),a}function n(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function i(){}function a(){}function c(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function u(e){function r(o,i,a,c){var u=n(e[o],e,i);if("throw"!==u.type){var f=u.arg,l=f.value;return l&&"object"===(void 0===l?"undefined":t(l))&&g.call(l,"__await")?Promise.resolve(l.__await).then(function(t){r("next",t,a,c)},function(t){r("throw",t,a,c)}):Promise.resolve(l).then(function(t){f.value=t,a(f)},c)}c(u.arg)}"object"===("undefined"==typeof process?"undefined":t(process))&&process.domain&&(r=process.domain.bind(r));var o;this._invoke=function(t,e){function n(){return new Promise(function(n,o){r(t,e,n,o)})}return o=o?o.then(n,n):n()}}function f(t,e,r){var o=E;return function(i,a){if(o===_)throw new Error("Generator is already running");if(o===O){if("throw"===i)throw a;return y()}for(;;){var c=r.delegate;if(c){if("return"===i||"throw"===i&&c.iterator[i]===d){r.delegate=null;var u=c.iterator.return;if(u&&"throw"===(f=n(u,c.iterator,a)).type){i="throw",a=f.arg;continue}if("return"===i)continue}if("throw"===(f=n(c.iterator[i],c.iterator,a)).type){r.delegate=null,i="throw",a=f.arg;continue}if(i="next",a=d,!(l=f.arg).done)return o=j,l;r[c.resultName]=l.value,r.next=c.nextLoc,r.delegate=null}if("next"===i)r.sent=r._sent=a;else if("throw"===i){if(o===E)throw o=O,a;r.dispatchException(a)&&(i="next",a=d)}else"return"===i&&r.abrupt("return",a);o=_;var f=n(t,e,r);if("normal"===f.type){o=r.done?O:j;var l={value:f.arg,done:r.done};if(f.arg!==S)return l;r.delegate&&"next"===i&&(a=d)}else"throw"===f.type&&(o=O,i="throw",a=f.arg)}}}function l(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function s(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function h(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(l,this),this.reset(!0)}function p(t){if(t){var e=t[m];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(g.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=d,e.done=!0,e};return n.next=n}}return{next:y}}function y(){return{value:d,done:!0}}var d,v=Object.prototype,g=v.hasOwnProperty,w="function"==typeof Symbol?Symbol:{},m=w.iterator||"@@iterator",b=w.toStringTag||"@@toStringTag",L="object"===("undefined"==typeof module?"undefined":t(module)),x=e.regeneratorRuntime;if(x)L&&(module.exports=x);else{(x=e.regeneratorRuntime=L?module.exports:{}).wrap=r;var E="suspendedStart",j="suspendedYield",_="executing",O="completed",S={},k={};k[m]=function(){return this};var G=Object.getPrototypeOf,N=G&&G(G(p([])));N&&N!==v&&g.call(N,m)&&(k=N);var P=a.prototype=o.prototype=Object.create(k);i.prototype=P.constructor=a,a.constructor=i,a[b]=i.displayName="GeneratorFunction",x.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===i||"GeneratorFunction"===(e.displayName||e.name))},x.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,b in t||(t[b]="GeneratorFunction")),t.prototype=Object.create(P),t},x.awrap=function(t){return{__await:t}},c(u.prototype),x.AsyncIterator=u,x.async=function(t,e,n,o){var i=new u(r(t,e,n,o));return x.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},c(P),P[b]="Generator",P.toString=function(){return"[object Generator]"},x.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},x.values=p,h.prototype={constructor:h,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=d,this.done=!1,this.delegate=null,this.tryEntries.forEach(s),!t)for(var e in this)"t"===e.charAt(0)&&g.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=d)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){function e(e,n){return i.type="throw",i.arg=t,r.next=e,!!n}if(this.done)throw t;for(var r=this,n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var a=g.call(o,"catchLoc"),c=g.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&g.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?this.next=o.finallyLoc:this.complete(i),S},complete:function(t,e){if("throw"===t.type)throw t.arg;"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&e&&(this.next=e)},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),s(r),S}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;s(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:p(t),resultName:e,nextLoc:r},S}}}}("object"===("undefined"==typeof global?"undefined":t(global))?global:"object"===("undefined"==typeof window?"undefined":t(window))?window:"object"===("undefined"==typeof self?"undefined":t(self))?self:"object"===t(void 0)?void 0:{}); 
 			}); 
		define("models/address.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function i(i){return i&&i.__esModule?i:{default:i}}function t(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});i(require("../common/data_util"));var s=i(require("../constants/addresses"));exports.default=function i(e){t(this,i),e&&(this.address=e.address,this.addressId=e.address_id,this.city=e.city,this.cityId=e.city_id,this.district=e.district,this.districtId=e.district_id,this.isDefaultAddress=e.is_default.toString()===s.default.AddressClass.Default,this.mobile=e.mobile,this.name=e.name,this.province=e.province,this.provinceId=e.province_id,this.uid=e.uid)}; 
 			}); 
		define("models/format/coupons_format.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(e,l,c){var y=[];if(!a.default.isArray(e))return y;for(var m=0;m<e.length;m++){var C=e[m],T=parseInt(C.discount,10),v=parseInt(C.min_amount,10),h=parseInt(C.type,10),A=parseInt(C.display_type,10)||0,S=1===parseInt(C.is_invalid,10),N=parseInt(C.start_time,10),M=parseInt(C.end_time,10),D=parseInt(C.mall_id,10),B=C.mall_name||"",F=C.link_url||"",I=parseInt(C.count,10)||1,U={key:C.coupon_id.toString(),expiredTime:M,startTime:t.default.formatTime(new Date(1e3*N),"yyyy.M.d"),endTime:t.default.formatTime(new Date(1e3*M),"yyyy.M.d"),discount:o.default.price(T,100),batchName:_(C.batch_name)||"",minAmount:o.default.price(v,100),orderSN:C.order_sn||"",type:h,isFree:h===p.default.CouponBatchType.GroupFreeCoupon,isMall:h===p.default.CouponBatchType.MallCoupon,isCategory:A===p.default.CouponDisplayType.Category,isApp:A===p.default.CouponDisplayType.App||A===p.default.CouponDisplayType.AppMobile,goodsType:C.goods_type,mallId:D,mallName:B,scope:C.rules_desc||s.Unlimited,linkUrl:F,count:I,receiveTime:C.receive_time};if(U.isMobileFare=h===p.default.CouponBatchType.CategoryCoupon&&U.goodsType.toString()==u.default.GoodsType.MOBILE_FARE,U.isMobileFare&&(U.isCategory=!0),f(U.goodsType)?U.scope=s.VirtualGoods:b(U.goodsType)&&(U.scope=s.Overseas),S||U.orderSN||1==l&&I>0?(U.style=n.Used,U.couponStatus=g.Used):M<c?(U.style=n.Out,U.couponStatus=g.Expired):N>c?(U.style=n.Available,U.couponStatus=g.Frozen,U.isFrozen=!0):(U.style=n.Available,T===v||h===p.default.CouponBatchType.GoodsCoupon?U.couponStatus=g.Cash:U.couponStatus=g.Bound),U.style===l){if(U.style===n.Out){if(U.couponStatus===g.Used&&!S&&!U.orderSN)continue;if(U.couponStatus===g.Expired&&M>=c)continue}if(U.isMall?(U.couponTypeName=i.Mall,U.scope=s.Mall+B):U.isCategory?(U.couponTypeName=i.Category,U.isMobileFare&&(U.scope=s.MobileFare)):U.isApp?U.couponTypeName=i.App:A==p.default.CouponDisplayType.Shuang11&&U.count>0?(U.couponTypeName=i.Shuang11,0==l?(U.couponTypeName="持有"+U.count+"张",U.labelStyle="coupon_label_super_avi"):1==l&&(U.couponTypeName="已使用"+U.count+"张",U.labelStyle="coupon_label_super_used")):A==p.default.CouponDisplayType.Anniversary?U.couponTypeName=i.Anniversary:T===v||h===p.default.CouponBatchType.GoodsCoupon?(U.couponTypeName=i.Cash,U.batchName=_(C.batch_name,"cash",T)||""):U.couponTypeName=i.Bound,U.bgUrl=r.CouponBgNew,U.style===n.Out||U.style===n.Used?(U.bgColor=d.Out,U.isOut=!0):U.isMall?U.bgColor=d.Mall:U.isCategory?U.bgColor=d.Bound:U.isApp?U.bgColor=d.App:U.couponTypeName===i.Bound||U.couponTypeName===i.Cash||U.couponTypeName===i.Anniversary?U.bgColor=d.Bound:A==p.default.CouponDisplayType.Shuang11?U.bgColor=d.Superimposed:U.bgColor=d.Out,h!=p.default.CouponBatchType.superimposedCoupon&&A!=p.default.CouponDisplayType.Shuang11||(U.isFrozen=!1,!U.isOut&&U.count>1?U.bgUrl=r.Superimposed:U.isOut&&U.count>1&&(U.bgUrl=r.SuperimposedUsed)),U.scopeClass=U.isOut||U.isFrozen?"scope-out":"scope-available",0==l){t.default.formatTime(U.receiveTime,"yyyy/MM/dd")==t.default.formatTime(c,"yyyy/MM/dd")&&(U.labelStyle="coupon_label_today_got");var O=Math.ceil((M-c)/86400);O>0&&O<=3&&(U.leftDays=O,U.labelStyle="coupon_label_to_expired"),N>c&&(U.labelStyle="coupon_label_not_use")}y.push(U)}}return y};var o=e(require("../../common/std_format")),a=e(require("../../common/data_util")),t=e(require("../../common/time_util")),p=e(require("../../constants/coupons")),u=e(require("../../constants/goods")),l=e(require("../../common/image_util")),s={None:"",Unlimited:"全场通用(除话费等特殊商品)",Cash:"仅限指定商品",Free:"点击选择团免商品",Mall:"仅限",MobileFare:"仅限话费商品使用",Overseas:"仅限海淘商品（包括进口、直供、直邮商品）",VirtualGoods:"仅限话费流量使用"},n={Available:0,Used:1,Out:2},i={Cash:"现金券",Bound:"通用券",Category:"类目券",Free:"团免券",Mall:"店铺券",App:"App专享券",Anniversary:"周年庆",Shuang11:"双旦礼"},r={BoundAvailable:l.default.getCDNImgURL("coupons/v2/bound_available_bg.png"),BoundExpired:l.default.getCDNImgURL("coupons/v2/bound_expired_bg.png"),CategoryAvailable:l.default.getCDNImgURL("coupons/v2/category_available_bg.png"),CategoryExpired:l.default.getCDNImgURL("coupons/v2/category_expired_bg.png"),FreeAvailable:l.default.getCDNImgURL("coupons/v2/free_available_bg.png"),FreeExpired:l.default.getCDNImgURL("coupons/v2/free_expired_bg.png"),MallAvailable:l.default.getCDNImgURL("coupons/v2/mall_available_bg.png"),MallExpired:l.default.getCDNImgURL("coupons/v2/mall_expired_bg.png"),AppAvailable:l.default.getCDNImgURL("coupons/v2/app_available_bg.png"),AppExpired:l.default.getCDNImgURL("coupons/v2/app_expired_bg.png"),Superimposed:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/coupon/superimposed_avi_bg.png",SuperimposedUsed:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/coupon/superimposed_used_bg.png",CouponBgNew:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/coupon/coupon__bg_new.png"},d={Bound:"#FF7472",Category:"#5ccaf7",Free:"#FFAB5B",Mall:"#FFAB5B",App:"#68D162",Out:"#D2D2D2",Superimposed:"#E02E24"},c=[u.default.GoodsType.IMPORTS,u.default.GoodsType.OVERSEAS_TRANSSHIP,u.default.GoodsType.OVERSEAS_DM],y=[u.default.GoodsType.MOBILE_DATA,u.default.GoodsType.MOBILE_FARE,u.default.GoodsType.TRADE_COUPON],g={Available:{label:"立即使用",class:"status-available",stamp:""},Cash:{label:"立即使用",class:"status-cash",stamp:""},Bound:{label:"立即使用",class:"status-bound",stamp:""},Frozen:{label:"未激活",class:"status-frozen",stamp:"stamp-frozen"},Used:{label:"已使用",class:"status-used",stamp:"stamp-used"},Expired:{label:"已过期",class:"status-expired",stamp:"stamp-expired"}},m=function(e,o){if(!a.default.isArray(e)||!a.default.isArray(o))return!1;if(0===e.length||0===o.length||e.length<o.length)return!1;for(var t=0;t<o.length;t++)if(-1===e.indexOf(o[t]))return!1;return!0},f=function(e){return m(y,e)},b=function(e){return m(c,e)},_=function(e,a,t){var p=void 0,u=e.length;return u>3&&"优惠券"===e.substring(u-3)&&(p=e.substring(0,u-3)),a&&"cash"===a&&t&&(p="满"+o.default.price(t+1,100)+"减"+o.default.price(t,100)),void 0===p?e:p}; 
 			}); 
		define("models/format/grid_item_goods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../../common/std_format")),a=e(require("../../common/image_util"));exports.default={formatData:function(e){var r=e.group||{},o=parseInt(r.customer_num||e.customer_num||0),i=r.price||e.price,s={key:"goods-"+e.goods_id,goodsId:e.goods_id,isApp:e.is_app,imgUrl:a.default.cdnCompress(e.hd_thumb_url||e.thumb_url),goodsName:e.goods_name,groupDesc:o+"人团",price:t.default.price(i,100),marketPrice:t.default.price(e.market_price,100),soldQuantity:t.default.sales(e.sales||e.cnt),customerNum:parseInt(o,10),nationalFlag:e.country?a.default.getCDNImgURL("nation/rect/"+e.country+".png"):"",tag:parseInt(e.tag,10),icon:e.icon,eventType:e.event_type},c=["spike","economical-brand","go-shopping","good-fruit","brand-clean"];return!isNaN(s.tag)&&s.tag>=0&&s.tag<c.length&&(s.activityFlagClass="activity-flag activity-flag-gap activity-flag-"+c[s.tag]),s.allowance=t.default.getDiscount(s.price,s.marketPrice),s.transData={goodsId:s.goodsId,preGroupPrice:parseInt(i,10),preSinglePrice:parseInt(e.normal_price,10),preMarketPrice:parseInt(e.market_price,10),goodsName:s.goodsName,customerNum:s.customerNum,ad:e.ad,p_rec:e.p_rec,p_search:e.p_search},s}}; 
 			}); 
		define("models/format/group_order_goods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e&&e.__esModule?e:{default:e}}(require("../../common/std_format")),s={formatData:function(s){var t=s.goods,r=s.isOnsale,i=s.isDeleted;r=r&&"0"!==t.is_onsale;var u=function(e){if(!e)return{};var s={};return Object.keys(e).map(function(t){s[t]={skuId:e[t].id,quantity:parseInt(e[t].quantity,10)||0}}),s}(t.skus),o=!1;return o=!!(t.skus&&t.skus[0]&&t.skus[0].id)&&Object.keys(u).some(function(e){var s=u[e];if(s.quantity>0)return s}),{actTag:parseInt(t.act_tag,10),goodsId:t.goods_id,goodsName:t.goods_name,goodsNumber:t.goods_number,price:e.default.price(t.goods_price,100),thumbUrl:t.hd_thumb_url||t.thumb_url,isOnSale:r&&o,isDeleted:i,goodsType:t.goods_type,skus:u,isRefundable:"1"===t.is_refundable,shareDesc:t.share_desc||"",imageUrl:t.image_url,listDesc:t.list_desc,eventType:parseInt(t.event_type,10),allowedRegions:t.allowed_regions||"",luckyDraw:t.lucky_draw||{},sales:t.sales,singlePrice:e.default.price(t.single_price,100),gapPrice:e.default.price(t.market_price-t.goods_price,100),country:t.country,shipmentLimitHour:t.shipment_limit_second?t.shipment_limit_second/3600:0,quickRefund:"1"===t.quick_refund}}};exports.default=s; 
 			}); 
		define("models/format/index_goods_item.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("../../common/std_format")),t=e(require("../../common/image_util")),a=e(require("../../constants/groups")),n={formatData:function(e){var n={};return n.goodsId=e.goods_id||"",n.normalPrice=r.default.price(parseInt(e.normal_price||0),100),n.shortName=e.short_name||"",n.eventType=parseInt(e.event_type||"0"),n.isApp=parseInt(e.is_app||"0"),n.goodsName=e.goods_name||"",n.imgUrl=t.default.cdnCompress(e.image_url||""),n.customerNum=e.group.customer_num,n.price=r.default.price(parseInt(e.group.price||0),100),n.isFreeTrial=n.eventType===a.default.EventType.FREE_TRIAL,n.soldQuantity=r.default.sales(parseInt(e.cnt||0)),n.isCompleteLottery=[a.default.EventType.LUCKY_DRAW,a.default.EventType.FREE_TRIAL,a.default.EventType.CAPITAL_GIFT_LOTTERY,a.default.EventType.DEPOSITE_GROUP].indexOf(n.eventType)>=0,n.nationalFlag=e.country?t.default.getCDNImgURL("nation/rect/"+e.country+".png"):"",n.preMarketPrice=parseInt(e.market_price||0,10),n.preGroupPrice=parseInt(e.group.price||0,10),n.preSinglePrice=parseInt(e.normal_price||0,10),n}};exports.default=n; 
 			}); 
		define("models/format/luck_draw.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../../common/data_util")),a=e(require("../../common/std_format")),r={LuckyDraw:{key:"LuckyDraw",title:"抽奖规则",desc:'抽奖结果将实时公布，请前往微信公众号"拼多多”查看。',time:"{0}~{1}",detail:["1. 活动结束后将从拼单成功的所有订单中，随机抽取中奖者。","2. 一等奖为{0}（共{1}名），二等奖会全额退款并赠送88元代金券。","3. 中奖的商品预计{0}发放。"]},FreeTrial:{key:"FreeTrial",title:"活动规则",desc:'活动结果将实时公布，请前往微信公众号"拼多多”查看。',time:"{0}~{1}",detail:["1. 活动结束后将从拼单成功的所有订单中，随机选取{0}名试用者赠送。","2.一等奖为{0}（共{1}名），二等奖赠送88元代金券。","3. 试用的商品预计{0}发放。","4. 试用者完成试用报告后可以保留试用品。"]}},i=function(e,r){function i(e){function a(e){return e<10&&(e="0"+e),e}var r=e.getMonth()+1,i=e.getDate(),u=a(e.getHours()),o=a(e.getMinutes());return t.default.formatByPos("{0}月{1}日{2}:{3}",r,i,u,o)}var u=new Date(1e3*e.start_time),o=new Date(1e3*e.end_time),l=i(u),n=i(o),d=e.name,s=e.goods_quantity,f=a.default.price(e.coupons_value,100),m=void 0,y=void 0;return y=e.shipping_time?new Date(1e3*e.shipping_time):new Date(1e3*(e.end_time+86400)),m=t.default.formatByPos("{0}月{1}日",y.getMonth()+1,y.getDate()),r.time=t.default.formatByPos(r.time,l,n),"LuckyDraw"===r.key?r.detail=[r.detail[0],t.default.formatByPos(r.detail[1],d,s,f),t.default.formatByPos(r.detail[2],m)]:"FreeTrial"===r.key&&(r.detail=[t.default.formatByPos(r.detail[0],s,d),t.default.formatByPos(r.detail[1],d,s),t.default.formatByPos(r.detail[2],m),r.detail[3]]),r},u={formatData:function(e,t){var a={},u={},o=r[(t=t||{}).rulesKey]?JSON.parse(JSON.stringify(r[t.rulesKey])):{};return e&&(u={luckyId:e.lucky_id,luckyStatus:parseInt(e.status,10)||0,luckyStartTime:parseInt(e.start_time,10),luckyEndTime:parseInt(e.end_time,10)},a=i(e,o)),{rules:a,info:u}}};exports.default=u; 
 			}); 
		define("models/format/mall_info.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../../common/std_format")),a=e(require("../../common/time_util")),m={formatData:function(e){var m={};m.mallId=e.mall_id,m.mallName=e.mall_name,m.goodsNum=e.goods_num,m.isOpen=e.is_open,m.logo=e.logo,m.mallCoupons=[];var n=e.mall_coupons||[];e.server_time;return n.forEach(function(e){e.min_amount===e.discount&&e.min_amount++,m.mallCoupons.push({batchId:e.id,batchName:e.batch_name,mallId:e.mall_id,startTime:a.default.formatTime(new Date(1e3*e.start_time),"yyyy.M.d"),endTime:a.default.formatTime(new Date(1e3*e.end_time),"yyyy.M.d"),discount:t.default.price(e.discount,100),startTimeForToast:a.default.formatTime(new Date(1e3*e.start_time),"yyyy.MM.dd"),endTimeForToast:a.default.formatTime(new Date(1e3*e.end_time),"yyyy.MM.dd"),minAmount:t.default.price(e.min_amount,100),couponDisableText:e.is_taken_out?"已抢光":"已领取",takenOut:e.is_taken_out,canReceived:!e.is_taken_out})}),m.mallDesc=e.mall_desc,m.mallId=e.mall_id,m.mallSales=e.mall_sales,m.soldQuantity=t.default.sales(e.mall_sales),m},formatMallCouponData:function(e){var m=[];return(e.mall_coupons||[]).forEach(function(e){e.min_amount===e.discount&&e.min_amount++,m.push({batchId:e.id,batchName:e.batch_name,mallId:e.mall_id,startTime:a.default.formatTime(new Date(1e3*e.start_time),"yyyy.M.d"),endTime:a.default.formatTime(new Date(1e3*e.end_time),"yyyy.M.d"),discount:t.default.price(e.discount,100),startTimeForToast:a.default.formatTime(new Date(1e3*e.start_time),"yyyy.MM.dd"),endTimeForToast:a.default.formatTime(new Date(1e3*e.end_time),"yyyy.MM.dd"),minAmount:t.default.price(e.min_amount,100),couponDisableText:e.is_taken_out?"已抢光":"已领取",takenOut:e.is_taken_out,canTakenCount:e.can_taken_count})}),m}};exports.default=m; 
 			}); 
		define("models/format/order_goods_detail.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e(require("../../common/std_format")),r=(e(require("../../common/data_util")),e(require("../../common/image_util"))),s=e(require("../../constants/goods")),n=require("../../common/message"),u={getGroupTypes:function(e){e=e||[];for(var t=[],r={},s=0;s<e.length;s++){var n=e[s];"0"==n.is_open||r[n.customer_num]||(t.push({requireNum:n.customer_num.toString(),customerNum:n.customer_num.toString(),price:o.default.price(n.price,100),totalPrice:o.default.price(n.price*n.customer_num,100),groupId:n.group_id,startTime:parseInt(n.start_time),endTime:parseInt(n.end_time),orderLimit:parseInt(n.order_limit||"1")}),r[n.customer_num]=!0)}return t.sort(function(e,t){return e.requireNum-t.requireNum}),t},getSkus:function(e){for(var t=[],o=0;o<e.length;o++){var s=e[o];if("0"!=s.is_onsale){var n=parseInt(s.limit_quantity,10)||0;t.push({skuId:s.sku_id,quantity:parseInt(s.quantity),initQuantity:parseInt(s.init_quantity),isOnSale:!0,soldQuantity:parseInt(s.sold_quantity),specs:s.specs,thumbUrl:r.default.cdnCompress(s.thumb_url),limitQuantity:n,groupPrice:parseInt(s.group_price,10),normalPrice:parseInt(s.normal_price,10),weight:parseInt(s.weight)})}}return t},formatData:function(e){var i=e.promotion_events?e.promotion_events:[];if(i.length>0)for(var a in i){var p=i[a].event_items,m=i[a].discount_type;for(var d in p){var _=p[d];switch(m){case 4:i[a].event_items[d].descountDesc="第"+_.goods_number+"件"+o.default.price(_.discount_param,100)+"元";break;case 5:i[a].event_items[d].descountDesc="第"+_.goods_number+"件减"+o.default.price(_.discount_param,100)+"元";break;case 6:i[a].event_items[d].descountDesc="第"+_.goods_number+"件"+o.default.price(10*_.discount_param,100)+"折"}}}var c={};return c.goodsId=e.goods_id||"",c.goodsDesc=e.goods_desc||"",c.goodsName=e.goods_name||"",c.goodsType=e.goods_type,c.isOnsale=e.is_onsale,c.isPresale=e.is_pre_sale,c.allowedRegion=e.allowed_region,c.isApp=e.is_app,c.mallId=e.mall_id,c.skus=u.getSkus(e.sku),c.thumbUrl=r.default.cdnCompress(e.hd_thumb_url||e.thumb_url),c.groupTypes=u.getGroupTypes(e.group),c.eventType=e.event_type,c.freeCoupon=e.free_coupon,c.captainCoupon=e.captain_coupon,c.costTemplateId=e.cost_template_id,c.promotionEvents=i,c.isRefundable=e.is_refundable,c.spikeGroup=e.spike_group,c.serverTime=e.server_time,void 0===t(c.eventType)&&n.Message.emit(n.KEYS.UNDEFINED_EVENT_TYPE),c.isVirtualGoods=[s.default.GoodsType.MOBILE_DATA,s.default.GoodsType.QQ_COIN,s.default.GoodsType.OIL_CARD,s.default.GoodsType.MOBILE_FARE].indexOf(parseInt(e.goods_type,10))>=0,c}};exports.default=u; 
 			}); 
		define("models/format/promotion_goods_formatter.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e&&e.__esModule?e:{default:e}}(require("../../common/std_format")),t=require("../../common/index"),i={formatData:function(i){if(i)return i.map(function(i){if(i.group_price?i.group_price=e.default.price(i.group_price,100):i.group&&i.group.price&&(i.group_price=e.default.price(i.group.price,100)),i.normal_price=e.default.price(i.normal_price,100),i.market_price=e.default.price(i.market_price,100),i.sales=e.default.sales(i.sales),i.hd_thumb_url=t.ImageUtil.cdnCompress(i.hd_thumb_url),i.display_name)i.tagTitle=i.display_name,i.tagClass=" multi-discount-tag";else if(i.pick_num)i.tagTitle="限时免单"+i.pick_num+"件",i.tagClass=" limit-free-tag";else if(i.init_quantity){var r=Date.parse(new Date)/1e3;if(i.start_time>r){var a=new Date(1e3*i.start_time).getHours();i.tagTitle=a+"点限量"+i.init_quantity+"件"}else i.tagTitle=i.init_quantity+"件限量疯抢";i.tagClass=" limit-discount-tag"}return i}),i}};exports.default=i; 
 			}); 
		define("models/format/spike_goods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../common/index"),e=function(t){return t&&t.__esModule?t:{default:t}}(require("../../storage/ram_manager")),r={on:"ts-on-btn",coming:"ts-coming-btn",off:"ts-off-btn",remind:"ts-remind-btn"},i={onsales:{title:"正在疯抢",timerText:"距结束"},rightSales:{title:"即将开抢",timerText:"距开始"},tomorrowSales:{title:"明日开抢",timerText:"距开始"},afterTomorrowSales:{title:"后日开抢",timerText:"距开始"}},o={0:"getTomorrow",1:"getAfterTomorrow",2:"getBigAfterTomorrow"},s={todayIcon:"icon-daily-berserk",tomorrowIcon:"icon-pending"},a={formatGoodsData:function(i,o){var s={goodsId:i.goods_id,isApp:i.is_app,startTime:parseInt(i.start_time,10)||0,quantity:parseInt(i.quantity,10)||0,soldQuantity:parseInt(i.sold_quantity,10)||0,imgUrl:t.ImageUtil.cdnCompress(i.hd_thumb_url||i.thumb_url),goodsName:i.goods_name||"",salePrice:t.StdFormat.price(i.price,100),marketPrice:t.StdFormat.price(i.market_price,100),allQuantity:parseInt(i.all_quantity,10)||1e3,buttonClass:r.coming,buttonType:"coming",spikeStatus:"coming",currentCanBuy:!0};s.progressValue=Math.floor(parseInt(100*s.soldQuantity,10)/parseInt(s.allQuantity,10));var a=s.progressValue;if(s.progressWidth=a<=6&&a>0?"4%":a>6&&a<=12?"8%":s.progressValue+"%",s.progressType=a<=6&&a>0?"ts-progress-five-percent":a>6&&a<=12?"ts-progress-ten-percent":"",o){for(var n=o.length-1;n>=0&&o[n]&&o[n].time>s.startTime;)n--;n<0&&(n=0),s.timesIndex=n,e.default.spikeRemindGoodsIds.indexOf(s.goodsId.toString())>=0&&(s.buttonClass=r.remind,s.buttonType="remind"),o[n].isPast&&(s.buttonClass=r.on,s.buttonType="on",s.spikeStatus="on")}return s.quantity<=0&&(s.buttonClass=r.off,s.buttonType="off",s.spikeStatus="off",s.isSalesOut=!0,s.currentCanBuy=!1),s.isFarFuture=t.TimeUtil.checkTimeDay(s.startTime)<0,(s.isFarFuture||s.isApp)&&(s.isForbidden=!0),s.onlyKey=""+s.goodsId+s.startTime,s},formatTimeData:function(e,r,a){var n=[];(e=e||[]).sort(function(t,e){return 1*t-1*e});var m=Date.parse(new Date)/1e3;return e.forEach(function(l,u){var T={time:l*=1,title:i.rightSales.title,timerText:i.rightSales.timerText};if(T.timeLine=t.TimeUtil.formatTime(l,"hh:mm"),a)a*=1,T.isPast=m>l&&m<a,T.isPast?(T.title=i.onsales.title,T.timerText=i.onsales.timerText,T.timerNumObj=t.TimeUtil.transferToTime(1e3*(a-m),{needObj:!0}),T.salesOut=[]):m<l&&(T.timerNumObj=t.TimeUtil.transferToTime(1e3*(l-m),{needObj:!0}));else{T.isPast=m>l;var d=0,p=m,c={};T.isPast?(T.title=i.onsales.title,T.timerText=i.onsales.timerText,u<e.length-1?d=e[u+1]:(c[o[r]]=!0,d=t.TimeUtil.getTodayTime(c))):u<e.length-1?d=l:(c[o[r]]=!0,d=t.TimeUtil.getTodayTime(c)),T.timerNumObj=t.TimeUtil.transferToTime(1e3*(d-p),{needObj:!0})}var f=t.TimeUtil.checkTimeDay(l);if(!(f<0)){switch(f){case 2:T.spikeTitleIcon=s.todayIcon;break;case 3:T.spikeTitleIcon=s.tomorrowIcon,T.title=i.tomorrowSales.title,T.timerText=i.tomorrowSales.timerText;break;case 4:T.spikeTitleIcon=s.tomorrowIcon,T.title=i.afterTomorrowSales.title,T.timerText=i.afterTomorrowSales.timerText}n.push(T)}}),n}};exports.default=a; 
 			}); 
		define("models/format/spike_list_goods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e){var t=n.default.formatTime(new Date(1e3*e),"yyyy/MM/dd");f=Math.floor(new Date(t).getTime()/1e3),c=f-86400,y=f+86400,T=f+172800}function r(e){return e>=c&&e<f}function o(e){return e>=y&&e<T}function a(e){return e>=T&&e<T+86400}Object.defineProperty(exports,"__esModule",{value:!0});var s=e(require("../../common/image_util")),i=e(require("../../common/std_format")),n=e(require("../../common/time_util")),m=e(require("../../storage/ram_manager")),d={On:"spike-button-on",Coming:"spike-button-coming",Off:"spike-button-off",Remind:"spike-button-remind"},u={tomorrow:"明日",afterTomorrow:"后天"},l={tomorrow:"明日",afterTomorrow:"后日"},p={On:"正在进行中",Coming:"即将开抢",Off:"",ComingFuture:"开抢"},f=void 0,c=void 0,y=void 0,T=void 0,g={formatData:function(e,f){var c=(f=f||{}).beforeGoodsTime,y=(f.nextGoodsTime,f.serverTime);t(y);var T={key:"spike_goods_"+e.goods_id,goodsId:e.goods_id,isApp:e.is_app,startTime:parseInt(e.start_time,10)||0,quantity:parseInt(e.quantity,10)||0,soldQuantity:parseInt(e.sold_quantity,10)||0,imgUrl:s.default.cdnCompress(e.hd_thumb_url||e.thumb_url),goodsName:e.goods_name||"",salePrice:i.default.price(e.price,100),marketPrice:i.default.price(e.market_price,100),allQuantity:parseInt(e.all_quantity,10)||1e3,finalGood:f.isFinalGood};if(T.startTime===c&&(T.addClock=!1),T.btnClass="btnClass",T.startTime>y){T.coming=!0,T.addClock=!0,T.leftTime=T.startTime-y;var g=c;T.startTime===g&&(T.addClock=!1),T.spikeText=p.Coming,o(T.startTime)&&(T.day=u.tomorrow,T.day2=l.tomorrow,T.btnTomorrow=!0,n.default.formatTime(new Date(1e3*T.startTime),"yyyy-MM-dd")!==n.default.formatTime(new Date(1e3*g),"yyyy-MM-dd")&&(T.Foreshow=!0),T.spikeText=p.ComingFuture),a(T.startTime)&&(T.day=u.afterTomorrow,T.day2=l.afterTomorrow,T.btnAfterTomorrow=!0,n.default.formatTime(new Date(1e3*T.startTime),"yyyy-MM-dd")!==n.default.formatTime(new Date(1e3*g),"yyyy-MM-dd")&&(T.Foreshow=!0),T.spikeText=p.ComingFuture),T.time=n.default.formatTime(new Date(1e3*T.startTime),"hh:mm"),T.buttonClass=d.Coming,T.buttonType="coming",m.default.spikeRemindGoodsIds.indexOf(T.goodsId.toString())>=0&&(T.buttonClass=d.Remind,T.buttonType="remind")}else T.addClock=!0,new Date(parseInt(1e3*T.startTime,10))<=new Date(parseInt(1e3*y,10))&&(!f.isPageFirstGoods||parseInt(c)<=parseInt(y))&&(T.addClock=!1),r(T.startTime)&&(T.time=""),T.current=!0,T.spikeText=p.On,T.buttonClass=d.On,T.buttonType="on",T.currentCanBuy=!0,T.quantity<=0&&(T.buttonClass=d.Off,T.buttonType="off",T.currentCanBuy=!1);T.salesRate=Math.floor(parseInt(100*T.soldQuantity,10)/parseInt(T.allQuantity,10));var _=T.salesRate;return T.fivePercent=_<=6&&_>0,T.percentileMore=_>6&&_<=12,T.statusWidth=_>12?_+"%":"",T.statusWidth=_>12?_+"%":"",T.statusProgressClass="status-progress",T.fivePercent&&(T.statusProgressClass+=" status-five-percent"),T.percentileMore&&(T.statusProgressClass+=" status-more"),f&&f.isFirstGoods&&(T.addClock=!0),T.onlyKey=""+T.goodsId+T.startTime,T.transData={goodsId:T.goodsId,preGroupPrice:parseInt(e.price,10),preSinglePrice:parseInt(e.normal_price,10),preMarketPrice:parseInt(e.market_price,10),goodsName:T.goodsName,customerNum:e.customer_num,ad:e.ad,p_rec:e.p_rec,p_search:e.p_search},T}};exports.default=g.formatData; 
 			}); 
		define("models/format/v2_goods_detail.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../../common/std_format")),r=e(require("../../common/data_util")),i=e(require("../../common/time_util")),a=e(require("../../constants/image")),s=e(require("../../constants/goods")),n=e(require("../../constants/groups")),o=e(require("../../constants/promotion")),u=e(require("../../common/image_util")),l={min:.625,max:1},p={getGroupTypes:function(e,r){e=e||[];for(var i=[],a={},s=0;s<e.length;s++){var n=e[s];"0"==n.is_open||a[n.customer_num]||(i.push({requireNum:n.customer_num.toString(),price:t.default.price(n.price,100),totalPrice:t.default.price(n.price*n.customer_num,100),marketPriceDeltaPrice:t.default.price(r-n.price,100),groupId:n.group_id,startTime:parseInt(n.start_time),endTime:parseInt(n.end_time),orderLimit:parseInt(n.order_limit||"1")}),a[n.customer_num]=!0)}return i.sort(function(e,t){return e.requireNum-t.requireNum}),i},getSkus:function(e,r){for(var i=[],a=0;a<e.length;a++){var s=e[a],n=parseInt(s.is_onsale)||0;if(0!==n){var o=parseInt(s.limit_quantity,10)||0;i.push({skuId:s.sku_id,quantity:parseInt(s.quantity),initQuantity:parseInt(s.init_quantity),isOnSale:n,soldQuantity:parseInt(s.sold_quantity),specs:s.specs,thumbUrl:u.default.cdnCompress(s.thumb_url||r),limitQuantity:o,normalPrice:t.default.price(s.normal_price,100),groupPrice:t.default.price(s.group_price,100)})}}return i},getGallery:function(e){if(!e)return{};var t=[],r=[];e=e.sort(function(e,t){return e.priority-t.priority});var i=375*l.max;return e.forEach(function(e){e.downloadUrl=e.url,e.url=u.default.cdnCompress(e.url);var s=e.type+"";if(s===a.default.GalleryType.Top&&(t.push(e),e.height>0&&e.width>0)){var n=0;(n=e.height/e.width>=l.max?375*l.max:375*l.min)<i&&(i=n)}s===a.default.GalleryType.Detail&&r.push(e)}),{detailGallery:r,topGallery:t,bannerHeight:i}},getHaitaoStatus:function(e){return(e=parseInt(e)||0)===s.default.GoodsType.IMPORTS||e===s.default.GoodsType.OVERSEAS_TRANSSHIP||e===s.default.GoodsType.OVERSEAS_DM},getGroupEventTypeData:function(e,t,r,i){e=parseInt(e,10)||0;var a=!1,s=!1,o=!1,u=!1,l=!1,p=!1,c=!1,m=!1,d=!1,_=!1,f=!1;switch(t.length>1&&t[1].startTime>i&&(a=!0),e){case n.default.EventType.NEW_USER_GROUP:s=!0;break;case n.default.EventType.LUCKY_DRAW:r>0&&(o=!0);break;case n.default.EventType.FREE_TRIAL:r>0&&(u=!0);break;case n.default.EventType.SPIKE:l=!0;break;case n.default.EventType.SUPER_SPIKE:p=!0;break;case n.default.EventType.FREE_GROUP:c=!0;break;case n.default.EventType.CAPITAL_GIFT:m=!0;break;case n.default.EventType.CAPITAL_GIFT_LOTTERY:r>0&&(d=!0);break;case n.default.EventType.TZYY:_=!0;break;case n.default.EventType.LIMIT_TIME_DISCOUNT:f=!0}return{eventComing:a,isNewUserGroup:s,isLottery:o,isFreeTrial:u,isSpike:l,isSuperSpike:p,isGroupFree:c,isCapitalGift:m,isCapitalGiftLottery:d,isTZYY:_,isLimitDiscount:f}},getShipmentLimitHour:function(e){return(parseInt(e.shipment_limit_second)||0)/3600},getPromotionsFromData:function(e){var t=[];return r.default.isArray(e)?(e.forEach(function(e){t.push({id:parseInt(e.id,10),type:e.type,startTime:parseInt(e.start_time,10),endTime:parseInt(e.end_time,10)})}),t):t},getMallServiceData:function(e){var t=parseInt(e.goodsType)||0,r=e.country||"",i=(e.countryLogo,e.warehouse||""),a=(e.shipmentLimitHour,e.isLottery,e.isFreeTrial,e.isPreSale,e.isRefundable,!!e.isHaitao);parseInt(e.catId2),parseInt(e.catId3),e.serverTime;if(a){switch(t){case s.default.GoodsType.IMPORTS:r+="进口";break;case s.default.GoodsType.OVERSEAS_TRANSSHIP:r+="直供";break;case s.default.GoodsType.OVERSEAS_DM:r+="直邮"}""!==i&&(i+="发货")}return{isHaitao:a,goodsCountry:r,goodsWarehouse:i,service:e.servicePromise}},getShowMallRecommendStatus:function(e,t,r){if(r)return!0;t=t||parseInt(Date.now()/1e3,10),e=e||[];for(var i=0;i<e.length;i++){var a=e[i];if(a.type===o.default.PromotionType.Event618&&a.startTime<=t&&a.endTime>=t)return!0}return!1},processUseOnSalePrice:function(e,t){var r=!1;return(e||t.eventComing&&(t.isSpike||t.isSuperSpike||t.isLottery||t.isCapitalGiftLottery||t.isFreeTrial||t.isDepositeGroup))&&(r=!0),r},getDeltaPrice:function(e,r,i,a){return a?t.default.price(i-r,100):t.default.price(i-e,100)},processSaleStatus:function(e,t){var r=t.length,i=!1,a=e;t=t||[];for(var s=0;s<r;s++){var n=t[s];i=i||n.is_onsale&&n.quantity>0}return a&&!i&&(a=!1),a},getChannelSign:function(e){var t=s.default.ChannelSign[e];return void 0===t&&(t={tag:-1,fontColor:"#e02e24",backgroundColor:"#ffffff",iconClass:""}),t},formatData:function(e){var r=e.server_time||0,a=p.getGallery(e.gallery),s=p.getGroupTypes(e.group,e.market_price),n=p.getHaitaoStatus(e.goods_type),o=n?u.default.getCDNImgURL("nation/rect/"+e.country.trim()+".png"):"",l=p.getGroupEventTypeData(e.event_type,s,e.lucky_id,r),c=p.getShipmentLimitHour(e),m=s.length>1?s[1].marketPriceDeltaPrice:"0",d=p.processSaleStatus("0"!=e.is_onsale,e.sku),_=p.processUseOnSalePrice(d,l),f=p.getChannelSign(e.tag),g=0,y=0;s.length>1&&(g=t.default.price(e.min_on_sale_group_price*s[1].requireNum,100),y=p.getDeltaPrice(e.min_group_price,e.min_on_sale_group_price,e.market_price,_));var T={allowedRegion:e.allowed_region,catId:e.cat_id,catId1:e.cat_id_1,catId2:e.cat_id_2,catId3:e.cat_id_3,country:e.country,countryLogo:o,detailGallery:a.detailGallery,marketPriceDeltaPrice:m,eventType:parseInt(e.event_type,10),eventComing:l.eventComing,freeCoupon:[],promotions:p.getPromotionsFromData(e.promotions),topGallery:a.topGallery,bannerHeight:a.bannerHeight,goodsDesc:(e.goods_desc||"").replace(/\n/g,""),goodsId:e.goods_id,goodsName:e.goods_name,goodsType:parseInt(e.goods_type),groupTypes:s,hdThumbUrl:e.hd_thumb_url,images:e.images?e.images[0]:{},isApp:1==e.is_app,isOnSale:d,isPreSale:1==e.is_pre_sale,isRefundable:1==e.is_refundable,isNewUserGroup:l.isNewUserGroup,isDepositeGroup:l.isDepositeGroup,isLottery:l.isLottery,isFreeTrial:l.isFreeTrial,isSpike:l.isSpike,isSuperSpike:l.isSuperSpike,isGroupFree:l.isGroupFree,isCapitalGift:l.isCapitalGift,isCapitalGiftLottery:l.isCapitalGiftLottery,isTZYY:l.isTZYY,isLimitDiscount:l.isLimitDiscount,isHaitao:n,isMallRec:parseInt(e.is_mall_rec,10)||0,localGroups:[],luckyId:e.lucky_id,luckyEndTime:parseInt(e.lucky_end_time),luckyStartTime:parseInt(e.lucky_start_time),luckyStatus:parseInt(e.lucky_status,10)||0,hasLocalGroup:!1,mallId:e.mall_id,preSaleTime:e.pre_sale_time,quickRefund:1===parseInt(e.quick_refund,10),rv:1===parseInt(e.rv,10),sales:e.sales,serverTime:r,servicePromise:e.service_promise,shareDesc:e.share_desc,shipmentLimitSecond:e.shipment_limit_second,shipmentLimitHour:c,skipGoods:e.skip_goods,thumbUrl:u.default.cdnCompress(e.thumb_url),warehouse:e.warehouse,marketPrice:t.default.price(e.market_price,100),useOnSalePrice:_,deltaPrice:y,maxGroupPrice:t.default.price(e.max_group_price,100),minGroupPrice:t.default.price(e.min_group_price,100),maxNormalPrice:t.default.price(e.max_normal_price,100),minNormalPrice:t.default.price(e.min_normal_price,100),maxOnsaleGroupPrice:t.default.price(e.max_on_sale_group_price,100),minOnsaleGroupPrice:t.default.price(e.min_on_sale_group_price,100),maxOnsaleNormalPrice:t.default.price(e.max_on_sale_normal_price,100),minOnsaleNormalPrice:t.default.price(e.min_on_sale_normal_price,100),minTotalGroupPrice:g,channelSign:f,soldQuantity:null,allQuantity:null,redEnvelopes:e.red_envelopes};if(e.spike_group&&e.spike_group.length>0){T.soldQuantity=t.default.sales(e.spike_group[0].sold_quantity,100),T.allQuantity=t.default.sales(e.spike_group[0].all_quantity,100),T.spikeLimitQuantity=e.spike_group[0].limit_quantity,T.spikeStart=Date.parse(new Date)-1e3*parseInt(e.spike_group[0].start_time)>0,T.spikeOver=parseInt(e.spike_group[0].sold_quantity)>=parseInt(e.spike_group[0].all_quantity);var S=36e5-(Date.now()-1e3*parseInt(e.spike_group[0].start_time));T.spikeLeftTime=S,T.spikePackagedTime=S>0?i.default.getPackagedTimeFromTimeBucket(S,"HMS"):null}T.marketPriceDeltaPrice=T.marketPrice-T.minGroupPrice;var k=p.getMallServiceData(T),v=p.getShowMallRecommendStatus(T.promotions,r,T.isMallRec);return T.mallService=k,T.showMallRecommend=v,T.isShowBanner=!0,e.icon&&(T.icon=e.icon),T}};exports.default=p; 
 			}); 
		define("models/group_proxy.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../constants/groups")),r=e(require("../constants/goods")),s=e(require("../constants/regions")),a=e(require("../constants/app_constant")),o=e(require("../constants/lottery")),i=e(require("../models/format/group_order_goods")),u=require("../common/index"),l=[{TITLE:["快来入团吧","入团成功","开团成功"],DETAIL:["就差你了","快去邀请好友加入吧","快去邀请好友加入吧"]},{TITLE:["来晚了一步！该团已被挤爆","团购成功","团购成功"],DETAIL:["求人不如求自己，自己当团长吧！","我们会尽快为您发货，请耐心等待","我们会尽快为您发货，请耐心等待"]},{TITLE:["来晚了一步！","团购失败","团购失败"],DETAIL:["","",""]}],n={Default:"",Success:"tm_succ",Fail:"tm_err"},p={GROUP:{DESC:"{0}，优质商品新鲜直供，一起实惠一起拼",UNCOMPLETE_WITH_FREE_TRAIL_GOODS:"我免费拼到了{0}，大家快来拼多多吧！",UNCOMPLETE_WITH_GOODS:"快来{0}元拼{1}",UNCOMPLETE_WITH_GOODS_AND_NUMBER:"我参加了{0}拼单，还差{1}个人！",COMPLETE_WITH_FREE_TRAL_GOODS:"我免费拼到了{0}，大家快来拼单吧！",COMPLETE_WITH_GOODS:"我{0}元拼了{1}，大家快来拼单吧！"},UNGROUP:{UNCOMPLETE_WITH_GOODS:"快来{0}元拼{1}，大家一起来玩吧！",UNCOMPLETE_WITH_FREE_TRAIL_GOODS:"快来免费拼{0}，大家一起来玩吧! ",UNCOMPLETE_WITH_GOODS_AND_NUMBER:"快来免费拼{0}，还差{1}个人！",COMPLETE_WITH_GOODS:"快来{0}元拼{1}，大家快来拼单吧！",COMPLETE_WITH_FREE_TRAIL_GOODS:"快来免费拼{0},大家快来拼单吧！",COMPLETE_WITH_GOODS_NOT_NUMBER:"{0}拼单，大家一起来玩吧！"}},d=[{title:"拼团须知",textArr:["人不满退款","人满发货","好友参团"]},{title:"拼团须知",textArr:["抽中发货","0元参团"]},{title:"拼团须知",textArr:["二等奖退款赠券","一等奖发货","好友参团"]},{title:"团长送礼玩法",textArr:["分享送礼","全部领取成团发货","分享好友"]}],f={Default:"",Out:"img-out",Success:"img-succ",Fail:"img-fail",LotteryWait:"img-lottery-wait",LotteryEnd:"img-lottery-end"},_={Default:"我也要参团",FreeTrial:"申请试用",CapitalGift:"立即领取"},T={Default:{title:"拼团玩法",steps:[["选择","心仪商品"],["支付开团","或参团"],["等待好友","参团支付"],["达到人数","团购成功"]]},CapitalGift:{title:"团长送礼玩法",steps:[["团长","支付包团"],["分享好友","赠送礼物"],["全部领取","成团发货"]]},CapitalGiftLottery:{title:"团长送礼玩法",steps:[["团长","支付开团"],["分享好友","免费领取"],["拼团成功","抽取奖品"],["团员中奖","团长必中"]]}},c={0:{actTagIcon:"限时秒杀",actTagClass:"act-tag-icon act-spike"},1:{actTagIcon:"名品折扣",actTagClass:"act-tag-icon act-brand"},2:{actTagIcon:"爱逛街",actTagClass:"act-tag-icon act-shopping"},3:{actTagIcon:"品质水果",actTagClass:"act-tag-icon act-fruit"},4:{actTagIcon:"品牌清仓",actTagClass:"act-tag-icon act-brand-clean"}},m={isLottery:"【抽奖】",isFreeTrial:"【免费试用】"},g=[r.default.GoodsType.IMPORTS,r.default.GoodsType.OVERSEAS_TRANSSHIP,r.default.GoodsType.OVERSEAS_DM],I=function(e){var t=d[0];return!e.isFreeTrial&&!e.isDepositeGroup||e.lotteryRuleTitle?e.isLottery&&!e.lotteryRuleTitle?t=d[2]:e.isCaptialGift&&(t=d[3]):t=d[1],t},O=function(e){var t=e.actTag;return c[t]?c[t]:null},G=function(e){var t="";return u.User.getShowGroupTitlePrefix()&&(e.isFreeTrial||e.isDepositeGroup?t=m.isFreeTrial:e.isLottery&&(t=m.isLottery)),t},y=function(e,r,s,a){var o={shareTitle:"",shareDesc:""},i=e.goodsName,l=e.price;if(s!==t.default.GroupRole.NotInGroup?r>0?a.isFreeTrial?o.shareTitle=u.DataUtil.formatByPos(p.GROUP.UNCOMPLETE_WITH_FREE_TRAIL_GOODS,i):o.shareTitle=u.DataUtil.formatByPos(p.GROUP.UNCOMPLETE_WITH_GOODS,l,i):a.isFreeTrial?o.shareTitle=u.DataUtil.formatByPos(p.GROUP.COMPLETE_WITH_FREE_TRAL_GOODS,i):o.shareTitle=u.DataUtil.formatByPos(p.GROUP.COMPLETE_WITH_GOODS,l,i):r>0?a.isFreeTrial?o.shareTitle=u.DataUtil.formatByPos(p.UNGROUP.UNCOMPLETE_WITH_FREE_TRAIL_GOODS,i):o.shareTitle=u.DataUtil.formatByPos(p.UNGROUP.UNCOMPLETE_WITH_GOODS,l,i):a.isFreeTrial?o.shareTitle=u.DataUtil.formatByPos(p.UNGROUP.COMPLETE_WITH_FREE_TRAIL_GOODS,i):o.shareTitle=u.DataUtil.formatByPos(p.UNGROUP.COMPLETE_WITH_GOODS,l,i),o.shareDesc=u.DataUtil.formatByPos(p.GROUP.DESC,"拼多多"),e.shareDesc){var n=e.shareDesc.replace("%%num",e.requireNum);n.replace("%%price",e.price),o.shareDesc=n}return(a.isCapitalGift||a.isCapitalGiftLottery)&&(o.shareTitle=a.ownerName+"送你一份礼物，快来领取吧！"+i),o},E=function(e){var r=e,s=null,a="点击右上角发送给朋友";return(!r.showSharePointer||wx.canIUse&&wx.canIUse("button.open-type.share"))&&(a="赶快邀请好友来参团吧"),s={pre:"还差",emphasis:r.leftUserNum,after:"人，"+a},!r.isNewUserGroup||r.isFreeTrial||r.isDepositeGroup||(s={pre:"还差",emphasis:r.leftUserNum+"位新用户",after:"，"+a}),r.goodsInfo.eventType===t.default.EventType.CAPITAL_GIFT&&(r.showSharePointer||(a="全被领取才能成团哦"),s={pre:"还剩",emphasis:r.leftUserNum+"个礼物",after:">，"+a}),s},v=function(e){var r="";e.goodsInfo.eventType!==t.default.EventType.CAPITAL_GIFT||e.showSharePointer||(r="全被领取才能成团哦");var s={pre:"还差",emphasis:e.leftUserNum,after:"人，"+r};return e.isNewUserGroup&&(s={pre:"还差",emphasis:e.leftUserNum+"位新用户",after:"，"+r}),(e.isFreeTrial||e.isDepositeGroup)&&(s={pre:"还差",emphasis:e.leftUserNum,after:"人，赶紧邀请好友来",afterEmphasis:"参团吧~"}),e.goodsInfo.eventType===t.default.EventType.CAPITAL_GIFT&&(s={pre:"还差",emphasis:e.leftUserNum+"个礼物",after:"，{shareTip}"}),s},S=function(e){var r={server_time:e.server_time,gov:e.gov,group_order:{users:[],order:{order_goods:[],mall:{}}},location:e.location||"",isBanRegion:s.default.IPServer.BanProvinces.some(function(t){return e.location.indexOf(t)>=0}),mallServices:e.service_promise,selfOrderInfo:e.self_order_info,resourceFile:e.resource_file},a=r.group_order,o=e.group_order_info;Object.keys(o).forEach(function(e){switch(e){case"uid":a.owner_id=o[e];break;case"group_status":a.status=o[e];break;default:a[e]=o[e]}}),a.is_app=e.goods_info.is_app,a.app_invite_code=e.app_invite_code;var i=e.self_order_info,u=e.leader_order_info,l=t.default.GroupRole;a.group_role=i&&i.uid===u.uid?l.Lead:i?l.Member:l.NotInGroup,e.self_order_info&&(a.uid=e.self_order_info.uid),a.users=e.order_list,a.users.forEach(function(e){e&&(e.join_time=e.pay_time)}),a.is_pre_sale=e.goods_info.is_pre_sale;var n=a.order.order_goods,p=e.goods_info;return p.lucky_draw=e.lucky_draw,p.skus=p.sku.map(function(e){return{id:e.sku_id,quantity:e.quantity}}),Object.keys(p).forEach(function(e){"number"==typeof p[e]&&(p[e]+="")}),p.cat_id=p.cat_id_2,n.push(e.goods_info),r.marketPrice=(e.goods_info||{}).market_price,r.maxOnsalePrice=(e.goods_info||{}).goods_price||(e.goods_info||{}).max_on_sale_group_price,r},L=function(e){var t=[];return e.map(function(e){t.push({avatar:e.avatar,nickname:e.nickname||"游客",uid:e.uid,joinTime:parseInt(e.join_time,10)})}),t.sort(function(e,t){return e.joinTime-t.joinTime}),t},D=function(e,t){return{mallName:e.mall_name,mallDesc:e.mall_desc,logo:e.logo,mallId:t,mallSales:e.mall_sales||0,mallIconSmall:a.default.CDNImgHostName+"mall/mall_icon_small.png"}},C=function(e){return e.goodsInfo.isOut?f.Out:e.groupClass===n.Fail?f.Fail:e.groupClass===n.Success?e.hasLotteryRule&&(parseInt(e.goodsInfo.luckyDraw.status,10)||o.default.LotteryStatus.Start)===o.default.LotteryStatus.Complete?f.LotteryEnd:f.Success:f.Default},R={receiveGroupOrderData:function(e){var r;e=S(e);var s=parseInt(e.server_time,10)||0,p=parseInt(e.gov,10)||0,d=1,f=0;!1===e.has_address&&(d=0),e.is_new_buyer&&(f=1);var c=parseInt(e.init_num,10)||0,m=parseInt(e.order_type||e.group_order.order_type,10)||t.default.GroupOrderType.Default;r={tips:{},serverTime:s,gov:p,hasAddressToNumber:d,isNewUserToNumber:f,location:e.location||""};var g=e.group_order;r.marketPrice=e.marketPrice,r.maxOnsalePrice=e.maxOnsalePrice,g.order&&g.order.order_goods||(r=null);var R=i.default.formatData({goods:g.order.order_goods[0],isOnsale:g.is_onsale||"1",isDeleted:g.is_deleted||"0"}),h=O(R);if(h)for(var U in h)h.hasOwnProperty(U)&&(R[U]=h[U]);R.mallServices=e.mallServices||[];var P=parseInt(g.status,10);parseInt(R.luckyDraw.status,10)!==o.default.LotteryStatus.Start&&[t.default.EventType.LUCKY_DRAW,t.default.EventType.FREE_TRIAL].indexOf(R.eventType)>=0&&P===t.default.GroupStatus.OnGoing&&(P=t.default.GroupStatus.Failed);var N={userId:g.caller_id||g.uid||g.user_id||0,requireNum:parseInt(g.customer_num,10)+c,expireTime:parseInt(g.expire_time,10),groupOrderId:g.group_order_id||""||"0",groupRole:g.group_role,ownerId:g.owner_id,status:P,successTime:g.success_time,users:L(g.users),orderGoods:R,mallInfo:D(g.order.mall,g.order.mall_id),groupId:g.group_id,isApp:1===parseInt(g.is_app,10),code:g.app_invite_code||"",isPreSale:1===parseInt(g.is_pre_sale,10),groupOrderType:m};r.groupOrderType=N.groupOrderType,r.goodsPreSaleClass=N.isPreSale?"goods-pre-sale":"",r.isPreSale=N.isPreSale,N.status===t.default.GroupStatus.OnGoing&&s>N.expireTime&&(N.status=t.default.GroupStatus.Failed),r.tips.groupTitleVisibility="visible",r.tips.groupTitleDisplay="block",r.status=N.status,r.groupRole=N.groupRole;var A=0;switch(r.status!==t.default.GroupStatus.OnGoing&&(r.status===t.default.GroupStatus.Success?r.groupRole===t.default.GroupRole.NotInGroup&&(A=1):A=2),r.tips.titleStatus=A,r.tips.title=l[r.status].TITLE[r.groupRole],r.tips.txt=l[r.status].DETAIL[r.groupRole],r.tips["titleStatus_"+A]=!0,r.status){case t.default.GroupStatus.Success:r.groupClass=n.Success;break;case t.default.GroupStatus.Failed:r.groupClass=n.Fail;break;default:r.groupClass=n.Default}r.goodsInfo=N.orderGoods,r.hasLotteryRule=[t.default.EventType.LUCKY_DRAW,t.default.EventType.FREE_TRIAL,t.default.EventType.CAPITAL_GIFT_LOTTERY].indexOf(r.goodsInfo.eventType)>=0,r.isFreeTrial=r.goodsInfo.eventType===t.default.EventType.FREE_TRIAL,r.isDepositeGroup=r.goodsInfo.eventType===t.default.EventType.DEPOSITE_GROUP,r.isCapitalGift=r.goodsInfo.eventType===t.default.EventType.CAPITAL_GIFT,r.isCapitalGiftLottery=r.goodsInfo.eventType===t.default.EventType.CAPITAL_GIFT_LOTTERY,r.isLottery=r.goodsInfo.eventType===t.default.EventType.LUCKY_DRAW,r.isSoldOut=!r.goodsInfo.isOnSale,r.soldOutStr=r.isSoldOut?"1":"0",r.goodsInfo.requireNum=N.requireNum,r.goodsInfo.isOut=r.isSoldOut&&r.status===t.default.GroupStatus.OnGoing,r.users=N.users,r.userAvatars={};var F=N.users.length,x=Math.max(N.requireNum,F);r.leftUserNum=x-F,r.joinNum=F;for(var w=0;w<x;w++){var k,M=r.users[w];k=M?{avatarImg:u.DataUtil.dealWithAvatarURL(M.avatar),avatarClass:"pp_users_normal"}:{avatarImg:a.default.BaseAvatar,avatarClass:"pp_users_blank"},r.hasLotteryRule&&(k.avatarClass2="pp_users_lottery2"),r.userAvatars[w]=k,M&&(M.avatarImg=k.avatarImg),0===w&&M&&(M.isLeader=!0)}r.usersJson=JSON.stringify(r.users),r["status_"+r.status]=!0,r.expireTime=N.expireTime,r.mallInfo=N.mallInfo,r.status!==t.default.GroupStatus.OnGoing||r.isCapitalGiftLottery||r.isCapitalGift?r.stepItemOn_3="":r.stepItemOn_3="step_item_on",r.status!==t.default.GroupStatus.Success||r.isCapitalGiftLottery||r.isCapitalGift?r.stepItemOn_4="":r.stepItemOn_4="step_item_on",r.bottomStatus=0;var W=G(r);r.goodsInfo.goodsName=W+r.goodsInfo.goodsName,r.status===t.default.GroupStatus.OnGoing&&(r.groupRole>t.default.GroupRole.NotInGroup&&r.leftUserNum>0?r.bottomStatus=1:r.bottomStatus=2,r.isSoldOut&&(r.bottomStatus=0)),r["bottomStatus_"+r.bottomStatus]=!0,r.groupOrderId=N.groupOrderId,r.skuNum=Object.keys(r.goodsInfo.skus).length,r.skuNum>0&&(r.skuId=r.goodsInfo.skus[0].skuId||0),r.groupId=N.groupId||0,r.isSoldOut?r.soldOutStr="1":r.soldOutStr="0",r.isNewUser=!1,r.ppwrap="",r.status===t.default.GroupStatus.Success&&(r.ppwrap="ppwrap"),r.goExclusiveGroup="0",N.isApp&&(r.goExclusiveGroup="1"),N.isApp?r.isApp="1":r.isApp="0",r.code=N.code,r.userId=N.userId,r.stampClass=C(r),r.isNewUserGroup=r.goodsInfo.eventType===t.default.EventType.NEW_USER_GROUP,r.lotteryRuleTitle=r.hasLotteryRule?u.User.getLotteryRule():"",r.promoteLotteryIcon=!1,r.showShareTimeline=u.User.getShowShareTimeline(),r.GroupBuyButtonText=u.User.getGroupBuyButtonText(),r.showSharePointer=u.User.showSharePointer()&&!r.isBanRegion,r.joinGroupText=r.isFreeTrial?_.Default:r.isCapitalGift||r.isCapitalGiftLottery?_.CapitalGift:_.Default,r.groupRuleText=r.isCapitalGift?T.CapitalGift:r.isCapitalGiftLottery?T.CapitalGiftLottery:T.Default,r.createGroupText="我也开个团",r.successTime=parseInt(N.successTime,10),r.goodsInfo=u.ObjectUtil.assign(r.goodsInfo,this.getImportInfo(r.goodsInfo)),r.selfOrderInfo=e.selfOrderInfo,r.audioInfo=e.resource_file&&e.resource_file.url?{url:e.resource_file.url,duration:e.resource_file.audio_duration}:null;var b=y(r.goodsInfo,r.leftUserNum,r.groupRole,{isFreeTrial:r.isFreeTrial,expireTime:r.expireTime,serverTime:r.serverTime,isCapitalGift:r.isCapitalGift,isCapitalGiftLottery:r.isCapitalGiftLottery,ownerName:r.users[0].nickname,isLottery:r.isLottery});return r.shareInfo=b,r.groupNoticeBarText=I(r),r.maskShareTip=E(r),r.groupJoinedTips=v(r),r},isImportGoods:function(e){return e=+e,g.indexOf(e)>=0},isOverseaGoods:function(e){return e=+e,g.indexOf(e)>0},getImportInfo:function(e){var t=this.isImportGoods(e.goodsType),s=this.isOverseaGoods(e.goodsType),o=e.country||"",i={countryImg:"",goodsCountry:""};return t&&(i.countryImg=[a.default.CDNImgHostName,"nation/rect/",o.trim(),".png"].join(""),i.goodsCountry=o+"进口",e.warehouse&&(i.goodsWarehouse=e.warehouse+"发货"),s&&(i.goodsCountry=o+(parseInt(e.goodsType,10)===r.default.GoodsType.OVERSEAS_DM?"直邮":"直供"),i.goodsWarehouse=e.warehouse+"发货")),i},receiveLocalGroupData:function(e,t,r){if(t=parseInt(t)||0,e&&u.DataUtil.isArray(e)){for(var s=[],a=0;a<e.length;a++){var o={};try{o=JSON.parse(e[a])||{}}catch(e){}!o.group_order_id||parseInt(o.expire_time)<t||s.push({groupOrderId:o.group_order_id,cityName:o.city_name,nickname:o.nickname||"游客",avatar:u.DataUtil.dealWithAvatarURL(o.avatar),requireNum:parseInt(o.require_num||1,10),usersNum:parseInt(o.users_num||1,10),expireTime:o.expire_time})}return{localGroups:s,serverTime:t,total:r}}}};exports.default=R; 
 			}); 
		define("models/managers/base_manager.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),a=function(){function a(e,n){t(this,a),this.keyName=e,this.dataList=[],this.dataKeyIndexMap={}}return e(a,[{key:"getDataKeyIndexMap",value:function(){return this.dataKeyIndexMap}},{key:"getDataList",value:function(){return this.dataList}},{key:"pushDataItem",value:function(t){var e=t[this.keyName];t&&e&&null==this.dataKeyIndexMap[e]&&(this.dataList.push(t),this.dataKeyIndexMap[e]=this.dataList.length-1)}},{key:"removeAllDatas",value:function(){this.dataList=[],this.dataKeyIndexMap={}}},{key:"resetDataKeyIndexMap",value:function(){this.dataKeyIndexMap={};for(var t=0;t<this.dataList.length;t++){var e=this.dataList[t];e&&(this.dataKeyIndexMap[e[this.keyName]]=t)}}},{key:"removeItemByKey",value:function(t){if(t&&null!=this.dataKeyIndexMap[t]){var e=this.dataKeyIndexMap[t];if(e>=0&&e<this.dataList.length){var a=this.dataList.splice(e,1);return this.resetDataKeyIndexMap(),a}}return null}},{key:"removeItemByKey",value:function(t){if(t&&null!=this.dataKeyIndexMap[t]){var e=this.dataKeyIndexMap[t];if(e>=0&&e<this.dataList.length){var a=this.dataList.splice(e,1);return this.resetDataKeyIndexMap(),a}}return null}},{key:"isLastThreeItemByKey",value:function(t){if(t&&null!=this.dataKeyIndexMap[t]){var e=this.dataKeyIndexMap[t];if(e>=0&&e>=this.dataList.length-3&&e<this.dataList.length)return!0}return!1}}]),a}();exports.default=a; 
 			}); 
		define("package_a/promo_dec_venue/venue_constants.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var a={mainColor:"#ff351f",loadingBg:"brand-bg",loadingColor:"#8C0000",bottomBar:[{class:"year-end-shopping",id:3440},{class:"seventy-percent-off",id:3442},{class:"special-offers",id:3441}]},s={3443:{barTitle:"服饰",class:"clothes",mainColor:"#f93345",loadingBg:"clothes-seventy-bg",loadingColor:"#7E020D",bottomBar:[{class:"fashion",id:4620},{class:"home-textiles",id:3444},{class:"men-clothes",id:3448}]},3444:{barTitle:"居家",class:"home-textiles",mainColor:"#fe3e66",loadingBg:"home-bg",loadingColor:"#9E0626",bottomBar:[{class:"mater-child",id:3454},{class:"clothes",id:3443},{class:"appliances",id:3445}]},3445:{barTitle:"家电",class:"appliances",mainColor:"#40bafd",loadingBg:"appliances-bg",loadingColor:"#00669E",bottomBar:[{class:"men-clothes",id:3448},{class:"clothes",id:3443},{class:"home-textiles",id:3444}]},3446:{barTitle:"美食",class:"tasty-food",mainColor:"#fca43a",loadingBg:"food-bg",loadingColor:"#A94400",bottomBar:[{class:"beauty",id:3456},{class:"home-textiles",id:3444},{class:"mater-child",id:3454}]},3448:{barTitle:"男装",class:"men-clothes",mainColor:"#1480f4",loadingBg:"men-clothes-bg",loadingColor:"#003E81",bottomBar:[{class:"appliances",id:3445},{class:"fashion",id:4620},{class:"clothes",id:3443}]},3454:{barTitle:"母婴",class:"mater-child",mainColor:"#ff90a8",loadingBg:"mater-child-bg",loadingColor:"#B32443",bottomBar:[{class:"beauty",id:3456},{class:"clothes",id:3443},{class:"tasty-food",id:3446}]},3456:{barTitle:"美妆",class:"beauty",mainColor:"#e05bea",loadingBg:"beauty-bg",loadingColor:"#91079B",bottomBar:[{class:"tasty-food",id:3446},{class:"mater-child",id:3454},{class:"clothes",id:3443}]},4620:{barTitle:"潮搭",class:"fashion",mainColor:"#f151ab",loadingBg:"year-fashion-bg",loadingColor:"#91002B",bottomBar:[{class:"tasty-food",id:3446},{class:"beauty",id:3456},{class:"clothes",id:3443}]},3440:{barTitle:"年终清仓",class:"year-end-shopping",mainColor:"#f151ab",loadingBg:"year-fashion-bg",loadingColor:"#91002B",bottomBar:[{class:"clothes",id:3443},{class:"seventy-percent-off",id:3442},{class:"special-offers",id:3441}]},3441:{barTitle:"尖货特价",class:"special-offers",mainColor:"#fd7647",loadingBg:"special-offers-bg",loadingColor:"#9E2400",bottomBar:[{class:"home-textiles",id:3444},{class:"year-end-shopping",id:3440},{class:"seventy-percent-off",id:3442}]},3442:{barTitle:"三折封顶",class:"seventy-percent-off",mainColor:"#f93345",loadingBg:"clothes-seventy-bg",loadingColor:"#7E020D",bottomBar:[{class:"appliances",id:3445},{class:"year-end-shopping",id:3440},{class:"special-offers",id:3441}]}};exports.VenueSubject=s,exports.FixedVenue=a; 
 			}); 
		define("package_a/promotion_main/component/carnival_promotion.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=t(require("../../../components/component.js")),n=t(require("../../../configs/api")),s=t(require("../../../models/format/promotion_goods_formatter")),u=t(require("../../../storage/ram_manager")),l=(t(require("../../../libs/es6-promise.min.js")),t(require("../../../libs/co/we-index"))),m=t(require("../../../libs/regenerator-runtime/runtime")),c=require("../../../common/index"),f=[{startTitle:"距限量折扣开始",endTitle:"距限量折扣结束"},{startTitle:"距免单开始",endTitle:"距免单结束"}],d=function(t){function d(t){var r=t.page,a=t.ns;e(this,d);var o=i(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,r,a));return o.setCoWrap(),o}return r(d,o.default),a(d,[{key:"constantData",value:function(){return{cssClassSuffix:{3440:"a",3441:"b",3442:"c"}}}}]),a(d,[{key:"setCoWrap",value:function(){this.loadData=l.default.wrap(m.default.mark(function t(){var e,i,r,a;return m.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,t.prev=1,i=n.default.carnivalPromotion,r=c.Request.requestDataWithUrl("GET",i),t.next=6,c.Request.runMainRequestForPage(r,e.target);case 6:(a=t.sent).errorCode?e.page.setData({showError:!0}):(e.formateData(a),e.setData({carnival_promotions:a.goods_list})),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),e.page.setData({showError:!0}),console.error(t.t0);case 14:case"end":return t.stop()}},t,this,[[1,10]])}))}},{key:"formateData",value:function(t){var e=this,i=0,r=0;if(t.goods_list.map(function(t,a){return t.cssClassSuffix=e.constantData().cssClassSuffix[t.promotion_id]||"a",s.default.formatData(t.goods),3440==t.promotion_id?i=a:3441==t.promotion_id&&(r=a),t}),r<i&&this.page&&this.page.data&&this.page.data.promotionBottombar&&this.page.data.promotionBottombar.bottomBar){var a=this.page.data.promotionBottombar.bottomBar;a[0]=a.splice(1,1,a[0])[0],this.page.setData({"promotionBottombar.bottomBar":a})}}},{key:"updateData",value:function(){if(this.data&&this.data.carnival_promotions){var t=Date.now()+u.default.timeDiff;this.data.carnival_promotions.map(function(e){if(e.limited_discount_time){var i="",r=0;t<1e3*e.limited_discount_time.start_time?(i=f[0].startTitle,r=1e3*e.limited_discount_time.start_time):t<1e3*e.limited_discount_time.end_time?(i=f[0].endTitle,r=1e3*e.limited_discount_time.end_time):(e.countdownTitle="",e.packagedTime="");var a=r-t;if(a>0){var o=c.TimeUtil.getPackagedTimeFromTimeBucket(a,"HMS");e.countdownTitle=i,e.packagedTime=o}}else if(e.limited_time_free_list&&e.limited_time_free_list[0]){var n="",s=0;t<1e3*e.limited_time_free_list[0].start_time?(n=f[1].startTitle,s=1e3*e.limited_time_free_list[0].start_time):t<1e3*e.limited_time_free_list[0].end_time?(n=f[1].endTitle,s=1e3*e.limited_time_free_list[0].end_time):(e.countdownTitle="",e.packagedTime="");var u=s-t;if(u>0){var l=c.TimeUtil.getPackagedTimeFromTimeBucket(u,"HMS");e.countdownTitle=n,e.packagedTime=l}}return e}),this.setDataObj({carnival_promotions:this.data.carnival_promotions})}}}]),d}();exports.default=d; 
 			}); 
		define("package_a/promotion_main/component/main_carnival_promotion.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(require("../../../components/component.js")),i=e(require("../../../configs/api")),s=e(require("../../../models/format/promotion_goods_formatter")),c=(e(require("../../../libs/es6-promise.min.js")),e(require("../../../libs/co/we-index"))),l=e(require("../../../libs/regenerator-runtime/runtime")),u=require("../../../common/index"),f=function(e){function f(e){var r=e.page,o=e.ns;t(this,f);var a=n(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,r,o));return a.addFunc("_segmentTap",a.segmentTap),a}return r(f,a.default),o(f,[{key:"constantData",value:function(){return{cssClassSuffix:{3443:"a",3444:"b",3445:"c",3446:"d",3448:"e",3454:"f",3456:"g",4620:"h"}}}},{key:"onPageScroll",value:function(e){if(wx.createSelectorQuery){var t=this,n=wx.createSelectorQuery();n.select(".segment-container").boundingClientRect(),n.select(".main-carnival-promotion-container").boundingClientRect();for(var r in this.data.goods_list){var o="#carnival-id-"+r;n.select(o).boundingClientRect()}n.exec(function(e){if(e&&e[0]&&e[1]&&e[0].top<0&&e[1].bottom-e[0].height>0?t.data.segmentFloat||t.setData({segmentFloat:!0}):t.data.segmentFloat&&t.setData({segmentFloat:!1}),e&&e[0]&&e[1]&&e[1].top<=0&&e[1].bottom>=0)for(var n in e)if(n>1&&e[n].top-e[0].height<=0&&e[n].bottom-e[0].height>0){t.data.selectedIndex!=n-2&&t.setData({selectedIndex:n-2});break}})}}}]),o(f,[{key:"loadData",value:function(){wx.setNavigationBarTitle&&wx.setNavigationBarTitle({title:"拼多多12.12购物节"});var e=this;(0,c.default)(l.default.mark(function t(){var n,r,o;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=i.default.mainCarnivalPromotion,r=u.Request.requestDataWithUrl("GET",n),t.next=5,u.Request.runMainRequestForPage(r,e.target);case 5:(o=t.sent).goods_list.map(function(t,n){return t.cssClassSuffix=e.constantData().cssClassSuffix[t.promotion_id]||"a",s.default.formatData(t.goods),t}),e.setData({selectedIndex:0,goods_list:o.goods_list}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0);case 13:case"end":return t.stop()}},t,this,[[0,10]])}))}},{key:"segmentTap",value:function(e){if(e&&e.target&&e.target.dataset){var t=e.target.dataset;if(this.setData({selectedIndex:t.index}),wx.pageScrollTo&&wx.createSelectorQuery){var n=this,r=wx.createSelectorQuery(),o="#carnival-id-"+t.index;r.select(o).boundingClientRect(),r.select(".segment-container").boundingClientRect(),r.exec(function(e){e&&e[0]&&e[1]&&wx.pageScrollTo({scrollTop:n.page.scrollTop+e[0].top-e[1].height})})}(0,u.TrackingRecord)({op:"click",page_el_sn:99332,idx:t.index,tab_subject_id:t.promotionId,page_sn:10115,refer_xcx_campaign_d12:1})}}}]),f}();exports.default=f; 
 			}); 
		define("package_a/promotion_main/component/promotion_alert.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=e(require("../../../components/component.js")),i=e(require("../../../storage/ram_manager")),u=require("../../../common/index"),c=function(e){function c(e){var o=e.page,r=e.ns;t(this,c);var a=n(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,o,r));return a.addFunc("_alertTap",a.alertTap),a.countDown=5,a.updateData(),a}return o(c,a.default),r(c,[{key:"updateData",value:function(){15132672e5-Date.now()-i.default.timeDiff<=0&&(this.data.showAlert?this.countDown>0?(this.setData({countDown:this.countDown}),this.countDown--):u.Navigation.route("/pages/index/index","switchTab"):(this.setData({showAlert:!0,countDown:this.countDown}),this.countDown--))}},{key:"alertTap",value:function(e){u.Navigation.route("/pages/index/index","switchTab")}}]),c}();exports.default=c; 
 			}); 
		define("package_a/promotion_main/component/promotion_banner.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e(require("../../../components/component.js")),i=e(require("../../../configs/api")),u=(e(require("../../../libs/es6-promise.min.js")),e(require("../../../libs/co/we-index"))),c=e(require("../../../libs/regenerator-runtime/runtime")),s=require("../../../common/index"),l=function(e){function l(e){var n=e.page,o=e.ns;t(this,l);var a=r(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,n,o));return a.loadData(),a}return n(l,a.default),o(l,[{key:"loadData",value:function(){var e=this;(0,u.default)(c.default.mark(function t(){var r,n,o;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=i.default.carnivalImages+"?types=carnival_head",n=s.Request.requestDataWithUrl("GET",r),t.next=5,s.Request.runMainRequestForPage(n,e.target);case 5:o=t.sent,e.setData({carnivalImage:o.carnival_images[0]}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}},t,this,[[0,9]])}))}}]),l}();exports.default=l; 
 			}); 
		define("package_a/promotion_main/component/promotion_bottombar.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),a=e(require("../../../components/component.js")),i=(e(require("../../../configs/api")),e(require("../../../libs/es6-promise.min.js")),e(require("../../../libs/co/we-index")),e(require("../../../libs/regenerator-runtime/runtime")),require("../../../common/index")),c=[{title:"年终清仓",bottomBarId:3440,index:0},{title:"尖货特价",bottomBarId:3441,index:1},{title:"品类风暴",bottomBarId:"main",index:2},{title:"品牌折扣",index:3}],s=function(e){function s(e){var r=e.page,n=e.ns;t(this,s);var a=o(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,r,n));return a.addFunc("_bottombarItemTap",a.bottombarItemTap),a.initData(),a}return r(s,a.default),n(s,[{key:"onPageScroll",value:function(e){if(wx.createSelectorQuery){var t=this,o=wx.createSelectorQuery(),r=this.data.bottomBar;for(var n in r)if(r[n]&&r[n].bottomBarId){var a="#bottombar-id-"+r[n].bottomBarId;o.select(a).boundingClientRect()}o.exec(function(e){if(e&&e.length>0)if(e[0]&&e[0].top>=0)0!=t.data.selectedIndex&&t.setData({selectedIndex:0});else if(e[e.length-1]&&e[e.length-1].top<=0)t.data.selectedIndex!=e.length-1&&t.setData({selectedIndex:e.length-1});else for(var o=0;o<e.length-1;o++)if(e[o]&&e[o+1]&&e[o].top<=0&&e[o+1].top>0){t.data.selectedIndex!=o&&t.setData({selectedIndex:o});break}})}}}]),n(s,[{key:"initData",value:function(){this.setData({selectedIndex:0,bottomBar:c})}},{key:"bottombarItemTap",value:function(e){if(e&&e.target&&e.target.dataset){var t=e.target.dataset;if(3==t.index)i.Navigation.forward("/pages/subjects/subjects?subjects_id=14");else if(this.setData({selectedIndex:t.index}),this.page.setData({"mainCarnivalPromotion.selectedIndex":0}),wx.pageScrollTo&&wx.createSelectorQuery){var o=this,r=wx.createSelectorQuery(),n="#bottombar-id-"+this.data.bottomBar[t.index].bottomBarId;r.select(n).boundingClientRect(),r.exec(function(e){e&&e[0]&&wx.pageScrollTo({scrollTop:o.page.scrollTop+e[0].top})})}else this.page.$showToast("微信版本较低无法跳转，您可以滑动查看对应商品",{showDuration:3e3});var a=[99330,99331,99329,99328];(0,i.TrackingRecord)({op:"click",page_el_sn:a[t.index],page_sn:10115,refer_xcx_campaign_d12:1})}}}]),s}();exports.default=s; 
 			}); 
		define("package_a/promotion_main/component/promotion_share_banner.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),o=e(require("../../../components/component.js")),s=e(require("../../../configs/api")),i=require("../../../common/message"),u=e(require("../../../storage/user_storage")),c=e(require("../../../libs/md5.min.js")),p=(e(require("../../../libs/es6-promise.min.js")),e(require("../../../libs/co/we-index"))),f=e(require("../../../libs/regenerator-runtime/runtime")),l=require("../../../common/index"),h=function(e){function h(e){var a=e.page,n=e.ns,o=e.pageSn;t(this,h);var s=r(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,a,n));return s.addFunc("_getFormId",s.getFormId),s.setCoWrap(),i.Message.on(i.KEYS.PROMOTION_MAIN_GET_OPEN_GID,s.promotionShare,!1,s),s.pageSn=o,s}return a(h,o.default),n(h,[{key:"onShareAppMessage",value:function(e){var t="";e&&("menu"==e.from?t="top_forward":"share-btn"==e.target.dataset.subRefer&&(t="big_sale_share"));var r=this;return this.page.$generateShareContent({title:this.shareTip?this.shareTip:"11.11购物节全民狂欢！限时免单，第二件1折等劲爆优惠错过等1年！",imageUrl:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_nov_venue/custom-share2.png",successCallBack:function(){},failCallBack:function(){r.data.showShareBanner&&r.page.$showToast("分享到微信群中才能领取红包哦",{showDuration:3e3})},referStr:t,pageSn:r.pageSn})}}]),n(h,[{key:"setCoWrap",value:function(){this.loadData=p.default.wrap(f.default.mark(function e(){var t,r,a,n;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.prev=1,r=s.default.promotionUserInfo,a=l.Request.requestDataWithUrl("POST",r,null,!1,{needGZToken:!0,forceUseApiGZ:!0}),e.next=6,l.Request.runMainRequestForPage(a,t.target);case 6:(n=e.sent).error_code||(t.setData({showShareBanner:n.data.popup,shareImage:n.data.image_url}),t.shareTip=n.data.share_tip),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:case"end":return e.stop()}},e,this,[[1,10]])}))}},{key:"onUnload",value:function(){i.Message.off(i.KEYS.PROMOTION_MAIN_GET_OPEN_GID)}},{key:"promotionShare",value:function(e){var t=this;(0,p.default)(f.default.mark(function r(){var a,n,o,i,p,h;return f.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(a=u.default.getUserId(),n=u.default.getOpenId(),r.prev=2,e){r.next=5;break}throw"获取群信息失败";case 5:if(n){r.next=7;break}throw"获取登陆信息失败";case 7:return o={group_id:e,open_id:n,form_id:t.formId||"",sign:(0,c.default)("epcYXQ9JNx34C0hS3GYbR+tJquSSRiecmJDoZD8pwTQ="+a+e)},i=s.default.promotionShare,r.next=11,l.Request.apiRequest("POST",i,o,!1,{forceUseApiGZ:!0,needGZToken:!0});case 11:if(p=r.sent,h=p.data||{},l.DataUtil.isObject(h)&&p.success){r.next=15;break}throw"获取活动信息出错";case 15:t.shareTip=h.share_tip,h.toast&&t.data.showShareBanner&&t.page.$showToast(h.toast,{showDuration:3e3}),r.next=23;break;case 19:r.prev=19,r.t0=r.catch(2),console.error(r.t0),t.data.showShareBanner&&t.requestError(r.t0);case 23:case"end":return r.stop()}},r,this,[[2,19]])}))}},{key:"getFormId",value:function(e){e&&e.detail&&e.detail.formId&&(this.formId=e.detail.formId,(0,l.TrackingRecord)({op:"click",page_element:"share_btn",page_sn:this.pageSn}))}},{key:"requestError",value:function(e){var t="string"==typeof e?e:"网络出错";this.page.$showToast(t,{showDuration:3e3})}}]),h}();exports.default=h; 
 			}); 
		define("package_a/promotion_main/component/promotion_timeline.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=e(require("../../../components/component.js")),r=e(require("../../../configs/api")),s=(require("../../../common/message"),e(require("../../../storage/user_storage")),e(require("../../../libs/md5.min.js")),e(require("../../../controller/formid_controller")),e(require("../../../libs/es6-promise.min.js")),e(require("../../../libs/co/we-index"))),p=e(require("../../../libs/regenerator-runtime/runtime")),u=e(require("../../../storage/ram_manager")),c=require("../../../common/index"),m={12.04:0,12.07:0,"12.10":0,12.13:0,12.05:1,12.08:1,12.11:1,12.14:1,12.06:2,12.09:2,12.12:2},l=[["恭喜！你被1折特权选中","12.12超值礼包免费领","限时开放：0元专区>>","冬装清仓团¥5.9起","亏本卖！收纳箱2.3元起","10件限量抢！电吹风¥19.9","限时！10斤新米免费领","5折专场>>厂家直销男款冬装","奶粉纸尿裤1折特卖","大牌身体乳、洗护套装¥5.9","超厚显瘦羽绒服¥29.9起"],["抢免单！纸抽小家电0元","送你一个9.9元入场资格","点击进入1折专区>>","9.9元保暖内衣套装已到货","8.9元洗衣液最后1小时","最后50件！大牌微波炉¥59","亏本卖！1折专区：薄皮核桃8元","男人必备 毛呢大衣￥19.9","童装羽绒服封顶¥49","抗皱精华、眼霜¥15.9","网红毛呢大衣、阔腿裤¥19.9"],["9.9特价已开启，仅1天！","恭喜！邀请你进入免单专区","0.99元特价福利>>入场领","¥8.5打底裤毛衣已降底价","最后5套 纯棉四件套¥19.9","限量50件！大牌电饭煲¥29.9","坚果组合特价¥8.9 水果生鲜1元","超厚羽绒服！￥39.9即将涨价","纯棉儿童内衣>>加厚打底裤","唇膏买1送1 超火bb霜19.9","明星款 美美御寒￥39.9"]],d=[3440,3441,3442,3443,3444,3445,3446,3448,3454,3456,4620],h=[{timestamp:15124032e5,endTime:15130944e5,titleTop:"12.4",titleBottom:"粉丝狂欢节开幕",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1204.png"},{timestamp:15124896e5,endTime:15130944e5,titleTop:"12.5",titleBottom:"红包拼手速",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1205.png"},{timestamp:1512576e6,endTime:15130944e5,titleTop:"12.6",titleBottom:"每日有惊喜",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1205.png"},{timestamp:15126624e5,endTime:15130944e5,titleTop:"12.7",titleBottom:"每日有惊喜",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1205.png"},{timestamp:15127488e5,endTime:15130944e5,titleTop:"12.8",titleBottom:"每日有惊喜",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1205.png"},{timestamp:15128352e5,endTime:15130944e5,titleTop:"12.9",titleBottom:"每日有惊喜",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1205.png"},{timestamp:15129216e5,endTime:15130944e5,titleTop:"12.10",titleBottom:"限时免单日",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1210.png"},{timestamp:1513008e6,endTime:15130944e5,titleTop:"12.11",titleBottom:"红包翻倍",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1210.png"},{timestamp:15130944e5,endTime:15130944e5,titleTop:"12.12",titleBottom:"历史最低价",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1212.gif"},{timestamp:15131808e5,endTime:15132672e5,titleTop:"12.13",titleBottom:"返场归来 最后疯抢",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1213.png"},{timestamp:15132672e5,endTime:15132672e5,titleTop:"12.14",titleBottom:"返场归来 最后疯抢",topBanner:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/top_banner1214.png"}],f=function(e){function f(e){var n=e.page,i=e.ns,a=e.pageSn;t(this,f);var r=o(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,n,i));return r.addFunc("_calendarTap",r.calendarTap),r.addFunc("_closeCalendarTap",r.closeCalendarTap),r.addFunc("_gotoChaihongbao",r.gotoChaihongbao),r.addFunc("_hideShareAlert",r.hideShareAlert),r.setCoWrap(),r.initData(),r.pageSn=a,r}return n(f,a.default),i(f,[{key:"onShareAppMessage",value:function(e){var t="";e&&("menu"==e.from?t="top_forward":"share-btn"==e.target.dataset.subRefer&&(t="big_sale_share"));var o=this;return this.page.$generateShareContent({title:this.shareTip?this.shareTip:"12.12狂欢节1折品牌清仓，年终疯抢！红包整点发放，入场领取>>",imageUrl:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/custom-share2.png",successCallBack:function(){o.loadPromotionUserInfo()},failCallBack:function(){o.loadPromotionUserInfo()},referStr:t,refer_xcx_campaign_d12:1,pageSn:o.pageSn})}}]),i(f,[{key:"setCoWrap",value:function(){this.loadData=s.default.wrap(p.default.mark(function e(){var t;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.prev=1,e.next=4,[t.loadPromotionUserInfo()];case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:case"end":return e.stop()}},e,this,[[1,6]])})),this.loadPromotionUserInfo=s.default.wrap(p.default.mark(function e(){var t,o,n,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.prev=1,o=r.default.promotionUserInfo,n=c.Request.requestDataWithUrl("POST",o,null,!1,{needGZToken:!0,forceUseApiGZ:!0}),e.next=6,c.Request.runMainRequestForPage(n,t.target);case 6:if((i=e.sent)||i.success){e.next=9;break}return e.abrupt("return");case 9:t.processPromotionUserInfo(i),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0);case 15:case"end":return e.stop()}},e,this,[[1,12]])}))}},{key:"processPromotionUserInfo",value:function(e){var t=this;e.error_code||(t.shareTip=e.data.share_tip)}},{key:"initData",value:function(){var e=this,t=Date.now()+u.default.timeDiff;h.some(function(o){return!!(o&&t<o.timestamp)&&(e.setData(o),!0)});var o=c.TimeUtil.formatTime(t/1e3,"MM.dd"),n=m[o]||0;this.gotCouponList=l[n],this.setData({gotCouponList:this.gotCouponList,bubbleId:d}),this.countTime=0,this.setTimes=0}},{key:"updateData",value:function(){var e=this.data.endTime-Date.now()-u.default.timeDiff,t=this.data.timestamp-Date.now()-u.default.timeDiff;if(e>=0&&t>0){var o=c.TimeUtil.getPackagedTimeFromTimeBucket(e,"DHMS");this.setDataObj({packagedTime:o})}else this.initData();3==++this.countTime&&this.gotCouponList&&this.gotCouponList.length>0&&this.gotCouponList.length>this.setTimes&&(this.countTime=0,this.setGotCoupon())}},{key:"setGotCoupon",value:function(){var e=this;e.gotCouponList&&(e.setDataObj({bubbleIndex:e.setTimes,bubbleNextIndex:e.bubblePreviousIndex}),e.bubblePreviousIndex=e.setTimes,e.setTimes<e.gotCouponList.length-1?e.setTimes++:e.setTimes=0)}},{key:"calendarTap",value:function(e){this.setData({showCalendar:!0}),(0,c.TrackingRecord)({op:"click",page_sn:10115,page_el_sn:99353,refer_xcx_campaign_d12:1})}},{key:"closeCalendarTap",value:function(e){this.setData({showCalendar:!1})}},{key:"gotoChaihongbao",value:function(e){c.Navigation.route("/pages/open_envelope/open_envelope"),(0,c.TrackingRecord)({op:"click",page_sn:10115,page_el_sn:99349,refer_xcx_campaign_d12:1})}},{key:"hideShareAlert",value:function(e){this.setData({showShareAlert:!1})}},{key:"requestError",value:function(e){var t="string"==typeof e?e:"网络出错";this.page.$showToast(t,{showDuration:3e3})}}]),f}();exports.default=f; 
 			}); 
		define("package_a/promotion_main/component/relay_promotion.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),a=e(require("../../../components/component.js")),i=e(require("../../../configs/api")),u=e(require("../../../models/format/promotion_goods_formatter")),s=(e(require("../../../libs/es6-promise.min.js")),e(require("../../../libs/co/we-index"))),l=e(require("../../../libs/regenerator-runtime/runtime")),c=require("../../../common/index"),f=function(e){function f(e){var o=e.page,n=e.ns,a=e.type;t(this,f);var i=r(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,o,n));return i.type=a,i}return o(f,a.default),n(f,[{key:"loadData",value:function(){this.loadRelayPromotion()}},{key:"loadRelayPromotion",value:function(){var e=this;(0,s.default)(l.default.mark(function t(){var r,o,n,a;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=i.default.relayPromotion,o={type:e.type},n=c.Request.requestDataWithUrl("GET",r,o),t.next=6,c.Request.runMainRequestForPage(n,e.target);case 6:(a=t.sent).relay_promotion_list.map(function(e){return u.default.formatData(e.goods_list),e}),e.setData({relay_promotion_list:a.relay_promotion_list}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0);case 14:case"end":return t.stop()}},t,this,[[0,11]])}))}}]),f}();exports.default=f; 
 			}); 
		define("package_a/promotion_main/component/tesla.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e(require("../../../components/component.js")),i=e(require("../../../configs/api")),u=require("../../../common/index"),s=(e(require("../../../libs/es6-promise.min.js")),e(require("../../../libs/co/we-index"))),c=e(require("../../../libs/regenerator-runtime/runtime")),f=function(e){function f(e){var n=e.page,o=e.ns;return t(this,f),r(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,n,o))}return n(f,a.default),o(f,[{key:"loadData",value:function(){var e=this;(0,s.default)(c.default.mark(function t(){var r,n,o;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=i.default.tesla+"?offset=0&count=40&app_name=industry_promotion",n=u.Request.requestDataWithUrl("GET",r),t.next=5,u.Request.runMainRequestForPage(n,e.target);case 5:o=t.sent,e.formateData(o),e.setData({teslaList:o.data}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0);case 13:case"end":return t.stop()}},t,this,[[0,10]])}))}},{key:"formateData",value:function(e){e&&e.data instanceof Array&&e.data.map(function(e){e.goodsId=e.goods_id,e.imgUrl=u.ImageUtil.cdnCompress(e.hd_thumb_url||e.thumb_url),e.goodsName=e.short_name||e.goods_name,e.price=u.StdFormat.price(e.price,100),e.soldQuantity=u.StdFormat.sales(e.sales),e.transData={ad:e.ad,p_rec:e.p_rec,p_search:e.p_search}})}}]),f}();exports.default=f; 
 			}); 
		define("pages/goods/cache_goods_data.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e&&e.__esModule?e:{default:e}}(require("../../common/data_util")),t={},a={setDataToCache:function(a,u){var n=[a,e.default.getLogId()].join("_");return t[n]=u,n},getDataFromCache:function(e){return e?t[e]:null},deleteCacheData:function(e){delete t[e]},clearCacheData:function(){t={}}};exports.default=a; 
 			}); 
		define("pages/goods/goods_icons.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={lottery:"抽奖",freeTrial:"免费试用",appOnly:"App专享",preSale:"预售",capitalGift:"包团送礼"};exports.default={getGoodsIconsData:function(a){if(a){var t=[];return a.isLottery&&t.push({iconName:e.lottery}),a.isFreeTrial&&t.push({iconName:e.freeTrial}),(a.isCapitalGift||a.isCapitalGiftLottery)&&t.push({iconName:e.capitalGift}),a.isApp&&t.push({iconName:e.appOnly}),a.isPreSale&&t.push({iconName:e.preSale}),t}}}; 
 			}); 
		define("pages/goods/goods_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function a(){var a=getCurrentPages(),e=void 0;return a.length>0&&(e=a[a.length-1]||{}),e}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../../common/index"),t={hasSkuSelector:{valName:"hasSkuSelector",fromData:!1},goodsBottomBarData:{valName:"goodsBottomBarData",fromData:!1},goods:{valName:"goodsInfo",fromData:!0},selectedGroup:{valName:"selectedGroup",fromData:!0},currentSelect:{valName:"currentSelect",fromData:!0},goodsNumber:{valName:"goodsNumber",fromData:!0},mallInfo:{valName:"mallInfo",fromData:!0},currentSkuImg:{valName:"currentSkuImg",fromData:!0},selectedLocalGroupOrderId:{valName:"selectedLocalGroupOrderId",fromData:!0}},r={setBarDataInPage:function(e){var r=a();if(r){var o={};for(var l in e)if(e.hasOwnProperty(l)&&t.hasOwnProperty(l)){var u=t[l];u.fromData?o[u.valName]=e[l]:r[u.valName]=e[l]}this.setData(o)}},getBarDataNeededFromPage:function(e){var r=a();if(r){var o={};for(var l in t)if(t.hasOwnProperty(l)){var u=t[l];u.fromData?o[l]=r.data[u.valName]:o[l]=r[u.valName]}return e?o[e]:o}},setData:function(e){var t=a();t&&t.setData(e)},goLotteryList:function(a){var t=this.getBarDataNeededFromPage("goods");!t||2!==t.luckyStatus&&3!==t.luckyStatus||!t.luckyId||e.Navigation.forward("/pages/lottery_list/lottery_list?"+e.UrlUtil.buildQuery({lucky_id:t.luckyId}))},goDrawLuckyList:function(){e.Navigation.forward("/pages/subject/subject?"+e.UrlUtil.buildQuery({subject_id:2742}))}};exports.default=r; 
 			}); 
		define("pages/goods/play_rules.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={default:"拼团玩法",freeTrial:"免费试用团玩法",capitalGift:""},t=[["支付开团","或参团"],["邀请好友","参团"],["人数达到","分别发货"],["人数不够","自动退款"]],a=[["0元开团","或参团"],["邀请好友","参团"],["人数达到","成团"],["随机抽中","未中赠券"]],i=[["支付订单","开团送礼"],["分享好友","赠送礼物"],["全部领取","成团发货"],["人数不够","自动退款"]];exports.default={getPlayRules:function(l){var r=e.default,f=t;return l&&(l.isFreeTrial?(r=e.freeTrial,f=a):(l.isCapitalGift||l.isCapitalGiftLottery)&&(r=e.capitalGift,f=i)),{title:r,flow:f}}}; 
 			}); 
		define("pages/group/group_user_data.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e&&e.__esModule?e:{default:e}}(require("../../common/time_util")),s={leftUser:"leftUser",collapses:"collapses"};exports.default={processUsersData:function(e,t){t=t||{};var r=JSON.parse(JSON.stringify(e.users)),a=e.leftUserNum;t.dontShowleftUserIcon&&(a=0);var l=r.length+a;if(a)for(var u=0;u<a&&!(r.length>=50);u++)r.push({avatarImg:"",type:s.leftUser,isLast:!1});if(50!==l&&r.length>=50){r=r.slice(0,49);var o={};o.isLast=!0,a?(o.type=s.leftUser,r.push(o)):(o.type=s.collapses,r.push(o))}return r.map(function(e){return e.userItemClass="group-detail-user",e.avatarImg||(e.type===s.leftUser&&(e.userItemClass=[e.userItemClass,"left-user"].join(" "),e.isLast&&(e.userItemClass=[e.userItemClass,"is-last"].join(" "))),e.type===s.collapses&&(e.userItemClass=[e.userItemClass,"collapses"].join(" "))),e}),r},getUsersTemplateData:function(t,r){var a=!!(r=r||{}).dontShowleftUserIcon,l=this.processUsersData(t,{dontShowleftUserIcon:a}),u=t.users;return u.map(function(s){return s.formatJoinTimeStr=s.joinTime&&e.default.formatTime(new Date(1e3*s.joinTime)),s}),{usersData:l,users:u,leader:u[0],currentUser:t.selfOrderInfo||{},userType:s,leftUserNum:a?0:t.leftUserNum,totalNum:t.users.length+t.leftUserNum,userListPopVisible:!1}}}; 
 			}); 
		define("pages/index/index_special_goods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../common/index"),r=e(require("../../constants/groups")),o=e(require("../../models/format/index_goods_item")),a=[r.default.EventType.FREE_TRIAL,r.default.EventType.LUCKY_DRAW];exports.default={processSpecialGoods:function(e){var n=[];return(e=e||[]).forEach(function(e){var s=!0;if(a.indexOf(parseInt(e.event_type,10))>=0&&1!=e.is_app){var u=o.default.formatData(e);t.User.getShowPortalFreeTrialGoods()||u.eventType!==r.default.EventType.FREE_TRIAL||(s=!1),t.User.getShowPortalLotteryGoods()||u.eventType!==r.default.EventType.LUCKY_DRAW||(s=!1),s&&n.push(u)}}),n}}; 
 			}); 
		define("pages/order/complaint_const.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _={PAY_COMPLAINT_APPLIED_0:0,PAY_COMPLAINT_APPEND_1:1,PAY_COMPLAINT_MODIFY_2:2,PAY_COMPLAINT_CANCEL_3:3,PAY_COMPLAINT_AGREE_BY_SALER_4:4,PAY_COMPLAINT_REJECT_BY_SALER_5:5,PAY_COMPLAINT_SET_SERVICE_6:6,PAY_COMPLAINT_MODIFY_BY_SERVICE_8:8,PAY_COMPLAINT_AGREE_BY_SERVICE_7:7,PAY_COMPLAINT_REJECT_BY_SERVICE_9:9,PAY_COMPLAINT_REFUND_COMPL_10:10,PAY_COMPLAINT_AGREE_BY_SALER_EXPIRE_11:11,PAY_COMPLAINT_SALER_REQUIRE_RETURN_12:12,PAY_COMPLAINT_APPEND_BY_SALER_13:13,PAY_COMPLAINT_APPEND_BY_SERVICE_14:14,PAY_COMPLAINT_REJECT_BY_SALER_EXPIRE_15:15,PAY_COMPLAINT_RETURN_SUCC_16:16,PAY_COMPLAINT_RETURN_FAIL_17:17,PAY_COMPLAINT_RETURN_EXPIRE_SUCC_18:18,PAY_COMPLAINT_CHEAT_SALER_19:19,PAY_COMPLAINT_USER_SUBMIT_DSN_20:20,PAY_COMPLAINT_USER_REAPPLY_21:21,PAY_COMPLAINT_USER_APPLY_JUDGEMENT_22:22,PAY_COMPLAINT_SALER_APPLY_JUDGEMENT_23:23,PAY_COMPLAINT_SALER_AGREE_RETURN_24:24,PAY_COMPLAINT_USER_EXPIRE_DEAL_25:25,PAY_COMPLAINT_USER_EXPIRE_SEND_26:26,PAY_COMPLAINT_APPLIED_BY_SERVICE_27:27,PAY_COMPLAINT_USER_EXPIRE_DEAL_END_28:28,PAY_COMPLAINT_RESTORE_BY_SERVICE_29:29,PAY_COMPLAINT_APPEND_PUBLIC_BY_SERVICE_30:30,PAY_COMPLAINT_SERVICE_APPLY_JUDGEMENT_31:31,PAY_COMPLAINT_APPEND_PUBLIC_WITH_ADDR_BY_SERVICE_32:32,OLD_COMPLAINT_INTT_100:100,OLD_COMPLAINT_STATUS_101:101,OLD_COMPLAINT_END_102:102},A={COMPLAINT_NULL_M1:-1,COMPLAINT_INIT_0:0,COMPLAINT_SALES_DEALING_1:1,COMPLAINT_SERVICE_INIT_2:2,COMPLAINT_SERVICE_DEALING_3:3,COMPLAINT_REFUNDING_4:4,COMPLAINT_REFUNDED_SUCC_5:5,COMPLAINT_CANCELED_6:6,COMPLAINT_FAILED_7:7,COMPLAINT_END_8:8,COMPLAINT_WAIT_USER_DEAL_9:9,COMPLAINT_WAIT_USER_SEND_10:10,COMPLAINT_WAIT_SALES_SEND_COMFIRM_11:11,COMPLAINT_FAIL_12:12,COMPLAINT_FAIL_EXPIRE_13:13};exports.default={operateType:_,flowType:A,getOperateTypeString:function(A,P){0===P&&(P=1);var E="";switch(void 0!==P&&(E=["申诉","退款","退货退款","换货"][P]),A){case _.PAY_COMPLAINT_APPLIED_0:return"用户申请"+E;case _.PAY_COMPLAINT_APPEND_1:return"用户添加了描述和凭证";case _.PAY_COMPLAINT_MODIFY_2:return"用户修改了信息";case _.PAY_COMPLAINT_CANCEL_3:return"用户撤销了申请";case _.PAY_COMPLAINT_AGREE_BY_SALER_4:return"商家通过了退款申请";case _.PAY_COMPLAINT_REJECT_BY_SALER_5:return"商家驳回了买家申请";case _.PAY_COMPLAINT_SET_SERVICE_6:return"平台分配受理人";case _.PAY_COMPLAINT_MODIFY_BY_SERVICE_8:return"平台修改退款金额";case _.PAY_COMPLAINT_AGREE_BY_SERVICE_7:return"平台通过了买家申请";case _.PAY_COMPLAINT_REJECT_BY_SERVICE_9:return"平台驳回了买家申请";case _.PAY_COMPLAINT_REFUND_COMPL_10:return"退款成功";case _.PAY_COMPLAINT_AGREE_BY_SALER_EXPIRE_11:return"商家逾期未处理，默认同意";case _.PAY_COMPLAINT_SALER_REQUIRE_RETURN_12:return"商家要求买家退货";case _.PAY_COMPLAINT_APPEND_BY_SALER_13:return"商家添加了描述和凭证";case _.PAY_COMPLAINT_APPEND_BY_SERVICE_14:return"平台添加了备注";case _.PAY_COMPLAINT_REJECT_BY_SALER_EXPIRE_15:return"商家逾期未处理，转由平台处理";case _.PAY_COMPLAINT_RETURN_SUCC_16:return"退货成功，商家同意退款";case _.PAY_COMPLAINT_RETURN_FAIL_17:return"退货失败，商家拒绝退款";case _.PAY_COMPLAINT_RETURN_EXPIRE_SUCC_18:return"退货成功，商家逾期未处理";case _.PAY_COMPLAINT_CHEAT_SALER_19:return"商家发生未知错误";case _.PAY_COMPLAINT_USER_SUBMIT_DSN_20:return"用户已发货";case _.PAY_COMPLAINT_USER_REAPPLY_21:return"用户修改了"+E+"申请";case _.PAY_COMPLAINT_USER_APPLY_JUDGEMENT_22:return"用户申请平台介入";case _.PAY_COMPLAINT_SALER_APPLY_JUDGEMENT_23:return"商家申请平台介入";case _.PAY_COMPLAINT_SALER_AGREE_RETURN_24:return"商家同意退货退款";case _.PAY_COMPLAINT_USER_EXPIRE_DEAL_25:return"买家逾期未处理";case _.PAY_COMPLAINT_USER_EXPIRE_SEND_26:return"买家逾期未发货";case _.PAY_COMPLAINT_APPLIED_BY_SERVICE_27:return"平台发起"+E+"申请";case _.PAY_COMPLAINT_USER_EXPIRE_DEAL_END_28:return"超过退款有效期，退款关闭";case _.PAY_COMPLAINT_RESTORE_BY_SERVICE_29:return"平台恢复了买家申请";case _.PAY_COMPLAINT_APPEND_PUBLIC_BY_SERVICE_30:return"平台添加了留言";case _.PAY_COMPLAINT_SERVICE_APPLY_JUDGEMENT_31:return"平台协助买家介入";case _.PAY_COMPLAINT_APPEND_PUBLIC_WITH_ADDR_BY_SERVICE_32:return"平台添加了退货信息";case _.OLD_COMPLAINT_INTT_100:return"用户申请售后投诉";case _.OLD_COMPLAINT_STATUS_101:return"平台正在处理此售后投诉";case _.OLD_COMPLAINT_END_102:return"此售后投诉单已完成";default:return"未知流程"+A}},getFlowStatusString:function(A,P){var E,I="";switch(A){case _.PAY_COMPLAINT_APPLIED_0:E="申请收到";break;case _.PAY_COMPLAINT_CANCEL_3:E="申请已撤销";break;case _.PAY_COMPLAINT_AGREE_BY_SALER_4:E="商家已同意退款",I="商家";break;case _.PAY_COMPLAINT_AGREE_BY_SALER_EXPIRE_11:E="商家逾期未处理",I="商家";break;case _.PAY_COMPLAINT_SALER_REQUIRE_RETURN_12:E="商家要求买家退货";break;case _.PAY_COMPLAINT_REJECT_BY_SALER_5:E="商家驳回";break;case _.PAY_COMPLAINT_REJECT_BY_SALER_EXPIRE_15:E="商家逾期未处理";break;case _.PAY_COMPLAINT_AGREE_BY_SERVICE_7:E="平台已同意退款",I="平台";break;case _.PAY_COMPLAINT_REJECT_BY_SERVICE_9:E="平台驳回申请";break;case _.PAY_COMPLAINT_REFUND_COMPL_10:E="退款成功";break;case _.PAY_COMPLAINT_RETURN_SUCC_16:case _.PAY_COMPLAINT_RETURN_EXPIRE_SUCC_18:E="退货成功",I="商家";break;case _.PAY_COMPLAINT_RETURN_FAIL_17:E="商家驳回退款";break;case _.PAY_COMPLAINT_CHEAT_SALER_19:E="";break;case _.PAY_COMPLAINT_USER_SUBMIT_DSN_20:E="买家已发货";break;case _.PAY_COMPLAINT_USER_REAPPLY_21:E="申请已修改";break;case _.PAY_COMPLAINT_USER_APPLY_JUDGEMENT_22:E="用户申请平台介入";break;case _.PAY_COMPLAINT_SALER_APPLY_JUDGEMENT_23:E="商家申请平台介入";break;case _.PAY_COMPLAINT_SALER_AGREE_RETURN_24:E="商家同意退货退款";break;case _.PAY_COMPLAINT_USER_EXPIRE_DEAL_25:E="买家逾期未处理";break;case _.PAY_COMPLAINT_USER_EXPIRE_SEND_26:E="买家逾期未发货";break;case _.PAY_COMPLAINT_APPLIED_BY_SERVICE_27:E="平台发起申请";break;case _.PAY_COMPLAINT_USER_EXPIRE_DEAL_END_28:E="";break;case _.PAY_COMPLAINT_RESTORE_BY_SERVICE_29:E="平台恢复申请";break;case _.PAY_COMPLAINT_SERVICE_APPLY_JUDGEMENT_31:E="平台协助买家介入";break;case _.PAY_COMPLAINT_APPEND_PUBLIC_WITH_ADDR_BY_SERVICE_32:E="平台添加退货信息";break;case _.OLD_COMPLAINT_INTT_100:case _.OLD_COMPLAINT_STATUS_101:return"申诉收到，平台处理中";case _.OLD_COMPLAINT_END_102:return"售后流程结束";default:return"未知状态("+A+")请升级拼多多版本"}return 0==P||1==P||11==P?(E&&(E+="，"),E+"商家处理中"):2==P||3==P?(E&&(E+="，"),E+"平台处理中"):4==P?(E&&(E+="，"),E+I+"退款中"):10==P?(E&&(E+="，"),E+"等待用户发货"):12==P?(E&&(E+="，"),E+I+"退款失败"):13==P?(E&&(E+="，"),E+I+"退款关闭"):E}}; 
 			}); 
		define("pages/order_checkout/auto_create_group.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function r(e){return e=parseInt(e,10),-1===[t.default.EventType.TZMD,t.default.EventType.CAPITAL_GIFT,t.default.EventType.CAPITAL_GIFT_LOTTERY,t.default.EventType.TZYY,t.default.EventType.SPIKE].indexOf(e)}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../../constants/groups")),a=e(require("../../configs/api")),o=e(require("../../common/data_util")),u=e(require("../../common/request")),n=e(require("../../common/url_util")),s=e(require("../../storage/ram_manager")),c=e(require("../../libs/co/we-index")),l=e(require("../../libs/regenerator-runtime/runtime")),i={createGroup:function(e,t,a){if(this.autoCreateData=e,this.createOrderFunc=t,this.failCallback=a,this.selectedMallCoupon=null,this.selectedPlatformCoupon=null,r(e.eventType)){var o=this;s.default.CPPage.$showToast("该团已满，正在开新团...",{hideToastFunc:function(){e.orderSn?o.tryCancelPreOrder(e.orderSn):o.prepareOrder()}})}else wx.showModal({content:"团已满",showCancel:!1,success:function(e){e.confirm&&"function"==typeof this.failCallback&&this.failCallback()}})},tryCancelPreOrder:function(e){var r=this,t=o.default.formatByPos(a.default.cancelOrder,e);u.default.apiRequest("POST",t,null).then(function(){r.prepareOrder()},function(){"function"==typeof r.failCallback&&r.failCallback()})},prepareOrder:function(){var e=this,r=this.autoCreateData;this.currentOrderAmount=r.notFormatPrice*r.goodsNumber,this.currentOrderAmount<=100?this.createOrder():this.loadMallCoupons(function(){e.currentOrderAmount<=100?e.createOrder():e.loadPlatformCoupons(function(){e.createOrder()})})},loadMallCoupons:function(e){var r=this.autoCreateData,t=this;(0,c.default)(l.default.mark(function o(){var s,c,i,d,f,p;return l.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,s=t.couponsParams,c={group_id:r.groupId,sku_id:r.skuId,sku_number:r.goodsNumber,source_mall_id:r.sourceMallId},i=a.default.mallCoupons+"?"+n.default.buildQuery(c),o.next=6,u.default.apiRequest("GET",i);case 6:d=o.sent,f=d.coupons||{},(p=(f.usable_coupons||[])[0])&&(t.autoCreateData.createOrderParams.mallCouponId=p.coupon_id,t.currentOrderAmount-=p.discount,t.selectedMallCoupon=p.coupon_id),e(),o.next=17;break;case 13:o.prev=13,o.t0=o.catch(0),console.error(o.t0),e();case 17:case"end":return o.stop()}},o,this,[[0,13]])}))},loadPlatformCoupons:function(e){var r=this.autoCreateData,t=this;(0,c.default)(l.default.mark(function o(){var s,c,i,d,f,p;return l.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,s=t.couponsParams,c={group_id:r.groupId,sku_id:r.skuId,sku_number:r.goodsNumber,current_order_amount:t.currentOrderAmount},i=a.default.platformCoupons+"?"+n.default.buildQuery(c),o.next=6,u.default.apiRequest("GET",i);case 6:d=o.sent,f=d.coupons||{},(p=(f.usable_coupons||[])[0])&&(t.autoCreateData.createOrderParams.platformCouponId=p.coupon_id,t.currentOrderAmount-=p.discount,t.selectedPlatformCoupon=p.coupon_id),e(),o.next=17;break;case 13:o.prev=13,o.t0=o.catch(0),console.error(o.t0),e();case 17:case"end":return o.stop()}},o,this,[[0,13]])}))},createOrder:function(){var e=this.autoCreateData.createOrderParams;e.mallCouponId=this.selectedMallCoupon,e.platformCouponId=this.selectedPlatformCoupon,"function"==typeof this.createOrderFunc&&this.createOrderFunc(e)}};exports.default=i; 
 			}); 
		define("pages/order_checkout/goods_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={getLimitQuantity:function(e,t){var r=parseInt(e.quantity,10)||0,i=parseInt(t.orderLimit,10)||0,u=parseInt(e.limitQuantity,10)||0,n=i;return n>r&&r>0&&(n=r),n>u&&u>0&&(n=u),n},getSelectedSkuPrice:function(e,t){return parseInt(e.customerNum||0,10)>1?t&&t.groupPrice?t.groupPrice:"":t.normalPrice}}; 
 			}); 
		define("pages/orders/orders_manager_util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(require("../../models/managers/base_manager")),i=e(require("../../common/object_util")),u={},f=function(e){function u(e,r){return t(this,u),n(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e,r))}return r(u,a.default),o(u,[{key:"updateOrderInfo",value:function(e,t){if(e&&null!=this.dataKeyIndexMap[e]){var n=this.dataKeyIndexMap[e];n>=0&&n<this.dataList.length&&(this.dataList[n]=i.default.assign(this.dataList[n],t||{}))}}}]),u}(),l={createOrdersManager:function(e,t){e&&t&&t.forEach(function(t){u[e+"#"+t.type]=new f("order_sn")})},getManagerWithType:function(e,t){return null!=e&&null!=t?u[e+"#"+t]:null},removeOrdersManager:function(e){if(e)for(var t in u)t&&u.hasOwnProperty(t)&&t.indexOf(e)>=0&&delete u[t]}};exports.default=l; 
 			}); 
		define("pages/subjects/subjects_spike.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t,e){var r=a.TimeUtil.formatTime(t,"yyyy-MM-dd").replace(/-/g,"/"),o=new Date(r).getTime()/1e3,i=o+86400;return e>=o&&e<i}function e(t,e){var r=a.TimeUtil.formatTime(t,"yyyy-MM-dd").replace(/-/g,"/"),o=new Date(r).getTime()/1e3,i=o+172800;return e>=o+86400&&e<i}function r(t,e){var r=a.TimeUtil.formatTime(t,"yyyy-MM-dd").replace(/-/g,"/"),o=new Date(r).getTime()/1e3;return e>o+172800}Object.defineProperty(exports,"__esModule",{value:!0});var a=require("../../common/index"),o={today:"今日",tomorrow:"明日",afterTomorrow:"后天"},i={sellOut:"{0}件已抢光",notSellOut:"仅剩{0}件",waittingDesc:"{0}开抢"},s={getSpikeGoodsData:function(t,e){var r=this;t&&"function"==typeof e&&a.Request.apiRequest("GET",t,null,!0).then(function(t){e(r.formatData(t))},function(t){e(null)})},formatData:function(s,n){var m=s.goods||[],u=s.server_time||Math.floor(Date.now()/1e3);u=parseInt(u,10);var c=[],l={},d=[],p=[];(m=a.DataUtil.objectArrayDuplicateRemove(m,"goods_id",function(t){return 1==t.is_app})).forEach(function(t,s){var n={goodsId:t.goods_id,goodsName:t.short_name||t.goods_name||"",startTime:parseInt(t.start_time,10)||0,thumbUrl:a.ImageUtil.cdnCompress(t.hd_thumb_url||t.thumb_url),price:a.StdFormat.price(t.price,100),marketPrice:a.StdFormat.price(t.market_price,100),quantity:parseInt(t.quantity,10)||0,soldQuantity:parseInt(t.sold_quantity,10)||0,isLineLast:!1};t.ad&&(n.transData={ad:t.ad,p_rec:t.p_rec,p_search:t.p_search});var m=a.TimeUtil.formatTime(n.startTime,"hh:mm"),p=r(u,n.startTime)?o.afterTomorrow+"预告":e(u,n.startTime)?o.tomorrow+m:o.today+m;n.goodsTimeDesc=p,n.isSoldOut=n.quantity<=0,n.duringSpike=u>=n.startTime,n.duringSpike?n.countDesc=n.isSoldOut?a.DataUtil.formatByPos(i.sellOut,n.soldQuantity):a.DataUtil.formatByPos(i.notSellOut,n.quantity):n.countDesc=a.DataUtil.formatByPos(i.waittingDesc,m),l[n.startTime]?l[n.startTime].push(s):(l[n.startTime]=[],l[n.startTime].push(s),c=c.concat(d),d=[]),n.isSoldOut?d.push(n):c.push(n)}),c=c.concat(d);for(var f in l)if(l.hasOwnProperty(f)){var T=l[f]||[];c[T[T.length-1]].isLineLast=!0;var y=T[T.length-1];y<c.length-1&&(c[y].nextGoodsTimeDesc=c[y+1].goodsTimeDesc);var g=a.TimeUtil.formatTime(f,"hh:mm"),h=e(u,f)?o.tomorrow+g+(n&&f>u?"开抢":""):o.today+g+(n&&f>u?"开抢":""),D={time:f,startTime17Desc:r(u,f)?o.afterTomorrow+"预告":t(u,f)?o.today+"试吃":o.tomorrow+"预告",startTimeDesc:h,firstItemIndex:T[0],len:T.length};p.push(D)}return{goodsList:c,timelineList:p}}};exports.default=s; 
 			}); 
		define("pages/tzfree_list/tzfree_list_data.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={title:"",paramExpireTime:0,paramIsGetNew:0,paramReferPageName:"",showExpireTime:!1,isShowFreeCls:"",isShowRecCls:"",scrollTop:0,couponCount:0,freeIsRequest:!1,freePage:1,freeSize:50,freeDataList:[],recIsRequest:!1,recNoMoreText:"",recOffset:0,recCount:20,recDataList:[],signText:"团免价",btnText:"免费领取",cacheScrollTop:0,windowHeight:0,freeCanLoadMore:!0,recCanLoadMore:!0,loadingVisible:!0};exports.default=e; 
 			}); 
		define("pages/widget/widget.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";getApp();Page({data:{motto:"转发本页可看效果"},onLoad:function(){console.log("onLoad");wx.updateShareMenu&&wx.updateShareMenu({widget:!0})},onShareAppMessage:function(e){return{title:"一亿人都在拼多多~",path:"/pages/index/index",cacheKey:"pdd-detail-24952632"}}}); 
 			}); 
		define("storage/classification_storage.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e&&e.__esModule?e:{default:e}}(require("../constants/storage_keys")),t=require("../common/index");exports.default={saveClassificationInfo:function(t){t&&wx.setStorageSync(e.default.CLASSIFACATION_INFO,t)},getClassificationInfo:function(){return t.StorageUtil.getStorageSync(e.default.CLASSIFACATION_INFO)}}; 
 			}); 
		define("storage/ram_manager.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={isFirstShowLikeHint:!0,likeGoodsList:[],likeMallsList:[],likeGoodsIds:{},likeMallsIds:{},favoriteUpdateTime:null,favoriteMallUpdateTime:null,isFirstFavoritUpdate:!1,hasShowIndexUpaidOrderDialog:!1,showUnpaidOrderDialog:!1,isLastPagePayPage:!1,hasCreatedOrder:!1,isOrderForbidden:!1,lastOrderSn:"",hasPaySucess:!1,lastOrderGoodsData:{},lastOrderCheckoutOptions:{},showNotEnoughGroupDialog:!1,isLastPageGroupPage:!1,lastGroupOrderId:"",lastOrderGoodsId:"",lastPayGoodsId:"",isLastGroupNotEnough:"",hadGroupShareArray:[],requestCode:[],requestGid:"",shareTicket:"",CPSetData:{},CPData:{},CPPage:{},isSpecialOfferSubjects:!1,isCurrentPageMessage:!1,sceneId:null,carrySceneId:!0,carryReferShare:!0,networkType:"wifi",isWaitingOpenGid:!1,isFromAppOnShow:!1,referPageName:null,referPageId:null,referPageSn:null,timeDiff:0,inTransitionPage:"",transitionStartTime:0,limitChallengeGidWaiting:!1,monitorURL:"",spikeRemindGoodsIds:[],isSpikeRemindGoodsIdsUpdate:!1,globalPageId:0,sceneIdActivity:null,blockLevel:0,autoLoginStartTime:0,openId:"",pddUserType:null,ncTest:null,isReadBigSales:!1,rpTest:null,rpShareTest:null,sourceId:null};exports.default=e; 
 			}); 
		define("storage/regions_storage.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(e){return e&&e.__esModule?e:{default:e}}(require("../constants/storage_keys")),t=require("../common/index");exports.default={saveRegionsData:function(t){t&&t.regions&&t.regions.length>0&&(wx.setStorageSync(e.default.REGIONS,{regions:t.regions[0].children,lastUpdateTime:t.regions_update_time}),wx.setStorageSync("REGIONS_LAST_UPDATED",t.regions_update_time))},getRegionsData:function(){return t.StorageUtil.getStorageSync(e.default.REGIONS)},getRegionsLastUpdated:function(){return t.StorageUtil.getStorageSync("REGIONS_LAST_UPDATED")||0}}; 
 			}); 
		define("storage/search_history_storage.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("../constants/storage_keys")),t=(e(require("../common/object_util")),require("../common/index"));exports.default={saveSearchValue:function(e){e=(e||"").trim();var t=this.getSearchValueArray()||[];if(e){t.unshift(e.toString());var a={},u=[];return t.forEach(function(e){a[e]||(u.push(e),a[e]=!0)}),u=u.slice(0,10),wx.setStorageSync(r.default.SEARCH_HISTORY,u),u}return t},getSearchValueArray:function(){return t.StorageUtil.getStorageSync(r.default.SEARCH_HISTORY)},removeSearchValueArray:function(){wx.removeStorageSync(r.default.SEARCH_HISTORY)}}; 
 			}); 
		define("storage/user_storage.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var n=e(require("../constants/storage_keys")),r=e(require("../common/object_util")),t=e(require("../common/data_util")),o=e(require("../common/storage_util")),s={userInfo:null,saveUserLocalInfo:function(e){if(e&&0!=e.length){var t=this.getUserLocalInfo()||{};t=r.default.assign(t,e);try{wx.setStorageSync(n.default.USER_INFO,t),this.userInfo=t}catch(e){}}},clearUserLocalInfo:function(){try{wx.removeStorageSync(n.default.USER_INFO),this.userInfo=null}catch(e){}},getUserLocalInfo:function(){try{this.userInfo||(this.userInfo=o.default.getStorageSync(n.default.USER_INFO))}catch(e){this.userInfo=null}return this.userInfo},getUserLocalInfoByKey:function(e){if(e){var n=this.getUserLocalInfo();if(n)return n[e]}return null},saveAccessToken:function(e){e&&this.saveUserLocalInfo({accessToken:e})},getAccessToken:function(){var e=this.getUserLocalInfo();return e?e.accessToken:null},getOpenId:function(){var e=this.getUserLocalInfo();return e?e.openId:null},saveUserInfo:function(e){if(e){var r=e.access_token,t=e.uid,o={};t&&(o[n.default.UID]=parseInt(t,10).toString(36)),r&&(o.accessToken=r),e.user_info&&e.user_info.nick_name&&(o.nickName=e.user_info.nick_name),e.user_info&&e.user_info.avatar_url&&(o.avatarUrl=e.user_info.avatar_url),e.user_info&&e.user_info.gender&&(o.gender=e.user_info.gender),e.user_info&&e.user_info.province&&(o.province=e.user_info.province),e.user_info&&e.user_info.city&&(o.city=e.user_info.city),e.user_info&&e.user_info.open_id&&(o.openId=e.user_info.open_id),e.createTime&&(o.createTime=e.createTime),this.saveUserLocalInfo(o)}},saveUserId:function(e){if(e){var r={};r[n.default.UID]=parseInt(e,10).toString(36),this.saveUserLocalInfo(r)}},getUserId:function(){var e=this.getUserLocalInfo();return e&&e[n.default.UID]?t.default.trans36To10(e[n.default.UID]):null},getEgrp:function(){var e=this.getUserLocalInfo();if(e){var n=e.EGRP;return n&&Date.now()<n.expTime?n.value:null}return null},setEgrp:function(e){null!=e&&this.saveUserLocalInfo({EGRP:{expTime:Date.now()+6e5,value:parseInt(e,10)}})},setNickNameAndAvatarUrl:function(e){var n=(e=e||{}).nickName||"",r=e.avatarUrl||"",t=e.gender||"";this.saveUserLocalInfo({nickName:n,avatarUrl:r,gender:t})}};exports.default=s; 
 			}); 
		define("storage/webp_test_storage.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("../constants/storage_keys")),a=e(require("../common/storage_util"));exports.default={isEnable:null,setWebpEnable:function(e){this.isEnable=e,e?wx.setStorage({key:t.default.WEBP_ENABLE,data:1}):wx.setStorage({key:t.default.WEBP_ENABLE,data:0})},isWebpEnable:function(){if(null===this.isEnable){var e=!!a.default.getStorageSync(t.default.WEBP_ENABLE);return this.isEnable=e,e}return this.isEnable}}; 
 			}); 
		define("app.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=e(require("./common/pdd_app")),n=e(require("./storage/ram_manager")),a=(require("./common/index"),e(require("./common/request"))),o=e(require("./configs/api")),u=e(require("./libs/co/we-index")),i=(e(require("./libs/es6-promise.min")),e(require("./storage/user_storage"))),c=e(require("./libs/regenerator-runtime/runtime")),s=e(require("./common/preload")),d=e(require("./common/url_util")),f=e(require("./components/new_user_coupon/new_user_coupon")),l=require("./common/message");(0,r.default)({onLaunch:function(){i.default.getAccessToken()&&(n.default.pddUserType="0"),f.default.fetchUserType()},onShow:function(e){var r=void 0,i=void 0,f=!1;if(e&&e.path&&(r=e.query,i=e.path,"string"==typeof r&&r.match(/\{([\s\S]+)\}/)?(r=(r=(r=(r=r.match(/\{([\s\S]+)\}/)[1]).split(",")).join("&")).replace(/ /g,""),s.default.preloadData(null,i+"?"+r)):"object"===(void 0===r?"undefined":t(r))&&Object.keys(r).length>0?(s.default.preloadData(null,i+"?"+d.default.buildQuery(r)),f=r.ignore_scene,r.rp_share_test&&(n.default.rpShareTest=r.rp_share_test.toString()),r.source_id&&(n.default.sourceId=r.source_id.toString())):s.default.preloadData(null,i)),e&&1022==e.scene?n.default.isFromAppOnShow=!1:n.default.isFromAppOnShow=!0,n.default.sceneId=e&&e.scene,n.default.sceneIdActivity=e&&e.scene,n.default.carrySceneId=!f,e&&e.reLaunch&&(n.default.carrySceneId=!0,n.default.carryReferShare=!0),e&&e.shareTicket&&1044==e.scene){n.default.isWaitingOpenGid=!0;var p=function(e){n.default.isWaitingOpenGid=!1,!!e&&(n.default.requestGid=e.open_gid),n.default.CPPage&&n.default.CPPage.__route__&&n.default.CPPage.imprTracking&&n.default.CPPage.imprTracking()};wx.login({success:function(t){wx.getShareInfo&&wx.getShareInfo({shareTicket:e.shareTicket,success:function(e){var r={code:t.code,iv:e.iv,encrypted_data:e.encryptedData};(0,u.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.default.apiRequest("POST",o.default.getOpenGid,r);case 3:(t=e.sent)&&t.open_gid&&(n.default.requestGid=t.open_gid),l.Message.emit(l.KEYS.LC_ENTRY_GET_OPEN_GID,t.open_gid),p(t),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),p(),console.error(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,9]])}))},fail:function(){n.default.sceneIdActivity=1011,l.Message.emit(l.KEYS.LC_ENTRY_GET_OPEN_GID,!1),p()}})},fail:function(){p()}})}},onHide:function(){}}); 
 			}); 	require("app.js");
 		__wxRoute = 'pages/index/index';__wxRouteBegin = true; 	define("pages/index/index.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=e(require("../../constants/share_info")),o=(e(require("../../libs/es6-promise.min")),e(require("../../constants/ui/base64/webp_test"))),n=e(require("../../storage/webp_test_storage")),s=e(require("../../storage/user_storage")),i=e(require("../../components/bubble/bubble")),c=e(require("../../controller/user_controller")),d=e(require("../../controller/group")),u=e(require("./index_special_goods")),l=e(require("../../constants/groups")),p=e(require("../../constants/index_quick_entrance")),h=e(require("../../common/navigation")),g=e(require("../../common/gotop_util")),f=e(require("../../common/event_queue")),m=e(require("../../controller/formid_controller")),_=e(require("../../models/format/coupons_format")),w=require("../../constants/category_sort"),S=e(require("../../libs/co/we-index")),b=e(require("../../libs/regenerator-runtime/runtime")),v=e(require("../../storage/ram_manager")),x=e(require("../../common/scene_route")),T=require("../../common/index"),I=e(require("../../constants/tracking/subjects")),D=e(require("../../configs/api")),C=(e(require("../../constants/order")),e(require("../../constants/storage_keys"))),R=e(require("../../components/segment/segment.js")),k=e(require("../../components/big_sales/big_sales")),y=e(require("../../components/new_user_coupon/new_user_coupon")),q=(require("../../common/message"),{pageIndex:1,recPageIndex:1,pageSize:20,canLoadMore:!0,scrollToLowerlock:!1,columnOne:0,globalSecond:0,isOnHideStatus:!1,updateSecondTimer:null,indexDispatchIds:{},pageData:{},tabbarLineAnimation:null,tabbarScrollInterval:null,tabsReqRunningArr:[],catgoodsManagers:[],catgoodsStorage:[],indexRecommendGoodsManager:null,backupTabStatus:[],catgoodsLastScrollTop:[],hasReqUserAuth:!1,inRequest:[],scrollLeftDeno:6,shsCoordinate:[0,0,78,2],lastOpenPageData:{},isRequestingCoupon:!1,onShareAppMessage:function(e){return this.$generateShareContent({title:r.default.DefaultTitle})},segmentControl:null,showNewUserCouponFlag:!0,data:{pageName:"index",localGroupsMap:{},myGoods:[],webpTestSrc:o.default,notFirstEnterPage:!1,indexRecommendGoods:[],hideloadingMore:!0,isLoading:!1,showLoadingIcon:!0,loadingMoreText:"正在加载中",scrollTopValue:0,aniDuration:300,intervalDuration:3e3,visible:!1,curBannerIndex:0,quickEntranceHeight:T.Util.rpxToPx(286),homeOperations:[],curTabIndex:0,catgoodsList:[],tabStatus:[{loadingVisible:!0,canLoadMore:!0,recCanLoadMore:!0,showNoMoreText:!1,showError:!1}],bubble:{isShow:!0,top:"104rpx"},timeSpikeImg:"http://pinduoduoimg.yangkeduo.com/wxapp/time_spike.git.gif",unpaidOrderInfo:{},showModal:!1,globalSecond:"00",showRedCircle:{},bannerAutoPlay:!0,goTopClass:!1,couponsList:[],showCouModal:!1,isPageOnShow:!0,iconScrollLeft:0,showCanvasSliper:!0,quickEntranceScroll:T.Util.rpxToPx(233),$tabsData:[],showBigSalesModel:!1,showChaiHongbao:!1,showNewUserWindow:!1,showNewUserCoupon:!1},scroll:function(e){var t=Math.floor(e.detail.scrollLeft/this.scrollLeftDeno);this.shsCoordinate[0]=t,this.data.iconScrollLeft!=t&&(this.data.iconScrollLeft=t,this.drawShsCtx())},drawShsCtx:function(){var e=this.data,t=e.scrollTopValue,a=e.quickEntranceScroll,r=e.showModal,o=e.showBigSalesModel,n=e.showChaiHongbao,s=e.showNewUserWindow,i=e.showNewUserCoupon;!(t<a)||r||n||o||s||i?(this.data.showCanvasSliper=!1,this.shsCtx.clearRect(0,0,113,2),this.shsCtx.draw()):(this.data.showCanvasSliper=!0,this.shsCtx.clearRect(0,0,113,2),this.shsCtx.setFillStyle("#FF6969"),this.shsCtx.fillRect.apply(this.shsCtx,this.shsCoordinate),this.shsCtx.draw())},getCacheEntranceData:S.default.wrap(b.default.mark(function e(t){var a;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.StorageUtil.getStorage("QUICK_ENTRANCE_DATA");case 3:(a=e.sent)&&Array.isArray(a)?t.processEntranceData({data:a},!1):t.processEntranceData({data:p.default},!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])})),getEntranceData:S.default.wrap(b.default.mark(function e(t,a){var r,o,n,s,i;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0,o=void 0,n=void 0,s=void 0,e.prev=1,r=D.default.indexQuickEntranceList,!a){e.next=9;break}return s=setTimeout(function(){t.getEntranceData(t,!1)},300),e.next=7,T.StorageUtil.getStorage("QUICK_ENTRANCE_DATA_UPDATE");case 7:n=e.sent,clearTimeout(s);case 9:return o={forceUseApiGZ:!0,reqConfigHeader:{},needResponseHeader:!0},n&&"string"==typeof n&&(o.reqConfigHeader["If-Modified-Since"]=n),e.next=13,T.Request.apiRequest("GET",r,{},!0,o);case 13:i=e.sent,t.processEntranceData(i,!0),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),e.t0&&"request:ok"!==e.t0.error_msg&&console.error(e.t0);case 20:case"end":return e.stop()}},e,this,[[1,17]])})),processEntranceData:function(e,t){if(e&&e.data){var a=e.data,r=[],o=a.length/2,n=[];this.shsCoordinate[2]=Math.floor(10/a.length*112),this.scrollLeftDeno=T.Util.rpxToPx(750)*(a.length/10)/112,this.drawShsCtx(),a.forEach(function(e,t){if((e.redPoint||e.newGif)&&r.push(e),t<o){var s=[a[t],a[t+o]];n.push(s)}}),this.entranceData=a,this.setData({entranceDataColumn:n}),t&&(T.DataUtil.isArray(a)&&T.StorageUtil.setStorage("QUICK_ENTRANCE_DATA",a),e.header&&e.header["Last-Modified"]&&T.StorageUtil.setStorage("QUICK_ENTRANCE_DATA_UPDATE",e.header["Last-Modified"])),this.getOpenPageTime(r,this)}},saveOpenPageTime:function(e){e&&T.StorageUtil.setStorage(C.default.USER_OPEN_PAGE_TIME,e)},getOpenPageTime:S.default.wrap(b.default.mark(function e(t,r){var o;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.StorageUtil.getStorage(C.default.USER_OPEN_PAGE_TIME);case 3:o=e.sent,!Array.isArray(t)&&(t=[]),o||(o={},t.forEach(function(e){o[e.pageSrc]={hitTimes:0,timeStamp:0}})),o&&t.forEach(function(e){var t=o[e.pageSrc];("object"!==(void 0===t?"undefined":a(t))||0===Object.keys(t).length)&&(o[e.pageSrc]={hitTimes:0,timeStamp:0})}),r.lastOpenPageData=o,r.initOpenPageData(t,o),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])})),webpTestImgLoad:function(e){var t=e.detail||{};t.width&&t.height?n.default.setWebpEnable(!0):n.default.setWebpEnable(!1)},forwardCatgoods:function(e,t){var a=e.currentTarget.dataset.cat;if(a&&a.opt_id){var r=a.children?1:2;this.$forward("catgoods",{opt_id:a.opt_id,opt_type:r,opt_name:a.opt_name});var o={op:"click",event:"sub_opt_entry_clk",page_name:"index",page_section:"opt",page_element:"sub_opt",section_id:this.data.homeOperations[this.data.curTabIndex].opt_id,element_id:t?0:a.opt_id,idx:t?0:e.currentTarget.dataset.index};(0,T.TrackingRecord)(o)}},viewCatgoods:function(e){this.forwardCatgoods(e,!1)},viewAllCatgoods:function(e){this.forwardCatgoods(e,!0)},onPageScroll:function(e){var t=parseInt(e.scrollTop),a=this.data.curTabIndex,r=this.data.quickEntranceScroll;this.data.scrollTopValue=t,t<r&&!this.data.showCanvasSliper&&this.drawShsCtx(),t>r&&this.data.showCanvasSliper&&this.drawShsCtx(),g.default.showGoTopBtn(t,this),a>0&&this.updateScrollTop(t)},didClickSegmentTab:function(e){var t=parseInt(e.currentTarget.dataset.index);isNaN(t)||(this.changeCurTabIndex(t,!1,!0),(0,T.TrackingRecord)({op:"click",event:"opt_entry_clk",page_name:"index",page_section:"opt_list",page_element:"opt",element_id:this.data.homeOperations[t].opt_id,idx:t}))},onReachBottom:function(){if(!this.scrollToLowerlock){this.scrollToLowerlock=!0;var e=this.data.curTabIndex;this.fillCatgoodsListData(e)}},fillCatgoodsListData:function(e,a,r){var o=this;this.scrollToLowerlock=!1;var n=this.catgoodsStorage[e],s=this.data.catgoodsList[e]||[];r&&(s=[]);var i=s.length;if(n&&n.length>i){var c=void 0;if(c=0===i?8:s.length+20,s=n.slice(0,c),0==e&&r)this.pageData["catgoodsList["+e+"]"]=s;else{var u={};if(u["catgoodsList["+e+"]"]=s,a){var l=this.data.tabStatus[e]||{};l=T.ObjectUtil.assign(l,a),u["tabStatus["+e+"]"]=l}this.setData(u),this.clearLastImprList(),this.updateScrollTop(0)}if(0==e){var p=[];s.slice(i).forEach(function(e,t){2==e.customerNum&&p.push(e.goodsId)}),(0,S.default)(b.default.mark(function e(){var t;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.default.loadLocalGroups(p,o.data.localGroupsMap,o);case 3:t=e.sent,o.setData({localGroupsMap:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}))}}else{var h=this.data.tabStatus[e]||{};if(h.canLoadMore)(0,S.default)(b.default.mark(function t(){var a;return b.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,0!==e){t.next=7;break}return a=D.default.indexGoodsList+"?"+T.UrlUtil.buildQuery({column:1,page:o.pageIndex,size:o.pageSize}),t.next=5,o.getIndexReqGoodsList(-1,o.pageIndex,a,1,o);case 5:t.next=9;break;case 7:return t.next=9,o.getTabReqGoodsList(e,o);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0);case 14:case"end":return t.stop()}},t,this,[[0,11]])}));else if(0===e&&h.recCanLoadMore){var g=D.default.indexGoodsList+"?"+T.UrlUtil.buildQuery({column:2,list_id:"xcx_index_goods_"+o.randomStr,page:o.recPageIndex,size:o.pageSize});o.getIndexReqGoodsList(-2,this.recPageIndex,g,2,o)}else h.showNoMoreText=!0,this.setData(t({},"tabStatus["+e+"]",h))}},getRandomStr:function(e,t){var a=e.split(""),r="",o=a.length;if(t>o)return"";for(var n=0;n<t;n++){var s=Math.floor(Math.random()*o);r+=a[s],a[s]=a[o-1],o--}return r},changeCurTabIndex:function(e,a,r){var o,n=this;if(e!==this.data.curTabIndex||a){var s=this.data.homeOperations||[],i=this.data.curTabIndex,c=this.data.catgoodsList[i],d=this.data.catgoodsList[e];c&&(c=0==i?this.data.catgoodsList[i].slice(0,5):this.data.catgoodsList[i].slice(0,10));var u=0==e;0==e&&(this.shsCoordinate[0]=0,this.drawShsCtx());var l=T.ObjectUtil.assign((o={},t(o,"catgoodsList["+i+"]",c),t(o,"catgoodsList["+e+"]",[]),t(o,"curTabIndex",e),t(o,"goTopClass",!1),t(o,"bubble.isShow",u),o),this.segmentControl.$data());this.setData(l);var p=function(a){if(a>0&&a<s.length){var r=n.data.tabStatus;r[a]&&r[a].offset?setTimeout(function(){n.setData(t({},"catgoodsList["+e+"]",d)),n.delayScrollTop(100)},100):(0,S.default)(b.default.mark(function e(){var t;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0!==a){e.next=7;break}return t=D.default.indexGoodsList+"?"+T.UrlUtil.buildQuery({column:1,page:n.pageIndex,size:n.pageSize}),e.next=5,n.getIndexReqGoodsList(-1,n.pageIndex,t,1,n);case 5:e.next=9;break;case 7:return e.next=9,n.getTabReqGoodsList(a,n);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])}))}};p(e),p(e-1),p(e+1),e>0&&(this.isInitRect()?(this.clearLastImprList(),setTimeout(function(){n.updateScrollTop(0)},100)):setTimeout(function(){wx.canIUse&&wx.canIUse("createSelectorQuery")&&wx.createSelectorQuery().selectAll("#impr-id").boundingClientRect(function(e){e.length>0&&n.initRect(e,function(e){n.imprItems(e)})}).exec()},500))}},reLoad:function(){this.startLoadPage()},delayScrollTop:function(e){setTimeout(function(){g.default.goTop(!0)},e)},clickTopBanner:function(e){var t=e.currentTarget.dataset.linkUrl,a=e.currentTarget.dataset.index,r=e.currentTarget.dataset.pageName;if(t){var o={op:"click",page_name:"index",page_section:"top_banner",event:"top_banner_clk",page_el_sn:99299,idx:a};"subject"==r?(this.$forward(r,{subject_id:t.split("=")[1],refer_page_el_sn:99299}),o.page_element="subject",o.element_id=t.split("=")[1]):"promo_d12_venue"==r?(this.$forward("promo_dec_venue",{promotionId:t.split("=")[1],refer_page_el_sn:99299}),o.page_element="top_banner_d12",o.refer_xcx_campaign_d12=0):(this.$forward("promotion_main",{refer_page_el_sn:99299}),o.page_element="top_banner_d12",o.refer_xcx_campaign_d12=0),(0,T.TrackingRecord)(o)}},topBannerChange:function(e){var t=e.detail.current;this.setData({curBannerIndex:t})},forwardGoodDetail:function(e,t){var a=e.currentTarget.dataset,r=a.goodsId,o=a.goodsItem,n=a.index;null!=r&&(this.transGoodsData=o,this.$forward("goods",{goods_id:r}));var s=this.data.curTabIndex,i={op:"click",event:"goods_clk",page_name:"index",page_section:"goods_list",goods_id:r,idx:n};if("subject"==t){i.event="subject_goods_clk",i.page_section="subject",i.page_element="goods",i.idx=a.subIndex;var c=this.data.homeOperations[s];i.section_id=c.opt_id}else if("main"==t){if(s>0){var d=this.data.homeOperations[s],u=d.children?1:2;i.opt_type=u,i.opt_id=d.opt_id,i.page_section="opt_goods_list"}else this.data.catgoodsList&&this.data.catgoodsList[s]&&this.data.catgoodsList[s][n]&&(i.event_type=this.data.catgoodsList[s][n].eventType);i.page_element="goods",o&&(o.ad&&(i.ad=JSON.stringify(o.ad)),o.p_rec&&(i.p_rec=JSON.stringify(o.p_rec)),o.p_search&&(i.p_search=JSON.stringify(o.p_search)))}else"rec"==t?(i.page_section="rec_list",i.page_element="goods",i.rec_goods_id=r,delete i.goods_id,this.data.catgoodsList&&this.data.catgoodsList[s]&&this.data.catgoodsList[s][n]&&(i.event_type=this.data.catgoodsList[s][n].eventType)):(i.event="buy_clk",i.page_element="buy_btn",this.data.catgoodsList&&this.data.catgoodsList[s]&&this.data.catgoodsList[s][n]&&(i.event_type=this.data.catgoodsList[s][n].eventType));(0,T.TrackingRecord)(i)},gotoGoodsDetail:function(e){var t=e.currentTarget.dataset.refer;0!==this.data.curTabIndex||t?this.forwardGoodDetail(e,"main"):this.forwardGoodDetail(e,"rec")},enterGoods:function(e){this.forwardGoodDetail(e,"enter")},onUnload:function(){this.tabbarScrollInterval&&clearTimeout(this.tabbarScrollInterval),i.default.close(this),clearInterval(this.updateSecondTimer)},onReady:function(){this.setScrollHeight()},setScrollHeight:function(){this.winHeight||(this.winHeight=T.SystemInfo.getWindowHeightSync()),this.winHeight&&this.setData({scrollContainerHeight:this.winHeight})},generateReqFlag:function(e,t){return["req",e,t].join("#")},isReqRunning:function(e,t){var a=this.generateReqFlag(e,t);return this.tabsReqRunningArr.indexOf(a)>=0},removeReqFlag:function(e,t){var a=this.generateReqFlag(e,t),r=this.tabsReqRunningArr.indexOf(a);r>=0&&this.tabsReqRunningArr.splice(r,1)},addReqFlag:function(e,t){var a=this.generateReqFlag(e,t);this.tabsReqRunningArr.push(a)},formatIndexGoodsData:function(e){var t={};return t.goodsId=e.goods_id,t.normalPrice=T.StdFormat.price(parseInt(e.normal_price||0),100),t.shortName=e.short_name||"",t.eventType=parseInt(e.event_type),t.isApp=parseInt(e.is_app||"0"),t.goodsName=e.goods_name||"",t.imgUrl=T.ImageUtil.cdnCompress(1===e.column?e.image_url:e.hd_thumb_url),t.customerNum=e.group.customer_num,t.price=T.StdFormat.price(parseInt(e.group.price||0),100),t.isFreeTrial=t.eventType===l.default.EventType.FREE_TRIAL,t.soldQuantity=T.StdFormat.sales(parseInt(e.cnt||0)),t.isCompleteLottery=[l.default.EventType.LUCKY_DRAW,l.default.EventType.FREE_TRIAL,l.default.EventType.CAPITAL_GIFT_LOTTERY,l.default.EventType.DEPOSITE_GROUP].indexOf(t.eventType)>=0,t.nationalFlag=e.country?T.ImageUtil.getCDNImgURL("nation/rect/"+e.country+".png"):"",t.visibleWidth=e.country?this.data.visibleWidth-T.Util.rpxToPx(42):this.data.visibleWidth,t.preMarketPrice=parseInt(e.market_price||0,10),t.preGroupPrice=parseInt(e.group.price||0,10),t.preSinglePrice=parseInt(e.normal_price||0,10),t.hasMallCoupon=parseInt(e.has_mall_coupon||0,10),t.template=1===e.column?"indexRecGoodsItem":"gridItemV2",t},getDiscount:function(e,t){if(!e||!t)return 0;var a=Math.floor(e/t*100)/10;return a%1==0&&0!==a&&(a=a.toFixed(1)),a},formatTagGoodsData:function(e){var t=e.group||{},a=parseInt(t.customer_num||e.customer_num||0),r=t.price||e.price,o={key:"goods-"+e.goods_id,goodsId:e.goods_id,imgUrl:T.ImageUtil.cdnCompress(e.hd_thumb_url||e.thumb_url),goodsName:e.goods_name,groupDesc:a+"人团",price:T.StdFormat.price(r,100),marketPrice:T.StdFormat.price(e.market_price,100),soldQuantity:T.StdFormat.sales(e.sales||e.cnt),customerNum:parseInt(a,10),nationalFlag:e.country?T.ImageUtil.getCDNImgURL("nation/rect/"+e.country+".png"):"",tag:parseInt(e.tag,10)},n=["spike","economical-brand","go-shopping","good-fruit","brand-clean"];return!isNaN(o.tag)&&o.tag>=0&&o.tag<n.length&&(o.activityFlagClass="activity-flag activity-flag-gap activity-flag-"+n[o.tag]),o.allowance=this.getDiscount(o.price,o.marketPrice),o.transData={goodsId:o.goodsId,preGroupPrice:parseInt(r,10),preSinglePrice:parseInt(e.normal_price,10),preMarketPrice:parseInt(e.market_price,10),goodsName:o.goodsName,customerNum:o.customerNum,ad:e.ad,p_rec:e.p_rec,p_search:e.p_search},o},filterIndexReqGoods:function(e,t){var a=this,r=[l.default.EventType.DEFAULT,l.default.EventType.FREE_GROUP,l.default.EventType.SPIKE,l.default.EventType.SUPER_SPIKE],o=[];return e.forEach(function(e){var n=!0;if(r.indexOf(parseInt(e.event_type,10))>=0&&1!=e.is_app){e.column=t;var s=a.formatIndexGoodsData(e);T.User.getShowPortalFreeTrialGoods()||s.eventType!==l.default.EventType.FREE_TRIAL||(n=!1),n&&(s.transData={goodsId:s.goodsId,preGroupPrice:s.preGroupPrice,preSinglePrice:s.preSinglePrice,preMarketPrice:s.preMarketPrice,goodsName:s.goodsName,customerNum:s.customerNum,ad:s.ad,p_rec:s.p_rec,p_search:s.p_search},o.push(s))}}),o},getIndexReqGoodsList:S.default.wrap(b.default.mark(function e(t,a,r,o,n){var s,i,c,d,u;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isReqRunning(t,a)){e.next=2;break}return e.abrupt("return",null);case 2:return n.addReqFlag(t,a),s=n.pageSize,i=r,e.prev=4,c=T.Request.requestDataWithUrl("GET",i,null,!0),e.next=8,T.Request.runMainRequestForPage(c,n);case 8:return d=e.sent,u=d.goods_list,u=n.filterIndexReqGoods(u,o),n.processGoodsList({rootOptId:t,pageIndex:a,curRawPageSize:u.length,goodsList:u}),e.abrupt("return",u);case 15:e.prev=15,e.t0=e.catch(4),console.error(e.t0),n.requestTagGoodsError({resIndex:0,rootOptId:t,pageIndex:a});case 19:case"end":return e.stop()}},e,this,[[4,15]])})),getTabReqGoodsList:S.default.wrap(b.default.mark(function e(t,a){var r,o,n,s,i,c,d,u,l,p,h,g,f;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.data.homeOperations||[],o=r[t]||{},n=o.opt_id,s=a.data.tabStatus[t]||{},i=s.offset||0,c=0==i?20:50,d=0,u=1,null!=n&&-1!=n){e.next=3;break}return e.abrupt("return",null);case 3:if(!a.isReqRunning(n,i)){e.next=5;break}return e.abrupt("return",null);case 5:return a.addReqFlag(n,i),l=T.DataUtil.formatByPos(D.default.v3CatgoodsList,n)+"?"+T.UrlUtil.buildQuery({opt_type:u,offset:i,size:c,sort_type:w.CategorySortTypes[d].api}),e.prev=7,p=T.Request.requestDataWithUrl("GET",l,null,!0),e.next=11,T.Request.runSecondaryRequestForPage(p,a);case 11:h=e.sent,g=h.goods_list||[],f=h.opt_infos||[],g=g.map(function(e){return a.formatTagGoodsData(e)}),f=f.map(function(e){return{key:"optinfo-"+e.id,optId:parseInt(e.id,10)||0,optType:parseInt(u,10)+1,optName:e.opt_name,priority:e.priority}}),a.processGoodsList({goodsList:g,optInfos:f,rootOptType:u,rootOptId:n,offset:i,curRawGoodsListSize:g.length}),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(7),console.error(e.t0),a.requestTagGoodsError({resIndex:t,rootOptId:n,pageIndex:null,offset:i});case 23:case"end":return e.stop()}},e,this,[[7,19]])})),processGoodsList:function(e){this.removeReqFlag(e.rootOptId,null==e.pageIndex?e.offset:e.pageIndex);var t=this.getIndexByOptId(e.rootOptId);Array.isArray(this.catgoodsStorage[t])||(this.catgoodsStorage[t]=[]),this.catgoodsStorage[t]=this.catgoodsStorage[t].concat(e.goodsList),this.catgoodsStorage[t]=T.DataUtil.objectArrayDuplicateRemove(this.catgoodsStorage[t],"goodsId",function(e){return 1==e.isApp});var a=this.data.tabStatus[t]||{};if(!0!==a.showError&&(a.loadingVisible=!1,a.loadMoreVisible=!0,a.showError=!1),e.goodsList.length>0&&(a.showError=!1),0===t)this.columnOne=-1===e.rootOptId?this.columnOne+e.curRawPageSize:this.columnOne,a.columnOne=this.columnOne,a.canLoadMore=-1===e.rootOptId?e.curRawPageSize>0:a.canLoadMore,a.recCanLoadMore=-2===e.rootOptId?e.curRawPageSize>0:a.recCanLoadMore,this.fillCatgoodsListData(0,a,0===this.pageIndex),this.pageIndex=-1===e.rootOptId?this.pageIndex+1:this.pageIndex,this.recPageIndex=-2===e.rootOptId?this.recPageIndex+1:this.recPageIndex;else{a.canLoadMore=e.curRawGoodsListSize>0,a.offset=a.offset||0;var r=a.offset;a.offset+=0==a.offset?20:50,this.fillCatgoodsListData(t,a,0===r)}},requestTagGoodsError:function(e){this.removeReqFlag(e.rootOptId,null==e.pageIndex?e.offset:e.pageIndex);var a=e.resIndex;this.$showToast("网络出错");var r=!1;if(null==e.pageIndex?0===e.offset&&(r=!0):1===e.pageIndex&&(r=!0),r){var o;this.setData((o={},t(o,"tabStatus["+a+"].showError",!0),t(o,"tabStatus["+a+"].loadingVisible",!1),o))}},getIndexByOptId:function(e){if(-1==e||-2==e)return 0;for(var t=null,a=this.data.homeOperations||[],r=0,o=a.length;r<o;r++)if(a[r].opt_id==e){t=r;break}return t},refreshSpecialGoods:function(){var e=this,t=function(){var t=T.Request.requestDataWithUrl("GET","v2/subject/1713/goods?page=1&size=20",null,!0);T.Request.runSecondaryRequestForPage(t,e).then(function(t){if(t){var a=u.default.processSpecialGoods(t.goods_list)||[];e.setData({specialList:a.slice(0,2)})}},function(e){})},a=function(){if(null==s.default.getEgrp()){var a=c.default.reqUserAB();a&&a.then(function(){t()},function(t){"获取用户信息失败"===t.error_msg&&(e.hasReqUserAuth=!0)})}else t()};T.User.hasLogin()?a():this.hasReqUserAuth||a()},dealWithHomeOperationsData:function(e){var t=[],a=[];return(e=[].concat(e)).unshift({opt_name:"首页",opt_id:-1,children:[]}),e.forEach(function(e,r){e.children=e.children.slice(0,7),e.children.map(function(e){return e.opt_name=e.opt_name.slice(0,5),e}),t.push(e),a[r]={},0==r?(a[r].loadingVisible=!1,a[r].recCanLoadMore=!0):a[r].loadingVisible=!0,a[r].canLoadMore=!0,a[r].showNoMoreText=!1,a[r].showError=!1}),{homeOperations:t,tabStatus:a}},receiveIndexPageSubjectsBanner:function(e){var t=[],a=void 0,r=void 0;return e.result.forEach(function(e){var o=e.link_url.split("//"),n=o[0].split(".")[0];if(o.length>1&&(n=o[1].split("/")[1].split(".")[0]),!(["subject","promo_d12","promo_d12_venue"].indexOf(n)<0)){var s={bannerUrl:T.ImageUtil.cdnCompress(e.img_url),name:n,linkUrl:e.link_url};s.bannerHeightWidthRatio=.375,(!a||375<a)&&(r=(a=375)/1e3),t.push(s)}}),{swiperRatio:r,topBannerData:t}},renderFirstScreenData:function(e,t){var a=this,r=this,o=null;if(e&&t&&!T.DataUtil.detectReqDataIsError(e,this.$showToast)&&!T.DataUtil.detectReqDataIsError(t,this.$showToast)){if(Array.isArray(e)&&e.length<=0)try{if(!(o=T.StorageUtil.getStorageSync(C.default.HOME_OPERATIONS)))return void this.setData({"tabStatus[0].showError":!0,"tabStatus[0].loadingVisible":!1})}catch(e){}o||(o=this.dealWithHomeOperationsData(e)||{});var n=o.tabStatus,s=o.homeOperations,i=this.receiveIndexPageSubjectsBanner(t)||{},c=s.map(function(e){return{title:e.opt_name}});this.segmentControl.refreshTabsData(c);var d=T.ObjectUtil.assign({scrollContainerWidth:this.windowWidth,homeOperations:s,tabStatus:n,swiperRatio:i.swiperRatio,quickEntranceScroll:this.windowWidth*i.swiperRatio+this.data.quickEntranceHeight-50,topBannerData:i.topBannerData,notFirstEnterPage:!0,curBannerIndex:this.data.curBannerIndex||0,visible:!0},this.segmentControl.$data());this.setData(d),wx.setStorage({key:C.default.HOME_OPERATIONS,data:o}),wx.setStorage({key:C.default.TOP_BANNER,data:i});for(var u=1;u<=4;u++)!function(e){(!a.data.catgoodsList[e]||a.data.catgoodsList[e].length<=0)&&(0,S.default)(b.default.mark(function t(){return b.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.getTabReqGoodsList(e,r);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}))}(u)}else this.setData({"tabStatus[0].showError":!0,"tabStatus[0].loadingVisible":!1})},getHomeOperationsDetail:S.default.wrap(b.default.mark(function e(t){var a,r;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.rawHomeOperations=null,a=T.Request.requestDataWithUrl("GET",D.default.homeOperations,null,!0),e.next=5,T.Request.runMainRequestForPage(a,t);case 5:return r=e.sent,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),t.setData({"tabStatus[0].showError":!0,"tabStatus[0].loadingVisible":!1});case 13:case"end":return e.stop()}},e,this,[[0,9]])})),getTopBannerDetail:S.default.wrap(b.default.mark(function e(t){var a,r;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.rawHomeOperations=null,a=T.Request.requestDataWithUrl("GET",D.default.indexPageTopBanner,null,!0),e.next=5,T.Request.runMainRequestForPage(a,t);case 5:return r=e.sent,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),t.setData({"tabStatus[0].showError":!0,"tabStatus[0].loadingVisible":!1}),t.$showToast("网络出错");case 14:case"end":return e.stop()}},e,this,[[0,9]])})),startLoadPage:function(){var e=this,t=this.data.curTabIndex||0;this.windowWidth||(this.windowWidth=T.SystemInfo.getWindowWidthSync(),this.windowWidth&&this.setData({visibleWidth:this.windowWidth-T.Util.rpxToPx(30)})),(0,S.default)(b.default.mark(function a(){var r;return b.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,0!==t){a.next=8;break}return a.next=4,[e.getHomeOperationsDetail(e),e.getTopBannerDetail(e)];case 4:r=a.sent,e.renderFirstScreenData(r[0],r[1]),a.next=10;break;case 8:return a.next=10,e.getTabReqGoodsList(t,e);case 10:a.next=15;break;case 12:a.prev=12,a.t0=a.catch(0),console.error(a.t0);case 15:case"end":return a.stop()}},a,this,[[0,12]])}));try{if(0===t){var a=D.default.indexGoodsList+"?"+T.UrlUtil.buildQuery({column:1,page:e.pageIndex,size:e.pageSize});e.getIndexReqGoodsList(-1,e.pageIndex,a,1,e),e.getCacheEntranceData(e),e.getEntranceData(e,!0)}}catch(e){console.error(e)}},initOpenPageData:function(e,t,a){var r=(new Date).setHours(0,0,0,0),o=new Date(r).getTime(),n={},s=this.data,i=s.curTabIndex||0,c=s.tabStatus||[],d=s.tabStatus[i].showError,u=s.tabStatus[i].loadingVisible;!Array.isArray(e)&&(e=[]),e.forEach(function(e){t[e.pageSrc].timeStamp&&1*t[e.pageSrc].timeStamp>o?1*e.hitTimes<0?n["showRedCircle."+e.pageSrc]=!0:1*e.hitTimes>1*t[e.pageSrc].hitTimes?n["showRedCircle."+e.pageSrc]=!0:n["showRedCircle."+e.pageSrc]=!1:n["showRedCircle."+e.pageSrc]=!0}),c[i]&&c[i].showError&&(d=!1,u=!0),n["tabStatus["+i+"].showError"]=d,n["tabStatus["+i+"].loadingVisible"]=u,this.setData(n)},loadLocalStorageData:function(){self=this,(0,S.default)(b.default.mark(function e(){var t;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,[T.StorageUtil.getStorage(C.default.HOME_OPERATIONS),T.StorageUtil.getStorage(C.default.TOP_BANNER)];case 3:t=e.sent,self.renderLocalStorageData(t[0],t[1]),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}))},renderLocalStorageData:function(e,t){if(!(this.data.homeOperations&&this.data.homeOperations[0]||this.data.bannerData))if(this.windowWidth||(this.windowWidth=T.SystemInfo.getWindowWidthSync()),e&&t&&e.homeOperations&&t.topBannerData){var a=e.homeOperations,r=a.map(function(e){return{title:e.opt_name}});this.segmentControl.refreshTabsData(r);var o=T.ObjectUtil.assign({scrollContainerWidth:this.windowWidth,homeOperations:a,swiperRatio:t.swiperRatio,quickEntranceScroll:this.windowWidth*t.swiperRatio+this.data.quickEntranceHeight-50,topBannerData:t.topBannerData,notFirstEnterPage:!0,curBannerIndex:this.data.curBannerIndex||0,visible:!0},this.segmentControl.$data());this.setData(o)}else{var n=[{bannerHeightWidthRatio:.375,bannerUrl:"http://pinduoduoimg.yangkeduo.com/wxapp/default_square.png",subject_id:0}];this.setData({scrollContainerWidth:this.windowWidth,swiperRatio:n[0].bannerHeightWidthRatio,quickEntranceScroll:this.windowWidth*n[0].bannerHeightWidthRatio+this.data.quickEntranceHeight-50,topBannerData:n,notFirstEnterPage:!0,curBannerIndex:this.data.curBannerIndex||0,visible:!0})}},quickEntranceClick:function(e){var t=e.currentTarget.dataset;if(t){var a=t.pageSrc,r=t.index,o=t.url,n=(new Date).getTime(),s=this.lastOpenPageData,i={showRedCircle:this.data.showRedCircle},c=isNaN(1*t.hitTimes)?0:1*t.hitTimes;s[a]&&T.DataUtil.isObject(s[a])&&(s[a].hitTimes++,s[a].timeStamp=n,c<0?i.showRedCircle[a]=!0:s[a].hitTimes<c?i.showRedCircle[a]=!0:i.showRedCircle[a]=!1,this.setData(i),this.saveOpenPageTime(s)),a&&void 0!==r&&(0,T.TrackingRecord)(T.ObjectUtil.assign({},I.default.EntryClick,{page_element:a,idx:r})),o.match("haitao")?h.default.route(o,"switchTab"):h.default.route(o)}},componentsAddRootFunc:function(e,t){e&&"function"==typeof t&&(this[e]=t)},onLoad:function(e){v.default.ncTest||(v.default.ncTest="0"),this.pvTracking(),e&&e.scene&&(this.setData({isPageOnShow:!1}),x.default.route(e.scene));this.randomStr=this.getRandomStr("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",6);var t={tabsData:this.data.$tabsData,alignType:"align-gap",setDataFunc:function(e){self.setData(e)}};this.eventQueue=new f.default(this),this.segmentControl=new R.default(t,this);var a=wx.createCanvasContext("scrollHorizontalScrollbar");this.shsCtx=a,this.drawShsCtx(),this.loadLocalStorageData(),this.startLoadPage()},onShow:function(){var e=this,t=!1;i.default.init(this,!1,"",1),this.$urlQueryObj&&this.$urlQueryObj.scene&&!this.$firstShow&&this.setData({isPageOnShow:!0}),this.$urlQueryObj&&(t=this.$urlQueryObj.from_presetation||!1),this.drawShsCtx(),this.refreshSpecialGoods(),this.setData({fromPresetation:t,bannerAutoPlay:!0}),e.$BigSalesModal||(e.$BigSalesModal=new k.default({setDataFunc:function(t){e.setData(t)},addRootFunc:T.Util.bind(e.componentsAddRootFunc,e)})),e.$BigSalesModal.showBigSalesFloat();var a=this.eventQueue;(0,S.default)(b.default.mark(function r(){var o,n,s,i,c,d,u,l,p,h,g,f,m,_,w,S;return b.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,o=e.data,n=o.showCouModal,s=o.showModal,i=o.showBigSalesModel,c=o.showChaiHongbao,d=o.showNewUserCoupon,!(s||n||i||c||d)){r.next=4;break}return r.abrupt("return");case 4:return r.next=6,[e.checkStorage("login_index_time"),e.checkStorage("coupons_modal"),e.checkStorage("big_sales_modal"),e.checkStorage("chaihongbao_model")];case 6:return u=r.sent,l=u[0],p=u[1],h=u[2],g=u[3],e.isUnpaidShow=!1,e.isCouponShow=!1,e.isBigSalesShow=!1,e.isNewUserCouponShow=!1,f=[],m={},f.push(y.default.shouldShowNewUserPop()),m.isNewUserCouponShow=f.length-1,(_=e.$BigSalesModal.checkInBigSales())||l&&(f.push(e.getUnpaidOrder(e)),m.isUnpaidShow=f.length-1),p&&(f.push(e.requestCouponListDetail(e)),m.isCouponShow=f.length-1),h&&_&&(w=e.$BigSalesModal.getBigSalesWindowImg(),e.setData({bigSalesWindowImg:w}),f.push(e.requestBigSalesInfo(e)),m.isBigSalesShow=f.length-1),r.next=25,f;case 25:S=r.sent,Object.keys(m).forEach(function(t){"number"==typeof m[t]&&m[t]>=0&&(e[t]=S[m[t]])}),g&&"true"!=t&&a.pushHandler("showChaiHongbaoFn","hideChaiHongbaoFn"),e.isNewUserCouponShow&&a.pushHandler("showNewUserCouponFn","hideNewUserCouponFn"),e.isBigSalesShow&&a.pushHandler("showBigSalesModelFn","hideBigSalesModelFn"),e.isUnpaidShow&&a.pushHandler("showUnpaidModel","hideModal"),e.isCouponShow?a.pushHandler("showCouponModal"):a.pushHandler("delayDrawShsCtx"),a.triggerHandler(),r.next=38;break;case 35:r.prev=35,r.t0=r.catch(0),console.error(r.t0);case 38:case"end":return r.stop()}},r,this,[[0,35]])})),this.isOnHideStatus=!1,v.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},delayDrawShsCtx:function(){self.drawShsCtx()},onHide:function(){i.default.close(this),this.isOnHideStatus=!0,this.setData({bannerAutoPlay:!1})},checkStorage:S.default.wrap(b.default.mark(function e(t){var a,r,o,n;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=!1,e.next=4,T.StorageUtil.getStorage(t);case 4:return(r=e.sent)?(o=(new Date).setHours(0,0,0,0),n=new Date(o).getTime(),r<=n&&(a=!0)):a=!0,e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}},e,this,[[0,9]])})),showUnpaidModel:function(){this.setData({showModal:!0}),this.drawShsCtx()},getUnpaidOrder:S.default.wrap(b.default.mark(function e(t){var a,r,o,n;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=T.Request.requestDataWithUrl("GET",D.default.getUnpaidOrder),e.next=4,T.Request.runSecondaryRequestForPage(a,t);case 4:if(!(r=e.sent)||!r.error_code){e.next=7;break}return e.abrupt("return");case 7:return(o=Object.keys(r).length>1)&&(r.title=1==r.popup_type?"你的拼单还未支付，请尽快支付":"还在等你拼单，赶紧去支付吧",r.timerNumObj=T.TimeUtil.transferToTime(1e3*(r.expire_time-r.server_time),{needObj:!0}),t.globalSecond=r.timerNumObj.intSeconds,null===t.updateSecondTimer&&(t.updateSecondTimer=setInterval(function(){if(t.globalSecond--,t.globalSecond<0)return t.globalSecond=59,void t.updateMinutesHours(t.globalSecond);var e=t.globalSecond;e<10&&(e="0"+e),t.isOnHideStatus||t.setData({globalSecond:e})},1e3)),(n=t.globalSecond)<10&&(n="0"+n),t.setData({globalSecond:n,unpaidOrderInfo:r})),e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])})),updateMinutesHours:function(e){var a,r=this.data.unpaidOrderInfo.timerNumObj;if(r.intMinutes--,r.intSeconds--,r.intMinutes<0){r.intMinutes=59,r.intHours--;var o=r.intHours;if(o<0)return clearInterval(this.updateSecondTimer),void(this.updateSecondTimer=null);o<10&&(o="0"+o),r.intHours=o}var n=r.intMinutes;n<10&&(n="0"+n),r.minutes=n,this.setData((a={},t(a,"unpaidOrderInfo.timerNumObj",r),t(a,"globalSecond",e),a))},preventTouchMove:function(){},hideModal:function(){this.setData({showModal:!1}),T.StorageUtil.setStorage("login_index_time",(new Date).getTime())},onCancel:function(){this.hideModal()},onConfirm:function(){this.hideModal(),this.$forward("orders",{type:1})},showCouponModal:function(){this.setData({showCouModal:!0,showModal:!1}),this.drawShsCtx(),T.StorageUtil.setStorage("coupons_modal",(new Date).getTime());var e=this;setTimeout(function(){e.setData({showCouModal:!1})},4e3)},requestCouponListDetail:S.default.wrap(b.default.mark(function e(t){var a,r,o,n,s,i,c,d,u,l,p,h;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=1,r=60,o=Date.parse(new Date)/1e3,n=T.DataUtil.formatByPos(D.default.avaCoupons,a,r),s=T.Request.requestDataWithUrl("GET",n),e.next=8,T.Request.runSecondaryRequestForPage(s,t);case 8:for(i=e.sent,c=i.server_time||parseInt(Date.now()/1e3,10),d=(0,_.default)(i.coupons,0,c)||[],u=0,l=0;l<d.length;++l)p=parseInt(d[l].expiredTime)-259200,o>p&&(h=parseInt(d[l].discount),u+=h);return t.setData({tobeEndTimeCouponTotal:u}),e.abrupt("return",u>0);case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0);case 20:case"end":return e.stop()}},e,this,[[0,17]])})),closeCou:function(){this.setData({showCouModal:!1})},toCoupons:function(){this.closeCou(),this.$forward("coupons")},toMatch:function(e){var t=e.currentTarget.dataset,a=e.currentTarget.dataset.linkUrl;if(this.closeCou(),t.mallId>0)this.$forward("mall_page",{mall_id:t.mallId});else if(t.isFree)this.$forward("tzfree_list");else if(t.isCategory&&a){var r=a.indexOf("?"),o=a.slice(r+1),n=a.split(".")[0],s={};s=T.UrlUtil.parseUrlQueryStr(o),this.$forward(n,s)}else this.$forward("coupon_newbee",{coupon_id:t.couponId,min_amount:t.minAmount,batch_name:t.batchName,discount:t.discount})},requestBigSalesInfo:S.default.wrap(b.default.mark(function e(t){return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",!0);case 5:return e.abrupt("return",!1);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),hideBigSalesModelFn:function(e){if(this.setData({showBigSalesModel:!1}),T.StorageUtil.setStorage("big_sales_modal",(new Date).getTime()),e&&"closeBtn"===e.currentTarget.dataset.refer){var a;(0,T.TrackingRecord)((a={op:"click",page_section:"d12_popup",page_element:"close_d12"},t(a,"page_element","close_btn"),t(a,"refer_xcx_campaign_d12",0),a))}},showBigSalesModelFn:function(){this.setData({showBigSalesModel:!0}),this.drawShsCtx(),(0,T.TrackingRecord)({op:"impr",page_name:"index",page_section:"d12_popup",refer_xcx_campaign_d12:0})},imprItems:function(e){var t=this,a=t.data.curTabIndex,r=t.data.homeOperations[a],o=r.opt_id,n=r.children?1:2;e.forEach(function(e){var a=t.data.curTabIndex||0,r=t.data.catgoodsList[a]||[];if(e<r.length){var s=r[e]||{},i={op:"impr",page_section:"opt_goods_list",page_element:"goods",idx:e,goods_id:s.goodsId,opt_type:n,opt_id:o};s.transData&&(s.transData.ad&&(i.ad=JSON.stringify(s.transData.ad)),s.transData.p_rec&&(i.p_rec=JSON.stringify(s.transData.p_rec)),s.transData.p_search&&(i.p_search=JSON.stringify(s.transData.p_search))),(0,T.TrackingRecord)(i)}})},gotoLimitChallengePageFloat:function(e){this.$forward("limit_challenge"),(0,T.TrackingRecord)({op:"click",page_name:"index",page_section:"limit_challenge_float",page_element:"limit_challenge"}),e&&e.detail&&e.detail.formId&&m.default.uploadFormIdToSH(e.detail.formId,!0)},submitFormId:function(e){var t=e.detail&&e.detail.formId;m.default.uploadFormIdToSH(t,!0)},gotoBigSalesPage:function(e){var t=this;t.$forward("promotion_main",{}),setTimeout(function(){t.hideBigSalesModelFn()},1e3),(0,T.TrackingRecord)({op:"click",page_section:"d12_popup",page_element:"go_d12",refer_xcx_campaign_d12:0}),this.$uploadFormId(e)},showChaiHongbaoFn:function(){this.setData({showChaiHongbao:!0}),this.drawShsCtx(),(0,T.TrackingRecord)({op:"impr",page_name:"index",page_section:"d11_red_group"})},hideChaiHongbaoFn:function(){this.setData({showChaiHongbao:!1}),T.StorageUtil.setStorage("chaihongbao_model",Date.now())},showNewUserCouponFn:function(){this.showNewUserCouponFlag?(this.setData({showNewUserCoupon:!0}),this.drawShsCtx(),(0,T.TrackingRecord)({op:"impr",page_section:"nc_popup"})):this.hideNewUserCouponFn()},hideNewUserCouponFn:function(){this.showNewUserCouponFlag=!1,this.setData({showNewUserCoupon:!1}),(0,T.TrackingRecord)({op:"click",page_section:"nc_popup",page_element:"close_btn"})},gotoChaihongbao:function(){var e=this;this.$forward("open_envelope"),setTimeout(function(){e.hideChaiHongbaoFn()},1e3),(0,T.TrackingRecord)({op:"click",page_name:"index",page_section:"d11_red_group",page_element:"going_btn"})},getCoupon:function(e){if(!this.isRequestingCoupon){this.isRequestingCoupon=!0;var t=this;(0,S.default)(b.default.mark(function e(){var a,r,o,n;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=T.Request.requestDataWithUrl("POST","backend/newuser/coupon/grant",null,!1,{needGZToken:!0,forceUseApiGZ:!0}),e.next=3,T.Request.runMainRequestForPage(a,t);case 3:r=e.sent,t.isRequestingCoupon=!1,r&&r.success?(o=T.StdFormat.price(r.data.money,100),t.setData({showNewUserWindow:!0,sumOfMoney:o}),t.drawShsCtx(),wx.setStorage({key:"hasDrawCoupon",data:!0})):("4000022"!=r.error_code&&"4000020"!=r.error_code||t.$showToast(r.error_msg),t.drawShsCtx()),n=r.data||{},v.default.ncTest="1",(0,T.TrackingRecord)({op:"impr",page_section:"nc_success_popup",batch_id:n.batch_id,is_success:r.success?"1":"0"});case 9:case"end":return e.stop()}},e,this)})),this.setData({showNewUserCoupon:!1}),e&&e.detail&&e.detail.formId&&m.default.uploadFormIdToSH(e.detail.formId,!1),(0,T.TrackingRecord)({op:"click",page_section:"nc_popup",page_element:"new_coupons"})}},clickNewUserButton:function(e){var t=e.currentTarget.dataset&&e.currentTarget.dataset.refer;this.setData({showNewUserWindow:!1,showNewUserCoupon:!1}),this.drawShsCtx(),e&&e.detail&&e.detail.formId&&m.default.uploadFormIdToSH(e.detail.formId,!1),(0,T.TrackingRecord)({op:"click",page_section:"nc_popup",page_element:t}),"use_btn"==t&&this.$forward("spike")},uploadFormId:function(e){var t=e.detail.formId;m.default.uploadFormIdToSH(t,!0)},pvTracking:function(){(0,T.TrackingRecord)({op:"pv"}),this.$firstTimeTrackRecord.pv=!0}});(0,T.PddPage)(q,{pageName:"index",notUseCommonPV:!0}); 
 			}); 	require("pages/index/index.js");
 		__wxRoute = 'pages/new_arrivals/new_arrivals';__wxRouteBegin = true; 	define("pages/new_arrivals/new_arrivals.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}var e=t(require("../../common/request")),o=(t(require("../../common/std_format")),t(require("../../common/object_util")),t(require("../../components/bubble/bubble"))),a=t(require("../../common/system_info")),s=t(require("../../controller/group")),i=t(require("../../models/format/grid_item_goods")),r=t(require("../../components/big_sales/big_sales")),n=t(require("../../configs/api")),c=(t(require("../../libs/es6-promise.min")),t(require("../../libs/co/we-index"))),l=t(require("../../libs/regenerator-runtime/runtime")),d=t(require("../../common/gotop_util")),u=require("../../common/index"),h=[9,12,15,18,21],g={cacheGoodsList:[],onShareAppMessage:function(t){return this.$generateShareContent({title:"新品尝鲜"})},subjectData:{size:30,page:1,subjectId:"2742"},data:{pageName:"new_arrivals",size:50,page:1,avatars:{one:"同城排行",two:"身边的人都在拼",icon:[]},projects:{one:"精选专题",two:"你要的，都整理好了",icon:[]},toTopCls:"",noOrderText:"",showMidLoading:!0,isLoadingMore:!1,list:[],lotteryGoodsList:[],localGroupsMap:{},showError:!1,isLoadAll:!1},getNextUpdateTime:function(){for(var t=h[0],e=(new Date).getHours(),o=0;o<h.length;o++)if(e<h[o]){t=h[o];break}return t},componentsAddRootFunc:function(t,e){t&&"function"==typeof e&&(this[t]=e)},onLoad:function(t){this.setData({nextUpdateTime:this.getNextUpdateTime(),scrollContainerHeight:a.default.getWindowHeightSync()}),this.getLotterySubjectGoods(this),this.requestList(!0)},onUnload:function(){o.default.close(this)},onShow:function(){o.default.init(this,!1,"",1);var t=this;t.$BigSalesModal||(t.$BigSalesModal=new r.default({setDataFunc:function(e){t.setData(e)},addRootFunc:u.Util.bind(t.componentsAddRootFunc,t)})),t.$BigSalesModal.showBigSalesFloat()},onHide:function(){o.default.close(this)},reLoad:function(){this.cacheGoodsList=[],this.setData({nextUpdateTime:this.getNextUpdateTime(),page:1,noOrderText:"",list:[],showError:!1,isLoadAll:!1}),this.getLotterySubjectGoods(this),this.requestList(!0)},onPageScroll:function(t){if(t){var e=parseInt(t.scrollTop);d.default.showGoTopBtn(e,this)}},onReachBottom:function(){this.fillGoodsList()},getLotterySubjectGoods:c.default.wrap(l.default.mark(function t(o){var a,s,r,c,d,h,g,f,p,m;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=o.subjectData,s=a.page,r=a.size,c=a.subjectId,d=u.DataUtil.formatByPos(n.default.subjectGoodsApi,c,s,r),h=e.default.requestDataWithUrl("GET",d,null,!0),g=this,t.next=5,e.default.runMainRequestForPage(h,g);case 5:f=t.sent,p=f.goods_list||[],m=[],p.forEach(function(t){m.push(i.default.formatData(t))}),o.setData({lotteryGoodsList:m}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0);case 15:case"end":return t.stop()}},t,this,[[0,12]])})),requestHeadIcon:function(){var t=this,o=this.data,a=e.default.requestDataWithUrl("GET","avatars_subjects",null,!0);e.default.runMainRequestForPage(a,this).then(function(e){var a=[];e.goods_list.forEach(function(t){a.push(t.hd_thumb_url?t.hd_thumb_url:t.thumb_url)}),o.avatars.icon=e.avatars,o.projects.icon=a,t.setData({avatars:o.avatars,projects:o.projects})})},requestList:function(t){var o=this,a=this.data,s=a.page,r=a.size,n="v5/newlist?page="+s+"&size="+r;if(!a.isLoadingMore){this.setData({isLoadingMore:!0}),t&&this.setData({showMidLoading:!0});var c=e.default.requestDataWithUrl("GET",n,null,!0);e.default.runMainRequestForPage(c,this).then(function(t){o.setData({isLoadingMore:!1,showMidLoading:!1});var e=u.DataUtil.isArray(t.goods_list)?t.goods_list:[],a=[].concat(o.data.list);e.forEach(function(t){a.push(i.default.formatData(t))}),o.cacheGoodsList=[].concat(a),o.cacheGoodsList=u.DataUtil.objectArrayDuplicateRemove(o.cacheGoodsList,"goodsId",function(t){return 1==t.isApp}),o.fillGoodsList(),t&&(o.setData({page:s+1}),0==t.goods_list.length&&o.setData({isLoadAll:!0,noOrderText:"没有更多的商品了..."}))},function(t){o.setData({showError:!0,isLoadingMore:!1,showMidLoading:!1})})}},fillGoodsList:function(){var t=this,e=this.cacheGoodsList||[],o=this.data.list||[],a=o.length;if(e.length>a){var i=e.length-a;1!==i||this.data.isLoadAll||this.requestList(!1);var r=20;i<20&&i%2!=0&&!this.data.isLoadAll&&(r=i-1),o=e.slice(0,o.length+r),this.setData({list:o});var n=[];o.slice(a).forEach(function(t,e){2==t.customerNum&&n.push(t.goodsId)}),n.length>0&&(0,c.default)(l.default.mark(function e(){var o;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.default.loadLocalGroups(n,t.data.localGroupsMap,t);case 3:o=e.sent,t.setData({localGroupsMap:o}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}))}else this.data.isLoadAll||this.requestList(!1)},gotoGoodsDetail:function(t){var e=t.currentTarget.dataset,o=e.goodsId,a=u.DataUtil.checkByKey(this.data.list,o,"goodsId");Object.keys(a).length<=0&&(a=u.DataUtil.checkByKey(this.data.lotteryGoodsList,o,"goodsId"));var s=e.itemIndex;this.$forward("goods",Object.assign({goods_id:o},a.transData));var i={op:"click",event:"goods_clk",page_name:"shangxin",goods_id:o,idx:s,page_element:"goods"};"timeLimit"===e.refer?i.page_section="time_limit":i.page_section="goods_list",(0,u.TrackingRecord)(i)},toRankHot:function(t){(0,u.TrackingRecord)({op:"click",event:"hotcity_clk",page_name:"shangxin",page_section:"topics_list",page_element:"hotcity"}),this.$forward("rank_hot")},toPrimeSubjects:function(t){(0,u.TrackingRecord)({op:"click",event:"selectedsubject_clk",page_name:"shangxin",page_section:"topics_list",page_element:"selected_subject"}),this.$forward("prime_subjects")}};(0,u.PddPage)(g,{pageName:"new_arrivals"}); 
 			}); 	require("pages/new_arrivals/new_arrivals.js");
 		__wxRoute = 'pages/rank_hot/rank_hot';__wxRouteBegin = true; 	define("pages/rank_hot/rank_hot.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}var e=t(require("../../components/bubble/bubble")),o=t(require("../../common/gotop_util")),i=require("../../common/index"),a={onShareAppMessage:function(t){return this.$generateShareContent({title:"同城排行"})},scrollContainerHeight:"",data:{pageName:"rank_hot",size:50,page:1,toTopCls:"",noOrderText:"",showMidLoading:!0,isLoadingMore:!1,list:[],cacheScrollTop:0,canLoadMore:!0},onLoad:function(t){this.requestList(!0),this.scrollContainerHeight=i.SystemInfo.getWindowHeightSync()},onReady:function(){this.setData({windowHeight:i.SystemInfo.getWindowHeightSync()})},onUnload:function(){e.default.close(this)},onShow:function(){e.default.init(this,!1,"",1)},onHide:function(){e.default.close(this)},onPullDownRefresh:function(){wx.stopPullDownRefresh(),this.reLoad()},reLoad:function(){this.setData({page:1,noOrderText:"",list:[],canLoadMore:!0}),this.requestList(!1)},onReachBottom:function(){this.data.canLoadMore&&this.requestList(!1)},onPageScroll:function(t){if(t){var e=parseInt(t.scrollTop);o.default.showGoTopBtn(e,this)}},requestList:function(t){var e=this,o=this.data,a=o.page,n=o.size,s="v2/ranklist?page="+a+"&size="+n;if(!o.isLoadingMore){this.setData({isLoadingMore:!0}),t&&this.setData({showMidLoading:!0});var r=i.Request.requestDataWithUrl("GET",s,null,!0);i.Request.runMainRequestForPage(r,this).then(function(t){e.setData({isLoadingMore:!1,showMidLoading:!1}),e.formatListData(t),t&&(e.setData({page:a+1}),t.goods_list.length<o.size&&e.setData({noOrderText:"没有更多的商品了...",canLoadMore:!1}))},function(t){e.setData({isLoadingMore:!1,showMidLoading:!1})})}},formatListData:function(t){if(t){var e=this.data.list;t.goods_list.forEach(function(t){t.imgUrl=t.hd_thumb_url?t.hd_thumb_url:t.thumb_url,t.priceDis=i.StdFormat.price(t.price||t.group.price,100),t.soldQuantity=null!=t.cnt?i.StdFormat.sales(t.cnt):null,t.marketPrice=i.StdFormat.price(t.market_price||0,100),t.customerNum=parseInt(t.customer_num||t.group.customer_num,10),e.push(t)}),this.setData({list:e})}},goodTap:function(t){var e=t.currentTarget.dataset.goodsId;i.Navigation.forward("/pages/goods/goods?goods_id="+e)}};(0,i.PddPage)(a,{pageName:"rank_hot"}); 
 			}); 	require("pages/rank_hot/rank_hot.js");
 		__wxRoute = 'pages/prime_subjects/prime_subjects';__wxRouteBegin = true; 	define("pages/prime_subjects/prime_subjects.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}var e=t(require("../../components/bubble/bubble")),o=t(require("../../common/gotop_util")),s=require("../../common/index"),a={onShareAppMessage:function(t){return this.$generateShareContent({title:"精选专题"})},data:{pageName:"prime_subjects",size:10,page:1,noOrderText:"",showMidLoading:!0,isLoadingMore:!1,isShowLoading:!0,isShowItem:!1,list:[],cacheScrollTop:0,canLoadMore:!0},onLoad:function(t){this.requestList(!0),this.scrollContainerHeight=s.SystemInfo.getWindowHeightSync()},onUnload:function(){e.default.close(this)},onReady:function(){this.setData({windowHeight:s.SystemInfo.getWindowHeightSync()})},onShow:function(){e.default.init(this,!1,"",1)},onHide:function(){e.default.close(this)},reLoad:function(){this.setData({page:1,noOrderText:"",list:[],canLoadMore:!0}),this.requestList(!1)},onPullDownRefresh:function(){wx.stopPullDownRefresh(),this.reLoad()},onReachBottom:function(){this.data.canLoadMore&&this.requestList(!1)},onPageScroll:function(t){if(t){var e=parseInt(t.scrollTop);o.default.showGoTopBtn(e,this)}},requestList:function(t){var e=this,o=this.data,a=o.page,i=o.size,n="rank_subjects?page="+a+"&size="+i;if(!o.isLoadingMore){this.setData({isLoadingMore:!0}),t&&this.setData({showMidLoading:!0});var r=s.Request.requestDataWithUrl("GET",n,null,!0);s.Request.runMainRequestForPage(r,this).then(function(t){e.setData({isLoadingMore:!1,showMidLoading:!1}),e.formatListData(t),t&&(e.setData({isShowLoading:!1,isShowItem:!0,page:a+1}),t.length<o.size&&e.setData({noOrderText:"没有更多的商品了...",canLoadMore:!1}))},function(t){e.setData({isLoadingMore:!1,showMidLoading:!1})})}},formatListData:function(t){if(t){var e=this.data.list;t.forEach(function(t){t.desc=t.desc||"优质商品精心挑选，走过路过不要错过",t.subject=t.subject||"优质商品精心挑选，走过路过不要错过",t.goods_num=t.goods_num||0,t.sales=s.StdFormat.sales(t.sales||0)||"",t.goods_list&&t.goods_list.forEach(function(t){t.thumbUrl=t.hd_thumb_url?t.hd_thumb_url:t.thumb_url,t.price=s.StdFormat.price(t.price,100),t.shortGoodsName=t.short_name||t.goods_name}),e.push(t)}),this.setData({list:e})}},goodTap:function(t){var e=t.currentTarget.dataset.goodsId;s.Navigation.forward("/pages/goods/goods?goods_id="+e)},toNewArrivals:function(t){wx.switchTab({url:"/pages/new_arrivals/new_arrivals"})},goToSubject:function(t){var e=t.currentTarget.dataset.subjectId;s.Navigation.forward("/pages/subject/subject?subject_id="+e)}};(0,s.PddPage)(a,{pageName:"prime_subjects"}); 
 			}); 	require("pages/prime_subjects/prime_subjects.js");
 		__wxRoute = 'pages/classification/classification';__wxRouteBegin = true; 	define("pages/classification/classification.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}var i=t(require("../../constants/ui/base64/ArrowsRight")),e=t(require("../../storage/classification_storage")),o=t(require("../../controller/formid_controller")),a=require("../../common/index"),s=t(require("../../libs/co/we-index")),r=t(require("../../libs/regenerator-runtime/runtime")),n=t(require("../../configs/api")),l=[1,4,12,13,14,15,16,18,1543,743,818,1451],c="icon-category",d={14:c+"-bag",15:c+"-furniture",4:c+"-baby",1:c+"-food",18:c+"-appliances",12:c+"-overseas",818:c+"-home",13:c+"-fruit",16:c+"-cosmetics",743:c+"-man",1543:c+"-recharge",1451:c+"-shoes",0:"icon-me-heart"},h={cacheScrollInfo:{},classificationInfoDispatchId:null,detailListOffsetTop:[],data:{page:"classification",rootList:[],detailList:[],currentActiveIndex:0,scrollTop:0,arrowsRight:i.default,rootListClick:!1,showError:!1},reLoad:function(){this.setData({showError:!1}),this.loadPage()},onShareAppMessage:function(t){return this.$generateShareContent({title:"拼多多-全部分类"})},loadPage:function(){this.initPageData();var t=e.default.getClassificationInfo();t?this.showView(t):this.setData({loadingVisible:!0});var i=this;this.getClassificiationData(i)},getClassificiationData:s.default.wrap(r.default.mark(function t(i){var e,o,s;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=a.Request.requestDataWithUrl("GET",n.default.classification,null,!0),t.next=4,a.Request.runMainRequestForPage(e,i);case 4:o=t.sent,s=i.formatClassificiation(o,{}),i.processClassficationInfo(s),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),this.setData({showError:!0,loadingVisible:!1});case 12:case"end":return t.stop()}},t,this,[[0,9]])})),formatClassificiation:function(t,i){function e(t){return(t||"").slice(0,5)}if(a.DataUtil.isArray(t)){var o={rootList:[],detailList:[]};return t.forEach(function(t,s){var r=t.opt_id;if(r){var n=e(t.opt_name),c=r;l.indexOf(c)<0&&(c=0),o.rootList.push({key:["root",s].join("-"),optId:r,optType:1,optName:n,priority:parseInt(t.priority,10),isHightlight:1===parseInt(t.is_highlight,10),iconClass:d[c]});var h=t.children;if(!a.DataUtil.isArray(h))return;o.detailList[s]={key:["detail",s].join("-"),optId:r,optType:1,tabName:n,cat:[],priority:parseInt(t.priority,10)};var f=[];h.forEach(function(t){if(t.opt_id&&t.opt_name&&t.image_url){var i=t.opt_id;f.push({key:["child",i].join("-"),optId:i,optType:2,optName:e(t.opt_name),priority:parseInt(t.priority,10),isHightlight:1===parseInt(t.is_highlight,10),imgUrl:a.ImageUtil.cdnCompress(t.image_url)})}}),i.sort&&o.detailList[s].cat.sort(function(t,i){return i.priority-t.priority});var p=i.limitChildrenNum||0;p&&(f=f.slice(0,parseInt(p,10))),o.detailList[s].cat=f}}),o}},processClassficationInfo:function(t){if(t){if(t.errorCode)return this.$showToast(t.errorMsg),void this.setData({showError:0==this.data.rootList.length||0==this.data.detailList.length,loadingVisible:!1});this.showView(t),this.setData({animation:!0});var i={rootList:t.rootList,detailList:t.detailList};e.default.saveClassificationInfo(i)}},showView:function(t){this.setData({rootList:t.rootList,detailList:t.detailList,loadingVisible:!1,animation:!1,rootListClick:!0}),this.setDetailListOffsetTop(),this.scrollRootItemToMiddle(this.data.currentActiveIndex),this.moveDetailListScroll()},initPageData:function(){this.initalDataObj?this.setData(this.initalDataObj):this.initalDataObj=JSON.parse(JSON.stringify(this.data)),this.detailListOffsetTop=[]},forwardToCatgoods:function(t,i){var o=void 0,s=void 0,r=void 0,n=t.currentTarget.dataset;if(n&&(r=n.optPos)){var l=r.split("-"),c=void 0,d=void 0;if(l&&(c=parseInt(l[0]),d=parseInt(l[1])),!isNaN(c)){var h=this.data.detailList,f=h[c];if(!isNaN(d)&&h[c]&&(f=h[c].cat[d]),f&&(o=f.optId)&&(s=f.optType)){this.$forward("catgoods",{opt_id:o,opt_type:s,opt_g:1,opt_name:f.tabName||f.optName||""});var p=e.default.getClassificationInfo(),u={op:"click",event:"search_sub_opt_clk",page_name:"search",page_section:"opt",page_element:"sub_opt",idx:d,element_id:o};p&&p.rootList&&(u.section_id=p.rootList[c].optId),i&&(u.event="search_opt_more_clk",u.page_element="more_btn",u.idx=c),(0,a.TrackingRecord)(u)}}}},tapMore:function(t){this.forwardToCatgoods(t,!0);var i=t.detail.formId;this.uploadFormId(i,"opt_more_click",!1)},uploadFormId:function(t,i,e){t&&i&&o.default.uploadFormIdToSH(t,e)},gotoCatgoodsPage:function(t){this.forwardToCatgoods(t,!1)},setDetailListOffsetTop:function(){var t=this,i=this.data.detailList||[];i.forEach(function(e,o){if(o>=1){var s=Math.ceil(i[o-1].cat.length/3)*a.Util.rpxToPx(176);s+=a.Util.rpxToPx(72),s+=a.Util.rpxToPx(30),t.detailListOffsetTop[o]=t.detailListOffsetTop[o-1]+s}else t.detailListOffsetTop[o]=0}),this.detailListClientHeight=a.SystemInfo.getWindowHeightSync()-a.Util.rpxToPx(86)},scroll:function(t){if(this.data.rootListClick)this.setData({rootListClick:!1});else{var i=this.data.detailList||[],e=(a.Util.rpxToPx(106),t.detail);if(e){var o=parseInt(e.scrollTop);if(!isNaN(o)){if(this.detailListOffsetTop[i.length-1]+a.Util.rpxToPx(216)-this.detailListClientHeight<o)return void this.scrollRootItemToMiddle(i.length-1,!0);for(var s=o+this.detailListClientHeight,r=0,n=(o+s)/2,l=99999,c=0,d=1;d<i.length;++d){var h=this.detailListOffsetTop[d],f=(r+h)/2;if(!(r<s))break;if(f>o&&f<s){var p=Math.abs(f-n);p<l&&(l=p,c=d-1)}r=h}this.scrollRootItemToMiddle(c,!0)}}}},moveDetailListScroll:function(){var t=this.data.currentActiveIndex,i=this.data.rootList[t],e=void 0;if(i&&(e=i.optId),null!=e){if(this.data.scrollToViewId==="detail-"+e)return;this.setData({scrollToViewId:"detail-"+e})}},clickRootItem:function(t){var i=t.currentTarget.dataset;if(i){this.setData({rootListClick:!0});var o=parseInt(i.rootItemIndex);isNaN(o)||o===this.data.currentActiveIndex||this.scrollRootItemToMiddle(o),this.moveDetailListScroll();var s=e.default.getClassificationInfo(),r={op:"click",event:"search_opt_clk",page_name:"search",page_section:"opt_list",page_element:"opt",idx:o};s&&s.rootList&&(r.element_id=s.rootList[o].optId),(0,a.TrackingRecord)(r)}var n=t.detail.formId;this.uploadFormId(n,"opt_list_click",!1)},onReady:function(){this.windowHeight=a.SystemInfo.getWindowHeightSync()},scrollRootItemToMiddle:function(t,i){var e=this,o=0,s=void 0;s=isNaN(t)?this.data.currentActiveIndex:t,o=a.Util.rpxToPx(106)*s-Math.floor((this.windowHeight-a.Util.rpxToPx(114))/2),i?!this.cacheScrollInfo||isNaN(this.cacheScrollInfo.currentActiveIndex)||isNaN(this.cacheScrollInfo.rootListScrollTop)?(this.cacheScrollInfo={currentActiveIndex:s,rootListScrollTop:o<0?0:o},setTimeout(function(){e.setData(e.cacheScrollInfo),e.cacheScrollInfo={}},330)):this.cacheScrollInfo={currentActiveIndex:s,rootListScrollTop:o<0?0:o}:this.setData({currentActiveIndex:s,rootListScrollTop:o<0?0:o})},gotoSearchResultPage:function(){this.$forward("search_result");var t={op:"event",event:"search_view_onclick",page_name:"search"};(0,a.TrackingRecord)(t)},onLoad:function(t){if(t){var i=parseInt(t.current_index||0,10);this.setData({currentActiveIndex:i})}this.loadPage()}};(0,a.PddPage)(h,{pageName:"classification"}); 
 			}); 	require("pages/classification/classification.js");
 		__wxRoute = 'pages/personal/personal';__wxRouteBegin = true; 	define("pages/personal/personal.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var n=e(require("../../configs/app_config.js")),a=(e(require("../../storage/user_storage")),e(require("../../configs/api"))),t=e(require("../../controller/formid_controller")),r=require("../../common/message"),o=require("../../common/index"),i=(e(require("../../storage/ram_manager")),e(require("../../constants/tracking/subjects"))),s=e(require("../../common/wx_socket")),c=e(require("../../libs/co/we-index")),u=e(require("../../libs/regenerator-runtime/runtime")),l=o.ImageUtil.getCDNImgURL("base/unlogin_avatar.png"),p=[{pageName:"custom_service_list",name:"我的消息",iconClass:"p-message",needLogin:!0},{pageName:"coupons",name:"我的优惠券",iconClass:"p-coupon",needLogin:!0},{pageName:"likes",name:"我的收藏",iconClass:"p-likes",needLogin:!0},{pageName:"after_sales",name:"退款/售后",iconClass:"p-sales",needLogin:!0}],g=[{pageName:"footprint",name:"我的足迹",iconClass:"p-my-footprint",needLogin:!0},{pageName:"tzfree_list",name:"我的免单券",iconClass:"free-icon",needLogin:!0},{pageName:"addresses",name:"收货地址",iconClass:"p-addresses",needLogin:!0},{pageName:"orders",name:"我的拼团",iconClass:"p-my-group",needLogin:!0},{pageName:"custom_service",name:"官方客服",iconClass:"p-offical-service",needLogin:!0},{pageName:"setup",name:"设置",iconClass:"p-set",noSplitLine:!0,needLogin:!0}],d={isActive:!1,firstClickTime:0,clickCount:0,data:{ordersCategoryData:[{type:1,key:"unpaid",name:"待付款",iconClass:"p-unpaid"},{type:5,key:"grouping",name:"待分享",iconClass:"p-grouping"},{type:2,key:"unshipping",name:"待发货",iconClass:"p-unshipping"},{type:3,key:"unreceived",name:"待收货",iconClass:"p-unreceived"},{type:4,key:"unrated",name:"待评价",iconClass:"p-unrated"}],rowOptions:p,singleList:g,loadingVisible:!0,visible:!1,avatarUrl:l,nickName:"未授权",gender:"未知",debugNavigationVisible:!1,debugWinVisible:!1},navigatePage:function(e){var n=this,a=e.detail.value.url;o.Navigation.route("/"+a).then(function(){},function(e){n.$showToast(e.errMsg)})},cancelNavWindow:function(){this.setData({debugNavigationVisible:!1})},easterEggClick:function(){(this.clickCount>8||Date.now()-this.firstClickTime>8e3)&&(this.clickCount=0,this.firstClickTime=0),this.firstClickTime||(this.clickCount=0,this.firstClickTime=Date.now()),++this.clickCount>8&&Date.now()-this.firstClickTime<=8e3&&this.setData({debugWinVisible:!0})},confirmDebug:function(e){var a=this,t=e.currentTarget.dataset.openDebug;this.setData({debugWinVisible:!1}),t&&wx.showActionSheet({itemList:[n.default.version,"清除缓存","跳转特定页面"],success:function(e){switch(e.tapIndex){case 0:break;case 1:a.clearStorage();break;case 2:a.setData({debugNavigationVisible:!0})}}})},clearStorage:function(){try{wx.clearStorageSync(),this.$showToast("缓存清理成功")}catch(e){this.$showToast("缓存清理失败")}},userInfoTracking:function(e){var n=["personal_my_message","personal_my_coupons","personal_my_likes","personal_after_sale","personal_my_footprint","personal_my_free_group","personal_my_address","personal_my_group","custom_service","setting"];(0,o.TrackingRecord)({op:"click",event:"o_icon_clk",page_name:"personal",page_section:"page_user_info",page_element:n[e]})},clickRowOptionsItem:function(e){var n=this,a=parseInt(e.currentTarget.dataset.index,10);if(!isNaN(a)){var t=p[a].pageName;p[a].needLogin?this.navigateInterceptor(function(){n.$forward(t)}):this.$forward(t),this.userInfoTracking(a)}var r=["my_message_clk","my_coupons_clk","my_likes_clk","my_aftersale_clk"],o=e.detail.formId,i=r[a];this.uploadFormId(o,i,!0),this.setData({couponDot:0})},uploadFormId:function(e,n,a){e&&n&&t.default.uploadFormIdToSH(e,a)},clickSingleListItem:function(e){var n=this,a=parseInt(e.currentTarget.dataset.index,10);if(!isNaN(a)){var t=g[a].pageName,r={};"custom_service"==t?r.mall_id=606:"addresses"==t&&(r.allow_location="1"),g[a].needLogin?this.navigateInterceptor(function(){"setup"===t?o.Util.toWeb({page_name:"setup"},n):n.$forward(t,r)}):"setup"===t?o.Util.toWeb({page_name:"setup"},this):this.$forward(t,r),this.userInfoTracking(a+4);var i=["my_footprint_clk","my_freecoupon_clk","my_address_clk","my_groups_clk"];if(a<i.length){var s=!0;1==a&&(s=!1);var c=e.detail.formId;this.uploadFormId(c,i[a],s)}}},orderTracking:function(e){var n=["personal_order_0","personal_unpaid","personal_unshipping","personal_unreceived","personal_unrated","personal_grouping"];(0,o.TrackingRecord)({op:"click",event:"o_icon_clk",page_name:"personal",page_section:"page_order",page_element:n[parseInt(e,0)]})},didClickGetUserInfoBtn:function(){wx.canIUse&&wx.canIUse("button.open-type.getUserInfo")?(0,o.TrackingRecord)(i.default.authPromptParams):this.$showToast("您的微信版本过低，建议升级微信获得更好体验"),(0,o.TrackingRecord)({op:"click",page_name:"personal",page_section:"header",page_element:"wx_data"})},getUserInfoHandler:function(e){var n=this;if(e&&e.detail&&e.detail.userInfo){var a=e.detail.userInfo,t={country:a.country,province:a.province,city:a.city,gender:a.gender,avatar:a.avatarUrl,nickname:a.nickName};o.User.uploadUserInfo(t,function(e){e?(n.setUserInfoData(a),o.User.saveNickNameAndAvatarUrl(a),n.$showToast("资料已更新")):n.$showToast("更新资料失败")}),(0,o.TrackingRecord)(i.default.authApproveParams)}else n.$showToast("更新资料失败"),(0,o.TrackingRecord)(i.default.authRefuseParams)},gotoOrders:function(e){var n=this,a=e.currentTarget.dataset,t=parseInt(a.type,10);this.navigateInterceptor(function(){n.$forward("orders",{type:t})});var r=["order_more_clk","order_unpaid_clk","order_unshipping_clk","order_unreceived_clk","order_unrated_clk","order_grouping_clk"];this.orderTracking(t);var o=e.detail.formId;this.uploadFormId(o,r[t],!1)},getFreeCouponsCount:function(){var e=this,n=o.Request.requestDataWithUrl("GET","free_coupon_goods_list?page=1&size=50");o.Request.runMainRequestForPage(n,this).then(function(n){var a=parseInt(n.useable_coupons_count,10);wx.stopPullDownRefresh(),e.setData({freeCouponsCount:a})},function(n){var a=n.error_msg||"";e.$showToast(a)})},getUnReadMsgCount:function(){var e={cmd:"unread_msg_count",request_id:1,page:1,size:100};s.default.sendSocketMessage(e);var n=this,a=r.Message.on(r.KEYS.UNREAD_MESSAGE_COUNT,function(e){n.setData({unReadCount:e.count}),a()})},setUserInfoData:function(e){var n=this;if(e&&null!=e.nickName&&null!=e.avatarUrl){var a={avatarUrl:e.avatarUrl,nickName:e.nickName};e.gender&&(a.gender=e.gender),n.setData(a)}},updateUserInfo:function(){var e=this;o.User.requireLogin(function(){e.getCouponState(),e.getFreeCouponsCount(),o.User.getUserInfo(function(n,a){n?(e.setUserInfoData(a),o.User.saveNickNameAndAvatarUrl(a)):e.$showToast("获取用户信息失败")})})},onShow:function(){this.isActive=!0,this.updateUserInfo(),this.getUnReadMsgCount()},getCouponState:function(){var e=this;(0,c.default)(u.default.mark(function n(){var t,r;return u.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=o.Request.requestDataWithUrl("GET",a.default.getCouponState,{query_coupon:1,query_order:1},!1),n.next=4,o.Request.runSecondaryRequestForPage(t,e);case 4:(r=n.sent)&&e.setData({couponDot:r.coupon_dot,ordersCount:{unpaid:r.un_pay_count,grouping:r.grouping,unshipping:r.un_delivery_count,unreceived:r.un_receive_count,unrated:r.un_comment_count}}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),console.error(n.t0);case 12:case"end":return n.stop()}},n,this,[[0,9]])}))},onHide:function(){this.isActive=!1},onUnload:function(){this.isActive=!1},navigateInterceptor:function(e){o.User.hasLogin()?"function"==typeof e&&e():this.updateUserInfo()},loadUserInfoFromLocal:function(){var e=this,n=o.User.getUserLocalInfo()||{},a=n.nickName,t=n.avatarUrl,r=n.gender;a&&t&&r&&e.setUserInfoData({nickName:a,avatarUrl:t,gender:r})},onLoad:function(e){this.loadUserInfoFromLocal()}};(0,o.PddPage)(d,{pageName:"personal"}); 
 			}); 	require("pages/personal/personal.js");
 		__wxRoute = 'pages/order_checkout/order_checkout';__wxRouteBegin = true; 	define("pages/order_checkout/order_checkout.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function o(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var t,a,s,r=e(require("../../controller/order_checkout")),n=e(require("../../controller/addresses_controller")),i=e(require("../../controller/coupons_controller")),d=e(require("../../components/order_checkout_address/order_checkout_address.js")),u=e(require("../../components/order_checkout_goods/order_checkout_goods.js")),l=e(require("../../libs/es6-promise.min")),p=(e(require("../../components/toast/toast.js")),e(require("../../constants/goods"))),c=e(require("../../constants/groups")),h=e(require("../../constants/payment")),f=e(require("./goods_util")),m=(e(require("../../constants/coupons")),e(require("../../configs/request_errors"))),C=e(require("../../components/bubble/bubble")),g=e(require("../../components/edit_address/edit_address.js")),v=(e(require("../../storage/regions_storage")),e(require("../../configs/api"))),I=e(require("./auto_create_group")),b=e(require("../../models/address")),T=require("../../constants/order_checkout"),_=e(require("../../libs/co/we-index")),y=e(require("../../libs/regenerator-runtime/runtime")),D=e(require("../../storage/ram_manager")),k=e(require("../../storage/user_storage")),P=e(require("../../controller/formid_controller")),w=e(require("../../models/format/mall_info")),S=e(require("../../models/format/order_goods_detail")),N=e(require("../../models/format/spike_goods")),E=require("../../common/message"),O=require("../../common/index"),M=(e(require("../../common/logger_util")),{NO_COUPON:0,SOME_COUPON_AT_LEAST_ONE_USED:1,SOME_COUPON_NONE_USED:2}),A=m.default.couponErrorHint,R=[],G=(t={mallInfoDispatchId:null,goodsDetailDispatchId:null,payDispatchId:null,dispatchIds:{},toast:null,goods:null,orderCheckoutAddressModule:null,orderCheckoutGoodsModule:null,idCardModule:null,createOrderParams:null,payBtnFlag:!1,couponsParams:{},couponTakeLock:!1,disableUserAction:!1,personalInfos:null,invalidIdCardInfoCount:0,nextStepIsPay:!1,idCardValidStatusCode:null,expireTimeMini:0,expireTime:[],data:{firstEnter:!0,showReqError:!1,goodsName:"",addressArray:[],loadingVisible:!0,visible:!1,bottomBarVisible:!1,finalPrice:0,groupOrderId:null,payText:"立即支付",subPayText:"",showFreeCoupon:!1,showCaptainCoupon:!1,showPlatformCoupon:!0,selectedMallCoupon:null,selectedPlatformCoupon:null,isShowClearBtn:!1,phoneNumber:"",couponReceivedSucc:!1,mallCouponToastData:{},mallCouponsListData:{showMallCouponsList:!1,mallMainClass:"mall-coupons-main mall-coupons-main-down"},myMallCouponsData:{showCouponsList:!1,mainClass:"mall-coupons-main mall-coupons-main-down"},myPlatformCouponsData:{showCouponsList:!1,mainClass:"mall-coupons-main mall-coupons-main-down"},orderCheckoutGoodsData:{disableUserAction:!1},addressData:{editAddressWindowVisible:!1},orderCheckoutAddressData:{disableUserAction:!1,addressInfo:{}},hasIdInfo:!1,showIdHintBubble:!1,idCardHeadImg:O.ImageUtil.cdnCompress(O.ImageUtil.getCDNImgURL("base/id_card/id_card_header.png")),idCardPopupMainClass:"",idCardPopupVisible:!1,realName:"",idNumber:"",idCardHints:T.ID_CARD_HINT||[],idCardHintVisible:!1,realNameInputCursorSpace:O.Util.rpxToPx(236),idNumberInputCursorSpace:O.Util.rpxToPx(136),costTemplateId:"",freight:0,selectedEventId:0,isRefundable:0,hideNumberList:!0,records:[],payType:{wechatPay:!0,friendPay:!1,showWechatPay:!1,showFriendPay:!1},showPayWindow:!1,showPayContainer:!1},preLoadPage:function(){var e=getCurrentPages(),o=void 0;if(e.length>1&&(o=e[e.length-2]),o&&o.transGoodsData){var t=o.transGoodsData;t&&t.goodsId==this.$urlQueryObj.goods_id&&this.setData({visible:!0,firstEnter:!1,"orderCheckoutGoodsData.preMallLogo":t.preMallLogo,"orderCheckoutGoodsData.preMallName":t.preMallName||"","orderCheckoutGoodsData.preGoodsName":t.preGoodsName||"","orderCheckoutGoodsData.prePrice":t.prePrice,"orderCheckoutGoodsData.preThumbUrl":t.preThumbUrl||""})}},defaultClick:function(){},getPostageChange:function(){var e=this,o=parseInt(e.data.orderCheckoutGoodsData.notFormatTotalPrice),t=e.data.costTemplateId,a=e.data.orderCheckoutAddressData.addressInfo.provinceId,s=e.data.orderCheckoutGoodsData.goodsNumber,r=this.$urlQueryObj.sku_id,n=this.$urlQueryObj.goods_id,i=this.goods.selectedSku,d=i?i.weight||0:0;(0,_.default)(y.default.mark(function i(){var u,l,p,c,h;return y.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return u=O.DataUtil.formatByPos(v.default.luaApiGateway,t,a,s,o,r,n,d),i.next=3,O.Request.apiRequest("GET",u);case 3:l=i.sent,p=O.StdFormat.price(l.cost,100),c=l.title,h={freight:parseInt(p),loadingVisible:!1},0!=p?(h.freightTitle=c,h.freightDesc="含配送费"+p+"元"):(h.freightTitle="",h.freightDesc="免运费"),e.setData(h),e.setFinalPayAmount();case 10:case"end":return i.stop()}},i,this)}))},setBottomBarPayText:function(e){this.data.orderCheckoutGoodsData;var o=this.data.finalPayAmount;if(e){if(this.data.payType.friendPay)return void this.setData({payText:"创建订单中",subPayText:"请稍候"});0==o&&this.data.showFreeCoupon?this.setData({payText:"正在开团",subPayText:""}):this.setData({payText:"正在支付",subPayText:"请稍候"})}else{var t="立即支付";0==o&&this.data.showFreeCoupon&&(t="免费开团"),this.cancelPay&&(t="继续支付"),this.goods.eventType===c.default.EventType.FREE_TRIAL&&(t="申请试用"),this.setData({payText:t,subPayText:"",loadingVisible:!1})}},superEditBtnClk:function(e){var o=this,t=o.data.couponInfos,a=t.platformCoupons.enableSuperpositionCoupons,s=(a.maxAvailableNum,o.data.selectedPlatformCoupon);s&&"101010"==s.couponId&&(a.selectedCertainNum=a.selectedNum,this.hideCouponsList()),a.showSuperEditBtn=!1,t.platformCoupons.enableSuperpositionCoupons=a,this.setData({couponInfos:t}),o.setCouponListWindowData("myPlatformCouponsData",o.data.couponTitle,(o.data.couponInfos||{}).platformCoupons||{},!1,o.data.selectedPlatformCoupon,[]),this.setPlatformCouponText()},updateSuperNumber:function(e){var o=this,t=parseInt(e.target.dataset.delta),a=o.data.couponInfos.platformCoupons.enableSuperpositionCoupons;if(!(a.reduceSuperDisable&&t<0||a.increaseSuperDisable&&t>0)){var s=a.selectedNum+t;o.setupSuperNumData(s)}},blurSuperNumInput:function(e){var o=this,t=parseInt(e.detail.value.trim(),10),a=o.data.couponInfos.platformCoupons.enableSuperpositionCoupons.maxAvailableNum;isNaN(t)&&(t=1),t<1&&(t=1),t>a&&(t=a),o.setupSuperNumData(t)},initSuperEditBtn:function(){var e=this.data.couponInfos,o=e.platformCoupons.enableSuperpositionCoupons,t=o.selectedCertainNum,a=!1,s=!1;a=t<=1,s=t>=o.maxAvailableNum,o.reduceSuperDisable=a,o.increaseSuperDisable=s,e.platformCoupons.enableSuperpositionCoupons=o,this.setData({couponInfos:e})},setupSuperNumData:function(e){var o=this,t=o.data.couponInfos,a=t.platformCoupons.enableSuperpositionCoupons,s=a.maxAvailableNum,r=o.data.selectedPlatformCoupon,n=!1,i=!1;n=e<=1,i=e>=s,a.reduceSuperDisable=n,a.increaseSuperDisable=i,a.selectedNum=e,a.showSuperEditBtn=!0,t.platformCoupons.enableSuperpositionCoupons=a;var d={couponInfos:t};r&&"101010"==r.couponId&&(d.selectedPlatformCoupon=a),o.setData(d),o.setCouponListWindowData("myPlatformCouponsData",o.data.couponTitle,(o.data.couponInfos||{}).platformCoupons||{},!1,o.data.selectedPlatformCoupon,[])},setCouponListWindowData:function(e,t,a,s,r,n){var i,d=this,u=a.enableCoupons||[],l=a.disableCoupons||[],p=a.enableSuperpositionCoupons||{},c=(i={},o(i,e+".title",t),o(i,e+".subtitle","使用优惠券"),o(i,e+".isMallCoupon",!!s),o(i,e+".promotionEvents",n),o(i,e+".enableCoupons",u),o(i,e+".enableSuperpositionCoupons",p),o(i,e+".disableCoupons",l),o(i,e+".hasCoupons",u.length>0||l.length>0||this.data.hasSuperpositionCoupons),o(i,e+".selectedCoupon",r),o(i,e+".selectedCouponId",(r||{}).couponId),o(i,e+".showLimitTips",u.length+l.length>=20),o(i,e+".showCouponsList",!0),i);this.setData(c),setTimeout(function(){d.setData(o({},e+".mainClass","mall-coupons-main mall-coupons-main-up"))},100)},hideIdCardPopup:function(){var e=this;this.nextStepIsPay=!1,this.setData({idCardPopupMainClass:" id-card-main-down"}),setTimeout(function(){e.setData({idCardPopupVisible:!1})},320)},showIdCardPopup:function(){var e=this;this.data.disableUserAction?this.$showToast("订单已生成，信息不可更改"):(this.setData({idCardPopupVisible:!0}),setTimeout(function(){e.setData({idCardPopupMainClass:" id-card-main-up"})},1))},setIdCardInfo:function(e){var o=(e=e||{}).realName,t=e.idNumber;this.checkIdNumberValid(t)&&this.checkRealNameValid(o)?this.setData({showIdHintBubble:!1}):this.setData({showIdHintBubble:!0})},showPlatformCouponList:function(){if(this.data.disableUserAction)this.$showToast("订单已生成，信息不可更改");else{var e=(this.data.couponInfos||{}).platformCoupons||{};(e.enableSuperpositionCoupons||{}).selectedNum&&(e.enableSuperpositionCoupons.selectedNum=e.enableSuperpositionCoupons.selectedCertainNum),this.setCouponListWindowData("myPlatformCouponsData",this.data.couponTitle,e,!1,this.data.selectedPlatformCoupon,[]);var o=this.getTrackingParams("click",null,"general_coupons");(0,O.TrackingRecord)(o)}},checkEnterNumber:function(e){var o=/(^1)\d{10}$/;return this.goods.goodsType==p.default.GoodsType.OIL_CARD?o=/(^1)\d{18}$/:this.goods.goodsType==p.default.GoodsType.QQ_COIN&&(o=/^[0-9]{5,11}$/),e?!!o.test(e)||(this.$showToast(this.data.virtualNumError),!1):(this.$showToast("请填写要充值的号码"),!1)},paySuccess:function(e){var o=this,t=this,a=v.default.orderPayCheck+"?order_sn="+e,s=O.Request.requestDataWithUrl("GET",a),r={op:"event",page_name:"order_checkout",sub_op:0==this.goods.isPresale?"pay_order":"prepay_order",order_sn:e,order_amount:parseInt(100*t.data.finalPayAmount,10),goods_id:this.goods.goodsId,goods_type:this.goods.goodsType,event_type:this.goods.eventType,goods_number:this.data.orderCheckoutGoodsData.goodsNumber,group_num:this.data.groupNum,sku_id:this.data.skuId,groupId:this.data.groupId,tag:"pdd_order",mall_id:this.goods.mallId};D.default.isReadBigSales&&(r.refer_xcx_campaign_d12=1),O.Request.runMainRequestForPage(s,t).then(function(e){var o,a=e;if(a&&(o=a.group_order_id),o){D.default.lastGroupOrderId=o,D.default.lastOrderGoodsId=t.$urlQueryObj.goods_id;var s="/pages/group/group?group_order_id="+o;O.Navigation.redirectForward(s),t.getGroupInfoTracking(o,t,r)}},function(e){var t=e.error_msg;t||(t="出错了，请稍后重试"),o.$showToast(t),(0,O.TrackingRecord)(r)})},getCouponUsageForTrackingRecord:function(){var e=(this.data.selectedMallCoupon||{}).couponId,o=(this.data.selectedPlatformCoupon||{}).couponId;if(e||o)return M.SOME_COUPON_AT_LEAST_ONE_USED;var t=this.data.couponInfos||{};return t.mallCoupons&&t.mallCoupons.enableCoupons.length>0||t.platformCoupons&&t.platformCoupons.enableCoupons.length>0?M.SOME_COUPON_NONE_USED:M.NO_COUPON},pay:function(e){if(!this.payBtnFlag){var o=O.DataUtil.getLogId(),t=this.goods||{};if(!O.FilterUtil.filter(t.eventType,t.goodsType))this.$showToast("在小程序中暂不支持购买该类商品");else{e.detail.formId;this.$uploadFormId(e,!1);var a=this.getTrackingParams("click",null,"pay_btn");if(a.coupon_usage=this.getCouponUsageForTrackingRecord(),a.log_id=o,e&&e.currentTarget&&e.currentTarget.dataset&&"cancel_pay_prompt"===e.currentTarget.dataset.refer&&(a.page_el_sn=99119,a.friend_pay=this.data.payType.friendPay),(0,O.TrackingRecord)(a),this.cancelPay)return this.data.payType.friendPay&&this.orderSn?void this.dealToHelpPay():void this.repay();var s={logId:o,goodsId:this.$urlQueryObj.goods_id||t.goodsId,isAutoGroup:!1,orderAmount:parseInt(100*this.data.finalPayAmount),skuId:this.data.skuId,groupId:this.data.groupId,groupNum:this.data.groupNum,goodsName:this.data.goodsName,skuNumber:this.data.orderCheckoutGoodsData.goodsNumber,mallCouponId:(this.data.selectedMallCoupon||{}).couponId,platformCouponId:"101010"!=(this.data.selectedPlatformCoupon||{}).couponId?(this.data.selectedPlatformCoupon||{}).couponId:null,couponNumber:(this.data.selectedPlatformCoupon||{}).selectedNum,goodsType:this.goods.goodsType,eventType:this.goods.eventType,eventId:this.data.selectedEventId,friendPay:this.data.payType.friendPay};if(s.eventType==c.default.EventType.MORE_THAN_ONE_DISCOUNT&&s.eventId>0&&1==s.skuNumber&&(s.eventId=0),s.finalPrice=this.data.finalPayAmount,(!this.data.isVirtualGoods||this.checkEnterNumber(this.data.phoneNumber))&&this.data.goodsNumber&&!(this.data.goodsNumber<0)){this.data.isVirtualGoods&&(s.phoneNumber=this.data.phoneNumber),this.data.groupOrderId&&(s.groupOrderId=this.data.groupOrderId),this.data.freeCoupon&&this.data.freeCoupon.couponId&&(s.groupFreeCoupon=this.data.freeCoupon),this.data.captainCoupon&&this.data.captainCoupon.couponId&&(s.groupCaptainCoupon=this.data.captainCoupon);var n=this.data.orderCheckoutAddressData;if(!this.data.isVirtualGoods){if(!n||!n.addressInfo||n.addressInfo.addressId<=0)return void("function"==typeof this.addAddress&&this.addAddress());if(!n.addressInfo.canReceived){var i=this;return void wx.showModal({content:"该商品有地区限制，请使用快递可以送达的地址",success:function(e){e.confirm&&"function"==typeof i.editAddress&&i.editAddress()}})}}if(s.addressId=this.data.isVirtualGoods?"0":n.addressInfo.addressId,!this.data.needId||this.data.hasIdInfo&&!this.data.showIdHintBubble)(s.addressId||this.data.isVirtualGoods)&&(this.setBottomBarPayText(!0),this.payBtnFlag=!0,this.createOrderParams=s,E.Message.on(E.KEYS.ORDER_CHECKOUT_PAY,O.Util.bind(this.processPay,this)),r.default.createOrder(s,E.KEYS.ORDER_CHECKOUT_PAY)),this.data.payType.friendPay&&this.$uploadFormId(e,!1);else if(this.nextStepIsPay=!0,this.showIdCardPopup(),this.idCardValidStatusCode){var d=m.default.messageFromCode(this.idCardValidStatusCode);this.$showToast(d),this.idCardValidStatusCode=null}}}}},dealToHelpPay:function(){this.goToHelpPay=!0;var e={order_sn:this.orderSn};this.data.groupOrderId&&(e.group_order_id=this.data.groupOrderId),this.$forward("help_pay",e)},repay:function(){this.orderSn&&(this.payBtnFlag=!0,this.setBottomBarPayText(!0),r.default.doPay(this.orderSn,E.KEYS.ORDER_CHECKOUT_PAY))},setUserActionDisabled:function(){this.setData({disableUserAction:!0,"orderCheckoutGoodsData.disableUserAction":!0,"orderCheckoutAddressData.disableUserAction":!0})},getSelectedSkuPrice:function(){var e=this.getSelectedGroup(),o=this.getSelectedSku();return f.default.getSelectedSkuPrice(e,o)},getGroupOrderDetail:_.default.wrap(y.default.mark(function e(o,t){var a,s;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=O.DataUtil.formatByPos(v.default.groupOrder,o),e.next=4,O.Request.apiRequest("GET",a);case 4:return s=e.sent,e.abrupt("return",s);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),closePayWindow:function(){this.setData({showPayWindow:!1})},processPay:function(e){this.payBtnFlag=!1,e&&e.orderSn&&(this.orderSn=e.orderSn,this.orderCheckoutAddressModule.orderSn=this.orderSn),this.setBottomBarPayText();this.$urlQueryObj.group_order_id;if(e.errorCode){var o=e.errorMsg;if(h.default.isCancelPay(o)){o=null,this.cancelPay=!0,this.setUserActionDisabled(),this.setBottomBarPayText(),this.dealPayWindow(!0);var t=!1,a=!0,s=!1,n=void 0;try{for(var i,d=this.expireTime[Symbol.iterator]();!(a=(i=d.next()).done);a=!0)if("orderTime"==i.value.name){t=!0;break}}catch(e){s=!0,n=e}finally{try{!a&&d.return&&d.return()}finally{if(s)throw n}}if(!t){var u={name:"orderTime",value:1800};this.expireTime.push(u),this.countExpireInterval||this.countDownTimeSpike()}}if(e.errorCode==m.default.GroupCompleted.code){var l={goodsId:this.goods.goodsId,createOrderParams:this.createOrderParams,orderSn:this.orderSn,eventType:this.goods?this.goods.eventType:"",notFormatPrice:this.getSelectedSkuPrice(),goodsNumber:this.data.orderCheckoutGoodsData.goodsNumber||this.data.goodsNumber||1,groupId:this.data.groupId,skuId:this.data.skuId,sourceMallId:this.goods.mallId},p=this;this.createOrderParams&&I.default.createGroup(l,function(e){e.groupOrderId=null,e.goodsType=this.goods?this.goods.goodsType:"",e.eventType=this.goods?this.goods.eventType:"",p.createOrderParams=e,e.isAutoGroup=!0,r.default.createOrder(e,E.KEYS.ORDER_CHECKOUT_PAY)},function(){var e=this.$urlQueryObj.goods_id;e&&O.Navigation.redirectForward("/pages/goods/goods?goods_id="+e)})}else if(e.errorCode==m.default.LimitDiscountError.code)this.$showToast(m.default.LimitDiscountError.message);else if(e.errorCode==m.default.LimitQuantityDiscountError.code){var c=this;o=m.default.LimitQuantityDiscountError.message,this.$showModal({content:o,showCancel:!1,success:function(e){if(e.confirm){var o=c.$urlQueryObj.goods_id;o&&c.$forward("goods",{goods_id:o})}}})}else if(o){var f=this;this.$showToast(o,{hideToastFunc:function(){if(!f.cancelPay&&f.orderSn){var e="/pages/order/order?ordersn="+f.orderSn;O.Navigation.redirectForward(e)}}})}}else if(e.orderSn){if(this.data.payType.friendPay)return void this.dealToHelpPay();D.default.hasPaySucess=!0,this.paySuccess(e.orderSn)}},getGroupInfoTracking:_.default.wrap(y.default.mark(function e(o,t,a){var s,r,n;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!o){e.next=12;break}return e.next=4,t.getGroupOrderDetail(o,t);case 4:s=e.sent,r=s.leader_order_info.uid,n=k.default.getUserId(),a.Is_group_owner=r==n?"1":"0",s&&s.group_order_info&&void 0!==s.group_order_info.group_status?a.group_status=s.group_order_info.group_status:a.group_status=0,s&&s.group_order_info&&s.group_order_info.customer_num&&(a.group_num=s.group_order_info.customer_num),a.group_order_id=o,(0,O.TrackingRecord)(a);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])})),getSelectedSku:function(){var e=this.data.skuId.toString(),o=this.goods.skus||null,t=null;if(null!==o)for(var a=0;a<o.length;a++)if(o[a].skuId.toString()===e){t=o[a];break}return t},getSelectedGroup:function(){var e=this.goods.groupTypes;if(e&&e.length>0)for(var o=0;o<e.length;o++)if(this.data.groupId==e[o].groupId)return e[o];if(e&&e.length>1)return e[1]},processMallInfo:function(e){if(e.errorCode){var o=e.errorMsg;this.$showToast(o)}else{var t=e.mallName?e.mallName:"",a=e.mallCoupons?e.mallCoupons:[],s=this.data.promotionEvents||[];this.setData({mallInfo:e,"mallCouponsListData.title":t,"mallCouponsListData.coupons":a,"mallCouponsListData.promotionEvents":s}),this.setupOrderCheckoutGoodsModule()}n.default.fetchRegionsJsonData()},setupOrderCheckoutGoodsModule:function(){if(this.data.mallInfo&&this.data.couponInfos&&this.personalInfos){var e=void 0;(this.goods.isCapitalGift||this.goods.isCapitalGiftLottery)&&(e=!this.$urlQueryObj.group_order_id),this.orderCheckoutGoodsModule||(this.orderCheckoutGoodsModule=new u.default);var o=this.getSelectedSkuPrice();this.orderCheckoutGoodsModule.load(this.goods,this.data.mallInfo,this.data.couponInfos,this.data.selectedEventId,{setDataFunc:this.componentsSetDataFuncs().orderCheckoutGoods,getDataFunc:this.componentsGetDataFuncs().orderCheckoutGoods,addRootFunc:O.Util.bind(this.componentsAddRootFunc,this),setFinalPayAmount:O.Util.bind(this.setFinalPayAmount,this),isCapitalOwner:e,skuId:this.data.skuId,selectedCoupon:this.data.selectedMallCoupon,goodsNumber:this.data.orderCheckoutGoodsData.goodsNumber||this.data.goodsNumber||1,selectedGroup:this.getSelectedGroup(),selectedSkuPrice:o,setupCouponsFunc:O.Util.bind(this.setupCoupons,this),showMallCouponsList:O.Util.bind(this.showMallCouponsList,this),selectMallCoupon:O.Util.bind(this.selectMallCoupon,this),couponReceivedSucc:this.data.couponReceivedSucc})}},initVirtualInfo:function(e){var o="",t="",a=11,s="请输入正确的充值号码";switch(e.goodsType){case p.default.GoodsType.MOBILE_DATA:case p.default.GoodsType.MOBILE_FARE:o="充值号码：",t="仅限中国大陆手机号码";break;case p.default.GoodsType.QQ_COIN:o="QQ号：",t="请输入QQ号",a=11;break;case p.default.GoodsType.OIL_CARD:o="加油卡号码：",t="请输入加油卡号码",a=19,s="请输入正确的19位加油卡号"}this.setData({virtualTitle:o,virtualPlaceholder:t,virtualLimit:a,virtualNumError:s})},clearIntervalFun:function(){var e=!0,o=!0,t=!1,a=void 0;try{for(var s,r=this.expireTime[Symbol.iterator]();!(o=(s=r.next()).done);o=!0)if(s.value.value>0){e=!1;break}}catch(e){t=!0,a=e}finally{try{!o&&r.return&&r.return()}finally{if(t)throw a}}e&&(clearInterval(this.countExpireInterval),this.countExpireInterval=null)},expireSpike:function(e){var o=this,t=e.name,a=t+"List",s=t+"Mini";if(e.value>=0){var r=O.TimeUtil.transferToTime(1e3*e.value).split(":"),n={};n[a]=r,0==e.value.toFixed(1)?(n[s]=0,"orderTime"==e.name&&(n.orderTimeTitle="请尽快支付"),o.clearIntervalFun()):n[s]=o.expireTimeMini,o.setData(n)}else o.clearIntervalFun()},countDownTimeSpike:function(){if(this.expireTime.length>0){var e=!0,o=!1,t=void 0;try{for(var a,s=this.expireTime[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var r=a.value;r&&r.value>=0&&this.expireSpike(r)}}catch(e){o=!0,t=e}finally{try{!e&&s.return&&s.return()}finally{if(o)throw t}}var n=this;n.countExpireInterval=setInterval(function(){var e=0,o=!0,t=!1,a=void 0;try{for(var s,r=n.expireTime[Symbol.iterator]();!(o=(s=r.next()).done);o=!0){var i=s.value;i.value-=.1,n.expireTime[e].value=i.value,0==n.expireTimeMini&&(n.expireTimeMini=10),n.expireTimeMini--,n.expireSpike(i),e++}}catch(e){t=!0,a=e}finally{try{!o&&r.return&&r.return()}finally{if(t)throw a}}},100)}},processGoodsDetail:function(e){var o=this,t=this;if(wx.stopPullDownRefresh(),this.goods=e||{},D.default.lastOrderGoodsData=e,e.errorCode)return e&&e.errorMsg&&this.$showToast(e.errorMsg),void this.setData({showReqError:!0});if(this.data.groupId||this.setData({groupId:e.groupTypes[1].groupId}),this.getMallInfo(),this.setupCoupons(),(16==e.eventType||18==e.eventType)&&e.promotionEvents&&e.promotionEvents.length>0){var a=e.promotionEvents[0],s=this.getSelectedSkuPrice(),r=a.discount_type,n=a.event_items[0].discount_param,i=this.data.orderCheckoutGoodsData.goodsNumber||this.data.goodsNumber||1;2==r&&(this.goods.promotionEvents[0].event_items[0].discount=Math.ceil((100-n)/100*s)*i,this.goods.promotionEvents[0].event_items[0].descountDesc=" -"+O.StdFormat.price(Math.ceil((100-n)/100*s)*i,100)+"元",this.goods.promotionEvents[0].event_items[0].goods_number=1)}if(e.freeCoupon&&e.freeCoupon.length>0&&(e.freeCoupon[0].discount=this.getSpecialCouponDiscount()),e.captainCoupon&&e.captainCoupon.length>0&&(e.captainCoupon[0].discount=this.getSpecialCouponDiscount(100)),this.goods.selectedSku=this.getSelectedSku(),e.eventType===c.default.EventType.CAPITAL_GIFT?this.goods.isCapitalGift=!0:e.eventType===c.default.EventType.CAPITAL_GIFT_LOTTERY&&(this.goods.isCapitalGiftLottery=!0),e){e.isOnsale||O.Navigation.back(),"1"==e.isApp&&O.Navigation.back(),e.isVirtualGoods&&this.initVirtualInfo(e);var u={needId:[p.default.GoodsType.OVERSEAS_TRANSSHIP,p.default.GoodsType.OVERSEAS_DM].indexOf(parseInt(e.goodsType,10))>=0,isVirtualGoods:e.isVirtualGoods,costTemplateId:e.costTemplateId,isRefundable:e.isRefundable,promotionEvents:e.promotionEvents,eventType:e.eventType};if(e.eventType==c.default.EventType.SPIKE){this.userId||(this.userId=k.default.getUserId());var h=parseInt(this.userId%100);h>=0&&h<=9&&(u.showSpikeInfo=!0)}if(u.showSpikeInfo&&e.spikeGroup&&e.spikeGroup[0]){var f=N.default.formatGoodsData(e.spikeGroup[0]),C=e.serverTime,g=f.startTime;if(C-g<3600){var I={name:"spikeTime",value:g+3600-C};this.expireTime.push(I),this.countExpireInterval||this.countDownTimeSpike(),f.showLeftTime=!0,f.showPercent=!1}else f.showPercent=!0,f.showLeftTime=!1;u.spikeData=f}if(u.needId?O.Request.apiRequest("GET",v.default.userIdCard).then(function(e){var t={realName:e.id_card_name,idNumber:e.id_card_no};o.personalInfos=t,o.setIdCardInfo(t),t.hasIdInfo=!0,o.setData(t),o.setupOrderCheckoutGoodsModule()},function(e){o.idCardValidStatusCode=e.error_code,o.idCardValidStatusCode==m.default.NoNameIDBefore.code&&(o.idCardValidStatusCode=null),o.personalInfos={},o.setIdCardInfo({}),o.setupOrderCheckoutGoodsModule()}):this.personalInfos={},!this.data.groupOrderId&&e.freeCoupon&&e.freeCoupon.length>0){var b=e.freeCoupon[0];u.showPlatformCoupon=!1,u.showFreeCoupon=!0,u.freeCoupon={couponId:b.coupon_id,discount:O.StdFormat.price(b.discount,100)}}else if(!this.data.groupOrderId&&e.captainCoupon&&e.captainCoupon.length>0){var T=e.captainCoupon[0];u.showPlatformCoupon=!1,u.showCaptainCoupon=!0,u.captainCoupon={couponId:T.coupon_id,discount:O.StdFormat.price(T.discount,100)}}if(this.goods.isCapitalGift){var _=!this.$urlQueryObj.group_order_id;u.showPlatformCoupon=_}this.goods.eventType!==c.default.EventType.FREE_TRIAL&&this.goods.eventType!==c.default.EventType.LUCKY_DRAW||(u.showPlatformCoupon=!1),this.data.skuId||(u.skuId=this.$urlQueryObj.sku_id||e.skus[0].skuId);var y=this.data.payType;y.showWechatPay=!0,1!=e.eventType&&3!=e.eventType&&7!=e.eventType&&(y.showFriendPay=!0),u.payType=y,this.setData(u);var P=[];e.allowedRegion&&"1"!==e.allowedRegion.toString()&&(P=e.allowedRegion.toString().split(",")),l.default.all(R).then(function(){t.orderCheckoutAddressModule||(t.orderCheckoutAddressModule=new d.default),t.orderCheckoutAddressModule.load(t.data.addressArray,t.$urlQueryObj.sel_address_id,P,{setDataFunc:t.componentsSetDataFuncs().orderCheckoutAddress,getDataFunc:t.componentsGetDataFuncs().orderCheckoutAddress,addRootFunc:O.Util.bind(t.componentsAddRootFunc,t)}),t.orderCheckoutAddressModule.setTrackingFunc(O.Util.bind(t.addressTracking,t)),t.setData({firstEnter:!1,visible:!0})}),this.data.isVirtualGoods&&this.goods.goodsType!==p.default.GoodsType.QQ_COIN&&this.goods.goodsType!==p.default.GoodsType.OIL_CARD&&O.Request.apiRequest("GET",v.default.getChargeHistory,{},!1).then(function(e){var t=e.records;if(t&&t.length>0){for(var a=0;a<t.length;a++){var s=t[a].mobile;if(s&&11==s.length){var r=[];r[0]=s.slice(0,3),r[1]=s.slice(3,7),r[2]=s.slice(7,11),t[a].mobileList=r}}o.setData({records:t})}},function(e){o.$showToast(e.error_msg)})}},setupPromotion:function(){var e=this.goods.promotionEvents;if(e&&e.length>0){var t,a=e[0].event_items,s=this.data.orderCheckoutGoodsData.goodsNumber||this.data.goodsNumber||1,r=0,n=(t={},o(t,"myMallCouponsData.selectedCoupon",null),o(t,"myMallCouponsData.selectedCouponId",null),o(t,"selectedMallCoupon",null),t);if(16!=this.goods.eventType){if(12==this.goods.eventType){var i=0;for(var d in a)s>=a[d].goods_number&&(r=e[0].event_id,i+=a[d].discount_param);r>0&&i>0&&(n.selectedEventId=r,n.promotionDiscount=i,this.setData(n))}else for(var d in a)if(s>=a[d].goods_number){r=e[0].event_id,n.selectedEventId=r,n.promotionDiscount=a[d].discount,this.setData(n);break}}else{var u=this.data.couponInfos,l=e[0].event_items[0].discount;if(r=e[0].event_id,u&&u.mallCoupons&&u.mallCoupons.enableCoupons&&u.mallCoupons.enableCoupons.length>0){var p=u.mallCoupons.enableCoupons;100*p[0].discount>l&&(r=0,n.selectedMallCoupon=p[0])}n.selectedEventId=r,r>0&&(n.promotionDiscount=l),this.setData(n)}}},getMallInfo:function(){var e=this,o=this.goods.mallId;(0,_.default)(y.default.mark(function t(){var a,s,r;return y.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=O.DataUtil.formatByPos(v.default.mallInfo,o),t.next=4,O.Request.apiRequest("GET",a,null,!0);case 4:s=t.sent,r=w.default.formatData(s),e.processMallInfo(r),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),e.processMallInfo({errorCode:t.t0.error_code,errorMsg:t.t0.error_msg});case 13:case"end":return t.stop()}},t,this,[[0,9]])}))},setupCoupons:function(){var e=this,t=this.goods.promotionEvents;if(t&&t.length>0){var a;this.setData((a={},o(a,"myMallCouponsData.selectedCoupon",null),o(a,"myMallCouponsData.selectedCouponId",null),o(a,"selectedMallCoupon",null),o(a,"selectedEventId",0),a))}var s=this.goods,r=null;if(!this.data.groupOrderId&&s.freeCoupon&&s.freeCoupon.length>0||7==s.goodsType||s.eventType==c.default.EventType.FREE_TRIAL||s.eventType==c.default.EventType.LUCKY_DRAW)r={freeCoupon:s.freeCoupon,mallCoupons:{enableCoupons:[],disableCoupons:[]},platformCoupons:{enableCoupons:[],disableCoupons:[]}},this.setData({couponInfos:r}),this.setupOrderCheckoutGoodsModule();else if(!this.data.groupOrderId&&s.captainCoupon&&s.captainCoupon.length>0)r={captainCoupon:s.captainCoupon,mallCoupons:{enableCoupons:[],disableCoupons:[]},platformCoupons:{enableCoupons:[],disableCoupons:[]}},this.setData({couponInfos:r}),this.setupOrderCheckoutGoodsModule();else{var n=this.getSelectedGroup(),i=this.getSelectedSku();if(this.couponsParams={goodsId:this.$urlQueryObj.goods_id,groupId:this.data.groupId,skuId:this.data.skuId,groupOrderId:this.data.groupOrderId,eventType:s.eventType,goodsNumber:this.data.orderCheckoutGoodsData.goodsNumber||this.data.goodsNumber,sourceMallId:s.mallId,price:f.default.getSelectedSkuPrice(n,i),limitQuantity:f.default.getLimitQuantity(i,n),customerNum:parseInt(n.requireNum,10)},this.data.groupOrderId||s.eventType!=c.default.EventType.TZYY)this.loadCoupons();else{var d={goodsId:this.$urlQueryObj.goods_id,groupId:this.$urlQueryObj.group_id,skuId:this.$urlQueryObj.sku_id};O.Request.apiRequest("POST",v.default.takeCaptainCoupon,d).then(function(o){var t=o&&o.captain_coupon;if(t&&t.length>0){s.captainCoupon=t;var a=t[0];r={captainCoupon:a,mallCoupons:{enableCoupons:[],disableCoupons:[]},platformCoupons:{enableCoupons:[],disableCoupons:[]}},e.setData({couponInfos:r,showPlatformCoupon:!1,showCaptainCoupon:!0,captainCoupon:{couponId:a.coupon_id,discount:O.StdFormat.price(a.discount,100)}}),e.setupOrderCheckoutGoodsModule()}else e.loadCoupons()},function(o){e.loadCoupons()})}}},loadCoupons:function(){var e=this.couponsParams;e.price*e.goodsNumber<=100&&18!=e.eventType?(this.setData({couponInfos:{mallCoupons:{enableCoupons:[],disableCoupons:[]},platformCoupons:{enableCoupons:[],disableCoupons:[]}}}),this.setupOrderCheckoutGoodsModule()):this.loadMallCoupons()},loadMallCoupons:function(){var e=this.couponsParams,o=this;o.payBtnFlag=!0;var t={enableCoupons:[],disableCoupons:[]};this.goods.isCapitalGift||this.goods.isCapitalGiftLottery?this.loadPlatformCoupons(t):e.eventType!==c.default.EventType.FREE_TRIAL?(0,_.default)(y.default.mark(function e(){var t,a,s,r,n,d,u;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=o.couponsParams,a={goods_id:t.goodsId,group_id:t.groupId,sku_id:t.skuId,group_order_id:t.groupOrderId,sku_number:t.goodsNumber,source_mall_id:t.sourceMallId},s=v.default.mallCoupons+"?"+O.UrlUtil.buildQuery(a),e.next=6,O.Request.apiRequest("GET",s);case 6:r=e.sent,n=r.coupons||{},d={serverTime:r.server_time||0,enableCoupons:n.usable_coupons||[],disableCoupons:n.unusable_coupon_list||[]},u=i.default.formatCouponsData(d,t),o.processMallCoupons(u),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),o.payBtnFlag=!1;case 17:case"end":return e.stop()}},e,this,[[0,13]])})):this.loadPlatformCoupons(t)},processMallCoupons:function(e){e.errorCode&&e&&e.errorMsg&&this.$showToast(e.errorMsg),this.goods.promotionEvents&&this.goods.promotionEvents.length>0?this.setData({selectedMallCoupon:null}):e.enableCoupons&&e.enableCoupons.length>0?this.setData({selectedMallCoupon:e.enableCoupons[0]}):this.setData({selectedMallCoupon:null}),this.loadPlatformCoupons(e)},setCouponInfosData:function(e,o){var t=this.data.couponInfos||{};t[e]=o,this.setData({couponInfos:t})},selectCouponItem:function(e){if(e&&e.detail&&e.detail.target&&e.detail.target.dataset&&e.detail.target.dataset.couponId&&e.detail.target.dataset.eventId&&e.detail.target.dataset.isMallCoupon)var t=e.detail.target.dataset.couponId,a=e.detail.target.dataset.eventId,s=e.detail.target.dataset.isMallCoupon;else var t=e.currentTarget.dataset.couponId,a=e.currentTarget.dataset.eventId,s=e.currentTarget.dataset.isMallCoupon;var r=this.data.selectedEventId||0,n=s?"myMallCouponsData":"myPlatformCouponsData",i=s?"selectedMallCoupon":"selectedPlatformCoupon";s&&(r=-1==a||a==this.data.selectedEventId?-1:a);var d=((s?this.data.selectedMallCoupon:this.data.selectedPlatformCoupon)||{}).couponId;if(0==t||t==d){var u;this.setData((u={},o(u,n+".selectedCoupon",null),o(u,n+".selectedCouponId",null),o(u,i,null),o(u,"selectedEventId",r),u))}else{var l=this.data.couponInfos||{},p=(s?l.mallCoupons:l.platformCoupons)||{},c=p.enableCoupons||[],h=p.enableSuperpositionCoupons||{};if("101010"==t){var f;h.showSuperEditBtn||(h.selectedCertainNum=h.selectedNum),this.setData((f={},o(f,n+".selectedCoupon",h),o(f,n+".selectedCouponId",t),o(f,i,h),o(f,"selectedEventId",r),f))}else for(var m=0;m<c.length;m++)if(t==c[m].couponId){var C;this.setData((C={},o(C,n+".selectedCoupon",c[m]),o(C,n+".selectedCouponId",t),o(C,i,c[m]),o(C,"selectedEventId",r),C));break}}if(16!=this.data.eventType&&18!=this.data.eventType||this.hideMallCouponsList(),this.hideCouponsList(),s?this.mallCouponUpdated():this.setPlatformCouponText(),e&&e.detail&&e.detail.formId)P.default.scene.common,e.detail.formId},mallCouponUpdated:function(){var e=(this.data.couponInfos||{}).mallCoupons||{};this.loadPlatformCoupons(e)},loadPlatformCoupons:function(e){e.errorCode||this.setCouponInfosData("mallCoupons",e),16!=this.data.eventType&&18!=this.data.eventType?this.data.myMallCouponsData.selectedCouponId||-1==this.data.selectedEventId||this.setupPromotion():this.data.myMallCouponsData.selectedCouponId||0!=this.data.selectedEventId||this.setupPromotion();var o=0,t=this,a={enableCoupons:[],disableCoupons:[]},s=this.data.selectedMallCoupon;o=this.data.selectedEventId>0&&this.data.promotionDiscount>0?this.data.promotionDiscount:s?100*s.discount:0;var r=this.couponsParams;if(r.currentOrderAmount=parseInt(r.price*r.goodsNumber-o),this.goods.isCapitalGift||this.goods.isCapitalGiftLottery){if(!!this.$urlQueryObj.group_order_id)return this.setCouponInfosData("platformCoupons",a),void this.setupOrderCheckoutGoodsModule();r.goodsNumber=r.customerNum,r.currentOrderAmount=r.price*r.goodsNumber}if((r.eventType||0)===c.default.EventType.FREE_TRIAL)return this.setCouponInfosData("platformCoupons",a),void this.setupOrderCheckoutGoodsModule();(0,_.default)(y.default.mark(function e(){var o,a,s,r,n,d,u;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=t.couponsParams,a={group_id:o.groupId,sku_id:o.skuId,group_order_id:o.groupOrderId,sku_number:o.goodsNumber,current_order_amount:o.currentOrderAmount,goods_id:o.goodsId},s=v.default.platformCoupons+"?"+O.UrlUtil.buildQuery(a),e.next=6,O.Request.apiRequest("GET",s);case 6:r=e.sent,n=r.coupons||{},d={serverTime:r.server_time||0,enableCoupons:n.usable_coupons||[],disableCoupons:n.unusable_coupon_list||[],enableSuperpositionCoupons:n.usable_superposition_coupon_vo||{}},u=i.default.formatCouponsData(d,o),t.processPlatformCoupons(u),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),t.payBtnFlag=!1;case 17:case"end":return e.stop()}},e,this,[[0,13]])}))},processPlatformCoupons:function(e){if(e.errorCode)e&&e.errorMsg&&this.$showToast(e.errorMsg);else{var o=null,t=!1,a="";e.enableSuperpositionCoupons&&e.enableSuperpositionCoupons.maxAvailableNum>0&&(t=!0),t?(a="平台优惠券",o=e.enableSuperpositionCoupons.usable?e.enableSuperpositionCoupons:null):(a=this.goods.isVirtualGoods?"话费流量优惠券":"通用优惠券",e.enableCoupons&&e.enableCoupons.length>0&&(o=e.enableCoupons[0])),this.setCouponInfosData("platformCoupons",e),this.setData({couponTitle:a,selectedPlatformCoupon:o,hasPlatformCoupons:e.enableCoupons.length>0||e.disableCoupons.length>0,hasSuperpositionCoupons:t}),this.setPlatformCouponText()}},setPlatformCouponText:function(){var e="",o=(this.data.couponInfos||{}).platformCoupons||{},t=!!o.enableCoupons&&o.enableCoupons.length>0,a=o.enableCoupons.length>0||o.disableCoupons.length>0,s=o.enableSuperpositionCoupons||{},r=this.data.selectedPlatformCoupon,n=!0;this.data.hasSuperpositionCoupons&&r&&"101010"==r.couponId?(e="- "+r.selectedNum*r.discount+"元",n=!1):!this.data.hasSuperpositionCoupons||r||t?!t&&a?e=this.data.couponInfos&&this.data.couponInfos.platformCoupons&&"ORDER_AMOUNT_BELOW_LIMITATION"==this.data.couponInfos.platformCoupons.disableCoupons[0].disableReason?"满"+this.data.couponInfos.platformCoupons.disableCoupons[0].minAmount+"减"+this.data.couponInfos.platformCoupons.disableCoupons[0].discount:"无可用":(t||s&&s.usable)&&!r?e="不使用优惠券":r&&(e="- "+r.discount+"元",n=!1):e="每满50元可用最多5个红包",this.setupOrderCheckoutGoodsModule(),this.setData({platformCouponText:e,colorSpecail:n})},processAddressesInfo:function(e){if(e&&e.errorCode)return e&&e.errorMsg&&this.$showToast(e.errorMsg),void this.setData({showReqError:!0,loadingVisible:!1});e&&O.DataUtil.isArray(e)&&e.length>0&&this.setData({addressArray:e})},hideMallCouponsList:function(){var e=this;this.setData({"mallCouponsListData.mallMainClass":"mall-coupons-main mall-coupons-main-down"}),setTimeout(function(){e.setData({"mallCouponsListData.showMallCouponsList":!1})},250)},receiveCoupon:function(e){var o=parseInt(e.currentTarget.dataset.index,10);if(!this.couponTakeLock&&!isNaN(o)){var t=(this.data.mallCouponsListData.coupons||[])[o],a=this;if(t&&t.canReceived){this.couponTakeLock=!0;var s=t.startTimeForToast+"-"+t.endTimeForToast+"可用";this.setData({loadingVisible:!0}),(0,_.default)(y.default.mark(function e(){var o,r;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o={mall_id:t.mallId,batch_id:t.batchId},e.next=4,O.Request.apiRequest("POST",v.default.takeMerchantCoupon,o);case 4:r=e.sent,a.processTakeCoupon(r,t.batchId,s),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),a.processTakeCoupon(e.t0,t.batchId,s);case 12:case"end":return e.stop()}},e,this,[[0,8]])}))}}},processTakeCoupon:function(e,t,a){var s=this;if(this.couponTakeLock=!1,e.error_code){this.setData({loadingVisible:!1});var r=A[e.error_code];if(r){var n=r.split("，");n.length>1?this.showCouponsToast(n[0],n[1]):this.showCouponsToast(r)}else this.showCouponsToast(A.fail);(this.data.mallCouponsListData.coupons||[]).forEach(function(a,r){a.batchId==t&&(a.canReceived=!1,e.errorCode==m.default.CouponTakenOut.code&&(a.takenOut=!0,a.couponDisableText="已抢光"),s.setData(o({},"mallCouponsListData.coupons["+r+"]",a)))})}else this.setData({couponReceivedSucc:!0,loadingVisible:!1}),this.showCouponsToast(A.success,a),16!=this.data.eventType&&18!=this.data.eventType&&this.setupCoupons();var i=this.getTrackingParams("click","shop_coupon_tip","receive_coupon_btn");i.is_success=e.error_code?"0":"1",(0,O.TrackingRecord)(i)},showCouponsToast:function(e,o){if(e){var t=this;this.setData({"mallCouponToastData.mainToast":e,"mallCouponToastData.subToast":o||"","mallCouponToastData.single":!o,"mallCouponToastData.toastVisible":!0}),setTimeout(function(){t.setData({"mallCouponToastData.toastVisible":!1})},1500)}},selectMallCoupon:function(){this.setCouponListWindowData("myMallCouponsData",(this.data.mallInfo||{}).mallName||"",(this.data.couponInfos||{}).mallCoupons||{},!0,this.data.selectedMallCoupon,this.data.promotionEvents);var e=this.getTrackingParams("click",null,"shop_coupon");(0,O.TrackingRecord)(e)},hideCouponsList:function(){var e=this,o=this,t=o.data.couponInfos,a=t.platformCoupons&&t.platformCoupons.enableSuperpositionCoupons?t.platformCoupons.enableSuperpositionCoupons:{};a.showSuperEditBtn&&(a.showSuperEditBtn=!1,t.platformCoupons.enableSuperpositionCoupons=a,o.initSuperEditBtn()),this.setData({"myMallCouponsData.mainClass":"mall-coupons-main mall-coupons-main-down","myPlatformCouponsData.mainClass":"mall-coupons-main mall-coupons-main-down",couponInfos:t}),setTimeout(function(){e.setData({"myMallCouponsData.showCouponsList":!1,"myPlatformCouponsData.showCouponsList":!1})},250)},showMallCouponsList:function(){var e=this;this.hideCouponsList(),this.setData({"mallCouponsListData.showMallCouponsList":!0}),setTimeout(function(){e.setData({"mallCouponsListData.mallMainClass":"mall-coupons-main mall-coupons-main-up"})},100)},setFinalPayAmount:function(){this.payBtnFlag=!1;var e=void 0,o=0,t=0,a=0,s=this.data.selectedEventId,r=this.data.orderCheckoutGoodsData.notFormatTotalPrice||0,n=this.data.orderCheckoutGoodsData.mallDiscount;this.goods.freeCoupon&&this.goods.freeCoupon.length>0&&this.data.showFreeCoupon&&(o=(this.goods.freeCoupon[0]||{}).discount||0),this.goods.captainCoupon&&this.goods.captainCoupon.length>0&&(t=(this.goods.captainCoupon[0]||{}).discount||0);var i=this.data.selectedPlatformCoupon;i&&i.couponId&&(a="101010"==i.couponId?Math.round(100*i.discount*i.selectedNum):Math.round(100*i.discount));var d=o+t+a,u=O.StdFormat.price(d+n,100);e=O.StdFormat.price(r-d+100*this.data.freight,100),(this.goods.isCapitalGift||this.goods.isCapitalGiftLottery)&&(this.isCapitalOwner||(e=0)),this.setData({finalPayAmount:e,totalDiscountAmount:u,bottomBarVisible:!0,selectedEventId:s}),this.setBottomBarPayText()},clickMobileInput:function(){this.data.disableUserAction&&this.$showToast("订单已生成，信息不可更改")},clearPhoneNumber:function(){this.setData({phoneNumber:""})},selectPhoneNumber:function(e){var o=e.currentTarget.dataset?e.currentTarget.dataset.numberValue:"";this.setData({phoneNumber:o,hideNumberList:!0})}},o(t,"clearPhoneNumber",function(){this.setData({phoneNumber:""})}),o(t,"inputPhoneNumber",function(e){this.setData({phoneNumber:e.detail.value})}),o(t,"focusPhoneInput",function(){this.setData({isShowClearBtn:!0,hideNumberList:!1})}),o(t,"blurPhoneInput",function(){this.setData({isShowClearBtn:!1,hideNumberList:!0})}),o(t,"componentsSetDataFuncs",function(){var e=this,o=this;return{orderCheckoutAddress:function(e){var t=o.data.orderCheckoutAddressData||{};for(var a in e)t[a]=e[a];o.setData({orderCheckoutAddressData:t}),o.data.orderCheckoutAddressData&&o.data.orderCheckoutAddressData.addressInfo&&o.data.orderCheckoutAddressData.addressInfo.provinceId>0&&void 0!=o.data.orderCheckoutGoodsData.goodsNumber&&o.getPostageChange()},orderCheckoutGoods:function(t){var a={};for(var s in t)a["orderCheckoutGoodsData."+s]=t[s];o.setData(a),t.getPostage&&o.data.orderCheckoutAddressData&&o.data.orderCheckoutAddressData.addressInfo&&o.data.orderCheckoutAddressData.addressInfo.provinceId>0&&void 0!=o.data.orderCheckoutGoodsData.goodsNumber?o.getPostageChange():t.getPostage&&e.setFinalPayAmount()}}}),o(t,"componentsGetDataFuncs",function(){var e=this;return{orderCheckoutAddress:function(){return e.data.orderCheckoutAddressData},orderCheckoutGoods:function(){return e.data.orderCheckoutGoodsData}}}),o(t,"componentsAddRootFunc",function(e,o){e&&"function"==typeof o&&(this[e]=o)}),o(t,"onUnload",function(){D.default.isLastPagePayPage=!0,D.default.showUnpaidOrderDialog=!0,this.unregisterDispatchCallback(),C.default.close(this),this.countExpireInterval&&(clearInterval(this.countExpireInterval),this.countExpireInterval=null)}),o(t,"onHide",function(){C.default.close(this),this.countExpireInterval&&(clearInterval(this.countExpireInterval),this.countExpireInterval=null)}),o(t,"unregisterDispatchCallback",function(){E.Message.off(E.KEYS.ORDER_CHECKOUT_PAY)}),o(t,"loadData",function(){var e=this;(a=this.getOrderGoodsDetail({goodsId:this.data.goodsId,groupId:this.data.groupId}))&&R.push(a),(s=n.default.getAddressesInfo(function(o){e.processAddressesInfo(o)}))&&R.push(s)}),o(t,"getOrderGoodsDetail",function(e){var o=void 0,t=void 0,a=this;if(e&&(o=e.goodsId,t=e.groupId),o){var s=O.DataUtil.formatByPos(v.default.orderGoodsDetail,o);return t&&(s+="?"+O.UrlUtil.buildQuery({group_id:t})),(0,_.default)(y.default.mark(function e(){var o,t,r;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=O.Request.requestDataWithUrl("GET",s),e.next=4,O.Request.runMainRequestForPage(o,this);case 4:t=e.sent,r=S.default.formatData(t),a.processGoodsDetail(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}},e,this,[[0,9]])}))}return null}),o(t,"getSpecialCouponDiscount",function(e){return e=e||0,this.getSelectedSkuPrice()-e}),o(t,"onPullDownRefresh",function(){this.loadPage()}),o(t,"reLoad",function(){this.loadPage()}),o(t,"loadPage",function(){this.data.showReqError&&this.setData({showReqError:!1,loadingVisible:!0}),R=[],this.personalInfos=null,this.preLoadPage(),this.loadData()}),o(t,"checkRealNameValid",function(e){return/^[\u4e00-\u9fa5]{2,10}([.·]{0,1}[\u4e00-\u9fa5]+)*$/gi.test(e)}),o(t,"checkIdNumberValid",function(e){return!!e&&/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(e.toString())}),o(t,"validateIdCardInfo",function(){return this.checkRealNameValid(this.data.realName)&&this.checkIdNumberValid(this.data.idNumber)}),o(t,"submitIdCardInfo",function(e){var o=this,t=e.detail.value||{},a=t.realName||"",s=t.idNumber||"";if(a=a.replace(/\s+/g,""),s=s.replace(/\s+/g,"").toString().toUpperCase(),this.setData({realName:a,idNumber:s}),this.setIdCardInfo({realName:a,idNumber:s}),this.validateIdCardInfo()){this.setData({loadingVisible:!0});var r={id_card_name:this.data.realName,id_card_no:this.data.idNumber};O.Request.apiRequest("POST",v.default.submitIdCard,r).then(function(e){var t=o.nextStepIsPay;o.setData({loadingVisible:!1,hasIdInfo:!0}),o.hideIdCardPopup(),o.personalInfos.realName&&o.personalInfos.idNumber?o.$showToast("身份证信息修改成功"):o.$showToast("提交成功"),t&&o.pay()},function(e){o.setData({loadingVisible:!1}),o.$showToast(e.error_msg)})}else this.invalidIdCardInfoCount++,this.checkRealNameValid(this.data.realName)?this.checkIdNumberValid(this.data.idNumber)||this.$showToast("请输入正确的身份证号码",{showDuration:3e3}):this.$showToast("请输入正确的姓名",{showDuration:3e3}),3===this.invalidIdCardInfoCount&&this.$showToast("错误的身份信息将可能导致您的商品无法通关，请重新填写",{showDuration:3e3})}),o(t,"hideIdCardHint",function(){this.setData({idCardHintVisible:!1})}),o(t,"showIdCardHint",function(){this.setData({idCardHintVisible:!0})}),o(t,"onLoad",function(e){this.pvTracking();D.default.hasCreatedOrder=!1,D.default.lastOrderCheckoutOptions=e,e&&(e=O.UrlUtil.parseQuery(e),this.setData({goodsId:e.goods_id,groupId:e.group_id,groupNum:e.group_num,skuId:e.sku_id,goodsNumber:parseInt(e.goods_number||1,10),groupOrderId:e.group_order_id}),D.default.lastPayGoodsId=e.goods_id),this.loadPage()}),o(t,"modalFooterRightFunc",function(e){var o=this.$urlQueryObj.goods_id;o&&this.$forward("goods",{goods_id:o})}),o(t,"componentsAddRootFunc",function(e,o){e&&"function"==typeof o&&(this[e]=o)}),o(t,"addAddress",function(){this.loadEditAddressModule();var e=this.getTrackingParams("click","addresses","add_address");(0,O.TrackingRecord)(e)}),o(t,"wechatAddAddress",function(){function e(){wx.chooseAddress({success:function(e){if(null!=e.nationalCode&&null!=e.detailInfo&&null!=e.userName&&null!=e.telNumber){var t={national_code:e.nationalCode,address:e.detailInfo,name:e.userName,mobile:e.telNumber,is_default:0},a=v.default.weixinAddress;o.setData({loadingVisible:!0}),O.Request.apiRequest("POST",a,t).then(function(e){o.setData({loadingVisible:!1});var t=new b.default(e);o.updateAddress(t)},function(e){o.setData({loadingVisible:!1}),e.error_msg&&o.$showToast(e.error_msg)})}else o.$showToast("地址信息不完整，无法导入")}})}if(wx.chooseAddress){var o=this;(0,_.default)(y.default.mark(function o(){var t,a;return y.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=!1,o.next=3,O.User.authorize("scope.address",function(){(0,O.TrackingRecord)({op:"impr",page_section:"auth_prompt",refer_page_element:"wechat_add_address"}),t=!0});case 3:(a=o.sent)?e():O.User.showAuthorizeModelDialog("scope.address"),t&&(0,O.TrackingRecord)({op:"click",page_section:"auth_prompt",page_element:a?"approve":"rufuse",refer_page_element:"wechat_add_address"});case 6:case"end":return o.stop()}},o,this)}));var t=this.getTrackingParams("click","addresses","wechat_add_address");(0,O.TrackingRecord)(t)}else this.$showToast("您的版本暂不支持，请升级到更高版本~")}),o(t,"loadEditAddressModule",function(){this.setData({loadingVisible:!0});var e=this;n.default.fetchRegionsJsonData(function(){e.execAddressWindowLoad()})}),o(t,"updateAddress",function(e){e&&this.orderCheckoutAddressModule&&this.orderCheckoutAddressModule.updateOrderAddress(e)}),o(t,"execAddressWindowLoad",function(){var e=n.default.getRegions();if(e){var o=this;this.editAddressModule||(this.editAddressModule=new g.default);var t=k.default.getUserId()%10;(0,_.default)(y.default.mark(function a(){var s;return y.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==t){a.next=5;break}return a.next=3,O.User.authorize("scope.userLocation");case 3:s=a.sent,o.editAddressModule.hasLocationAuth=s;case 5:o.editAddressModule.load(null,function(){o.editAddressModule.show(),o.setData({loadingVisible:!1})},function(e){o.editAddressModule.hide(),o.updateAddress(e)},{setDataFunc:function(e){var t={};for(var a in e)t["addressData."+a]=e[a];o.setData(t)},getDataFunc:function(){return o.data.addressData},addRootFunc:O.Util.bind(o.componentsAddRootFunc,o),windowTitle:"新增地址",regionsDatas:e});case 7:case"end":return a.stop()}},a,this)}))}}),o(t,"selectPayType",function(e){var o=e.detail.target.dataset.name,t=this.data.payType;if("friendPay"==o){t.wechatPay=!1,t.friendPay=!0;var a=this.getTrackingParams("click",null,"friend_pay_btn");a.goods_number=this.data.orderCheckoutGoodsData.goodsNumber,a.coupon_usage=this.getCouponUsageForTrackingRecord(),a.goods_price=this.getSelectedSkuPrice(),a.sku_id=this.$urlQueryObj.sku_id,(0,O.TrackingRecord)(a)}else"wechatPay"==o&&(t.wechatPay=!0,t.friendPay=!1);this.setData({payType:t}),this.$uploadFormId(e,!1)}),o(t,"onShow",function(){if(this.countExpireInterval||this.countDownTimeSpike(),this.goToHelpPay)return D.default.hasPaySucess=!0,wx.navigateBack(),void(this.goToHelpPay=!1);var e=getCurrentPages(),o=e[e.length-1].__route__;o+="?"+O.UrlUtil.buildQuery(this.$urlQueryObj),C.default.init(this,!0,o,1),D.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()}),o(t,"pvTracking",function(){var e={op:"pv",page_name:"order_checkout",goods_id:this.$urlQueryObj.goods_id,group_id:this.$urlQueryObj.group_id,sku_id:this.$urlQueryObj.sku_id};(0,O.TrackingRecord)(e),this.$firstTimeTrackRecord.pv=!0}),o(t,"addressTracking",function(e){var o="addresses";"alt_add"===e&&(o="cancel_pay_prompt");var t=this.getTrackingParams("click",o,e);"alt_add"===e&&(t.page_el_sn=99120),(0,O.TrackingRecord)(t)}),o(t,"getTrackingParams",function(e,o,t){var a=this.goods||{};return{op:e,page_name:"order_checkout",page_section:o,page_element:t,goods_id:a.goodsId,event_type:a.eventType,group_id:this.data.groupId,goods_number:this.data.orderCheckoutGoodsData.goodsNumber,sku_id:this.data.skuId,order_sn:this.orderSn}}),o(t,"closePayWindow",function(e){this.dealPayWindow(!1);var o=this.getTrackingParams("click","cancel_pay_prompt","close_btn");o.page_el_sn=99121,(0,O.TrackingRecord)(o)}),o(t,"dealPayWindow",function(e){var o=this;if(e){if(!o.data.showPayWindow){var t=this.getTrackingParams("impr","cancel_pay_prompt",null);t.page_el_sn=99122,(0,O.TrackingRecord)(t)}o.setData({showPayWindow:e}),setTimeout(function(){o.setData({showPayContainer:e})},200)}else o.setData({showPayContainer:e}),setTimeout(function(){o.setData({showPayWindow:e})},200)}),t);(0,O.PddPage)(G,{pageName:"order_checkout",notUseCommonPV:!0}); 
 			}); 	require("pages/order_checkout/order_checkout.js");
 		__wxRoute = 'pages/addresses/addresses';__wxRouteBegin = true; 	define("pages/addresses/addresses.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var s=e(require("../../controller/addresses_controller")),d=e(require("../../common/data_util")),t=(e(require("../../constants/addresses")),e(require("../../components/edit_address/edit_address.js"))),a=(e(require("../../common/system_info")),e(require("../../common/url_util"))),r=e(require("../../common/navigation")),i=(e(require("../../components/toast/toast.js")),e(require("../../common/util"))),o=(e(require("../../storage/regions_storage")),e(require("../../storage/user_storage")),e(require("../../configs/api"))),n=e(require("../../common/request")),l=e(require("../../models/address")),u=require("../../common/index"),c=e(require("../../controller/formid_controller")),h=e(require("../../libs/co/we-index")),f=e(require("../../libs/regenerator-runtime/runtime")),A=require("../../common/message"),D={addressListData:null,allowedRegions:[],notAllowRegions:[],differAmountRegions:[],goodsId:null,skuId:null,usedAddressId:null,defaultAddressIndex:-1,oprationLocked:!1,editAddressModule:null,data:{visible:!1,loadingVisible:!0,showWechatChooseAddr:!!wx.chooseAddress,addressList:[],showUseBtn:!1,addressData:{editAddressWindowVisible:!1}},setDefaultAddress:function(e){var t=this,a=e.currentTarget.dataset,r=void 0;if(a&&null!=a.index&&(r=parseInt(e.currentTarget.dataset.index)),null!=r&&this.addressListData){var i=this.data.addressList[r];i&&d.default.checkIndexByKey(this.addressListData,i.addressId,"addressId")!==this.defaultAddressIndex&&(this.setData({loadingVisible:!0}),s.default.setDefaultAddress(i,function(e){if(t.setData({loadingVisible:!1}),e.errorCode){var s=e.errorMsg||"";t.$showToast(s)}else{i.isDefaultAddress=!0;var a=i.addressId;if(t.addressListData&&a){var r=d.default.checkIndexByKey(t.addressListData,a,"addressId");null!=r&&r!==t.defaultAddressIndex&&t.updateDefaultAddress(r)}}}))}},dispatchDataToOrderCheckoutAddress:function(){var e=this.data.addressList||[];A.Message.emit(A.KEYS.ORDERCHECKOUT_CHOOSE_ADDRESS,e)},dealWithChooseAddress:function(e){if(e&&this.usedAddressId&&!(["NOT_ALLOWED","DIFFER_AMOUNT"].indexOf(e.deliveryType)>=0)){for(var s=this.data.addressList,d=0;d<s.length;d++)s[d]&&(s[d].addressId==this.usedAddressId&&(s[d].isUsing=!1),s[d].addressId==e.addressId&&(s[d].isUsing=!0));this.usedAddressId=e.addressId,this.setData({addressList:s}),r.default.back()}},chooseAddress:function(e){if(e&&e.detail&&e.detail.formId)c.default.scene.common,e.detail.formId;var s;e&&e.currentTarget&&e.currentTarget.dataset&&(s=parseInt(e.currentTarget.dataset.index)),e&&e.detail&&e.detail.target&&(s=parseInt(e.detail.target.dataset.index)),s>=0&&s<this.data.addressList.length&&this.dealWithChooseAddress(this.data.addressList[s])},editAddress:function(e){var s=parseInt(e.currentTarget.dataset.index),d=this.data.addressList;s>=0&&s<d.length&&this.loadEditAddressModule(d[s],{windowTitle:"编辑地址"})},execDeleteAddress:function(){var e=this;if(null!=this.data.deleteItemIndex){var s=this.data.deleteItemIndex;if(!this.oprationLocked){this.oprationLocked=!0,this.setData({loadingVisible:!0});var d=this.data.addressList,t=null;if(d.length>1){var r=d[(s+1)%d.length];r&&(t=r.addressId)}var i=this.data.addressList[s],l=o.default.deleteAddress+"/"+i.addressId;i&&i.isDefaultAddress&&t&&(l+="?"+a.default.buildQuery({default_id:t})),n.default.apiRequest("POST",l).then(function(s){var s={defaultAddressId:s.default_id,deletedAddressId:i.addressId};e.processDeleteAddress(s)},function(s){var s={errorCode:s.error_code,errorMsg:s.error_msg};e.processDeleteAddress(s)})}}},deleteAddress:function(e){var s=this,d=parseInt(e.currentTarget.dataset.index);this.setData({deleteItemIndex:d}),this.$showModal({title:"",content:"确定要删除该地址吗？",cancelText:"取消",confirmText:"确定",success:function(e){e.confirm&&s.execDeleteAddress()}})},updateDefaultAddress:function(e){if(this.addressListData&&void 0!=e&&e>=0&&e<this.addressListData.length){if(this.defaultAddressIndex>=0){var s=this.addressListData[this.defaultAddressIndex];s&&(s.isDefaultAddress=!1)}var d=this.addressListData[e];if(d){d.isDefaultAddress=!0;var t=this.dealWithAddressesData(this.addressListData);this.setData({addressList:t})}}},processDeleteAddress:function(e){if(this.setData({loadingVisible:!1}),e.errorCode){var s=e.errorMsg||"";this.$showToast(s)}else{var t=e.defaultAddressId,a=e.deletedAddressId,r=d.default.checkIndexByKey(this.addressListData,t,"addressId");if(null!=r&&r!==this.defaultAddressIndex&&this.updateDefaultAddress(r),a){var i=d.default.checkIndexByKey(this.addressListData,a,"addressId");this.addressListData.splice(i,1),this.setData({addressList:this.dealWithAddressesData(this.addressListData)})}this.oprationLocked=!1}},loadEditAddressModule:function(e,d){var t=this;t.setData({loadingVisible:!0}),s.default.fetchRegionsJsonData(function(){t.execAddressWindowLoad(e,d)})},execAddressWindowLoad:function(e,a){var r=s.default.getRegions();if(r){var o=this;(0,h.default)(f.default.mark(function s(){var n,l;return f.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(o.editAddressModule||(o.editAddressModule=new t.default),"1"!==o.$urlQueryObj.allow_location){s.next=8;break}return n=!1,s.next=5,u.User.authorize("scope.userLocation",function(){(0,u.TrackingRecord)({op:"impr",page_section:"auth_prompt",refer_page_element:"add_address"}),n=!0});case 5:l=s.sent,o.editAddressModule.hasLocationAuth=l,n&&o.authorizedClickTracking(l,"add_address");case 8:o.editAddressModule.load(e,function(){o.editAddressModule.show(),o.setData({loadingVisible:!1})},function(e){if(o.editAddressModule.hide(),e)if(Object.keys(d.default.checkByKey(o.addressListData,e.addressId,"addressId")).length>0)try{var s=d.default.checkIndexByKey(o.addressListData,e.addressId,"addressId");o.addressListData[s]=e,o.setData({addressList:o.dealWithAddressesData(o.addressListData)})}catch(e){console.error(e)}else o.addressListData||(o.addressListData=[]),o.addressListData.push(e),o.setData({addressList:o.dealWithAddressesData(o.addressListData,{setDefaultTop:!0})}),o.dealWithChooseAddress(e)},{setDataFunc:function(e){var s={};for(var d in e)s["addressData."+d]=e[d];o.setData(s)},getDataFunc:function(){return o.data.addressData},addRootFunc:i.default.bind(o.componentsAddRootFunc,o),windowTitle:a.windowTitle,regionsDatas:r,data:o.data});case 10:case"end":return s.stop()}},s,this)}))}},commonAddAddress:function(e){this.loadEditAddressModule(null,{windowTitle:"添加收货新地址"}),(0,u.TrackingRecord)({op:"click",page_element:"add_address"})},authorizedClickTracking:function(e,s){(0,u.TrackingRecord)({op:"click",page_section:"auth_prompt",page_element:e?"approve":"rufuse",refer_page_element:s})},wechatAddAddress:function(){var e=this;if(this.data.showWechatChooseAddr){var s=function(){wx.chooseAddress({success:function(s){if(null!=s.nationalCode&&null!=s.detailInfo&&null!=s.userName&&null!=s.telNumber){var t={national_code:s.nationalCode,address:s.detailInfo,name:s.userName,mobile:s.telNumber,is_default:0},a=o.default.weixinAddress;e.setData({loadingVisible:!0}),n.default.apiRequest("POST",a,t).then(function(s){e.setData({loadingVisible:!1});var t=new l.default(s);e.addressListData||(e.addressListData=[]),d.default.isArray(e.addressListData)&&e.addressListData.push(t),e.setData({addressList:e.dealWithAddressesData(e.addressListData,{setDefaultTop:!0})}),e.dealWithChooseAddress(t)},function(s){e.setData({loadingVisible:!1}),e.$showToast(s.error_msg)})}else e.$showToast("地址信息不完整，无法导入")}})};(0,h.default)(f.default.mark(function d(){var t,a;return f.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return t=!1,d.next=3,u.User.authorize("scope.address",function(){(0,u.TrackingRecord)({op:"impr",page_section:"auth_prompt",refer_page_element:"wechat_add_address"}),t=!0});case 3:(a=d.sent)?s():u.User.showAuthorizeModelDialog("scope.address"),t&&e.authorizedClickTracking(a,"wechat_add_address");case 6:case"end":return d.stop()}},d,this)}))}else e.$showToast("您的版本暂不支持，请升级到更高版本~");(0,u.TrackingRecord)({op:"click",page_element:"wechat_add_address"})},dealWithAddressesData:function(e,s){var d=this,t=this;if(e.map(function(e,s){return e.isDefaultAddress?(d.defaultAddressIndex=s,e.defaultText="已设为默认"):e.defaultText="设为默认",e.isUsing=e.addressId.toString()==d.usedAddressId,t.setDeliveryType(e),e}),0!=this.defaultAddressIndex&&s&&s.setDefaultTop){var a=e[this.defaultAddressIndex];e[this.defaultAddressIndex]=e[0],e[0]=a,this.defaultAddressIndex=0}for(var r=1;r<e.length;r++)for(var i=r+1;i<e.length;i++)if(e[i].addressId>e[r].addressId){var o=e[i];e[i]=e[r],e[r]=o}return e},setDeliveryType:function(e){if(this.usedAddressId){var s=e.provinceId+"";this.notAllowRegions.indexOf(s)>=0?e.deliveryType="NOT_ALLOWED":this.differAmountRegions.indexOf(s)>=0?e.deliveryType="DIFFER_AMOUNT":this.allowedRegions.indexOf(s)>=0?e.deliveryType="SUPPORT_USE":e.deliveryType="NOT_ALLOWED"}},processAddressesInfo:function(e){if(wx.stopPullDownRefresh(),this.setData({loadingVisible:!1,visible:!0}),e.errorCode){var s=e.errorMsg||"";this.$showToast(s)}else e&&d.default.isArray(e)&&e.length>0&&(this.addressListData=this.dealWithAddressesData(e,{setDefaultTop:!0}),this.setData({addressList:this.addressListData}))},loadAddresses:function(){var e=this;s.default.getAddressesInfo(function(s){e.processAddressesInfo(s)})},dealWithUrlParams:function(){var e=this.$urlQueryObj||{};this.goodsId=e.goods_id,this.skuId=e.sku_id,this.usedAddressId=e.sel_address_id,this.usedAddressId&&(e.allowed_regions&&(this.allowedRegions=e.allowed_regions.split(",")),e.not_allow_region&&(this.notAllowRegions=e.not_allow_region.split(",")),e.differ_amount_regions&&(this.differAmountRegions=e.differ_amount_regions.split(","))),this.setData({showUseBtn:!!this.usedAddressId})},componentsAddRootFunc:function(e,s){e&&"function"==typeof s&&(this[e]=s)},loadPage:function(){this.addressListData=null,this.oprationLocked=!1,this.editAddressModule=null,this.dealWithUrlParams(),this.loadAddresses(),s.default.fetchRegionsJsonData()},onUnload:function(){this.dispatchDataToOrderCheckoutAddress()},onLoad:function(e){e=a.default.parseQuery(e),this.loadPage()}};(0,u.PddPage)(D,{pageName:"addresses"}); 
 			}); 	require("pages/addresses/addresses.js");
 		__wxRoute = 'pages/orders/orders';__wxRouteBegin = true; 	define("pages/orders/orders.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=require("../../common/index"),o=e(require("../../common/navigation")),s=e(require("../../controller/order_checkout")),n=e(require("../../common/order_utils")),d=e(require("../../constants/order")),i=e(require("../order_checkout/auto_create_group")),u=e(require("../../constants/goods")),l=e(require("./orders_manager_util")),c=e(require("../../configs/api")),_=e(require("../../models/format/grid_item_goods")),p=e(require("../../libs/co/we-index")),h=e(require("../../libs/regenerator-runtime/runtime")),g=e(require("../../components/segment/segment.js")),m=e(require("../../storage/ram_manager")),f=e(require("../../storage/user_storage")),b=(e(require("../../common/gotop_util")),e(require("../../controller/formid_controller"))),T=require("../../common/message"),D=+new Date("2015/11/05 00:00:00"),y=d.default.LotteryStatus,v=new Date("2015/11/05 00:00:00").getTime(),w=d.default.TabsConstants,I={requestLock:{},dispatchIds:{},segmentControl:null,data:{showMoreItemIndex:-1,ordersListData:w.map(function(e){return[]}),tabsData:w.map(function(e){return{label:e.label,type:e.type,url:e.url,page:1,size:10,canLoadMore:!0,loadingVisible:!0,loadingMoreVisible:!1,scrollTop:0,showNetError:!1,goTopClass:!1,extendModalInfo:{}}}),$tabsData:w.map(function(e){return{title:e.label}}),curSwiperItem:0,curTabIndex:0,canShowModal:!1,scrollViewWidth:a.SystemInfo.getWindowWidthSync(),scrollViewHeight:0,userHandleLock:!1,params:{offset:0,size:20},flag:!0,dataList:[],listLoading:!1,showSwiperAnimation:!1},onReady:function(){this.setData({scrollViewHeight:a.SystemInfo.getWindowHeightSync()-40})},onPullDownRefresh:function(){wx.stopPullDownRefresh&&wx.stopPullDownRefresh()},scrollBottom:function(){if(this.data.flag){var e={};e.size=this.data.params.size,e.offset=this.data.params.offset+e.size,80===e.offset&&this.setData({listLoading:!1}),this.setData({params:e,flag:!1}),this.getDataList()}},gotoGoodsDetail:function(e){var t=e.currentTarget.dataset.goodsItem;this.transGoodsData=t;var r="/pages/goods/goods?"+a.UrlUtil.buildQuery({goods_id:t.goodsId});o.default.forward(r)},getDataList:function(){var e=this,t=this,r=this.data.params.offset,o=this.data.params.size;if(!(r>=100)){var s="recommendation/express?";s+=a.UrlUtil.buildQuery({offset:r,count:o});var n=a.Request.requestDataWithUrl("GET",s);a.Request.runSecondaryRequestForPage(n,this).then(function(o){if(0===r&&e.setData({listLoading:!0}),o.list&&o.list.length>0){var s=o.list.map(function(e,t){return e=_.default.formatData(e)}),n=t.data.dataList.concat(s);n=a.DataUtil.objectArrayDuplicateRemove(n,"goodsId",function(e){return 1==e.isApp}),e.setData({dataList:n,flag:!0})}else e.setData({flag:!1})},function(e){})}},refreshTabOrders:function(e){var r;this.setData((r={},t(r,"tabsData["+e+"].page",1),t(r,"tabsData["+e+"].canLoadMore",!0),t(r,"tabsData["+e+"].loadingVisible",!0),t(r,"tabsData["+e+"].loadingMoreVisible",!1),t(r,"ordersListData["+e+"]",[]),r)),this.loadOrdersList(e)},showMore:function(e){this.data.ordersListData;var r,a=this.data.curTabIndex,o=e.currentTarget.dataset,s=parseInt(o.index,10);this.setData((r={showMoreItemIndex:s},t(r,"ordersListData["+a+"]["+s+"].canShowMore",!0),t(r,"canShowModal",!0),r))},hideMore:function(e){var r,a=this.data.showMoreItemIndex,o=this.data.curTabIndex;this.setData((r={},t(r,"ordersListData["+o+"]["+a+"].canShowMore",!1),t(r,"canShowModal",!1),t(r,"showMoreItemIndex",-1),r))},localManageOrders:function(e){var t=e.orderSn,r=void 0,a=void 0,o=void 0;switch(e.behavior){case"ORDER_CANCELED":r=1,a=this.data.tabsData[r]||{},o=this.isLastThreeOrderInManager(t,w[r].type),this.removeOrderInManager(t,w[r].type),this.reRenderList([w[1].type,w[0].type]),this.updateDeleteOrder({orderSn:t,managerType:w[this.data.curTabIndex].type,tabIndex:this.data.curTabIndex}),this.refreshTabOrders(0),o&&a.canLoadMore&&this.loadOrdersList(r);break;case"ORDER_RECEIVED":r=4,a=this.data.tabsData[r]||{},o=this.isLastThreeOrderInManager(t,w[r].type),this.removeOrderInManager(t,w[r].type),this.updateOrderStatus({orderSn:t,managerType:w[0].type,combinedStatus:d.default.OrderCombinedStatus.Received}),this.reRenderList([w[4].type,w[0].type]),this.refreshTabOrders(5),this.refreshTabOrders(0),o&&a.canLoadMore&&this.loadOrdersList(r);break;case"ORDER_PAY":this.refreshTabOrders(0),this.refreshTabOrders(1),this.refreshTabOrders(2),this.refreshTabOrders(3);break;case"ORDER_COMMENT":this.refreshTabOrders(0),this.refreshTabOrders(5);break;case"ORDER_ADDITIONAL_COMMENT":this.refreshTabOrders(0);break;case"ORDER_EXTEND":this.updateExtendOrder({orderSn:t,managerType:w[this.data.curTabIndex].type,tabIndex:this.data.curTabIndex});break;case"ORDER_DELETE":r=0,a=this.data.tabsData[r]||{},this.isLastThreeOrderInManager(t,w[r].type)&&a.canLoadMore&&this.loadOrdersList(r),this.removeOrderInManager(t,w[this.data.curTabIndex].type),this.reRenderList([w[this.data.curTabIndex].type,w[0].type]),o&&a.canLoadMore&&this.loadOrdersList(r)}},removeOrderInManager:function(e,t){null!=e&&null!=t&&l.default.getManagerWithType(this.ordersListManagerId,t).removeItemByKey(e)},isLastThreeOrderInManager:function(e,t){return null!=e&&null!=t&&l.default.getManagerWithType(this.ordersListManagerId,t).isLastThreeItemByKey(e)},updateDeleteOrder:function(e){var r=e=e||{},a=r.orderSn,o=r.managerType,s=r.tabIndex;if(null!=a&&null!=o){var n=l.default.getManagerWithType(this.ordersListManagerId,o);if(n){var d=n.getDataKeyIndexMap()[a];if(null!=d){this.data.ordersListData;this.setData(t({},"ordersListData["+s+"]["+d+"].can_delete_order",1))}}0!=s&&this.updateDeleteOrder({orderSn:a,managerType:w[0].type,tabIndex:0})}},updateExtendOrder:function(e){var r=e=e||{},a=r.orderSn,o=r.managerType,s=r.tabIndex;if(null!=a&&null!=o){var n=l.default.getManagerWithType(this.ordersListManagerId,o);if(n){var d=n.getDataKeyIndexMap()[a];if(null!=d){var i;this.data.ordersListData;this.setData((i={},t(i,"ordersListData["+s+"]["+d+"].order_extention.extention_time",Date.parse(new Date)/1e3),t(i,"ordersListData["+s+"]["+d+"].can_extend_receive.hasExtended",!0),i))}}0!=s&&this.updateExtendOrder({orderSn:a,managerType:w[0].type,tabIndex:0})}},updateOrderStatus:function(e){var r=e=e||{},a=r.orderSn,o=r.managerType,s=r.combinedStatus;if(null!=a&&null!=o&&null!=s){var i=l.default.getManagerWithType(this.ordersListManagerId,o);if(i){var u,c=void 0,_=i.getDataKeyIndexMap()[a];if(null!=_&&(c=i.getDataList()[_]),!c)return;var p=c.lucky_status;null!=p&&(p=parseInt(p,10));var h=1==c.lucky_result,g=c.order_goods[0].goods.event_type,m=c.order_amount,f=n.default.getOrderCombinedStatusDescription(s,p,h,null,g,m),b=(u={},t(u,"order_combined_status",s),t(u,"order_status_desc",f),u);s==d.default.OrderCombinedStatus.Received&&(b.rate_status=d.default.rateStatus.rateEnable,b.comment_status=d.default.CommentStatus.NoComment),i.updateOrderInfo(a,b)}}},reRenderList:function(e){var t=this;"object"!==(void 0===e?"undefined":r(e))&&(e=[]);var a={};e.forEach(function(e){var r=l.default.getManagerWithType(t.ordersListManagerId,e),o=t.getTabIndexByType(e);a["ordersListData["+o+"]"]=r.getDataList()||[]}),this.setData(a)},loadOrdersList:function(e,r){var o=this;if(this.ordersListManagerId||(this.ordersListManagerId="orders-"+a.DataUtil.getLogId(),l.default.createOrdersManager(this.ordersListManagerId,w)),!((e=e||0)<0||e>=w.length)){var s=this.data.tabsData[e],n=a.DataUtil.formatByPos(c.default.ordersv2,s.url,r?1:s.page,s.size),d=[s.url,s.page,s.size].join("#");if(!this.requestLock[d]){this.requestLock[d]=!0;var i=a.Request.requestDataWithUrl("GET",n);a.Request.runMainRequestForPage(i,this).then(function(a){var n;o.requestLock[d]=!1,r&&(s.page=1),wx.stopPullDownRefresh&&wx.stopPullDownRefresh();var i=o.formatOrdersData(a)||[];i=i.filter(function(e){return 1e3*e.order_time>D});var u=w[e].type,c=l.default.getManagerWithType(o.ordersListManagerId,u);1===s.page&&c.removeAllDatas(),i.forEach(function(e){c.pushDataItem(e)});var _=o.data.tabsData;o.setData((n={},t(n,"tabsData["+e+"].page",_[e].page+1),t(n,"tabsData["+e+"].canLoadMore",i.length>Math.floor(5)),t(n,"tabsData["+e+"].loadingVisible",!1),t(n,"tabsData["+e+"].loadingMoreVisible",!0),t(n,"tabsData["+e+"].showNetError",!1),t(n,"ordersListData["+e+"]",c.getDataList()),n))},function(r){if(o.requestLock[d]=!1,o.$showToast(r.error_msg),1===o.data.tabsData[e].page){var a;o.setData((a={},t(a,"tabsData["+e+"].loadingVisible",!1),t(a,"tabsData["+e+"].loadingMoreVisible",!1),t(a,"tabsData["+e+"].showNetError",!0),a))}})}}},reloadTabIfError:function(){var e,r=this.data.curTabIndex;this.setData((e={},t(e,"tabsData["+r+"].loadingVisible",!0),t(e,"tabsData["+r+"].loadingMoreVisible",!1),t(e,"tabsData["+r+"].showNetError",!1),e)),this.loadPage(r)},reloadButtonAction:function(){this.goTop(),wx.startPullDownRefresh&&wx.startPullDownRefresh(),this.loadOrdersList(this.data.curTabIndex,!0)},loadPage:function(e){var t={tabsData:this.data.$tabsData};this.segmentControl=new g.default(t,this);var r=0;if(e=parseInt(e,10),isNaN(e)){var a=this.$urlQueryObj||{},o=parseInt(a.type,10);w.forEach(function(e,t){e.type===o&&(r=t)})}else r=e;this.changeCurTab(r,{shouldChangeSwiper:!0}),this.getDataList()},getTabIndexByType:function(e){var t=null;return e=parseInt(e,10),w.forEach(function(r,a){r.type===e&&(t=a)}),t},orderListScroll:function(e){var t=parseInt(e.detail.scrollTop,10);this.showGoTopBtn(t)},onClickTopTips:function(e){a.Util.toWeb({page_name:"qa_detail",id:89},this),(0,a.TrackingRecord)({op:"click",page_name:"my_order",page_section:"order_list",page_element:"no_order"})},showGoTopBtn:function(e){var r=this.data.curTabIndex,a=this.data.tabsData[r],o=this.data.scrollViewHeight;o&&(e>o?!1===a.goTopClass&&this.setData(t({},"tabsData["+r+"].goTopClass",!0)):!0===a.goTopClass&&this.setData(t({},"tabsData["+r+"].goTopClass",!1)))},onLoad:function(e){T.Message.on(T.KEYS.LOCAL_MANAGE_ORDERS,a.Util.bind(this.localManageOrders,this)),this.loadPage()},gotoMallPage:function(e){var t=e.currentTarget.dataset.mallId;this.$forward("mall_page",{mall_id:t}),(0,a.TrackingRecord)({op:"click",page_name:"my_order",page_section:"order_list",page_element:"shop_link_btn",mall_id:t})},goTop:function(e){var r=this.data.curTabIndex||0;this.setData(t({},"tabsData["+r+"].scrollTop",1)),this.setData(t({},"tabsData["+r+"].scrollTop",0))},unregisterDispatch:function(){T.Message.off(T.KEYS.LOCAL_MANAGE_ORDERS)},onUnload:function(){this.unregisterDispatch(),l.default.removeOrdersManager(this.ordersListManagerId)},onShow:function(){},scrollToLower:function(){var e=this.data.curTabIndex;if((this.data.tabsData[e]||{}).canLoadMore&&this.loadOrdersList(e),!this.data.ordersListData[e]||0===this.data.ordersListData[e].length){if(!this.data.flag)return;var t={};t.size=this.data.params.size,t.offset=this.data.params.offset+t.size,80===t.offset&&this.setData({listLoading:!1}),this.setData({params:t,flag:!1}),this.getDataList()}},swiperChange:function(e){var t=parseInt(e.detail.current,10);isNaN(t)||(this.segmentControl.updateSelectIndex(t),this.changeCurTab(parseInt(t,10)))},didClickSegmentTab:function(e){var t=e.currentTarget.dataset,r=parseInt(t.index,10);this.changeCurTab(r,{shouldChangeSwiper:!0});var o=["all","unpaid","grouping","unshipping","unreceived","unrated"];(0,a.TrackingRecord)({op:"click",event:"tab_clk",page_name:"my_order",page_section:"tab_list",page_element:o[r]})},changeCurTab:function(e,t){function r(e){e>=0&&e<w.length&&1===s[e].page&&o.loadOrdersList(e)}var o=this;t=t||{};var s=this.data.tabsData,n={curTabIndex:e,showSwiperAnimation:o.data.showSwiperAnimation};t.shouldChangeSwiper&&(n.curSwiperItem=e),n=a.ObjectUtil.assign(n,this.segmentControl.$data()),this.setData(n),r(e),r(e-1),r(e+1),o.data.showSwiperAnimation=!0},getCurrentTab:function(){return this.data.tabsData[this.data.curTabIndex]},showOrderDetails:function(e){var t=e.currentTarget.dataset.orderSn,r=this.getCurrentTab().type;this.orderSn=t,this.$forward("order",{ordersn:t,type:r})},formatOrdersData:function(e,t){var r=this,o=[],s=e.orders,i=e.server_time||e.timestamp||parseInt(Date.now()/1e3,10);return s.forEach(function(e){var t=e.order_status,s=e.pay_status,l=e.shipping_status,c=(((e.order_goods||[])[0]||{}).lucky_draw||{}).status;null!=c&&(c=parseInt(c,10));var _=null,p=e.order_goods;if(null!=p&&p.length>0&&(_=p[0]),null!=_){var h=_.lucky_draw,g=e.lucky_draw_result;e.rate_status=e.rate_status||"0",e.shipping_name=(e.shipping||{}).shipping_name||"",e.shipping_number=e.tracking_number,e.used_coupons=parseInt(_.goods_price)*parseInt(_.goods_number||"1")>parseInt(e.order_amount),e.order_amount=a.StdFormat.price(e.order_amount,100),e.shipping_amount=a.StdFormat.price(e.shipping_amount,100),e.goods_price=a.StdFormat.price(_.goods_price,100),e.spec=_.spec||"",e.goods_number=_.goods_number||"1",e.isPreSale=_.goods_name.indexOf("预售")>=0;var m=0;_.goods&&_.goods.event_type&&(m=parseInt(_.goods.event_type,10),e.isCapitalGift=m===d.default.EVENT_TYPE.CAPITAL_GIFT,e.isCapitalGiftLottery=m===d.default.EVENT_TYPE.CAPITAL_GIFT_LOTTERY,[d.default.EVENT_TYPE.LUCKY_DRAW,d.default.EVENT_TYPE.FREE_TRIAL,d.default.EVENT_TYPE.CAPITAL_GIFT_LOTTERY].indexOf(m)<0&&(h=null,g=null));var f=n.default.getOrderCombinedStatus(t,s,l,c,{eventType:m});if(e.order_combined_status=f,e.order_status_desc=n.default.getOrderCombinedStatusDescription(f,null,null,e.rate_status),e.goods_type=_.goods&&_.goods.goods_type,e.coupons=e.coupons||[],e.order_time=e.order_time||0,e.show=(parseFloat(e.goods_price)>.09||1e3*e.order_time-v>0)&&!0,e.lucky_status=null!=h?parseInt(h.status,10):null,e.lucky_result=null!=g?g.status||"":null,f==d.default.OrderCombinedStatus.Unconfirmed&&0==e.order_amount&&i-e.order_time>=86400&&(e.order_status_desc=n.default.getOrderCombinedStatusDescription(d.default.OrderCombinedStatus.Expired)),e.orderLotteryClass="",1==e.order_status&&null!=e.lucky_status){var b=c==y.Complete,T=1==e.lucky_result;b?b&&!T?e.orderLotteryClass="order-lottery-not":b&&T&&(e.orderLotteryClass="order-lottery-lucky"):e.orderLotteryClass="orders-lottery-wait",e.lotteryStatus=c,e.winLottery=T,e.luckyID=h.lucky_id||h.id,e.showLuckyDrawResult=b&&!T,e.order_status_desc=n.default.getOrderCombinedStatusDescription(f,c,T,e.rate_status)}f==d.default.OrderCombinedStatus.Shipping&&(e.can_extend_receive=function(){if(e.hasOwnProperty("expect_auto_receive_time"))var t=(a=parseInt(e.expect_auto_receive_time))-259200;else{var r=1036800;[d.default.GoodsType.OVERSEAS_TRANSSHIP,d.default.GoodsType.OVERSEAS_DM].indexOf(_.goods.goodsType)>=0?r=2332800:3119==_.cat_id_2&&(r=3196800);var a=(t=parseInt(e.shipping_time)+r)+259200}var o=(e.order_extention||{}).extention_time||"0";return{time:t<i&&i<a,hasExtended:"0"!=o}}()),e.group_order&&e.group_order.wait_join_num&&"拼团中"===e.order_status_desc&&(e.order_status_desc="拼团中，差"+e.group_order.wait_join_num.toString()+"人"),e.depositeShipping=l==d.default.ShipmentStatus.Shipping,e.depositeReceived=l==d.default.ShipmentStatus.Received,e.isVirtualGoods=[u.default.GoodsType.MOBILE_DATA,u.default.GoodsType.MOBILE_FARE].indexOf(parseInt(e.order_goods[0].goods.goods_type,10))>=0,e.canShowMore=!1,e.showButtons=r.showButtons(e,i),e.showAllBtn=r.showAllBtn(e);var D=e.order_goods[0].goods;a.FilterUtil.filter(D.event_type,D.goods_type)?o.push(e):o.push(!1)}}),o},showButtons:function(e,t){e.canShowPay=0==e.order_combined_status,e.canShowCancel=0==e.order_combined_status,e.canShowConfirm=3==e.order_combined_status,e.canShowGrouping=1==e.order_combined_status,e.canShowComment=4==e.order_combined_status&&1==e.rate_status&&0==e.comment_status,3==e.order_combined_status||e.depositeShipping||4==e.order_combined_status||e.depositeReceived?e.canShowAgain=(4==e.order_combined_status||e.depositeReceived)&&!e.showLuckyDrawResult&&!e.is_lucky&&7!=e.order_combined_status:e.canShowAgain=-1==[0,3,4,1].indexOf(e.order_combined_status)&&!e.showLuckyDrawResult&&!e.is_lucky&&7!=e.order_combined_status,e.canShowAdditionaComment=4==e.order_combined_status&&0==e.rate_status&&1==e.comment_status,e.canShowExpress=7!=e.goods_type&&(4==e.order_combined_status||3==e.order_combined_status)&&!e.isVirtualGoods&&t-parseInt(e.shipping_time,10)<15552e3,e.canShowExtend=3==e.order_combined_status,e.canShowDelBtn=1==e.can_delete_order;for(var r=[{show:e.canShowPay,name:"go-pay"},{show:e.canShowCancel,name:"cancel"},{show:e.canShowConfirm,name:"confirm-shipment"},{show:e.canShowGrouping,name:"btn-grouping"},{show:e.canShowComment,name:"comment"},{show:e.canShowAgain,name:"again"},{show:e.canShowAdditionaComment,name:"additional-comment"},{show:e.canShowExpress,name:"shipping"},{show:e.canShowExtend,name:"extend"},{show:e.showLuckyDrawResult,name:"btn-lucky-draw-result"},{show:e.canShowDelBtn,name:"delete"}],a=[],o=0;o<r.length;++o)r[o].show&&a.push(r[o].name);return a},showAllBtn:function(e){return!!e.showLuckyDrawResult||(0==e.order_combined_status||2==e.order_combined_status||3==e.order_combined_status||e.depositeShipping||4==e.order_combined_status||e.depositeReceived||1==e.order_combined_status||e.showLuckyDrawResult||e.order_combined_status>4&&!e.showLuckyDrawResult&&!e.is_lucky||e.can_delete_order)},initCreateOrderParams:function(e){var t={skuId:e.order_goods[0].sku_id,groupId:e.group_id,goodsName:e.order_goods[0].goods_name,skuNumber:e.goods_number,mallCouponId:"",platformCouponId:""};return t.finalPrice=e.order_amount,e.isVirtualGoods=[u.default.GoodsType.MOBILE_DATA,u.default.GoodsType.MOBILE_FARE].indexOf(parseInt(e.order_goods[0].goods.goods_type,10))>=0,e.isVirtualGoods&&(t.phoneNumber=e.charge_mobile),e.group_order_id&&(t.groupOrderId=e.group_order_id),e.freeCoupon&&e.freeCoupon.couponId&&(t.groupFreeCoupon=e.freeCoupon),e.captainCoupon&&e.captainCoupon.couponId&&(t.groupCaptainCoupon=e.captainCoupon),t.addressId=e.isVirtualGoods?"0":e.address_id,t},processPay:function(e){var t=this,r="";if(e&&e.orderSn&&(r=e.orderSn),T.Message.emit(T.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_PAY"}),e.errorCode){var a=e.errorMsg;a&&(a="支付未完成，请重新支付",this.$showToast(a,{hideToastFunc:function(){r&&t.$redirect("order",{ordersn:r})}}))}else;},getGroupOrderDetail:p.default.wrap(h.default.mark(function e(t,r){var o,s,n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=a.DataUtil.formatByPos(c.default.groupOrder,t),s=a.Request.requestDataWithUrl("GET",o),e.next=5,a.Request.runMainRequestForPage(s,r);case 5:return n=e.sent,e.abrupt("return",n);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}},e,this,[[0,9]])})),goPayOrder:function(e){var t=this,r=e.currentTarget.dataset,o=r.order,n=r.orderSn,d=(r.goodsName,o.order_goods[0]);this.data.userHandleLock||(this.setData({userHandleLock:!0}),a.Payment.pay(n,function(e){var r=o.group_order_id;(0,p.default)(h.default.mark(function e(){var s,i,u,l;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getGroupOrderDetail(r,t);case 3:s=e.sent,i=s.leader_order_info.uid,u=f.default.getUserId(),l={op:"event",event:0!=d.is_pre_sale?"prepay_order":"pay_order",page_name:"order",refer_page_section:"paid_popup",group_order_id:o.group_order_id,Is_group_owner:i==u?1:0,order_sn:n,order_amount:parseInt(100*o.order_amount,10),goods_id:d.goods_id,goods_type:d.goods_type,goods_number:d.goods_number,mall_id:o.mall_id,tag:"pdd_order",lucky_status:o.is_lucky?1:0,shipping_amount:100*o.shipping_amount,discount_amount:100*o.discount_amount,group_num:o.group_order?o.group_order.customer_num:""},s&&s.group_order_info&&void 0!==s.group_order_info.group_status&&(l.group_status=s.group_order_info.group_status),l.sub_op=l.event,d.goods&&d.goods.event_type?l.event_type=d.goods.event_type:l.event_type="0",m.default.isReadBigSales&&(l.refer_xcx_campaign_d12=1),(0,a.TrackingRecord)(l),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])})),t.setData({userHandleLock:!1}),T.Message.emit(T.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_PAY"});var s=c.default.orderPayCheck+"?order_sn="+n;a.Request.apiRequest("GET",s)},function(e){if(t.setData({userHandleLock:!1}),e.errorCode+""=="42001"){var r=t.initCreateOrderParams(o),u={goodsId:d.goods_id,createOrderParams:r,orderSn:n,eventType:d.goods.event_type,notFormatPrice:d.goods_price,goodsNumber:o.goods_number||1,groupId:o.group_id,skuId:d.sku_id,sourceMallId:o.mall.id,goodsType:d.goods_type};r&&i.default.createGroup(u,function(e){e.groupOrderId=null,e.eventType=d.goods.event_type,e.goodsType=d.goods_type,t.createOrderParams=e,T.Message.on(T.KEYS.AUTO_CREATE_ORDER_CHECKOUT_PAY,a.Util.bind(t.processPay,t)),s.default.createOrder(e,T.KEYS.AUTO_CREATE_ORDER_CHECKOUT_PAY)},function(){t.setData({userHandleLock:!1})})}else t.$showToast(e.errorMsg)},function(e){t.setData({userHandleLock:!1})}),this.uploadFormId(e.detail.formId,"orders_pay_clk"),(0,a.TrackingRecord)({op:"click",event:"pay_btn_clk",page_name:"my_order",page_section:"order_list",page_element:"pay_btn"}))},bottomTapTrackingRecord:function(e){(0,a.TrackingRecord)({op:"click",page_name:"my_order",page_section:"order_list",page_element:e})},cancelOrder:function(e){var t=this;if(!this.data.userHandleLock){this.setData({userHandleLock:!0});var r=e.target.dataset.orderSn,o="order/"+r+"/cancel";this.$showModal({title:"确定取消订单？",cancelText:"取消",confirmText:"确定",success:function(e){if(e.confirm){var s=a.Request.requestDataWithUrl("POST",o);a.Request.runMainRequestForPage(s,t).then(function(e){t.$showToast("订单取消成功"),T.Message.emit(T.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_CANCELED",orderSn:r}),t.setData({userHandleLock:!1})},function(e){t.$showToast(e.error_msg),t.setData({userHandleLock:!1})})}else t.setData({userHandleLock:!1})}}),this.uploadFormId(e.detail.formId,"orders_other_clk"),this.bottomTapTrackingRecord("cancel_order")}},uploadFormId:function(e,t){e&&t&&b.default.uploadFormIdToSH(e,!1)},confirmShipment:function(e){var t=this,r=e.currentTarget.dataset.orderSn,o="order/"+r+"/received";this.data.userHandleLock||(this.setData({userHandleLock:!0}),this.$showModal({title:"是否确认收货？",cancelText:"取消",confirmText:"确认",success:function(s){if(s.confirm){var n=a.Request.requestDataWithUrl("POST",o);a.Request.runMainRequestForPage(n,t).then(function(a){t.setData({userHandleLock:!1}),T.Message.emit(T.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_RECEIVED",orderSn:r}),t.toComments(e)},function(e){e.error_code&&t.$showToast(e.error_msg),t.setData({userHandleLock:!1})})}else t.setData({userHandleLock:!1})}}),this.uploadFormId(e.detail.formId,"orders_other_clk"),this.bottomTapTrackingRecord("confirm_received"))},extendReception:function(e){var t=this,r=e.currentTarget.dataset,a=(r.order.order_sn,parseInt(r.index,10)),o=this.data.ordersListData[this.data.curTabIndex][a];if(1==o.can_extend_receive.hasExtended)t.$showToast("每笔订单只能延长一次哦~");else if(0==r.order.can_extend_receive.time)t.$showToast("亲，距离结束时间3天才可以申请哦~");else{if(t.data.userHandleLock)return;t.setData({userHandleLock:!0}),t.$showModal({content:"亲，确认延长收货订单？（每笔订单只能延长一次哦~）",success:function(e){e.confirm&&t.onExtendModalConfirm(),t.setData({userHandleLock:!1})}}),t.setData({extendModalInfo:o})}this.uploadFormId(e.detail.formId,"orders_other_clk"),this.bottomTapTrackingRecord("extend_received")},onExtendModalConfirm:function(){var e=this,t=e.data.extendModalInfo.order_sn,r="order/"+t+"/extention",o=a.Request.requestDataWithUrl("POST",r);a.Request.runMainRequestForPage(o,e).then(function(r){e.setData({userHandleLock:!1}),e.$showToast("延长收货成功!"),T.Message.emit(T.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_EXTEND",orderSn:t})},function(t){e.setData({userHandleLock:!1}),e.$showToast("延长收货失败!")})},toComments:function(e){var t=e.currentTarget.dataset.order;this.$forward("comments",{order_sn:t.order_sn,goods_id:t.order_goods[0].goods_id,thumb_url:t.order_goods[0].thumb_url,type:this.getCurrentTab().type,goods_name:t.order_goods[0].goods_name}),this.uploadFormId(e.detail.formId,"orders_other_clk"),this.bottomTapTrackingRecord("go_rating")},additionalComment:function(e){var t=e.currentTarget.dataset.order;this.$forward("comments",{order_sn:t.order_sn,goods_id:t.order_goods[0].goods_id,thumb_url:t.order_goods[0].thumb_url,goods_name:t.order_goods[0].goods_name,isAdditionalComments:!0}),this.uploadFormId(e.detail.formId,"orders_other_clk"),this.bottomTapTrackingRecord("reevaluate")},showGoodsDetails:function(e){var t=e.currentTarget.dataset.goodsId;null==t||t.length<=0||(this.$forward("goods",{goods_id:t}),this.uploadFormId(e.detail.formId,"orders_buy_again_clk"),this.bottomTapTrackingRecord("buy_again"))},removeOrders:function(e){var t=this,r=e.currentTarget.dataset.item.order_sn,o="order/"+r+"/delete";this.data.userHandleLock||(this.setData({userHandleLock:!0}),this.$showModal({title:"确认删除订单？",content:"删除之后订单无法恢复，我的拼团、我的抽奖中相关记录也将同步删除",cancelText:"取消",confirmText:"确定",success:function(e){if(e.confirm){var s=a.Request.requestDataWithUrl("POST",o);a.Request.runMainRequestForPage(s,t).then(function(e){t.setData({userHandleLock:!1}),t.$showToast("删除订单成功"),T.Message.emit(T.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_DELETE",orderSn:r})},function(e){t.setData({userHandleLock:!1}),t.$showToast("删除订单失败")})}t.setData({userHandleLock:!1})}}),this.uploadFormId(e.detail.formId,"orders_other_clk"),this.bottomTapTrackingRecord("del_btn"))},forwardExpress:function(e){var t=e.currentTarget.dataset.item,r={order_sn:t.order_sn,goods_id:t.order_goods[0].goods_id,shipping_name:t.shipping_name,tracking_number:t.tracking_number,shipping_id:t.shipping_id,thumb_url:t.order_goods[0].thumb_url,mall_id:t.mall_id||(t.mall?t.mall.id:"")};this.$forward("goods_express",r),this.uploadFormId(e.detail.formId,"orders_other_clk"),this.bottomTapTrackingRecord("view_received")},showGroupDetails:function(e){var t=e.currentTarget.dataset,r=t.groupOrderId,a=t.goGroupOrderId,o=r;a&&(o=o||a),this.$forward("group",{group_order_id:o}),this.uploadFormId(e.detail.formId,"orders_other_clk"),this.bottomTapTrackingRecord("invite_grouping")},toWinDetail:function(e){var t=e.currentTarget.dataset.item,r="/pages/lottery_list/lottery_list?lucky_id="+t.luckyID+"&status="+t.order_combined_status+"&win_lottery="+(t.winLottery?1:0)+"&lottery_status="+t.lotteryStatus;o.default.forward(r);var a=t.orderSn;this.uploadFormId(e.detail.formId,"orders_other_clk"),this.bottomTapTrackingRecord("lucky_btn",a)}};(0,a.PddPage)(I,{pageName:"orders"}); 
 			}); 	require("pages/orders/orders.js");
 		__wxRoute = 'pages/order/order';__wxRouteBegin = true; 	define("pages/order/order.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=e(require("../../controller/order_checkout")),a=e(require("../../constants/order")),o=e(require("../../common/std_format")),r=e(require("../../common/order_utils")),s=e(require("./complaint_const")),n=e(require("../../common/payment")),i=e(require("../../common/navigation")),d=e(require("../../common/data_util")),u=e(require("../../constants/coupons")),c=e(require("../order_checkout/auto_create_group")),l=(e(require("../../components/toast/toast.js")),e(require("../../constants/dispatch_type")),e(require("../../constants/goods"))),p=e(require("../../common/util")),_=e(require("../../common/url_util")),m=e(require("../../common/gotop_util")),g=require("../../common/index"),h=e(require("../../configs/api")),f=e(require("../../storage/ram_manager")),T=e(require("../../storage/user_storage")),y=e(require("../../models/format/grid_item_goods")),S=e(require("../../libs/co/we-index")),w=e(require("../../libs/regenerator-runtime/runtime")),v=e(require("../../controller/formid_controller")),I=require("../../common/message"),C=e(require("../../configs/request_errors")),k=s.default.flowType,E=a.default.LotteryStatus,D={0:{tag:"等待买家付款",msg:""},1:{tag:"拼团还未成功",msg:"让小伙伴们都来拼团吧~"},2:{tag:"拼团成功",msg:""},3:{tag:"卖家已发货",msg:""},4:{tag:"交易成功",msg:""},5:{tag:"订单已取消",msg:""},10:{tag:"拼团失败",msg:""},"2-lottery-start":{tag:"拼团成功，等待抽奖中",msg:""},"2-lottery-ing":{tag:"拼团成功，开奖中",msg:""},"2-lottery-complete-0":{tag:"二等奖，已退款并送券",msg:""},"2-lottery-complete-1":{tag:"一等奖",msg:"等待卖家发货"},"3-lottery-complete-1":{tag:"一等奖，配送中",msg:""},"4-lottery-complete-1":{tag:"一等奖，已签收",msg:""}},R={payDispatchId:null,recOffset:0,payStatus:0,addressId:0,orderStatus:0,data:{showCopyBtn:!!wx.setClipboardData,reloadCls:"top-loading",orderSn:"",type:"",isComplete:!1,orderInitInfo:{},canShowModal:!1,canShowMore:!1,userHandleLock:!1,isLoadAllRecGoods:!1,likeRecGoods:[],goTopClass:!1,scrollTopValues:0,scrollTop:0,noChat:!1,shippingInfoIcon:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/order/cart_icon%402x.png",latestShippingInfo:"",latestShippingTime:"",payType:{wechatPay:!0,friendPay:!1,showWechatPay:!1,showFriendPay:!1}},selectPayType:function(e){var t=e.detail.target.dataset.name,a=this.data.payType;"friendPay"==t?(a.wechatPay=!1,a.friendPay=!0):"wechatPay"==t&&(a.wechatPay=!0,a.friendPay=!1),this.setData({payType:a}),this.$uploadFormId(e,!1)},goToHelpPay:function(e){this.$forward("help_pay",{order_sn:this.data.orderSn})},onLoad:function(e){var t=e.ordersn,a=e.type;this.friendPay=e.friend_pay,this.groupStatus=e.group_status;var o=this;this.setData({orderSn:t,type:a}),this.requestOrderData(!0),o.loadLikeRecommendGoodsDetail(o)},onUnload:function(){I.Message.off(I.KEYS.AUTO_CREATE_ORDER_CHECKOUT_PAY)},copyOrderSn:function(){var e=this;this.data.showCopyBtn&&wx.setClipboardData({data:e.data.orderSn+"",success:function(t){wx.getClipboardData({success:function(t){t.data===e.data.orderSn+""&&e.$showToast("复制成功")}})}})},copyTrackNo:function(){var e=this;wx.setClipboardData({data:e.data.trackingNumber+"",success:function(t){wx.getClipboardData({success:function(t){t.data===e.data.trackingNumber+""&&e.$showToast("复制成功")}})}})},reLoad:function(){this.requestOrderData(!1)},gotoMallPage:function(){i.default.forward("/pages/mall_page/mall_page?mall_id="+(this.data.orderInitInfo||{}).mall_id)},showMore:function(){this.data.orderInitInfo;this.setData({canShowMore:!0,canShowModal:!0})},hideMore:function(){this.setData({canShowMore:!1,canShowModal:!1})},requestOrderData:function(e){var t=this,a="order/"+this.data.orderSn;e&&this.setData({isShowLoading:!0});var r=g.Request.requestDataWithUrl("GET",a);g.Request.runMainRequestForPage(r,this).then(function(a){if(a){if(t.setData({orderInitInfo:a}),t.formatOrderData(a),t.data.shipmentStatus>=1&&7!=t.data.goods.goodsType){var r="order/"+t.data.orderSn+"/shipping";g.Request.apiRequest("GET",r).then(function(e){if(e.shipping&&e.shipping.traces&&e.shipping.traces.length>0){var a=e.shipping.traces[0].info,o=e.shipping.traces[0].time;t.setData({latestShippingInfo:a,latestShippingTime:o})}},function(e){})}var s=h.default.v2GoodsDetail+a.order_goods[0].goods_id,n=g.Request.requestDataWithUrl("GET",s,null,!0);g.Request.runSecondaryRequestForPage(n,t).then(function(e){e&&t.setData({marketPrice:o.default.price(e.market_price,100),support7days:e.is_refundable})},function(e){})}e&&t.setData({isShowLoading:!1})},function(a){var o=C.default.errors[a.error_code];e&&t.setData({isShowLoading:!1}),t.$showModal({title:"",content:o||"",confirmText:"去首页逛逛",showCancel:!1,success:function(e){t.$forward("index")}})})},getBatchName:function(e){var t="店铺优惠",r="",s="-￥0.00";t=e.type==u.default.CouponBatchType.MallCoupon?"店铺优惠":"通用优惠",r=e.batch_name,s="-￥"+o.default.price(e.discount,100);var n=e.batch_name,i=o.default.price(e.discount,100);return n=e.type==u.default.CouponBatchType.TZYYCoupon?"一元换购券":e.type==u.default.CouponBatchType.GroupFreeCoupon?"团长免单券":e.type==u.default.CouponBatchType.MallCoupon?i+"元店铺券":e.type===u.default.CouponBatchType.CategoryCoupon||parseInt(e.display_type,10)===u.default.CouponDisplayType.Category?e.goods_type.toString()==a.default.GoodsType.MOBILE_FARE?i+"元话费优惠券":i+"元类目券":e.discount===e.min_amount?i+"元无门槛券":i+"元满减券",{type:e.type,typeName:t,description:r,discountDetail:s,couponName:n}},formatOrderData:function(e){var t=this,s=(parseInt(Date.now()/1e3,10),{isComplete:!0,userInteractionEnabled:!0,orderSn:e.order_sn||"",associatedGroupOrderID:null,shipmentStatus:a.default.ShipmentStatus.Unshipped,status:a.default.OrderCombinedStatus.Uncomfirmed,statusDescription:"",lotteryStatus:null,winLottery:null,showLuckyDrawResult:!1,luckyID:null,addressId:e.address_id,charge_mobile:e.charge_mobile,serverTime:e.server_time,statusClass:"",complaintStatus:-2,showComplaint:!1,showComplaintReturn:!1,orderAmount:o.default.price(e.order_amount,100),freightDescription:"",paymentProvider:function(e){var t=parseInt(e,10);return[27,30,12].indexOf(t)>=0?"QQ钱包":31===t?"Apple Pay":[6,9].indexOf(t)>=0?"支付宝":"微信"}(e.app_id),address:e.city_name+" "+e.district_name+" "+e.shipping_address,receiver:e.receive_name||"",numberTitle:"充值号码：",mobile:e.mobile||"",orderTime:e.order_time||"",confirmTime:e.confirm_time||"0",shippingTime:e.shipping_time||"0",receiveTime:e.receive_time||"0",presaleTime:e.order_extention.pre_sale_time||"0",shipmentProvider:(e.shipping||{}).shipping_name||"",trackingNumber:e.tracking_number||"",rateStatus:e.rate_status||"0",commentStatus:e.comment_status||0,canExtendReception:{time:!1,hasExtended:!1},can_delete_order:e.can_delete_order||0,extentionLastTime:"",mall:{id:"",name:"",logo:"",phone:"",canContact:!1},goods:{goodsID:null,name:"",goodsNumber:"",priceByCent:"",price:"",thumbnailURL:"",eventType:0,skuID:0,groupID:0,goodsType:""},bannerInfo:{title:{tag:"",msg:""},statusFlow:[]},recommendList:[],customerNumber:e.group_order.customer_num,weChatPayVisible:!0,isNativePlatform:!1,isCapitalGift:!1,isCapitalGiftLottery:!1,expressInfo:{lastTrace:"",timeLabel:""}}),n="",i=o.default.price(e.shipping_amount,100);n=i<.01?"(免运费)":"(含额外配送费"+i+"元)",s.freightDescription=n;var d=e.server_time||e.timestamp||parseInt(Date.now()/1e3,10),c=(e.group_order_id||"").toString(),p=e.order_status,_=e.pay_status,m=e.shipping_status,h=d-this.data.orderTime>86400;this.orderStatus=p,this.payStatus=_,this.addressId=e.address_id,null!=c&&c.length>0&&_>=a.default.PaymentStatus.Payed&&(s.associatedGroupOrderID=c),s.shipmentStatus=m;var f=e.order_goods||[],T=f.length>0?f[0]:null,y=0;T&&(y=T.event_type,T.goods&&(y=parseInt(y||T.goods.event_type,10)||0),s.isCapitalGift=y===a.default.EVENT_TYPE.CAPITAL_GIFT,s.isCapitalGiftLottery=y===a.default.EVENT_TYPE.CAPITAL_GIFT_LOTTERY),s.goods.eventType=y,s.goods.goodsType=parseInt(T.goods_type,10),s.goods.skuID=T.sku_id,s.goods.groupID=e.group_id,(T.lucky_draw||e.lucky_draw_result)&&[a.default.EVENT_TYPE.LUCKY_DRAW,a.default.EVENT_TYPE.FREE_TRIAL,a.default.EVENT_TYPE.CAPITAL_GIFT_LOTTERY].indexOf(y)>=0&&(s.lotteryStatus=parseInt((e.lucky_draw_result||{}).lucky_draw_status||(T.lucky_draw||{}).status,10)||0,s.luckyID=(e.lucky_draw_result||{}).lucky_draw_id||(T.lucky_draw||{}).id),e.lucky_draw_result&&[a.default.EVENT_TYPE.LUCKY_DRAW,a.default.EVENT_TYPE.FREE_TRIAL,a.default.EVENT_TYPE.CAPITAL_GIFT_LOTTERY].indexOf(y)>=0&&(s.winLottery=1==(e.lucky_draw_result.lucky_draw_result_status||e.lucky_draw_result.status)),s.lotteryStatus===a.default.LotteryStatus.Complete&&!1===s.winLottery&&s.luckyID&&(s.showLuckyDrawResult=!0),s.status=r.default.getOrderCombinedStatus(p,_,m,s.lotteryStatus,{eventType:y}),this.changeStatusClass(s),s.showComplaint=!1,s.showComplaintReturn=!1,e.after_sales&&e.after_sales.after_sales_id?(e.after_sales.after_sales_status=parseInt(e.after_sales.after_sales_status),s.showComplaintReturn=!0):(s.status!=a.default.OrderCombinedStatus.Shipping&&s.status!=a.default.OrderCombinedStatus.Received||(s.showComplaint=!0,-1==this.getComplaintStatus(s,e)&&(s.showComplaint=!1)),s.showComplaint||e.after_sales_trigger>0&&(e.after_sales||(e.after_sales={}),e.after_sales.after_sales_status=-1,s.showComplaintReturn=!0)),[a.default.EVENT_TYPE.FREE_TRIAL,a.default.EVENT_TYPE.CAPITAL_GIFT,a.default.EVENT_TYPE.CAPITAL_GIFT_LOTTERY].indexOf(y)>=0&&(s.showComplaint=!1,s.showComplaintReturn=!1),s.complaintStatus=this.getComplaintStatus(s,e);var S=e.mall;if(null!=S){s.mall.id=S.id||"0",s.mall.name=S.mall_name||"",s.mall.logo=S.logo||"",s.mall.phone=(S.company_phone||"").trim();var w="1"==S.chat_enable;s.mall.canContact=w}null!=T&&(s.goods.goodsID=T.goods_id,s.goods.name=T.goods_name||"",(s.isCapitalGift||s.isCapitalGiftLottery)&&T.goods_price>0&&(T.goods_price=Math.floor(parseInt(T.goods_price,10)/parseInt(s.customerNumber,10)||1),T.goods_number=s.customerNumber),s.goods.goodsNumber=T.goods_number||1,s.goods.priceByCent=T.goods_price,s.goods.price=o.default.price(T.goods_price,100),s.goods.thumbnailURL=T.thumb_url||"",s.goods.spec=T.spec||"",s.goods.goodsType=parseInt(T.goods_type||(T.goods||{}).goods_type||0,10),s.goods.goodsType==l.default.GoodsType.QQ_COIN?s.numberTitle="QQ号：":s.goods.goodsType==l.default.GoodsType.OIL_CARD&&(s.numberTitle="加油卡号码："),s.goods.isPreSale=s.goods.name.indexOf("预售")>=0),s.goods.goodsType===a.default.GoodsType.TRADE_COUPON&&(s.showComplaint=!1,s.showComplaintReturn=!1);for(var v=e.coupons||[],I=[],C=0;C<v.length;C++)(x=v[C])&&I.push(this.getBatchName(x));var k=e.promotion_events;if(k&&k.length>0){var R=k[0].event_items,L=k[0].discount_type;for(var b in R){var O=R[b],P="",A=0;switch(L){case 4:P="第"+O.goods_number+"件"+g.StdFormat.price(O.discount_param,100)+"元",A=100*s.goods.price-O.discount_param;break;case 5:P="第"+O.goods_number+"件减"+g.StdFormat.price(O.discount_param,100)+"元",A=O.discount_param;break;case 6:P="第"+O.goods_number+"件"+g.StdFormat.price(10*O.discount_param,100)+"折",A=100*s.goods.price*((100-O.discount_param)/100);break;case 2:P="-"+g.StdFormat.price((100-O.discount_param)/100*s.goods.goodsNumber*s.goods.price*100,100)+"元"}if(s.goods.eventType!=a.default.EVENT_TYPE.LIMIT_TIME_DISCOUNT&&s.goods.eventType!=a.default.EVENT_TYPE.LIMIT_COUNT_DISCOUNT)N={type:L,typeName:"店铺优惠",description:P,discountDetail:"-￥"+g.StdFormat.price(A,100),couponName:P};else var N={type:L,typeName:"店铺优惠",description:s.goods.eventType==a.default.EVENT_TYPE.LIMIT_TIME_DISCOUNT?"限时折扣":"限量折扣",discountDetail:P,couponName:k[0].event_name+":"+P};I.push(N)}}I.push({type:0,typeName:"快递邮费",description:0==e.shipping_amount?"包邮":"",discountDetail:"￥"+o.default.price(e.shipping_amount,100)}),s.discountDescriptions=I;for(var M=[],C=0;C<I.length;C++){var x=I[C];x.couponName&&M.push(x.couponName)}M.length>0&&(s.combainCouponDescription="使用"+M.join("，")),s.currencyBlock=!1,0==e.order_status&&0==e.pay_status?I.length>0&&(s.currencyBlock=!0):s.combainCouponDescription&&s.combainCouponDescription.length>0&&(s.currencyBlock=!0),1==I.length&&I[0].type==u.default.CouponBatchType.GroupFreeCoupon&&s.status==a.default.OrderCombinedStatus.Unconfirmed&&h&&(s.status=a.default.OrderCombinedStatus.Expired,this.changeStatusClass(s)),s.status==a.default.OrderCombinedStatus.Shipping&&(s.canExtendReception=function(){if(e.hasOwnProperty("expect_auto_receive_time"))var t=(r=parseInt(e.expect_auto_receive_time))-259200;else{var o=1036800;[a.default.GoodsType.OVERSEAS_TRANSSHIP,a.default.GoodsType.OVERSEAS_DM].indexOf(s.goods.goodsType)>=0?o=2332800:3119==T.cat_id_2&&(o=3196800);var r=(t=parseInt(e.shipping_time)+o)+259200}var n=(e.order_extention||{}).extention_time||"0";return s.extentionLastTime=function(){var e=Math.max(r+parseInt(n)-d,0),t=parseInt(e/3600),a=t%24,o=Math.floor(t/24);return o<=0?"还剩余"+a+"时自动确认":"还剩余"+o+"天"+a+"时自动确认"}(),{time:t<d&&d<r,hasExtended:"0"!=n}}()),s.statusDescription=r.default.getOrderCombinedStatusDescription(s.status,s.lotteryStatus,s.winLottery,s.rateStatus),s.lotteryStatus&&p==a.default.OrderStatus.Unconfirmed&&_==a.default.PaymentStatus.Payed&&(s.statusDescription="已开奖"),s.bannerInfo=function(){var e={};if(e.title=D[s.status]||{tag:s.statusDescription,msg:""},e.statusFlow=[],s.status==a.default.OrderCombinedStatus.Shipping&&(e.title.msg=s.extentionLastTime||""),s.lotteryStatus===E.Start?"2"==s.status&&(e.title=D["2-lottery-start"]):s.lotteryStatus===E.Complete?s.winLottery||"2"!=s.status?s.status>=2&&s.status<=4&&s.winLottery&&(e.title=D[s.status+"-lottery-complete-1"]):e.title=D["2-lottery-complete-0"]:null!=s.lotteryStatus&&"2"==s.status&&(e.title=D["2-lottery-ing"]),s.lotteryStatus&&p==a.default.OrderStatus.Unconfirmed&&_==a.default.PaymentStatus.Payed&&(e.title={tag:"已开奖",msg:""}),"2"==s.status){var t=void 0,o=Math.max(parseInt(s.presaleTime,10)-parseInt(s.confirmTime,10),0);o>172800?(t=Math.floor(o/86400)+"天",e.title.msg="预计拼团成功后"+t+"内发货"):o>=3600?(t=Math.ceil(o/3600)+"小时",e.title.msg="预计拼团成功后"+t+"内发货"):e.title.msg=o>0?"预计拼团成功后1小时内发货":"等待卖家发货",d>=1510156800&&d<=1510675199&&(e.title.msg="等待卖家发货"),y!=a.default.EVENT_TYPE.LUCKY_DRAW&&y!=a.default.EVENT_TYPE.FREE_TRIAL||(e.title.msg="")}return e}(),s.orderSn=this.data.orderSn,s.type=this.data.type,s.orderTimeStr=this.formatDate(1e3*parseInt(s.orderTime,10)),s.confirmTime>0&&(s.confirmTimeStr=this.formatDate(1e3*parseInt(s.confirmTime,10))),s.shippingTime>0&&(s.shippingTimeStr=this.formatDate(1e3*parseInt(s.shippingTime,10))),s.receiveTime>0&&(s.receiveTimeStr=this.formatDate(1e3*parseInt(s.receiveTime,10))),s.againHard=!(4==s.status&&"1"==s.rateStatus),s.hardCls=s.againHard?"hard":"",s.depositeShipping=m==a.default.ShipmentStatus.Shipping,s.depositeReceived=m==a.default.ShipmentStatus.Received,s.isVirtualGoods=[l.default.GoodsType.MOBILE_DATA,l.default.GoodsType.MOBILE_FARE].indexOf(parseInt(s.goods.goodsType,10))>=0,s.isShowBottom=this.isShowBottom(s),s.showButtons=this.showButtons(s,d);var G=this.data.payType;if(G.showWechatPay=!0,1==y||3==y||7==y||t.hasSetPayType||(G.showFriendPay=!0,t.friendPay&&(G.friendPay=!0,G.wechatPay=!1),1==t.groupStatus&&(G.btnText="重开一团"),t.hasSetPayType=!0),s.payType=G,s.userHandleLock=!1,s.isShowShortButtons=this.showShortButtons(s),"已成团，待发货"==s.statusDescription){var q=new Date;q.setFullYear(2017,11,10),q.setHours(0,0,0);var B=new Date;B.setFullYear(2017,11,16),B.setHours(0,0,0);var F=1e3*s.serverTime;F>q.getTime()&&F<B.getTime()&&s.confirmTime+172800<s.serverTime&&(s.showDelaySale=!0,s.delaySaleText="双十二期间物流繁忙，部分订单发货可能存在延迟")}this.setData(s)},clickChat:function(e){var t=this.data.orderInitInfo,a=t.mall_id,o={orderSn:t.order_sn,goodsName:t.order_goods[0].goods_name,src:t.order_goods[0].thumb_url,status:this.data.statusDescription,orderTime:t.order_time};if(this.data.showComplaintReturn&&-1!=this.data.complaintStatus){var r=this.data.complaintStatus;3==r?o.status="退款成功":4==r||5==r?o.status="退款关闭":0==r?o.status="退款处理中":1==r&&(o.status="退款中")}if(o.mall_id=a,this.$forward("custom_service",o),e&&e.detail&&e.detail.formId){var s=e.detail.formId;this.uploadFormId(s,"chat_click"),this.clickBtnTracking("contact_seller_btn",t.order_sn)}},changeStatusClass:function(e){switch(e.status){case 0:e.statusClass="order-unpay";break;case 1:e.statusClass="order-payed";break;case 2:e.statusClass="order-confirmed";break;case 3:e.statusClass="order-shipping";break;case 4:e.statusClass="order-receive";break;default:e.lotteryStatus===E.Complete&&!1===e.winLottery?e.statusClass="order-receive":e.statusClass="order-cancel"}},getComplaintStatus:function(e,t){if(e.showComplaintReturn){switch(t.after_sales.after_sales_status){case k.COMPLAINT_NULL_M1:return-1;case k.COMPLAINT_INIT_0:case k.COMPLAINT_SALES_DEALING_1:case k.COMPLAINT_SERVICE_INIT_2:case k.COMPLAINT_SERVICE_DEALING_3:case k.COMPLAINT_WAIT_SALES_SEND_COMFIRM_11:return 0;case k.COMPLAINT_REFUNDING_4:return 1;case k.COMPLAINT_REFUNDED_SUCC_5:return 3;case k.COMPLAINT_CANCELED_6:case k.COMPLAINT_FAILED_7:case k.COMPLAINT_FAIL_EXPIRE_13:return 4;case k.COMPLAINT_END_8:return 2;case k.COMPLAINT_WAIT_USER_DEAL_9:case k.COMPLAINT_WAIT_USER_SEND_10:return 0;case k.COMPLAINT_FAIL_12:return 5}return 2}var a=t.complain;return 0==a.length?-1:parseInt(a[0].status)},formatDate:function(e){var t=new Date(e),a=t.getFullYear(),o=t.getMonth()+1,r=t.getDate(),s=t.getHours(),n=t.getMinutes(),i=t.getSeconds();return o=o<10?"0"+o:o,r=r<10?"0"+r:r,s=s<10?"0"+s:s,n=n<10?"0"+n:n,i=i<10?"0"+i:i,a+"-"+o+"-"+r+" "+s+":"+n+":"+i},showShortButtons:function(e){return e&&(e.showComplaintReturn||e.associatedGroupOrderID||e.showLuckyDrawResult)},showButtons:function(e,t){e.canShowPay=0==e.status,e.canShowCancel=0==e.status,e.canShowConfirm=3==e.status,e.canShowGrouping=1==e.status,e.canShowComment=4==e.status&&1==e.rateStatus&&0==e.commentStatus,3==e.status||e.depositeShipping||4==e.status||e.depositeReceived?e.canShowAgain=(4==e.status||e.depositeReceived)&&!e.showLuckyDrawResult&&!e.luckyID&&7!=e.status:e.canShowAgain=-1==[0,3,4,1].indexOf(e.status)&&!e.showLuckyDrawResult&&!e.luckyID&&7!=e.status,e.canShowAdditionaComment=4==e.status&&0==e.rateStatus&&1==e.commentStatus,e.canShowExpress=7!=e.goods.goodsType&&(4==e.status||3==e.status)&&!e.isVirtualGoods&&t-parseInt(e.shippingTime,10)<15552e3,e.canShowExtend=3==e.status,e.canShowDelBtn=1==e.can_delete_order;for(var a=[{show:e.canShowPay,name:"pay"},{show:e.canShowCancel,name:"cancel"},{show:e.canShowAgain,name:"again"},{show:e.canShowAdditionaComment,name:"additional-comment"},{show:e.canShowExpress,name:"shipping"},{show:e.canShowExtend,name:"extend"},{show:e.canShowDelBtn,name:"delete"}],o=[],r=0;r<a.length;r++)a[r].show&&o.push(a[r].name);return o},isShowBottom:function(e){return!e.showLuckyDrawResult&&(0==e.status||2==e.status||3==e.status||4==e.status||1==e.status||e.status>4&&!e.luckyID||e.isShowHardAgain||e.can_delete_order)},initCreateOrderParams:function(e){var t={skuId:e.order_goods[0].sku_id,groupId:e.group_id,goodsName:e.order_goods[0].goods_name,skuNumber:e.order_goods[0].goods_number,mallCouponId:"",platformCouponId:""};return t.finalPrice=e.order_amount,e.isVirtualGoods=[l.default.GoodsType.MOBILE_DATA,l.default.GoodsType.MOBILE_FARE].indexOf(parseInt(e.order_goods[0].goods_type,10))>=0,e.isVirtualGoods&&(t.phoneNumber=e.charge_mobile),e.group_order_id&&(t.groupOrderId=e.group_order_id),e.freeCoupon&&e.freeCoupon.couponId&&(t.groupFreeCoupon=e.freeCoupon),e.captainCoupon&&e.captainCoupon.couponId&&(t.groupCaptainCoupon=e.captainCoupon),t.addressId=e.isVirtualGoods?"0":e.address_id,t},processPay:function(e){var t="",a=this;if(e&&e.orderSn&&(t=e.orderSn,a.data.payType.friendPay))this.$forward("help_pay",{order_sn:t});else if(I.Message.emit(I.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_PAY"}),e.errorCode){var o=e.errorMsg;o&&(o="支付未完成，请重新支付",a.$showToast(o,{hideToastFunc:function(){if(t){var e="/pages/order/order?ordersn="+t;i.default.redirectForward(e)}}}))}else;},getGroupOrderDetail:S.default.wrap(w.default.mark(function e(t,a){var o,r;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=d.default.formatByPos(h.default.groupOrder,t),e.next=4,g.Request.apiRequest("GET",o);case 4:return r=e.sent,e.abrupt("return",r);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),clickBtnTracking:function(e,t){(0,g.TrackingRecord)({op:"click",event:e+"_clk",page_name:"order_detail",page_section:"main",page_element:e,order_sn:t})},goPayOrder:function(e){var a=this;if(!this.data.userHandleLock){this.setData({userHandleLock:!0});var o=this.data.orderSn,r=(this.data.goods.name,this.data.orderInitInfo),s=r.order_goods[0];if(a.data.payType.friendPay&&1!=this.groupStatus)return this.$forward("help_pay",{order_sn:o}),void this.$uploadFormId(e,!1);n.default.pay(o,function(e){var t=r.group_order_id;(0,S.default)(w.default.mark(function e(){var n,i,d,u;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.getGroupOrderDetail(t,a);case 3:n=e.sent,i=n.leader_order_info.uid,d=T.default.getUserId(),u={op:"event",event:0!=s.is_pre_sale?"prepay_order":"pay_order",page_name:"order",refer_page_section:"paid_popup",group_order_id:r.group_order_id,Is_group_owner:i==d?1:0,order_sn:o,order_amount:parseInt(r.order_amount,10),goods_id:s.goods_id,goods_number:s.goods_number,goods_type:s.goods_type,mall_id:r.mall_id,tag:"pdd_order",lucky_status:r.is_lucky?1:0,shipping_amount:100*r.shipping_amount,discount_amount:100*r.discount_amount,group_num:r.group_order?r.group_order.customer_num:""},n&&n.group_order_info&&void 0!==n.group_order_info.group_status&&(u.group_status=n.group_order_info.group_status),s.goods&&s.goods.event_type?u.event_type=s.goods.event_type:u.event_type="0",u.sub_op=u.event,f.default.isReadBigSales&&(u.refer_xcx_campaign_d12=1),(0,g.TrackingRecord)(u),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])})),a.setData({userHandleLock:!1}),I.Message.emit(I.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_PAY"});var n=h.default.orderPayCheck+"?order_sn="+o;g.Request.apiRequest("GET",n)},function(e){if(a.setData({userHandleLock:!1}),e.errorCode+""=="42001"){var n=a.initCreateOrderParams(r);n.friendPay=a.data.payType.friendPay;var i={goodsId:s.goods_id,createOrderParams:n,orderSn:o,eventType:s.event_type,notFormatPrice:s.goods_price,goodsNumber:r.goods_number||1,groupId:r.group_id,skuId:s.sku_id,sourceMallId:r.mall_id,goodsType:s.goods_type};n&&c.default.createGroup(i,function(e){e.groupOrderId=null,e.goodsType=s.goods_type,I.Message.on(I.KEYS.AUTO_CREATE_ORDER_CHECKOUT_PAY,p.default.bind(a.processPay,a)),t.default.createOrder(e,I.KEYS.AUTO_CREATE_ORDER_CHECKOUT_PAY)},function(){a.setData({userHandleLock:!1}),a.reLoad()})}else e.errorCode+""=="45008"?a.$showToast(e.errorMsg,{hideToastFunc:function(){a.reLoad()}}):a.$showToast(e.errorMsg)},function(e){a.setData({userHandleLock:!1}),a.reLoad()}),this.clickBtnTracking("pay_btn",o),this.data.payType.friendPay?this.$uploadFormId(e,!1):this.uploadFormId(e.detail.formId,"order_pay")}},uploadFormId:function(e,t){e&&t&&v.default.uploadFormIdToSH(e,!1)},autoCreateGroup:function(){var e=this.data.orderInitInfo;if(!this.data.userHandleLock){this.setData({userHandleLock:!0});var t=this;this.$showToast("该团已满，正在开新团...",{hideToastFunc:function(){var a="order/"+e.order_sn+"/cancel";t.cancelOrderPost(a,e)}})}},cancelOrderPost:function(e,t){var a=this;g.Request.apiRequest("POST",e).then(function(e){a.createNewOrder(t)},function(e){a.createNewOrder(t)})},createNewOrder:function(e){var t=this,a={address_id:e.address_id,goods:[{sku_id:e.order_goods[0].sku_id,sku_number:e.order_goods[0].goods_number}],app_id:e.app_id,group_id:e.group_id};e.charge_mobile&&(a.charge_mobile=charge_mobile);var o="order?log_id="+d.default.getLogId();g.Request.apiRequest("POST",o,a).then(function(e){e.order_sn?n.default.pay(e.order_sn,function(e){t.setData({userHandleLock:!1}),t.reLoad()},function(e){t.setData({userHandleLock:!1}),t.reLoad()},function(e){t.setData({userHandleLock:!1}),t.reLoad()}):t.setData({userHandleLock:!1})},function(e){this.setData({userHandleLock:!1})})},cancelOrder:function(e){var t=this;if(!this.data.userHandleLock){this.setData({userHandleLock:!0});var a=this.data.orderSn,o="order/"+a+"/cancel";this.$showModal({title:"确定取消订单？",cancelText:"取消",confirmText:"确定",success:function(e){e.confirm?g.Request.apiRequest("POST",o).then(function(e){t.$showToast("订单取消成功"),t.setData({userHandleLock:!1}),t.reLoad(),I.Message.emit(I.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_CANCELED",orderSn:a});var o=getCurrentPages();o.length>1&&(o[o.length-2]||{}).__route__.indexOf("orders")>=0&&t.$back()},function(e){t.$showToast(e.error_msg),t.setData({userHandleLock:!1}),t.reLoad()}):t.setData({userHandleLock:!1})}}),this.clickBtnTracking("cancel_order_btn",a)}},showGroupDetails:function(e){var t=this.data.associatedGroupOrderID;if(!(null==t||t.length<=0)){i.default.forward("/pages/group/group?group_order_id="+t);var a=this.data.orderSn,o=e.currentTarget.dataset.param;this.clickBtnTracking("main"==o?"group_btn":"invent_btn",a);var r=e.detail.formId;this.uploadFormId(r,"order_group_detail")}},limitedFree:function(){var e=this.data.orderInitInfo,t=e.charge_free&&e.charge_free.activity_id?e.charge_free.activity_id:"",a=e.order_goods[0].goods_id;if(t&&a){var o="?goods_id="+a;o+="&activity_id="+t,i.default.forward("/pages/limited_free/limited_free"+o)}},showGoodsDetails:function(e){var t=this.data.goods.goodsID;if(!(null==t||t.length<=0)){i.default.forward("/pages/goods/goods?goods_id="+t);var a=e.currentTarget.dataset.param,o=this.data.orderSn;"main"==a?(0,g.TrackingRecord)({op:"click",event:"buy_again_btn_clk",page_name:"order_detail",page_section:"main",page_element:"buy_again_btn",order_sn:o,goods_id:t}):this.clickBtnTracking("buy_again_btn",o)}},removeOrders:function(){var e=this,t=this.data.orderSn,a="order/"+t+"/delete";this.data.userHandleLock||(this.setData({userHandleLock:!0}),this.$showModal({title:"确认删除订单？",content:"删除之后订单无法恢复，我的拼团、我的抽奖中相关记录也将同步删除",cancelText:"取消",confirmText:"确认",success:function(o){o.confirm&&g.Request.apiRequest("POST",a).then(function(a){e.setData({userHandleLock:!1}),e.$showToast("删除订单成功"),I.Message.emit(I.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_DELETE",orderSn:t}),e.$back()},function(t){e.setData({userHandleLock:!1}),e.$showToast("删除订单失败")}),e.setData({userHandleLock:!1})}}),this.clickBtnTracking("del_order_btn",t))},toAddComments:function(){var e=this.data.orderInitInfo,t="order_sn="+e.order_sn;t+="&goods_id="+e.order_goods[0].goods_id,t+="&thumb_url="+e.order_goods[0].thumb_url,t+="&goods_name="+e.order_goods[0].goods_name,t+="&isAdditionalComments=true",i.default.forward("/pages/comments/comments?"+t);var a=this.data.orderSn;this.clickBtnTracking("append_comment_btn",a)},toComments:function(){var e=this.data.orderInitInfo,t="order_sn="+e.order_sn;t+="&goods_id="+e.order_goods[0].goods_id,t+="&thumb_url="+e.order_goods[0].thumb_url,t+="&goods_name="+e.order_goods[0].goods_name,i.default.forward("/pages/comments/comments?"+t);var a=this.data.orderSn;this.clickBtnTracking("comment_btn",a)},extendReception:function(){var e=this,t=this.data.canExtendReception,a=this.data.orderSn;if(1==t.hasExtended)e.$showToast("每笔订单只能延长一次哦~");else if(0==t.time)e.$showToast("亲，距离结束时间3天才可以申请哦~");else{if(this.data.userHandleLock)return;this.setData({userHandleLock:!0}),e.$showModal({content:"亲，确认延长收货订单？（每笔订单只能延长一次哦~）",success:function(t){t.confirm&&e.onExtendModalConfirm(),e.setData({userHandleLock:!1})}})}this.clickBtnTracking("extend_receive_btn",a)},onExtendModalConfirm:function(){var e=this,t=this.data.orderSn,a="order/"+t+"/extention";g.Request.apiRequest("POST",a).then(function(a){e.setData({userHandleLock:!1}),e.$showToast("延长收货成功!"),I.Message.emit(I.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_EXTEND",orderSn:t}),e.reLoad()},function(t){e.setData({userHandleLock:!1}),e.$showToast("延长收货失败!")})},showExpress:function(e){var t=this.data,a={order_sn:t.orderSn,shipping_name:t.shipmentProvider,tracking_number:t.trackingNumber,goods_id:t.goods.goodsID,mall_id:t.mall.id||(this.data.orderInitInfo||{}).mall_id,shipping_id:t.orderInitInfo.shipping_id||(t.orderInitInfo.shipping||{}).id,thumb_url:t.goods.thumbnailURL};i.default.forward("/pages/goods_express/goods_express?"+_.default.buildQuery(a));var o=this.data.orderSn;"btn"==e.currentTarget.dataset.refer?this.clickBtnTracking("logistics_btn",o):(0,g.TrackingRecord)({op:"click",page_name:"order_detail",page_section:"shipping",order_sn:o})},confirmShipment:function(){var e=this,t="order/"+this.data.orderSn+"/received";if(!this.data.userHandleLock){this.setData({userHandleLock:!0}),this.$showModal({title:"是否确认收货？",cancelText:"取消",confirmText:"确认",success:function(a){a.confirm?g.Request.apiRequest("POST",t).then(function(t){e.setData({userHandleLock:!1}),I.Message.emit(I.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_RECEIVED",orderSn:t.orderSn}),e.toComments()},function(t){e.setData({userHandleLock:!1}),t.error_code&&e.$showToast(t.error_msg)}):e.setData({userHandleLock:!1})}});var a=this.data.orderSn;this.clickBtnTracking("receive_btn",a)}},onShow:function(){if(this.data.isComplete){var e=this,t="order/"+this.data.orderSn;g.Request.apiRequest("GET",t).then(function(t){t&&(e.setData({orderInitInfo:t}),e.formatOrderData(t))})}},didClickModifyHint:function(){var e=this;this.$showModal({title:"",content:"您好，若卖家未发货您可以联系卖家尝试修改地址，请点击下方'联系卖家'与商家沟通，谢谢",cancelText:"返回",confirmText:"联系卖家",success:function(t){var a=void 0;t.confirm?(e.clickChat(),a="contact_seller_btn"):a="close_btn",e.tracking("click","alter_add_popup",a)}}),this.tracking("click","address","add_wrong"),this.tracking("impr","alter_add_popup",null)},didClickModifyBtn:function(){var e=this.data.addressId,t=this.data.orderInitInfo.delivery_modify||{},a=void 0,o=void 0,r=void 0;this.data.orderInitInfo.delivery_modify&&(a=t.modifiable_region,o=t.not_allow_region,r=t.differ_ship_amount_region);var s={sel_address_id:e,allowed_regions:a,not_allow_region:o,differ_amount_regions:r};this.$forward("addresses",s),I.Message.on(I.KEYS.ORDERCHECKOUT_CHOOSE_ADDRESS,p.default.bind(this.selectAddress,this),!0),this.tracking("click","address","alter_btn")},selectAddress:function(e){for(var t=this,a=e||[],o=void 0,r=0;r<a.length;r++){var s=a[r];if(s.isUsing){o=s;break}}if(o){var n=this.data.orderInitInfo,i={order_sn:n.order_sn,address_id:o.addressId},d=g.Request.requestDataWithUrl("POST",h.default.updateOrderAddress,i);g.Request.runSecondaryRequestForPage(d,this).then(function(e){t.requestOrderData(!1),n.address_id!=o.addressId&&t.$showToast("地址已修改成功")}).catch(function(e){t.$showToast(e.error_msg||"修改地址失败")})}},contactMall:function(){this.$showToast("小程序里暂不提供此功能");var e=this.data.orderSn;this.clickBtnTracking("contact_seller_btn",e)},applyRefund:function(e){var t=this,a=e.currentTarget.dataset.order_sn,o=e.currentTarget.dataset.after_sales_trigger,r="after_sales/trigger/"+a;g.Request.apiRequest("GET",r).then(function(e){if(0===e.disable_reason_id){if(null==a||a.length<=0)return;t.$forward("refund_money",{order_sn:a,after_sales_trigger:o,after_sales_type:"apply"})}else 0!=e.disable_reason_id&&t.$showToast("卖家发货后或下单48小时后可申请售后")},function(e){}),this.clickBtnTracking("afs_btn",a)},applyRefundDetail:function(e){var t=e.currentTarget.dataset.after_sales_id;e.currentTarget.dataset.after_sales_status;null==t||t.length<=0||this.$forward("afterSalesStatus_detail",{after_sales_id:t})},loadLikeRecommendGoodsDetail:S.default.wrap(w.default.mark(function e(t){var a,o,r,s,n;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.data.isLoadAllRecGoods&&!t.recommendGoodsRequest){e.next=3;break}return e.abrupt("return");case 3:return t.recommendGoodsRequest=!0,a=d.default.formatByPos(h.default.likeRecommend,t.recOffset,20),e.next=7,g.Request.apiRequest("GET",a);case 7:(o=e.sent)&&(t.recOffset+=20,t.recommendGoodsRequest=!1),r=o.list||[],r=r.map(function(e){return y.default.formatData(e)}),s=t.data.likeRecGoods||[],s=s.concat(r),n=r.length<20,this.setData({likeRecGoods:s,isLoadAllRecGoods:n}),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0),t.recommendGoodsRequest=!1,t.$showToast("加载出错");case 22:case"end":return e.stop()}},e,this,[[0,17]])})),gotoGoodsDetail:function(e){var t=e.currentTarget.dataset;if(t){var a=t.goodsId;if(a){var o=t.index,r=t.eventType,s=t.goodsItem;this.transGoodsData=s;var n="/pages/goods/goods?goods_id="+a;1==t.showSkuSelector&&(n+="&show_sku_selector=1"),i.default.forward(n),(0,g.TrackingRecord)({op:"click",page_name:"order_detail",page_section:"rec_goods_list",page_element:"rec_goods",idx:o,rec_goods_id:a,rec_event_type:r})}}},goTop:function(){this.setData({scrollTop:1}),this.setData({scrollTop:0})},scroll:function(e){var t=parseInt(e.detail.scrollTop,10);isNaN(t)||(this.scrollTopValues=t,m.default.showGoTopBtn(t,this))},onReady:function(){m.default.showGoTopBtn(this.scrollTopValues,this)},scrollToLower:function(){var e=this;(0,S.default)(w.default.mark(function t(){return w.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.loadLikeRecommendGoodsDetail(e);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}))},toWinDetail:function(e){var t=e.currentTarget.dataset.status,a=e.currentTarget.dataset.winLottery,o=e.currentTarget.dataset.lotteryStatus,r="/pages/lottery_list/lottery_list?lucky_id="+this.data.luckyID+"&status="+t+"&win_lottery="+a+"&lottery_status="+o;i.default.forward(r);var s=this.data.orderSn;this.clickBtnTracking("lucky_btn",s)},phoneCall:function(){var e=this.data.mall.phone;e=e.replace(/-/g,""),p.default.checkTel(e)?wx.makePhoneCall({phoneNumber:e}):this.$showToast("卖家未预留电话，请联系卖家客服");var t=this.data.orderSn;this.clickBtnTracking("call_btn",t)},tracking:function(e,t,a){var o={op:e,page_section:t,pay_status:this.payStatus,order_status:this.orderStatus,address_id:this.addressId};a&&(o.page_element=a),(0,g.TrackingRecord)(o)}};(0,g.PddPage)(R,{pageName:"order"}); 
 			}); 	require("pages/order/order.js");
 		__wxRoute = 'pages/group/group';__wxRouteBegin = true; 	define("pages/group/group.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var r=require("../../common/index"),o=require("../../constants/event_constant"),s=(e(require("../../components/toast/toast.js")),e(require("../../constants/groups"))),a=e(require("./group_user_data")),i=e(require("../../components/bubble/bubble")),n=e(require("../../storage/user_storage")),u=(require("../../constants/share"),e(require("../../configs/api"))),d=e(require("../../common/gotop_util")),l=(e(require("../goods/goods_util")),e(require("../goods/cache_goods_data"))),c=e(require("../../models/group_proxy")),p=e(require("../../models/format/luck_draw")),h=e(require("../../models/format/v2_goods_detail")),g=e(require("../../storage/ram_manager")),f=e(require("../../common/buy_util")),m=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),T=e(require("../../libs/regenerator-runtime/runtime")),_=e(require("../../components/sku_selector/sku_selector_v2")),v=e(require("../../common/std_format")),w=e(require("../../components/screen_shot_share/screen_shot_share")),I=(e(require("../../controller/formid_controller")),e(require("../../models/format/grid_item_goods"))),y=(e(require("../../common/logger_util")),e(require("../../components/big_sales/big_sales"))),k={common:"common",lottery:"lottery",pink:"pink"},G={groupOrderId:null,recOffset:0,recCount:30,lowerLock:!1,recGoodsManager:null,groupDispatchIds:{},deltaTime:0,localGroupDeltaTime:0,referPageElement:"open_btn",shareImageUrl:"",lotteryInfo:{},recommendGoodsCache:[],minOnsaleGroupPrice:null,catchTapPage:function(){this.setData({showOvershadow:!1})},onShareAppMessage:function(e){this.userId||(this.userId=n.default.getUserId());var t=this.data.goodsInfo||{},r={group_order_id:this.$urlQueryObj.group_order_id,wt_id:this.$urlQueryObj.wt_id,uid:this.userId,_wv:1,goods_price:this.minOnsaleGroupPrice,goods_id:t.goodsId,event_type:t.eventType},o="";if(e)if("menu"==e.from)o="top_forward";else{var s=e.target.dataset.subRefer;"group-share-btn"==s?o="group_detail_share":"screen-shot"==s&&(o="screen_shot_share")}this.setShareTitle();return this.$generateShareContent({title:this.data.shareInfo.shareTitle,queries:r,referStr:o,successCallback:function(){g.default.hadGroupShareArray.push(g.default.lastGroupOrderId)}})},data:{pageName:"group",isFirstEnter:!0,serviceDetailVisible:!1,serviceMainClass:"service-detail-hidden",shareInfo:{},loadingVisible:!0,visible:!1,isApp:!1,shareHintMaskVisible:!wx.canIUse||!wx.canIUse("button.open-type.share"),shareHintText:"点右上角 ...可以转发给微信群或好友",users:[],showUsers:[],currentUser:{},currentUserJoinTimeStr:"",leftUserNum:0,userListPopupVisible:!1,expireTime:0,serverTime:0,groupState:0,successTime:0,groupRole:0,leftTime:"",userListPopupTips:"",groupStatusTips:"",groupButtonText:"",groupsStatusClass:"group-detail-buy",showOvershadow:!1,showJoinedView:!1,showNormalView:!1,showSuccessView:!1,showNoStoreView:!1,successViceDesc:"商家正在努力发货，请耐心等待！",curUserAddress:"",successTimeStr:"",groupNoticePopupVisible:!1,groupNoticeBarVisible:!0,location:"",showError:!1,canEnvokeShare:wx.canIUse&&wx.canIUse("button.open-type.share"),lotteryRulesPopupVisible:!1,showUnpaidHintModal:!1,eventType:"0",is_new_buyer:!1,shareMainClass:"screen-share-main screen-share-main-hide",canShowShare:!0,showShareModal:!1,lotteryRulesDetail:null,isLotteryOrFreeTrial:null,isPreparingStatus:!0,joinGroupStyle:"",joinGroupUseNewStyle:null,showBtnTimerText:!1,isBlackList:!1,isFreeGroup:null,hideGroupNav:!0,hideHintToast:!0,showNormalInfo:!1},clickGroupNotice:function(e){this.setData({groupNoticePopupVisible:!0}),this.$uploadFormId(e)},hideGroupNoticePopup:function(){this.setData({groupNoticePopupVisible:!1})},showShareHintMaskButton:function(e){if(e&&e.detail&&e.detail.formId){var t={form_id:e.detail.formId};this.data.eventType==s.default.EventType.LUCKY_DRAW?t.market=!1:t.market=!0,this.$uploadFormId(e,t.market)}var o=this.getTrackingParams("click","main","invite_btn");(0,r.TrackingRecord)(o)},showShareHintMask:function(e){this.$showToast(this.data.shareHintText),this.$uploadFormId(e);var t=this.getTrackingParams("click","invite_popup","invent_btn");(0,r.TrackingRecord)(t)},showServiceDetail:function(e){var t=this;this.setData({serviceDetailVisible:!0}),setTimeout(function(){t.setData({serviceMainClass:"service-detail-show"})},100),this.$uploadFormId(e)},hideServiceDetail:function(){var e=this;this.setData({serviceMainClass:"service-detail-hidden"}),setTimeout(function(){e.setData({serviceDetailVisible:!1})},200)},showUserListPop:function(){this.setData({userListPopVisible:!0})},hideUserListPop:function(){this.setData({userListPopVisible:!1})},clickUser:function(e){this.showUserListPopup()},getGoodsDetail:m.default.wrap(T.default.mark(function e(t,o){var s,a,i,n;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=u.default.v2GoodsDetail+t,a=r.Request.requestDataWithUrl("GET",s,null,!0),e.next=5,r.Request.runMainRequestForPage(a,o);case 5:return i=e.sent,n=h.default.formatData(i),o.minOnsaleGroupPrice=i.max_on_sale_group_price,e.abrupt("return",[n,i]);case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])})),reLoad:function(){this.setData({showError:!1}),this.loadPage()},loadPage:function(){var e=this,t=this.$urlQueryObj.goods_id,o=this.$urlQueryObj.group_order_id,a=this.$urlQueryObj.cache_bottom_id;this.setData({loadingVisible:!0,showError:!1}),this.initPageData(),(0,m.default)(T.default.mark(function i(){var n,u,d,c,p,h;return T.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,e.getGroupOrderDetail(o,e);case 3:if(e.groupInfo=i.sent,e.groupInfo){i.next=6;break}return i.abrupt("return");case 6:if(e.getBlackList(e,o),n=e.groupInfo.goods_info,u={eventType:parseInt(n.event_type),goodsId:n.goods_id,marketPrice:n.market_price?v.default.price(n.market_price,100):""},e.getLotteryInfo(e,u),e.getRecommendGoodsDetail(e),d=void 0,void 0!==a&&void 0!==t){i.next=20;break}return t=e.groupInfo.goods_info.goods_id,i.next=16,e.getGoodsDetail(t,e);case 16:d=i.sent,e.data.goodsInfo=d[0],i.next=30;break;case 20:if(!((c=l.default.getDataFromCache(a))&&c.barDataNeededFromPage&&c.barDataNeededFromPage.goods)){i.next=26;break}e.data.goodsInfo=c.barDataNeededFromPage.goods,e.minOnsaleGroupPrice=100*parseFloat(e.data.goodsInfo.minOnsaleGroupPrice),i.next=30;break;case 26:return i.next=28,e.getGoodsDetail(t,e);case 28:d=i.sent,e.data.goodsInfo=d[0];case 30:u=e.data.goodsInfo,e.data.goodsInfo&&e.data.goodsInfo.goodsId&&(g.default.lastOrderGoodsId=e.data.goodsInfo.goodsId),d&&d[1]?u.isOnSale&&d[1].sku&&d[1].sku.length>1&&(e.hasSkuSelector=!0):u.skus&&u.isOnSale&&u.skus&&u.skus.length>1&&(e.hasSkuSelector=!0),(p=e.groupInfo.is_new_buyer)&&e.closeNewUserAlert(),h=u.eventType,e.setData({eventType:h,is_new_buyer:p,isNewUser:p,isNewUserGroup:1*h==6,groupTopBanner:u.hdThumbUrl,groupTopImage:u.hdThumbUrl,groupPice:u.maxOnsaleGroupPrice}),u.eventType==s.default.EventType.FREE_GROUP&&e.setData({isFreeGroup:!0,isPreparingStatus:!1,isLotteryOrFreeTrial:!0,groupTopImage:u.hdThumbUrl,groupPice:u.maxOnsaleGroupPrice,marketPrice:u.marketPrice}),d&&d[1]&&e.setSkus(u,d[1],e),e.getScaleShareImage(u,e.groupInfo,e),e.imprTracking(),wx.onUserCaptureScreen&&wx.onUserCaptureScreen(function(t){var s={op:"impr",event:"screen_shot_popup_impr",page_name:"group_detail",page_section:"screen_shot_popup",group_order_id:o};(0,r.TrackingRecord)(s),w.default.listenScreenShot(e)}),i.next=47;break;case 44:i.prev=44,i.t0=i.catch(0),console.error(i.t0);case 47:case"end":return i.stop()}},i,this,[[0,44]])}))},setSkus:m.default.wrap(T.default.mark(function e(t,r,o){var s;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.skus||(s=h.default.getSkus(r.sku,r.thumb_url),o.setData({"goodsInfo.skus":s}));case 1:case"end":return e.stop()}},e,this)})),preSetView:function(e){var t=e.goodsInfo,r={isPreparingStatus:!1};1===t.eventType||7===t.eventType?(r.joinGroupStyle=k.lottery,r.showBtnTimerText=!0,r.isLotteryOrFreeTrial=!0):t.eventType==s.default.EventType.FREE_GROUP?(r.joinGroupStyle=k.lottery,r.showBtnTimerText=!0,r.isFreeGroup=!0):(r.showBtnTimerText=!0,r.joinGroupStyle=k.pink),this.setData(r)},getBlackList:m.default.wrap(T.default.mark(function e(t,o){var s,a,i,n;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.DataUtil.formatByPos(u.default.getBlackList,o),a=r.Request.requestDataWithUrl("GET",s),e.next=4,r.Request.runMainRequestForPage(a,t);case 4:i=e.sent,n=t.data.isBlackList,2===i.egrp&&(n=!0),t.setData({isBlackList:n});case 8:case"end":return e.stop()}},e,this)})),getLotteryInfo:m.default.wrap(T.default.mark(function e(t,o){var a,i,n,d,l,c;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==o.eventType&&7!==o.eventType){e.next=12;break}return a={goodsId:o.goodsId,rulesKey:o.eventType===s.default.EventType.LUCKY_DRAW?"LuckyDraw":"FreeTrial"},i=u.default.luckyDraw+o.goodsId,n=r.Request.requestDataWithUrl("GET",i),e.next=6,r.Request.runMainRequestForPage(n,t);case 6:d=e.sent,l=!1,d.server_time>=d.end_time&&(l=!0),c=p.default.formatData(d,a),t.lotteryInfo=c.info,t.setData({marketPrice:o.marketPrice,lotteryRulesDetail:c.rules,drawIsOver:l});case 12:case"end":return e.stop()}},e,this)})),processGroupView:function(){this.data.showJoinedView&&this.joinedViewDataProcess(),this.data.showNormalView&&this.normalViewDataProcess(),this.data.showSuccessView&&this.successViewDataProcess(),this.data.showNoStoreView&&this.noStoreViewDataProcess(),this.data.lotteryRuleTitle&&this.loadLotteryRule()},closeShare:function(){this.setData({shareMainClass:"screen-share-main screen-share-main-hide",canShowShare:!0});var e={op:"click",event:"close_btn_clk",page_name:"group_detail",page_section:"screen_shot_popup",page_element:"close_btn",group_order_id:this.$urlQueryObj.group_order_id};(0,r.TrackingRecord)(e)},onShow:function(){var e=this,t=this.$urlQueryObj.group_order_id,o=this.data.goodsInfo;this.data.isFirstEnter||((this.data.showNormalView||this.data.showJoinedView)&&this.setLeftTimeCountdown(),this.data.showNormalView&&this.setLocalGroupCountdown(),(0,m.default)(T.default.mark(function r(){return T.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e.getBlackList(e,t),r.next=4,e.getGroupOrderDetail(t,e);case 4:if(e.groupInfo=r.sent,e.groupInfo){r.next=7;break}return r.abrupt("return");case 7:o.eventType==s.default.EventType.FREE_GROUP&&e.setData({isFreeGroup:!0,isPreparingStatus:!1,joinGroupStyle:k.lottery,isLotteryOrFreeTrial:!0,groupTopImage:o.hdThumbUrl,groupPice:o.maxOnsaleGroupPrice,marketPrice:o.marketPrice}),e.imprTracking(),r.next=15;break;case 11:r.prev=11,r.t0=r.catch(0),console.error(r.t0),e.imprTracking();case 15:case"end":return r.stop()}},r,this,[[0,11]])}))),e.$BigSalesModal||(e.$BigSalesModal=new y.default({setDataFunc:function(t){e.setData(t)},addRootFunc:r.Util.bind(e.componentsAddRootFunc,e)})),e.$BigSalesModal.showBigSalesBanner(".png"),e.$BigSalesModal.showBigSalesFloat();var a=getCurrentPages(),n=a[a.length-1].__route__;n+="?"+r.UrlUtil.buildQuery(this.$urlQueryObj),i.default.init(this,!0,n,1),g.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},getGroupOrderDetail:m.default.wrap(T.default.mark(function e(t,o){var s,a,i,n;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=r.DataUtil.formatByPos(u.default.groupOrder,t),a=r.Request.requestDataWithUrl("GET",s),e.next=5,r.Request.runMainRequestForPage(a,o);case 5:return i=e.sent,n=c.default.receiveGroupOrderData(i),o.processGroupOrderInfo(n),e.abrupt("return",i);case 11:e.prev=11,e.t0=e.catch(0),this.setData({showError:!0,loadingVisible:!1});case 14:case"end":return e.stop()}},e,this,[[0,11]])})),getScaleShareImage:m.default.wrap(T.default.mark(function e(t,o,a){var i,n,u,d,l,c,p,h,g,f,m,_;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,parseInt(a.data.status,10)===s.default.GroupStatus.OnGoing){e.next=3;break}return e.abrupt("return");case 3:if(t.eventType==s.default.EventType.DEFAULT){e.next=5;break}return e.abrupt("return");case 5:if(i=a.$urlQueryObj.group_order_id+"",n=i.substring(i.length-1,i.length),u="4569",d="45",l="69",c="",!(u.indexOf(n)>-1)){e.next=23;break}d.indexOf(n)>-1?(c="common_B",a.shareFrom="lottery_draw_A"):l.indexOf(n)>-1&&(c="common_A",a.shareFrom="free_group_A"),p=[];for(h in o.order_list)p.push({avatar:o.order_list[h].avatar});return g={template_id:c,goods_id:t.goodsId,goods_price:t.minGroupPrice,market_price:t.marketPrice,group_left:a.data.groupJoinedTips.emphasis,group_list:p,group_id:a.data.groupId,goods_pic:t.hdThumbUrl,group_num:o.group_order_info.customer_num},f="https://wxapp.yangkeduo.com/access/Image/GetCustomImage",m=r.Request.requestDataWithUrl("POST",f,g,!0),e.next=20,r.Request.runSecondaryRequestForPage(m,a);case 20:return(_=e.sent).result&&_.result.custom_pic_url&&_.result.custom_pic_url.length>0&&(a.shareImageUrl=_.result.custom_pic_url),e.abrupt("return");case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),console.error(e.t0);case 28:case"end":return e.stop()}},e,this,[[0,25]])})),groupPageScroll:function(e){var t=parseInt(e.detail.scrollTop);isNaN(t)||this.setData({scrollTopValue:t})},onPageScroll:function(e){if(e){var t=parseInt(e.scrollTop);d.default.showGoTopBtn(t,this)}},onReachBottom:function(){var e=this;if(this.data.canLoadMore)this.getRecommendGoodsDetail(e)},getRecommendGoodsDetail:m.default.wrap(T.default.mark(function e(t){var o,s,a,i,n,d;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=t.data.goodsInfo||{},s=o.goodsId,!t.lowerLock&&s){e.next=5;break}return e.abrupt("return");case 5:return t.setData({loadingMoreVisible:!0}),t.lowerLock=!0,a={showMallRecommend:null,deleteAllGoods:0===t.recOffset},i=u.default.getRecommendGoodsData+"?"+r.UrlUtil.buildQuery({goods_id:s,referrer:"group_order",with_mall_rec:null,page_type:0,offset:t.recOffset||0,count:t.recCount||30}),n=r.Request.requestDataWithUrl("GET",i,null,!0),e.next=12,r.Request.runSecondaryRequestForPage(n,t);case 12:return d=e.sent,t.processRecommendGoods(d,a),e.abrupt("return");case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0);case 20:case"end":return e.stop()}},e,this,[[0,17]])})),processRecommendGoods:function(e,t){var r=this;if(this.lowerLock=!1,e)if(e.errorCode)this.$showToast(e.errorMsg);else{var o=Array.isArray(e.list)?e.list:[],s=o.length<=0;t.deleteAllGoods&&(this.recommendGoodsCache=[]),o.forEach(function(e){r.recommendGoodsCache.push(I.default.formatData(e))}),this.setData({canLoadMore:!s,loadMoreVisible:!0,hideGroupNav:!1});var a=this.recommendGoodsCache||[];this.setData({recommendList:a}),this.recOffset+=this.recCount}},closeNewUserAlert:function(){this.setData({newUserAlertVisible:!1})},clickGroupBtn:function(e){if(this.data.groupState===s.default.GroupStatus.OnGoing?this.joinGroup():this.createGroup(),e&&e.detail&&e.detail.formId){var t={form_id:e.detail.formId};this.data.goodsInfo.eventType===s.default.EventType.LUCKY_DRAW?t.market=!1:t.market=!0,this.$uploadFormId(e,t.market)}},joinLocalGroup:function(e){var t=e.currentTarget.dataset.groupOrderId;t&&this.justProcessJoinGroup(t);var o={click_group_order_id:t},s=this.getTrackingParams("click","local_group","join_btn",o);(0,r.TrackingRecord)(s)},justProcessJoinGroup:function(e){var t=this.data||{},r=this.data.goodsInfo;if(e=e||t.groupOrderId,t.isNewUserGroup&&!t.is_new_buyer)return this.setData({newUserAlertVisible:!0}),void(g.default.newUserAlertVisible=!0);if("1"!==t.goExclusiveGroup){var o=void 0,s=void 0;if(r&&r.isOnSale)if(r.isOnSale&&r.skus&&r.skus.length>1)this.showSkuSelector();else{var a=this.data.goodsInfo,i=a&&a.groupTypes&&a.groupTypes[1]?a.groupTypes[1]:{};o="order_checkout",s={sku_id:t.skuId,goods_id:r.goodsId,group_id:t.groupId,group_order_id:e,showwxpaytitle:"1",group_num:i.requireNum},this.$forward(o,s)}else this.$showToast("商品已售罄")}else this.$showToast("该商品是APP专享团商品，请在APP中购买和参团。")},getPriceRange:f.default.getPriceRange,showSkuSelector:f.default.showSkuSelector,selectSpec:_.default.selectSpec,preloadSkuImgLoaded:_.default.preloadSkuImgLoaded,updateGoodsNumber:_.default.updateGoodsNumber,goodsNumberFocus:_.default.goodsNumberFocus,goodsNumberBlur:_.default.goodsNumberBlur,goodsNumberChange:_.default.goodsNumberChange,hideSkuSelector:_.default.hideSkuSelector,skuContainerDefaultClick:_.default.skuContainerDefaultClick,viewSkuImage:_.default.viewSkuImage,confirmSku:_.default.confirmSku,joinGroup:function(){this.justProcessJoinGroup();var e=this.getTrackingParams("click","main","join_btn");(0,r.TrackingRecord)(e)},createGroup:function(){var e=this,t=this.data||{},o=t.goodsInfo||{};if(!o.isOnSale||"1"===t.soldOutStr)return this.$showToast("商品已售罄"),void setTimeout(function(){e.goLotteryPage()},2e3);var s=void 0,a=void 0;if(o.isOnSale&&o.skus&&o.skus.length>1)this.showSkuSelector();else{s="order_checkout";var i=this.data.goodsInfo,n=i.groupTypes&&i.groupTypes[1]?i.groupTypes[1]:{};a={sku_id:t.skuId,goods_id:o.goodsId,group_id:t.groupId,showwxpaytitle:"1",group_num:n.requireNum}}s&&a&&this.$forward(s,a);var u=this.getTrackingParams("click","main","open_btn");(0,r.TrackingRecord)(u)},processGroupOrderInfo:function(e){var t=this;this.preSetView(e);var o=this.$urlQueryObj.group_order_id;if(e.groupOrderId==o){var i=e.users||[],u=e.selfOrderInfo||{},d=u.receive_name;if(d){u.receiveNameSec=d.slice(0,1);for(var l=0;l<d.length-1;l++)u.receiveNameSec+="*"}var c=u.mobile;c&&(u.mobileSec=c.slice(0,3)+"****"+c.slice(7,12));n.default.getUserId();i.map(function(e,o){return e.formatJoinTimeStr=r.TimeUtil.formatTime(new Date(1e3*e.joinTime)),u&&u.uid===e.uid&&t.setData({currentUserJoinTimeStr:e.formatJoinTimeStr}),e.isLeader?e.formatJoinTimeStr+="开团":e.formatJoinTimeStr+="参团",e});var p=i[0],h=1===i.length&&u.uid?"快邀请好友参团吧～":"抢先成为第一个团员吧~",f=this.data.showOvershadow;this.data.isFirstEnter&&e.groupRole===s.default.GroupRole.Lead&&e.status===s.default.GroupStatus.OnGoing&&(f=!0);var m=this.data,T={lotteryRuleTitle:e.lotteryRuleTitle,groupJoinedTips:e.groupJoinedTips,showSharePointer:e.showSharePointer,maskShareTip:e.maskShareTip,groupNoticeBarText:e.groupNoticeBarText,isLottery:e.isLottery,isFreeTrial:e.isFreeTrial,isDepositeGroup:e.isDepositeGroup,promoteLotteryIcon:e.promoteLotteryIcon,isFirstEnter:!1,users:i,leader:p,userListPopupTips:h,groupState:e.status,groupRole:e.groupRole,leftUserNum:e.leftUserNum,currentUser:u,serverTime:e.serverTime,expireTime:e.expireTime,leftTime:1e3*(e.expireTime-e.serverTime),skuNum:parseInt(e.skuNum,10),skuId:e.skuId,groupId:e.groupId,groupOrderId:e.groupOrderId,soldOutStr:e.soldOutStr,hasLotteryRule:e.hasLotteryRule,successTime:e.successTime,shareInfo:e.shareInfo,joinNum:e.joinNum,isNewUserGroup:e.isNewUserGroup,isNewUser:e.isNewUser,goExclusiveGroup:e.goExclusiveGroup,status:e.status,isApp:e.isApp,sales:parseInt(e.goodsInfo.sales,10),canLoadMore:!0,groupNoticeBarVisible:!0,location:e.location,visible:!0,loadingVisible:!1,eventType:(e.goodsInfo||{}).eventType,groupPice:(e.goodsInfo||{}).price,groupTopImage:(e.goodsInfo||{}).hdThumbUrl,isBlackList:!(!e.location||!e.location.match("广州"))||this.data.isBlackList,marketPrice:e.marketPrice?v.default.price(e.marketPrice,100):"",maxOnsalePrice:e.maxOnsalePrice?v.default.price(e.maxOnsalePrice,100):""},_=100-100*r.DataUtil.accDiv(T.maxOnsalePrice,T.marketPrice);_=_<1?_.toString().slice(0,3):Math.floor(_),T.goodsDiscount=_+"%",m.goodsInfo?m.goodsInfo.requireNum=e.goodsInfo.requireNum:T.goodsInfo=e.goodsInfo,this.deltaTime=e.serverTime-parseInt(Date.now()/1e3,10),wx.stopPullDownRefresh();var w=!1,I=!1,y=!1,k=!1;if(g.default.isLastGroupNotEnough=!1,"1"===e.soldOutStr&&e.groupRole===s.default.GroupRole.NotInGroup)k=!0;else switch(e.status){case s.default.GroupStatus.OnGoing:e.groupRole>s.default.GroupRole.NotInGroup?(g.default.isLastGroupNotEnough=!0,w=!0):I=!0;break;case s.default.GroupStatus.Success:e.groupRole>s.default.GroupRole.NotInGroup?(y=!0,(e.goodsInfo||{}).eventType!=s.default.EventType.LUCKY_DRAW&&(e.goodsInfo||{}).eventType!=s.default.EventType.FREE_TRIAL||(this.openNewGroup=!0)):I=!0;break;case s.default.GroupStatus.Failed:I=!0}w&&this.data.shareHintMaskVisible&&this.$showToast(this.data.shareHintText);var G=a.default.getUsersTemplateData(e,{dontShowleftUserIcon:!!k});this.setData(r.ObjectUtil.assign(T,{showOvershadow:f,showJoinedView:w,showNormalView:I,showSuccessView:y,showNoStoreView:k},G)),this.processGroupView(),this.$setTrackingKeyParams({group_order_id:e.groupOrderId,goods_id:(e.goodsInfo||{}).goodsId,event_type:(e.goodsInfo||{}).eventType})}},goToOrderDetail:function(){var e=this.data.currentUser.order_sn;this.$forward("order",{ordersn:e})},joinedViewDataProcess:function(){this.setLeftTimeCountdown()},setLocalGroupCountdown:function(e,t){var o=this;if(!((t=t||this.data.localGroups||[]).length<=0)){var s=function(e,t){t=t||o.data.localGroups||[];var s=parseInt(Date.now()/1e3,10);t.map(function(t){null==t.deltaMillisecond&&(t.deltaMillisecond=Math.max(1e3*(t.expireTime-s-o.localGroupDeltaTime),0)),!e&&t.deltaMillisecond>=1e3&&(t.deltaMillisecond-=1e3);var a=r.TimeUtil.transferToTime(t.deltaMillisecond);return t.leftTimeStr="",parseInt(a.days)>0&&(t.leftTimeStr=a.days+"天:"),t.leftTimeStr=a,t}),o.setData({localGroups:t})};this.clearGroupCountDown(),e&&s(e,t);!function e(){o.localGroupCountdown=setTimeout(function(){s(!1),e()},1e3)}()}},setLeftTimeCountdown:function(){if(parseInt(this.data.status,10)===s.default.GroupStatus.OnGoing){var e=this,t=parseInt(Date.now()/1e3,10),o=1e3*(this.data.expireTime-t-this.deltaTime),a=r.TimeUtil.transferToTime(o),i=a.split(":");a=i.slice(0,i.length-1).join(":")+":"+i[i.length-1],this.setData({transferedTimeStr:a,leftTime:o}),this.clearGroupCountDown();!function t(){e.countDown=setTimeout(function(){var o=e.data.leftTime-1e3,s=r.TimeUtil.transferToTime(o),a=s.split(":");s=a.slice(0,a.length-1).join(":")+":"+a[a.length-1],e.setData({leftTime:o,transferedTimeStr:s,leftTimesArray:a,refreshCountDown:!e.data.refreshCountDown}),o>0&&t()},1e3)}()}},setShareTitle:function(){if(this.data.goodsInfo&&this.data.goodsInfo.minGroupPrice&&this.data.goodsInfo.goodsName)if(this.lotteryInfo&&this.lotteryInfo.luckyEndTime){var e=parseInt(Date.now()/1e3,10),o=1e3*(this.lotteryInfo.luckyEndTime-e-this.deltaTime),a=r.TimeUtil.getPackagedTimeFromTimeBucket(o);if(o<=0)return;var i="";a.days>1?this.data.groupJoinedTips.emphasis>0&&this.data.groupJoinedTips.emphasis<6&&(i="【仅剩"+this.data.groupJoinedTips.emphasis+"人】"):a.days>0?i="【最后"+a.days+"天】":a.hours>0?i="【最后"+a.hours+"小时】":a.minutes>0?i="【最后"+a.minutes+"分钟】":o>0&&(i="【最后1分钟】"),this.setData(t({},"shareInfo.shareTitle",i+(i?"":"【即将结束】")+"快来"+this.data.goodsInfo.minGroupPrice+"元拼"+this.data.goodsInfo.goodsName))}else this.data.goodsInfo&&this.data.goodsInfo.eventType===s.default.EventType.FREE_GROUP&&this.data.groupJoinedTips.emphasis>0?this.setData(t({},"shareInfo.shareTitle","【仅剩"+this.data.groupJoinedTips.emphasis+"名】快来"+this.data.goodsInfo.minGroupPrice+"元拼"+this.data.goodsInfo.goodsName)):this.data.goodsInfo&&this.setData(t({},"shareInfo.shareTitle","快来"+this.data.goodsInfo.minGroupPrice+"元拼"+this.data.goodsInfo.goodsName));else this.setData(t({},"shareInfo.shareTitle","【拼多多】快来一起超低价拼！"))},normalViewDataProcess:function(){this.processGroupStatusHint(),this.setLeftTimeCountdown(),this.processLocalGroupData()},processLocalGroupData:function(){var e=this,t=this.data,o=t.goodsInfo||{};if(parseInt(t.status,10)===s.default.GroupStatus.Success&&t.groupRole<=s.default.GroupRole.NotInGroup&&"local_group"!==this.$urlQueryObj.refer_page_element&&o.isOnSale){var a=r.DataUtil.formatByPos(u.default.localGroup,o.goodsId);r.Request.apiRequest("GET",a,null,!0).then(function(t){if(t.local_group&&r.DataUtil.isArray(t.local_group)){var s=parseInt(t.server_time,10),a=[];t.local_group.forEach(function(e){e=JSON.parse(e);var t={expireTime:parseInt(e.expire_time,10),nickname:e.nickname||"游客",avatar:e.avatar||r.ImageUtil.getCDNImgURL("base/logo.jpg"),groupOrderId:e.group_order_id,usersNum:parseInt(e.users_num,10)||1,requireNum:o.requireNum||o.groupTypes[1].requireNum};t.remaindNum=t.requireNum-t.usersNum,a.push(t)}),e.localGroupDeltaTime=s-parseInt(Date.now()/1e3,10),a.length>0&&e.setLocalGroupCountdown(!0,a)}},function(){})}},successViewDataProcess:function(){var e="",t=this.data.successViceDesc;e=r.TimeUtil.formatTime(new Date(1e3*this.data.successTime),"yyyy-MM-dd hh:mm"),(this.data.hasLotteryRule||this.data.goodsInfo.eventType===s.default.EventType.CAPITAL_GIFT)&&(t=e+"凑足"+this.data.joinNum+"人",this.data.currentUser.uid===this.data.leader.uid&&this.data.goodsInfo.eventType===s.default.EventType.CAPITAL_GIFT&&(t="商家将尽快发货给好友，请耐心等待"));var o="",a="";this.data.currentUser&&(o=[this.data.currentUser.province_name,this.data.currentUser.city_name,this.data.currentUser.district_name,this.data.currentUser.shipping_address].join(""),a=[this.data.currentUser.province_name,this.data.currentUser.city_name,this.data.currentUser.district_name,"..."].join("")),this.setData({successViceDesc:t,curUserAddress:o,curUserAddressSec:a,successTimeStr:e})},noStoreViewDataProcess:function(){var e="他们拼团成功了，将安排发货";switch(this.data.groupState){case s.default.GroupStatus.OnGoing:e="别人拼团中";break;case s.default.GroupStatus.Failed:e="别人拼团失败"}this.setData({noStoreGroupStatusTip:e})},hideLotteryRulesPopup:function(){this.setData({lotteryRulesPopupVisible:!1})},showLotteryRule:function(){this.data.lotteryRule?this.setData({lotteryRulesPopupVisible:!0}):this.loadLotteryRule(!0)},setupLotteryRuleData:function(e,t,o){var s=r.ActivityUtils.getLotteryRules(e,t);this.setData({lotteryRule:s,lotteryRulesPopupVisible:!!o})},loadLotteryRule:function(e){var t=this,s=this,a=this.data.goodsInfo||{};e&&this.setData({loadingVisible:!0});var i=function(){e&&s.setData({loadingVisible:!1})},n=r.Request.requestDataWithUrl("GET",u.default.luckyDraw+a.goodsId);r.Request.runSecondaryRequestForPage(n,this).then(function(s){if(i(),s.name){var a=void 0;(t.data.isFreeTrial||t.data.isDepositeGroup)&&(a=o.Rules.FreeTrial),a&&(a=r.ObjectUtil.assign({},a)),s.rule=a,t.setupLotteryRuleData(s,a,e)}else t.$showToast("该商品暂无抽奖规则")},function(){i(),t.$showToast("该商品暂无抽奖规则")})},goHomePage:function(e){this.$switchTab("index"),(0,r.TrackingRecord)({op:"impr",event:"group_success_btn_clk",page_name:"group_detail",page_element:"return_index"}),this.$uploadFormId(e)},goLotteryPage:function(e){r.Navigation.route("/pages/subject/subject?subject_id=2742"),this.$uploadFormId(e);var t=this.getTrackingParams("click","main","going_draw");(0,r.TrackingRecord)(t)},gotoGoodsDetail:function(e){var t=e.currentTarget.dataset,o=t.goodsId,s=t.index,a=t.eventType;if(null!=o){var i=e.currentTarget.dataset.goodsItem;this.transGoodsData=i,this.$forward("goods",{goods_id:o})}var n={rec_goods_id:o,rec_event_type:a,idx:s},u=this.getTrackingParams("click","rec_list","goods",n);(0,r.TrackingRecord)(u)},viewGoodsDetail:function(e){var t=this.data,o=t.goodsInfo,a=t.isNewUserGroup,i=t.isNewUser,n=void 0;if(this.$deleteShareInfo(),parseInt(t.status,10)!==s.default.GroupStatus.OnGoing||a&&!i)n=a&&!i?{goods_id:o.goodsId}:{goods_id:o.goodsId,status:t.status,group_role:t.groupRole};else{var u=this.$urlQueryObj||{},d={goods_id:o.goodsId,status:t.status,group_role:t.groupRole,group_order_id:t.groupOrderId};n=u=r.ObjectUtil.assign(u,d)}n&&this.$forward("goods",n);var l=this.getTrackingParams("click","main","goods");(0,r.TrackingRecord)(l)},processGroupStatusHint:function(){var e="",t="",r=!1,o=this.data.groupsStatusClass;switch(this.data.groupState){case s.default.GroupStatus.OnGoing:t="一键参团",this.data.goodsInfo.eventType!==s.default.EventType.LUCKY_DRAW&&this.data.goodsInfo.eventType!==s.default.EventType.FREE_TRIAL||(t="参与活动"),this.data.goodsInfo.eventType===s.default.EventType.CAPITAL_GIFT&&(t="立即领取"),o=this.data.groupsStatusClass+" ongoing",r=!0;break;case s.default.GroupStatus.Success:e="团已满",t="我来开这个团",this.openNewGroup=!0,this.data.goodsInfo.eventType!==s.default.EventType.LUCKY_DRAW&&this.data.goodsInfo.eventType!==s.default.EventType.CAPITAL_GIFT||(e=""),o=this.data.groupsStatusClass+" success";break;case s.default.GroupStatus.Failed:this.openNewGroup=!0,e="拼团不成功，款项将原路返还",this.data.goodsInfo.eventType!=s.default.EventType.LUCKY_DRAW&&this.data.goodsInfo.eventType!=s.default.EventType.FREE_TRIAL&&(t=this.data.groupRole===s.default.GroupRole.NotInGroup?"我来开这个团":"再次一键开团"),(this.data.isFreeTrial||this.data.isDepositeGroup)&&(e="拼团不成功"),o=this.data.groupsStatusClass+" failed"}6==this.data.eventType&&(t="新人一键参团"),this.setData({showLeftUserTips:r,groupButtonText:t,groupStatusTips:e,groupsStatusClass:o})},initPageData:function(){this.initalDataObj?this.setData(this.initalDataObj):this.initalDataObj=JSON.parse(JSON.stringify(this.data)),this.recOffset=0,this.lowerLock=!1,this.recGoodsManager=null,this.groupDispatchIds={}},onHide:function(){i.default.close(this),this.clearGroupCountDown()},clearGroupCountDown:function(){null!=this.countDown&&clearTimeout(this.countDown),null!=this.localGroupCountdown&&clearTimeout(this.localGroupCountdown),this.countDown=null,this.localGroupCountdown=null},onUnload:function(){g.default.isLastPagePayPage=!1,g.default.showNotEnoughGroupDialog=!0,g.default.isLastPageGroupPage=!0,this.clearGroupCountDown(),i.default.close(this)},pvTracking:function(){var e={op:"pv",page_name:"group_detail",group_order_id:this.$urlQueryObj.group_order_id,goods_id:this.$urlQueryObj.goods_id,event_type:this.$urlQueryObj.event_type};(0,r.TrackingRecord)(e),this.$firstTimeTrackRecord.pv=!0},getTrackingParams:function(e,t,o,s){var a=this.data.goodsInfo||{},i={op:e,page_name:"group_detail",page_section:t,page_element:o,goods_id:a.goodsId,event_type:a.eventType,group_order_id:this.data.groupOrderId,group_status:this.data.status,group_role:this.data.groupRole,sold_out:this.data.soldOutStr};return s&&(i=r.ObjectUtil.assign(i,s)),i},imprTracking:function(){if(!g.default.isFromAppOnShow||!this.$firstTimeTrackRecord.impr){var e=this.data.goodsInfo||{},t={has_local_group:0,has_audio:this.data.audioInfo?"1":"0",goods_type:e.goodsType,goods_price:this.minOnsaleGroupPrice},o=this.getTrackingParams("impr","main",null,t);(0,r.TrackingRecord)(o),this.$firstTimeTrackRecord.impr=!0}},groupDetailNavClickRecord:function(e){var t=e.detail.target.dataset;if(t){var o=t.pageElement,s=t.route;s.match(/index/)?r.Navigation.route(s,"switchTab"):r.Navigation.route(s);var a=this.getTrackingParams("click","icon_list",o);(0,r.TrackingRecord)(a)}this.$uploadFormId(e)},componentsAddRootFunc:function(e,t){e&&"function"==typeof t&&(this[e]=t)},onLoad:function(e){this.pvTracking();g.default.lastGroupOrderId=e.group_order_id,e&&this.$urlQueryObj.goods_id&&(g.default.lastOrderGoodsId=this.$urlQueryObj.goods_id),this.loadPage();var t=r.ObjectUtil.assign(_.default.initSkuStatus,{winWidth:r.SystemInfo.getWindowWidthSync(),winHeight:r.SystemInfo.getWindowHeightSync()});this.setData(t),this.data.shareHintMaskVisible&&this.$showToast(this.data.shareHintText)},ABTest:function(e,t){if(!e)return!0;if(e.eventType!=s.default.EventType.LUCKY_DRAW&&e.eventType!=s.default.EventType.FREE_TRIAL)return!0;var r=function(e){var t=e.length;return(e+"").substring(t-1,t)}(this.$urlQueryObj.group_order_id);for(var o in t)if(r==t[o])return!1;return!0},showHintToast:function(){var e=this;wx.setClipboardData&&wx.getClipboardData&&wx.setClipboardData({data:"拼多多",success:function(t){e.setData({hideHintToast:!1}),setTimeout(function(){e.setData({hideHintToast:!0})},3e3)}})},stopDetailMove:function(){}};(0,r.PddPage)(G,{pageName:"group",notUseCommonPV:!0}); 
 			}); 	require("pages/group/group.js");
 		__wxRoute = 'pages/goods/goods';__wxRouteBegin = true; 	define("pages/goods/goods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}e(require("../../components/toast/toast.js"));var o=e(require("../../controller/goods_bottom_bar")),a=e(require("../../components/goods_bottom_bar/goods_bottom_bar.js")),r=e(require("../../constants/share_info")),s=e(require("./play_rules")),i=e(require("../../constants/groups")),n=e(require("./goods_icons")),u=e(require("../../components/bubble/bubble")),d=e(require("../../configs/request_errors")),l=e(require("./cache_goods_data")),c=e(require("./goods_util")),p=(e(require("../../constants/tracking/goods")),e(require("../../constants/goods"))),h=e(require("../../configs/api")),g=(e(require("../../storage/user_storage.js")),e(require("../../common/navigation"))),f=e(require("../../storage/ram_manager")),m=require("../../common/message"),v=e(require("../../common/buy_util")),_=e(require("../../common/preload")),T=e(require("../../models/format/luck_draw")),k=e(require("../../models/format/v2_goods_detail")),I=e(require("../../models/format/mall_info")),b=e(require("../../models/group_proxy")),D=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),w=e(require("../../libs/regenerator-runtime/runtime")),y=e(require("../../components/sku_selector/sku_selector_v2")),S=e(require("../../constants/storage_keys")),C=e(require("../../common/gotop_util")),G=e(require("../../components/screen_shot_share/screen_shot_share")),P=e(require("../../controller/formid_controller")),L=e(require("../../models/format/grid_item_goods")),R=(e(require("../../common/logger_util")),e(require("../../common/scene_route"))),M=e(require("../../components/share_action_sheet/share_action_sheet")),x=require("../../common/index"),q=(require("../../constants/share"),e(require("../../configs/app_config"))),O=d.default.couponErrorHint,B={referPageElement:null,cacheBottomId:null,maxRecommendGoodsNum:100,goodsBottomBarData:null,toast:null,dispatchIds:{},localGroupModule:null,skuSelectorModule:null,hasSkuSelector:!1,goodsBottomBar:null,localGroupCountdown:null,current:0,recOffset:0,recCount:20,lowerLock:!1,longPressLock:!1,mallId:0,recommendGoodsCache:[],onShareAppMessage:function(e){var t=this.data.goodsInfo||{},o=x.ObjectUtil.assign({},this.$urlQueryObj,{mall_id:null,group_order_id:null,wt_id:null,status:null,group_role:null,like_flag:null,from:null,goods_id:t.goodsId,goods_type:t.goodsType,event_type:t.eventType,goods_price:this.data.minOnsaleGroupPrice}),a="";if(e)if("menu"==e.from)a="top_forward";else{var s=e.target.dataset.subRefer;"goods-share-btn"==s?a="goods_detail_share":"screen-shot"==s?a="screen_shot_share":"actionSheetTap"==s&&(a="pic_clk_share")}return this.$generateShareContent({title:t.groupTypes?(t.useOnSalePrice?t.minOnsaleGroupPrice:t.minGroupPrice)+"元"+t.goodsName:r.default.DefaultTitle,queries:o,referStr:a})},clickShareBtn:function(){var e=this.getClickTrackingParams("main","share_btn");(0,x.TrackingRecord)(e)},data:{goTopClass:!1,pageName:"goods",showNormalSalesElement:!1,loadingVisible:!0,visible:!1,goodsIcons:[],selectedGroup:null,topGalleryIndex:1,mallRecommendList:[],recommendList:[],loadRecommendComplete:!1,loadingMoreVisible:!1,loadingMoreText:"正在加载中...",mallInfo:null,firstEnter:!0,bottomBarVisible:!1,needLoadBg:!1,serviceDetailVisible:!1,serviceMainClass:"service-detail-hidden",couponsDetailVisible:!1,couponsMainClass:"coupons-detail-hidden",mallCouponToastData:{receiveSuccess:!1,toastVisible:!1,mainToast:"",subToast:""},reviews:{},groupWindowVisible:!1,isShowContent:!1,isShowTitle:!0,shareIconUrl:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/goods/share_icon_new%402x.png",shareMainClass:"screen-share-main screen-share-main-hide",canShowShare:!0,showError:!1,startTimeDesc:"",endTimeDesc:"",pickNum:""},toIndexPage:function(e){this.$switchTab("index");var t=this.getClickTrackingParams("bottom_bar","return_index");t.has_local_group=this.data.goodsInfo.hasLocalGroup?"1":"0",(0,x.TrackingRecord)(t),this.$uploadFormId(e)},onCustomServiceClicked:function(e){if(this.mallId){var t={goodsId:this.data.goodsInfo.goodsId,goodsName:this.data.goodsInfo.goodsName,customerNum:this.data.goodsInfo.groupTypes[1].requireNum,src:this.data.goodsInfo.thumbUrl,groupPrice:this.data.goodsInfo.minOnsaleGroupPrice},o="/pages/custom_service/custom_service?mall_id="+this.mallId;o=o+"&"+x.UrlUtil.buildQuery(t),g.default.forward(o);var a=this.getClickTrackingParams("bottom_bar","customer_service");a.has_local_group=this.data.goodsInfo.hasLocalGroup,(0,x.TrackingRecord)(a)}this.$uploadFormId(e,!1)},shopAround:function(e){this.$uploadFormId(e)},defaultClick:function(){},pvTracking:function(){var e={op:"pv",page_name:"goods_detail",goods_id:this.$urlQueryObj.goods_id};this.$urlQueryObj.event_type&&(e.event_type=this.$urlQueryObj.event_type),(0,x.TrackingRecord)(e),this.$firstTimeTrackRecord.pv=!0},getImprTrackingParams:function(e){var t=this.data.goodsInfo;return{op:"impr",page_name:"goods_detail",page_section:e,goods_id:t.goodsId,event_type:t.eventType}},getClickTrackingParams:function(e,t){var o={op:"click",page_name:"goods_detail",page_section:e,goods_id:this.$urlQueryObj.goods_id,page_element:t},a=this.data.goodsInfo||{};return o.event_type=a.eventType,a.skus&&(o.sku_num=a.skus.length),o},imprTracking:function(){if(!f.default.isFromAppOnShow&&!this.$firstTimeTrackRecord.impr){var e=this.data.goodsInfo;(0,x.TrackingRecord)({op:"impr",page_section:"main",page_name:"goods_detail",goods_id:e.goodsId,goods_type:e.goodsType,event_type:e.eventType,goods_price:this.data.minOnsaleGroupPrice,has_local_group:e.hasLocalGroup?"1":"0"}),this.$firstTimeTrackRecord.impr=!0}},showGroupModel:function(e){this.setData({groupWindowVisible:!0});var t=this.getClickTrackingParams("local_group","more");(0,x.TrackingRecord)(t)},hideGroupModule:function(){this.setData({groupWindowVisible:!1})},preLoadGoodsPage:function(){var e=getCurrentPages(),t=void 0;if(e.length>1&&(t=e[e.length-2]),t&&t.transGoodsData){var o=t.transGoodsData;if(o&&o.goodsId==this.$urlQueryObj.goods_id){var a="--";o.preMarketPrice&&o.preGroupPrice&&(a=x.StdFormat.price(o.preMarketPrice-o.preGroupPrice,100));var r=null!=o.preGroupPrice?x.StdFormat.price(o.preGroupPrice,100):"--.--",s=null!=o.preSinglePrice?x.StdFormat.price(o.preSinglePrice,100):"--.--",i=null!=o.preMarketPrice?x.StdFormat.price(o.preMarketPrice,100):"--.--";this.setData({visible:!0,needLoadBg:!0,goodsInfo:{preGroupPrice:r,preSinglePrice:s,preMarketPrice:i,goodsName:o.goodsName||"",customerNum:o.customerNum||"--",deltaPrice:a,isShowBanner:!0,bannerHeight:375}})}}},onPageScroll:function(e){if(e){var t=parseInt(e.scrollTop);C.default.showGoTopBtn(t,this)}},goTop:function(e){C.default.goTop(!0);var t=this.getClickTrackingParams("pop_list","top_btn");(0,x.TrackingRecord)(t)},gotoGoodsDetail:function(e){var t=this.data.goodsInfo,o=e.currentTarget.dataset;if(o){var a=o.goodsId;if(a){this.$forward("goods",{goods_id:a});var r=o.isMallRec,s=parseInt(o.index,10),i=e.currentTarget.dataset.goodsItem;this.transGoodsData=i;var n=r?"mall_rec_list":"rec_list",u=this.getClickTrackingParams(n,"goods");u.idx=s,u.rec_goods_id=a,u.rec_event_type=t.eventType,(0,x.TrackingRecord)(u)}}},navigationToMallPage:function(e){if(this.data.mallInfo.mallId){var t=this.data.mallInfo.mallId;this.data.mallInfo&&(this.transGoodsData=this.data.mallInfo,this.$forward("mall_page",{mall_id:t}))}var o=this.getClickTrackingParams("mall","go_mall_btn");(0,x.TrackingRecord)(o)},navigationToGoodsComments:function(e){var t=this.$urlQueryObj.goods_id;l.default.clearCacheData(),this.cacheBottomId=l.default.setDataToCache(t,{bottomBarData:this.data.bottomBarData,barDataNeededFromPage:c.default.getBarDataNeededFromPage()});var o=e.currentTarget.dataset.id?e.currentTarget.dataset.id:-1,a=this.data.goodsInfo;if(this.data.goodsInfo.goodsId){var r=this.data.goodsInfo.goodsId;this.$forward("goods_comments",{goods_id:r,tap_id:o,group_order_id:this.$urlQueryObj.group_order_id,cache_bottom_id:this.cacheBottomId,mall_id:this.mallId});var s=this.getClickTrackingParams("comment","comment_btn");s.has_local_group=a.hasLocalGroup,(0,x.TrackingRecord)(s)}e&&e.detail&&e.detail.formId&&P.default.uploadFormIdToSH(e.detail.formId,!0)},initPageData:function(){this.initialDataObj?this.setData(this.initialDataObj):this.initialDataObj=JSON.parse(JSON.stringify(this.data)),this.recOffset=0,this.lowerLock=!1},topGalleryChange:function(e){var t=e.detail.current;this.setData({topGalleryIndex:parseInt(t)+1})},processGoodsDetail:function(e,o){wx.stopPullDownRefresh();var a=this;if(e)if(e.errorCode)this.$showToast(e.errorMsg);else{if(!e.groupTypes||e.groupTypes.length<2)return this.$showToast("活动已经结束了"),void setTimeout(function(){a.$back()},1e3);o.sku&&o.sku.length>1&&(this.hasSkuSelector=!0);var r=n.default.getGoodsIconsData(e),i=s.default.getPlayRules(e);this.setData({minOnsaleGroupPrice:o.min_on_sale_group_price,goodsInfo:e,playRulesData:i,goodsIcons:r,loadingVisible:!1,visible:!0,showNormalSalesElement:e.isOnSale&&!e.isLottery&&!e.isFreeTrial&&!e.isDepositeGroup&&!e.isCapitalGift&&!e.isCapitalGiftLottery});var u=!0;e.luckyId&&(e.isLottery||e.isFreeTrial||e.isCapitalGiftLottery)&&(u=!1),e.isGroupFree&&x.User.hasLogin()&&(u=!1),u&&a.setBottomBar(o),e.spikeLeftTime>0&&e.spikeStart&&!e.spikeOver&&(this.spikeLeftTimeInterval&&clearInterval(this.spikeLeftTimeInterval),this.spikeLeftTimeInterval=setInterval(function(){a.data.goodsInfo.spikeLeftTime-=1e3;var e=a.data.goodsInfo.spikeLeftTime>0?x.TimeUtil.getPackagedTimeFromTimeBucket(a.data.goodsInfo.spikeLeftTime,"HMS"):null;a.setData(t({},"goodsInfo.spikePackagedTime",e))},1e3))}},showServiceDetail:function(e){var t=this;this.data.goodsInfo;this.setData({serviceDetailVisible:!0}),setTimeout(function(){t.setData({serviceMainClass:"service-detail-show"})},100);var o=this.getClickTrackingParams("main","ser_promise_bt");(0,x.TrackingRecord)(o)},hideServiceDetail:function(){var e=this;this.setData({serviceMainClass:"service-detail-hidden"}),setTimeout(function(){e.setData({serviceDetailVisible:!1})},200)},showCouponsDetail:function(e){var t=this;this.setData({couponsDetailVisible:!0}),setTimeout(function(){t.setData({couponsMainClass:"coupons-detail-show"})},100),this.$uploadFormId(e,!1)},hideCouponsDetail:function(){var e=this;this.setData({couponsMainClass:"coupons-detail-hidden"}),setTimeout(function(){e.setData({couponsDetailVisible:!1})},200)},couponTostShow:function(e,t){var o=this,a={};a.single=!t,a.toastVisible=!0,a.mainToast=e,a.subToast=t,this.setData({mallCouponToastData:a}),setTimeout(function(){o.setData({"mallCouponToastData.toastVisible":!1})},1500)},getCouponTracking:function(e,t,o){var a=this.getClickTrackingParams("main","coupon");a.batch_id=o,a.idx=e,a.is_success=t,(0,x.TrackingRecord)(a)},getCoupon:function(e){var t=e.detail.target.dataset||{},o=t.item,a=t.index;if(o.receiveBtnEnable&&!this.gettingCoupon){var r=this,s={mall_id:o.mallId,batch_id:o.batchId},i=o.startTime+"-"+o.endTime+"可用";this.gettingCoupon=!0,(0,D.default)(w.default.mark(function e(){var t,n;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=x.Request.requestDataWithUrl("POST","take_merchant_coupon",s),e.next=4,x.Request.runMainRequestForPage(t,this);case 4:(n=e.sent)&&n.error_code?(r.handleGetCouponError(r,n,o,a),r.getCouponTracking(a,0,o.batchId)):(r.couponTostShow(O.success,i),r.getCouponTracking(a,1,o.batchId)),r.gettingCoupon=!1,e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.t0&&e.t0.error_code&&(r.handleGetCouponError(r,e.t0,o,a),r.getCouponTracking(a,0,o.batchId)),r.gettingCoupon=!1;case 14:case"end":return e.stop()}},e,this,[[0,9]])}))}else this.getCouponTracking(a,0,o.batchId);this.$uploadFormId(e,!1)},handleGetCouponError:function(e,t,o,a){var r=void 0;if(t&&(r=O[t.error_code]),r){var s=r.split("，");s.length>1?e.couponTostShow(s[0],s[1]):e.couponTostShow(r)}else e.couponTostShow(O.fail);var i=e.data.mallCoupons;i[a].receiveBtnEnable=!1,t&&44025===t.error_code?i[a].receiveBtnText="已领取":t&&t.error_code===d.default.CouponTakenOut.code&&(i[a].receiveBtnText="已抢光"),e.setData({mallCoupons:i})},checkMerchantCoupon:D.default.wrap(w.default.mark(function e(t,o){var a,r,s;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=x.Request.requestDataWithUrl("GET",h.default.checkMerchantCoupon,{mall_id:t,check_merchant_coupon:"no"},!1),e.next=4,x.Request.runSecondaryRequestForPage(a,o);case 4:return r=e.sent,(s=I.default.formatMallCouponData(r)).forEach(function(e,t){e.canTakenCount>0?(e.receiveBtnEnable=!0,e.receiveBtnText="领取"):(e.receiveBtnEnable=!1,e.receiveBtnText="已领取"),e.takenOut||(o.showCouponArea=!0)}),this.setData({mallCoupons:s,showCouponArea:o.showCouponArea}),e.abrupt("return",r);case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])})),getMallDetail:D.default.wrap(w.default.mark(function e(t,o){var a,r,s,i,n;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=o.data.goodsInfo,r=x.DataUtil.formatByPos(h.default.mallInfo,t),s=x.Request.requestDataWithUrl("GET",r,{check_merchant_coupon:"no"},!0),e.next=6,x.Request.runSecondaryRequestForPage(s,o);case 6:return i=e.sent,n=I.default.formatData(i),o.processMallInfo(n),e.abrupt("return",n);case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])})),getLocalGroupsDetail:D.default.wrap(w.default.mark(function e(t,o){var a,r,s,i,n,u,d,l,c,p;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=t.groupTypes.length,2!=t.groupTypes[a-1].requireNum||!t.isOnSale||(t.isSpike||t.isSuperSpike)&&t.eventComing){e.next=17;break}return r=x.DataUtil.formatByPos(h.default.v2LocalGroup,t.goodsId),s=x.Request.requestDataWithUrl("GET",r,null,!0),e.next=7,x.Request.runSecondaryRequestForPage(s,o);case 7:if(i=e.sent,n=b.default.receiveLocalGroupData(i.local_group,i.server_time,i.total),o.processLocalGroupInfo(n),u=void 0,(d=n.localGroups||[]).length>0){l="";for(c in d)p=d[c].groupOrderId,l+=p+","}return o.imprTracking(),e.abrupt("return",n);case 17:return o.imprTracking(),e.abrupt("return",{});case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.error(e.t0);case 24:case"end":return e.stop()}},e,this,[[0,21]])})),processLocalGroupInfo:function(e){if(e)if(e.errorCode)this.$showToast(e.errorMsg);else{var t=void 0,o=this.data.goodsInfo;o&&o.groupTypes&&(t=parseInt(o.groupTypes[1].requireNum)),isNaN(t)||!o.isOnSale||e.localGroups.length<=0||(this.setData({"goodsInfo.hasLocalGroup":e.localGroups&&e.localGroups.length>0,localGroups:e.localGroups||[],requireNum:t,serverTime:e.serverTime||0,totalNum:e.total||0}),this.setupLocalGroup())}},showDesc:function(){this.setData({isShowTitle:!1,isShowContent:!0})},onReachBottom:function(){var e=this,t=this.data.goodsInfo;this.lowerLock||this.data.loadRecommendComplete||(0,D.default)(w.default.mark(function o(){var a;return w.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,e.getRecommendGoodsDetail(t,e);case 3:a=o.sent,o.next=9;break;case 6:o.prev=6,o.t0=o.catch(0),console.error(o.t0);case 9:case"end":return o.stop()}},o,this,[[0,6]])}))},getRecommendGoodsDetail:D.default.wrap(w.default.mark(function e(t,o){var a,r,s,i,n,u;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=t.goodsId,r=o.$urlQueryObj.hide_rec,!o.lowerLock&&a&&"true"!=r){e.next=5;break}return e.abrupt("return");case 5:return o.setData({loadingMoreVisible:!0}),o.lowerLock=!0,s={showMallRecommend:t.showMallRecommend,deleteAllGoods:0===o.recOffset},i=h.default.getRecommendGoodsData+"?"+x.UrlUtil.buildQuery({goods_id:a,referrer:"goods",with_mall_rec:t.showMallRecommend?"1":null,page_type:null,offset:o.recOffset||0,count:o.recCount||20}),n=x.Request.requestDataWithUrl("GET",i,null,!0),e.next=12,x.Request.runSecondaryRequestForPage(n,o);case 12:u=e.sent,o.processRecommendGoods(u,s),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0);case 19:case"end":return e.stop()}},e,this,[[0,16]])})),processRecommendGoods:function(e,t){var o=this;if(this.lowerLock=!1,e)if(e.errorCode)this.$showToast(e.errorMsg);else if(!this.data.showError){var a=Array.isArray(e.list)?e.list:[],r=a.length<=0;t.deleteAllGoods&&(this.recommendGoodsCache=[]),a.forEach(function(e){o.recommendGoodsCache.push(L.default.formatData(e))});var s=this.recommendGoodsCache,i=[],n=[];t.showMallRecommend?(i=s.slice(0,3),n=s.slice(3)):n=s;var u=(n=x.DataUtil.objectArrayDuplicateRemove(n,"goodsId",function(e){return 1==e.isApp})).length>=this.maxRecommendGoodsNum||r;n=n.slice(0,this.maxRecommendGoodsNum),0===this.recOffset&&i.length>0?this.setData({loadRecommendComplete:u,mallRecommendList:i,recommendList:n}):this.setData({loadRecommendComplete:u,recommendList:n}),this.recOffset+=this.recCount}},setupLocalGroup:function(){var e=this,t=function(t){var o=[],a=null,r=e.data.localGroups||[];r.map(function(r){null==r.deltaMillisecond&&(r.deltaMillisecond=Math.max(1e3*(parseInt(r.expireTime)-e.data.serverTime),0)),!t&&r.deltaMillisecond>=1e3&&(r.deltaMillisecond-=1e3);var s=x.TimeUtil.transferToTime(r.deltaMillisecond);return r.leftTimeStr="",parseInt(s.days)>0&&(r.leftTimeStr=s.days+"天:"),r.leftTimeStr=s,r.deltaMillisecond>0&&r.deltaMillisecond<=216e5&&(e.data.minLeftTimeLocalGroup&&r.groupOrderId==e.data.minLeftTimeLocalGroup.groupOrderId&&(a=r),o.push(r)),r});var s=[];if(1==r.length)s=[[r[0]]];else if(r.length>0&&r.length<6)s.push([r[0],r[1]]);else for(var i=0;i<Math.floor(r.length/2);i++){var n=[];n.push(r[2*i]),n.push(r[2*i+1]),s.push(n)}if(!a&&o.length>0&&(o.length>5?a=o[Math.floor(Math.random()*o.length)]:(o.sort(function(e,t){return e.deltaMillisecond&&t.deltaMillisecond?e.deltaMillisecond-t.deltaMillisecond:0}),a=o[0])),a&&!e.data.minLeftTimeLocalGroup){var u=e.data.goodsInfo;(0,x.TrackingRecord)({op:"impr",page_name:"goods_detail",page_section:"expiring_group_prompt",goods_id:u.goodsId,event_type:u.eventType,group_order_id:e.$urlQueryObj.group_order_id,page_el_sn:99503,page_sn:10014})}e.setData({localGroups:r,localGroupsSwiperItems:s||[],minLeftTimeLocalGroup:a,refreshCountDown:!e.data.refreshCountDown}),(1==s.length&&(-1!=e.data.transitionIndex||0!=e.data.swiperCurrent)||e.current>=s.length)&&(e.setData({transitionIndex:-1,swiperCurrent:0}),e.current=0)};t(!0),null!=this.localGroupCountdown&&clearTimeout(this.localGroupCountdown);!function o(){e.localGroupCountdown=setTimeout(function(){t(),o()},1e3)}()},localGroupClick:function(e){var t=e.currentTarget.dataset,o=void 0,a=this.$urlQueryObj.goods_id;if(l.default.clearCacheData(),this.cacheBottomId=l.default.setDataToCache(a,{bottomBarData:this.data.bottomBarData,barDataNeededFromPage:c.default.getBarDataNeededFromPage()}),t&&t.groupOrderId)o=t.groupOrderId;else if(t&&this.data.localGroupsSwiperItems&&this.data.localGroupsSwiperItems[this.current]){var r=t.index;o=this.data.localGroupsSwiperItems[this.current][r].groupOrderId}this.data.goodsInfo;if(o){this.hideGroupModule(),this.hasSkuSelector?this.showSkuSelector(o):y.default.confirmOrder({localGroupOrderId:o});var s=void 0;"bottom"===t.refer?((s=this.getClickTrackingParams("expiring_group_prompt",null)).page_el_sn=99503,s.page_sn=10014):s="list"===t.refer?this.getClickTrackingParams("local_group_popup","join_btn"):this.getClickTrackingParams("local_group","join_btn"),s.group_order_id=o,(0,x.TrackingRecord)(s)}},swiperChange:function(e){if(e.detail){this.current=e.detail.current;var t=this.current>0?this.current-1:this.data.localGroupsSwiperItems.length-1;this.setData({transitionIndex:t})}},processMallInfo:function(e){e&&(e.errorCode?this.$showToast(e.errorMsg):(this.setData({mallInfo:e}),this.mallId=e.mallId))},getFreeCouponsDetail:D.default.wrap(w.default.mark(function e(t,o){var a,r,s,i,n;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=t.goodsId,r=x.DataUtil.formatByPos(h.default.freeCoupons,a),!t.isGroupFree||!x.User.hasLogin()){e.next=13;break}return s=x.Request.requestDataWithUrl("GET",r),e.next=7,x.Request.runSecondaryRequestForPage(s,o);case 7:return i=e.sent,n=i.free_coupon||[],o.processFreeCouponsInfo(n),e.abrupt("return",n);case 13:return e.abrupt("return",{});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0);case 19:case"end":return e.stop()}},e,this,[[0,16]])})),processFreeCouponsInfo:function(e){e.errorCode&&this.$showToast(e.errorMsg),!e.errorCode&&e.length>0&&this.setData({"goodsInfo.freeCoupon":e}),this.setBottomBar()},goLotteryList:function(e){c.default.goLotteryList()},goDrawLuckyList:function(e){c.default.goDrawLuckyList();var t=e.currentTarget.dataset.refer;if(t&&"hint"===t){var o=this.getClickTrackingParams("overdue_popup","going_draw");(0,x.TrackingRecord)(o)}else{var a=this.getClickTrackingParams("icon_list","going_draw");(0,x.TrackingRecord)(a)}},selectSpec:y.default.selectSpec,preloadSkuImgLoaded:y.default.preloadSkuImgLoaded,updateGoodsNumber:y.default.updateGoodsNumber,goodsNumberFocus:y.default.goodsNumberFocus,goodsNumberBlur:y.default.goodsNumberBlur,goodsNumberChange:y.default.goodsNumberChange,hideSkuSelector:y.default.hideSkuSelector,skuContainerDefaultClick:y.default.skuContainerDefaultClick,viewSkuImage:y.default.viewSkuImage,confirmSku:y.default.confirmSku,getPriceRange:v.default.getPriceRange,showSkuSelector:v.default.showSkuSelector,groupBuy:v.default.groupBuy,singleBuy:v.default.singleBuy,groupBuyOrPromptShare:v.default.groupBuyOrPromptShare,spikeRemind:function(e){var t=this.getClickTrackingParams("bottom_bar","spike_remind");t.has_local_group=this.data.goodsInfo.hasLocalGroup?"1":"0",(0,x.TrackingRecord)(t);var o=this;if(o.data.goodsInfo.reminded)o.$showToast("已设提醒，开抢前3分钟自动提醒，请您留意微信消息。邀请好友一起抢购，更快成团哦");else if(!o.uploading&&e&&e.detail&&e.detail.formId){var a=0;this.data.goodsInfo&&this.data.goodsInfo.groupTypes&&this.data.goodsInfo.groupTypes[1]&&(a=this.data.goodsInfo.groupTypes[1].startTime);var r=(x.User.getUserLocalInfo()||{}).nickName,s={scene:P.default.scene.spikeRemind,form_id:e.detail.formId,template_info:{nick_name:r,goods_id:this.data.goodsInfo.goodsId,goods_name:this.data.goodsInfo.goodsName,original_price:x.DataUtil.accMul(this.data.goodsInfo.marketPrice,100),discount_price:x.DataUtil.accMul(this.data.goodsInfo.minGroupPrice,100),start_time:x.DataUtil.accMul(a,1e3)}};o.uploading=!0,P.default.upload(s,function(e){o.uploading=!1,!0===e.data||!0===e.success?(o.$showToast("已设提醒，开抢前3分钟自动提醒，请您留意微信消息。邀请好友一起抢购，更快成团哦"),o.setReminded(o),m.Message.emit(m.KEYS.WAIT_FOR_SPIKE_SHOW,o.data.goodsInfo.goodsId)):o.$showToast("设置失败，请稍后重试")},function(){o.uploading=!1,o.$showToast("设置失败，请稍后重试")})}},setReminded:function(e){e.data.goodsInfo.reminded=!0;var t=(0,o.default)(e.data.goodsInfo,e.$urlQueryObj);t.hasLiked=f.default.likeGoodsIds[e.$urlQueryObj.goods_id],e.goodsBottomBarData=t,e.goodsBottomBar.load(t,e.data.goodsInfo,e),f.default.spikeRemindGoodsIds.push(e.data.goodsInfo.goodsId.toString())},confirmClose:function(e){var t=this,o=t.data.bottomBarData;if(o.showLotteryConfirmModal=!1,t.setData({bottomBarData:o}),e){var a=this.getClickTrackingParams("overdue_popup","close_btn");(0,x.TrackingRecord)(a)}},preventTouchMove:function(){this.confirmClose()},setBottomBar:function(e){var t=this;this.data.goodsInfo.reminded=-1!=f.default.spikeRemindGoodsIds.indexOf(this.$urlQueryObj.goods_id);var r=(0,o.default)(this.data.goodsInfo,this.$urlQueryObj);this.goodsBottomBarData=r;var s=this.data.goodsInfo;if(this.goodsBottomBar||(this.goodsBottomBar=new a.default({showToast:this.$showToast,goodsId:this.$urlQueryObj.goods_id,setDataFunc:function(e){var o=t.data.bottomBarData||{},a=0;for(var r in e)e.hasOwnProperty(r)&&(o[r]=e[r]),++a;if(1==a&&e.hasOwnProperty("hasLiked")){var i=t.getClickTrackingParams("bottom_bar","like_btn");i.is_like=e.hasLiked?1:0,i.has_local_group=s.hasLocalGroup?"1":"0",(0,x.TrackingRecord)(i)}t.setData({bottomBarData:o})},addRootFunc:x.Util.bind(t.componentsAddRootFunc,t)})),this.goodsBottomBar&&(r.hasLiked=f.default.likeGoodsIds[this.$urlQueryObj.goods_id],this.goodsBottomBar.load(r,this.data.goodsInfo,this),this.setData({bottomBarVisible:!0})),r.showSkuSelector&&(this.data.goodsInfo.groupTypes&&this.data.goodsInfo.groupTypes[1]&&this.setData({selectedGroup:this.data.goodsInfo.groupTypes[1]}),e&&this.setSkus(this.data.goodsInfo,e,this),this.hasSkuSelector&&this.showSkuSelector()),t.data.bottomBarData.showLotteryConfirmModal){var i=this.getImprTrackingParams("overdue_popup");(0,x.TrackingRecord)(i)}},getLotteryDetail:D.default.wrap(w.default.mark(function e(t,o){var a,r,s,n,u,d,l;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=parseInt(t.eventType,10),r=t.goodsId,!t.luckyId||!(t.isLottery||t.isFreeTrial||t.isCapitalGiftLottery)){e.next=15;break}return s={goodsId:r,rulesKey:a===i.default.EventType.LUCKY_DRAW?"LuckyDraw":"FreeTrial"},n=h.default.luckyDraw+r,u=x.Request.requestDataWithUrl("GET",n),e.next=9,x.Request.runSecondaryRequestForPage(u,o);case 9:return d=e.sent,l=T.default.formatData(d,s),o.processLotteryData(l),e.abrupt("return",l);case 15:return e.abrupt("return",{});case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0);case 21:case"end":return e.stop()}},e,this,[[0,18]])})),processLotteryData:function(e){if(e.errorCode)return this.$showToast(e.errorMsg),void this.setBottomBar();var t=this.data.goodsInfo;e.info&&(t.luckyId=e.info.luckyId||t.luckyId,t.luckyStatus=e.info.luckyStatus||t.luckyStatus,t.luckyStartTime=e.info.luckyStartTime||t.luckyStartTime,t.luckyEndTime=e.info.luckyEndTime||t.luckyEndTime),t.eventComing=t.luckyStartTime>t.serverTime,this.setData({lotteryRules:e.rules,goodsInfo:t}),this.setBottomBar()},getReviewsDetail:D.default.wrap(w.default.mark(function e(t,o){var a,r,s,n,u;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=parseInt(t.eventType,10),!t.rv||a===i.default.EventType.LUCKY_DRAW){e.next=11;break}return r=h.default.reviews+t.goodsId,s={page:1,size:2,label:1},n=x.Request.requestDataWithUrl("GET",r,s,!0),e.next=8,x.Request.runSecondaryRequestForPage(n,o);case 8:return u=e.sent,o.processReviews(u),e.abrupt("return",u);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0);case 16:case"end":return e.stop()}},e,this,[[0,13]])})),processReviews:function(e){if(e&&e.labels){var t={};t.number=e.number,t.tagList=e.labels;var o=0,a=!1;t.detailList=e.data.map(function(e,t){return e.time=x.TimeUtil.formatTime(e.time,"yyyy.MM.dd"),e.specs=x.DataUtil.formatSpecs(e.specs),e}),t.tagList.forEach(function(e,t){e.positive&&o++}),o>=3&&(a=!0),t.isShow=a,this.setData({reviews:t})}},getGoodsDetail:D.default.wrap(w.default.mark(function e(t,o){var a,r,s,i;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=h.default.v2GoodsDetail+t,r=x.Request.requestDataWithUrl("GET",a,null,!0),e.next=5,x.Request.runMainRequestForPage(r,o);case 5:return s=e.sent,i=k.default.formatData(s),o.processGoodsDetail(i,s),e.abrupt("return",[i,s]);case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),o.showError(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,11]])})),preloadGoodsDetail:function(e){var t=k.default.formatData(e);this.processGoodsDetail(t,e),this.loadPage([t,e])},reLoad:function(){this.setData({showError:!1,loadingVisible:!0}),_.default.preload_goods(this.$urlQueryObj)},loadPage:function(e){var t=this;this.initPageData(),(0,D.default)(w.default.mark(function o(){var a,r,s,i,n;return w.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(o.prev=0,a=t.$urlQueryObj.goods_id,r=void 0,s=void 0,!(e&&e[0]&&e[1])){o.next=7;break}r=e[0],s=e[1],o.next=12;break;case 7:return o.next=9,t.getGoodsDetail(a,t);case 9:i=o.sent,r=i[0],s=i[1];case 12:return o.next=14,[t.getGoodsLisbon(r,t),t.checkMerchantCoupon(r.mallId,t),t.getMallDetail(r.mallId,t),t.getLocalGroupsDetail(r,t),t.getRecommendGoodsDetail(r,t),t.getReviewsDetail(r,t),t.getLotteryDetail(r,t),t.getFreeCouponsDetail(r,t),t.setSkus(r,s,t)];case 14:n=o.sent,o.next=20;break;case 17:o.prev=17,o.t0=o.catch(0),t.setData({loadingVisible:!1});case 20:case"end":return o.stop()}},o,this,[[0,17]])}))},setSkus:D.default.wrap(w.default.mark(function e(t,o,a){var r;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&o&&!t.skus&&(r=k.default.getSkus(o.sku,o.thumb_url),a.setData({"goodsInfo.skus":r}));case 1:case"end":return e.stop()}},e,this)})),getGoodsLisbon:D.default.wrap(w.default.mark(function e(t,o){var a,r,s,i,n,u,d;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=t.goodsId,r=t.goodsType,s=t.eventType,i=t.mallId,n={goods_id:a,goods_type:r,event_type:s,mall_id:i},13!==parseInt(s)&&16!==parseInt(s)&&18!==parseInt(s)){e.next=13;break}return u=x.Request.requestDataWithUrl("GET",h.default.getGoodsLisbon,n,!0),e.next=10,x.Request.runSecondaryRequestForPage(u,o);case 10:return d=e.sent,o.processLisbonData(d),e.abrupt("return",d);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])})),processLisbonData:function(e){var t=this;if(e&&e.events.limited_free_order&&e.events.limited_free_order.start_time&&e.events.limited_free_order.end_time){var o=e.events.limited_free_order,a=o.start_time,r=o.end_time,s=o.pick_num,i=x.TimeUtil.formatTime(a,"MM.dd hh:mm"),n=x.TimeUtil.formatTime(r,"MM.dd hh:mm");this.setData({startTimeDesc:i,endTimeDesc:n,pickNum:s})}if(e&&e.events.promotion_event_list){var u=e.events.promotion_event_list.event_list[0],d=u.promotion_event_type;if(d==p.default.PromotionEventType.LIMIT_TIME_DISCOUNT||d==p.default.PromotionEventType.LIMIT_COUNT_DISCOUNT){var l=u.end_time-e.server_time,c=u.event_items[0].discount_param;if(l>0&&c>0&&c<100){var h=x.TimeUtil.getPackagedTimeFromTimeBucket(1e3*l,"HMS"),g=0;d==p.default.PromotionEventType.LIMIT_TIME_DISCOUNT?g=l>=86400?h.days+"天"+h.hours+"小时后恢复":h.hours+":"+h.minutes+":"+h.seconds+"后恢复":d==p.default.PromotionEventType.LIMIT_COUNT_DISCOUNT&&(g="再售"+u.remain_quantity+"件后恢复");var f=(this.data.goodsInfo.useOnSalePrice?this.data.goodsInfo.minOnsaleGroupPrice:this.data.goodsInfo.minGroupPrice)||this.data.goodsInfo.preGroupPrice;f=x.DataUtil.accDiv(Math.floor(x.DataUtil.accMul(f,c)),100);var m=x.DataUtil.accDiv(Math.floor(x.DataUtil.accMul(this.data.goodsInfo.minOnsaleNormalPrice,c)),100),v="￥"+x.DataUtil.accDiv(Math.floor(x.DataUtil.accMul(this.data.goodsInfo.minOnsaleGroupPrice,c)),100);this.setData({"bottomBarData.discountGroupPrice":v,"bottomBarData.discountSinglePrice":m,discountPrice:f,"goodsInfo.discount":c,"goodsInfo.discountLeftTime":g}),this.discountLeftTimeInterval&&clearInterval(this.discountLeftTimeInterval);var _=this;this.discountLeftTimeInterval=setInterval(function(){l>0?--l<86400&&(h=x.TimeUtil.getPackagedTimeFromTimeBucket(1e3*l,"HMS"),d==p.default.PromotionEventType.LIMIT_TIME_DISCOUNT?g=h.hours+":"+h.minutes+":"+h.seconds+"后恢复":d==p.default.PromotionEventType.LIMIT_COUNT_DISCOUNT&&(g="再售"+u.remain_quantity+"件后恢复"),t.setData({"bottomBarData.discountGroupPrice":v,"bottomBarData.discountSinglePrice":m,discountPrice:f,"goodsInfo.discount":c,"goodsInfo.discountLeftTime":g})):(clearInterval(_.discountLeftTimeInterval),t.setData({"goodsInfo.discount":0,"goodsInfo.discountLeftTime":0,"bottomBarData.discountSinglePrice":0,"bottomBarData.discountGroupPrice":0}))},1e3)}}}},showError:function(e){var t=f.default.CPPage;t.$showToast("网络出错"),t.setData({showError:!0,loadingVisible:!1})},onShow:function(){var e=this;if(this.data.firstEnter)this.data.firstEnter=!1;else{var t=this.data.goodsInfo;t&&t.goodsId&&(0,D.default)(w.default.mark(function o(){var a;return w.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,[e.getLocalGroupsDetail(t,e),e.getFreeCouponsDetail(t,e)];case 3:a=o.sent,o.next=9;break;case 6:o.prev=6,o.t0=o.catch(0),console.error(o.t0);case 9:case"end":return o.stop()}},o,this,[[0,6]])}))}var o=getCurrentPages(),a=o[o.length-1].__route__;a+="?"+x.UrlUtil.buildQuery(this.$urlQueryObj),u.default.init(this,!0,a,1);var r=this.$urlQueryObj.goods_id,s=this.data.bottomBarData;if(s){var i=f.default.likeGoodsIds[r];i!=!!s.hasLiked&&this.setData({"bottomBarData.hasLiked":i})}wx.onUserCaptureScreen&&wx.onUserCaptureScreen(function(t){var o=e.getImprTrackingParams("screen_shot_popup");(0,x.TrackingRecord)(o),G.default.listenScreenShot(e)}),f.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},onHide:function(){f.default.isLastPagePayPage=!1,f.default.hasPaySucess=!1,f.default.isOrderForbidden=!1,f.default.isLastPageGroupPage=!1,u.default.close(this)},onUnload:function(){_.default.preloadUnlock(this.$urlQueryObj.goods_id),_.default.preloadUnlock(this.$urlQueryObj.goods_id+"_error"),null!=this.localGroupCountdown&&clearTimeout(this.localGroupCountdown),this.discountLeftTimeInterval&&clearInterval(this.discountLeftTimeInterval),this.spikeLeftTimeInterval&&clearInterval(this.spikeLeftTimeInterval),u.default.close(this),this.goodsBottomBar&&this.goodsBottomBar.unload()},clickTopGallery:function(e){if(!this.longPressLock){this.data.goodsInfo;var t=e.target.dataset,o=void 0;t&&(o=t.url);var a=[];this.data.goodsInfo.topGallery.forEach(function(e){a.push(e.url)}),o&&this.previewImage(o,a);var r=this.getClickTrackingParams("main","top_banner");(0,x.TrackingRecord)(r)}},longTapImage:function(e){var t=e.target.dataset,o=void 0;if(t){o=t.downloadUrl,this.actionSheet.show(o),this.longPressLock=!0;var a=this.getImprTrackingParams("save_pic_popup");(0,x.TrackingRecord)(a)}},previewImage:function(e,t){t=t||[e],wx.previewImage({current:e,urls:t})},componentsAddRootFunc:function(e,t){var o=this;e&&"function"==typeof t&&(this[e]="goodsLike"==e?function(e){(0,D.default)(w.default.mark(function a(){var r;return w.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.showShareTips();case 2:r=a.sent,t(e,r),o.$uploadFormId(e);case 5:case"end":return a.stop()}},a,this)}))}:t)},closeShare:function(){this.setData({shareMainClass:"screen-share-main screen-share-main-hide",canShowShare:!0});var e=this.getClickTrackingParams("screen_shot_popup","close_btn");(0,x.TrackingRecord)(e)},screenShare:function(){var e=this.getClickTrackingParams("screen_shot_popup","invent_btn");(0,x.TrackingRecord)(e)},showShareTips:D.default.wrap(w.default.mark(function e(){var t,o,a,r,s;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.data.goodsInfo&&this.data.goodsInfo.goodsId){e.next=2;break}return e.abrupt("return");case 2:if(!(t=!f.default.likeGoodsIds[this.data.goodsInfo.goodsId])){e.next=23;break}return o=this,e.prev=5,a=Date.parse(new Date),r=S.default.GOODS_LIKE_DATE,e.next=10,x.StorageUtil.getStorage(r);case 10:if((s=e.sent)&&!(a-s>2592e5)){e.next=18;break}return wx.setStorage({key:r,data:a}),u.default.hideBubble(o),o.pauseBubble=!0,o.setData({shareTipsVisible:!0}),setTimeout(function(){o.pauseBubble=!1,o.setData({shareTipsVisible:!1})},5e3),e.abrupt("return",!0);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(5),console.error(e.t0);case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}},e,this,[[5,20]])})),onLoad:function(e){this.pvTracking(),this.preLoadGoodsPage(),this.scrollContainerHeight=x.SystemInfo.getWindowHeightSync();var t=x.ObjectUtil.assign(y.default.initSkuStatus,{scrollContainerWidth:x.SystemInfo.getWindowWidthSync(),hideMinLeftTimeLocalGroup:this.$urlQueryObj.hideMinLeftTimeLocalGroup});this.setData(t),e.scene&&(e=x.ObjectUtil.assign(e,R.default.sceneMap(e.scene))),_.default.preloadPage(e.goods_id,this.preloadGoodsDetail,this.showError,this.loadPage,this);var o=this;if(this.actionSheet=new M.default({page:o,ns:"actionSheet",goosId:e.goods_id,complete:function(e){o.longPressLock=!1;var t=["share_btn","save_pic_btn","cancel"],a=o.getClickTrackingParams("save_pic_popup",t[e]);(0,x.TrackingRecord)(a)}}),this.$urlQueryObj.__p){var a={alias:this.$urlQueryObj.__p};(0,D.default)(w.default.mark(function e(){var t,r,s;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=q.default.apiGZDomain+h.default.decodeAlias,r=x.Request.requestDataWithUrl("GET",t,a,!0),e.next=5,x.Request.runSecondaryRequestForPage(r,o);case 5:s=e.sent,o.$urlQueryObj=x.ObjectUtil.assign(o.$urlQueryObj,s),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}},e,this,[[0,9]])}))}},stopDetailMove:function(){}};(0,x.PddPage)(B,{pageName:"goods",notUseCommonPV:!0}); 
 			}); 	require("pages/goods/goods.js");
 		__wxRoute = 'pages/search_result/search_result';__wxRouteBegin = true; 	define("pages/search_result/search_result.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=e(require("../../storage/search_history_storage")),a=e(require("../../controller/group")),s=e(require("../../constants/bottomTab")),r=e(require("../../configs/api")),i=e(require("../../libs/co/we-index")),o=e(require("../../libs/regenerator-runtime/runtime")),c=e(require("../../common/gotop_util")),n=e(require("../../controller/formid_controller")),h=require("../../common/index"),u=e(require("../../models/format/grid_item_goods")),l=[{typeName:"综合排序",param:"default"},{typeName:"评分排序",param:"_credit"},{typeName:"价格从高到低",param:"_price"},{typeName:"销量优先",param:"_sales"},{typeName:"价格从低到高",param:"price"}],d={isShowNavigation:!1,searchValue:"",page:1,searchResultDispatchId:null,searchResultDispatchIds:{},searchResultManager:null,rankListManager:null,sortType:0,lastSortType:0,cacheSeachGoodsList:[],cacheRankGoodsList:[],oriSearchKey:"",requery:0,data:{noResult:!1,inputSearchValue:"",searchResultAmount:0,resultList:[],resultDataType:"SEARCH_RESULT_GOODS",resultListVisible:!1,loadingVisible:!1,loadingMoreVisible:!1,isLoading:!1,canLoadMore:!0,searchIsEditing:!0,searchHistoryValues:[],shouldFocusInput:!0,bottomTab:s.default.bottomTab,hotSearchTags:[],searchKey:"",curSortTypeIndex:0,curRowSortTypeIndex:0,showTypeList:!1,sortTypeList:l.slice(0,3),rowSortTypeList:l.slice(3,5),localGroupsMap:{},isFixedSortFrom:!1},searchTapTracking:function(e){(0,h.TrackingRecord)({op:"click",event:"sort_clk",page_section:"sort",page_name:"search_result",page_element:e,search_key:this.searchValue})},clickSortType:function(e){var t=e.target.dataset.index;t!=this.sortType&&(this.sortType=t,this.lastSortType=t,this.setData({curSortTypeIndex:t,showTypeList:!1,curRowSortTypeIndex:0}),this.requery=0,this.searchGoods(),this.searchTapTracking(l[t].param),this.clearLastImprList())},clickRowSortType:function(e){var t=e.target.dataset.index;t+3!=this.sortType&&(this.sortType=t+3,this.lastSortType=t+3,this.setData({showTypeList:!1,curRowSortTypeIndex:t+1}),this.requery=0,this.searchGoods(),this.searchTapTracking(l[this.sortType].param),this.clearLastImprList())},sortDropListUp:function(){this.sortType=-1,this.setData({showTypeList:!1,curRowSortTypeIndex:0})},sortDropListDown:function(){this.sortType=-1,this.lastSortType=this.data.curSortTypeIndex,this.setData({showTypeList:!0,curRowSortTypeIndex:0})},clearSearchContent:function(){this.setData({inputSearchValue:" ",searchKey:" "}),this.setData({inputSearchValue:"",searchKey:"",qc:""})},onPageScroll:function(e){if(this.setData({showTypeList:!1}),e){var t=parseInt(e.scrollTop);c.default.showGoTopBtn(t,this),this.updateScrollTop(t)}},interConfirm:function(e){var t=e.detail.value;this.searchValue=t.trim(),this.requery=0,this.searchGoods(),this.searchReqTrackingRecord("new","keyboard_sort")},search:function(e){var t=e.detail.value,a="";t&&(a=t.searchValue||""),this.searchValue=a.trim(),this.requery=0,this.searchGoods(),this.searchReqTrackingRecord("new","btn_sort");var s=e.detail.formId;this.uploadFormId(s,"search_btn_clk",!1)},uploadFormId:function(e,t,a){e&&n.default.uploadFormIdToSH(e,a)},searchGoods:function(){if(this.setData({inputSearchValue:this.searchValue,searchKey:this.searchValue,shouldFocusInput:!1,showTypeList:!1}),wx.hideKeyboard(),0!==this.searchValue.length){this.setData({searchIsEditing:!1}),this.setData({noResult:!1,searchResultAmount:0,resultList:[],resultDataType:"SEARCH_RESULT_GOODS",resultListVisible:!1,loadingVisible:!0,loadingMoreVisible:!0,isLoading:!1,canLoadMore:!0});var e=t.default.saveSearchValue(this.searchValue)||[];this.setData({searchHistoryValues:e}),this.page=1,this.loadSearchList()}else this.$showToast("搜索内容不能为空")},clearSearchHistory:function(){t.default.removeSearchValueArray(),this.setData({searchHistoryValues:[]})},searchReqTrackingRecord:function(e,t){(0,h.TrackingRecord)({op:"event",event:"search_keywords",page_index:0,pase_size:50,page_name:"search_result",query:this.searchValue,source:e,page_element:t})},searchHistory:function(e){var t=e.currentTarget.dataset;if(t){var a=t.value||"";a&&(this.searchValue=a,this.requery=0,this.searchGoods()),t.updateHot?(this.loadHotSearchTags(),this.searchReqTrackingRecord("history","rec_sort")):this.oriSearchKey.length>0&&a!=this.oriSearchKey?this.searchReqTrackingRecord("history","corrected_sort"):this.searchReqTrackingRecord("history","history_sort"),this.oriSearchKey="";var s={op:"click",event:"query_list_clk",page_name:"search",page_section:t.updateHot?"hot_query_list":"history_query_list",page_element:"query",click_query:a};(0,h.TrackingRecord)(s)}if(t.updateHot){var r=e.detail.formId;this.uploadFormId(r,"search_hot_kw_clk",!1)}},initPageData:function(){this.initialDataObj?this.setData(this.initialDataObj):this.initialDataObj=JSON.parse(JSON.stringify(this.data))},gotoGoodsDetail:function(e){var t=e.currentTarget.dataset;if(t){var a=t.goodsId;if(a){var s=e.currentTarget.dataset.goodsItem;this.transGoodsData=s,h.Navigation.forward("/pages/goods/goods?goods_id="+a);var r={op:"click",page_section:this.data.noResult?"hot_goods_list":"goods_list",page_element:"goods",page_name:"search_result",query:this.searchValue,goods_id:a,idx:t.goodsIndex};s.ad&&(r.ad=JSON.stringify(s.ad)),(0,h.TrackingRecord)(r)}}},processDataReady:function(e){wx.stopPullDownRefresh(),this.setData({qc:e.qc,isLoading:!1,loadingMoreVisible:!1}),this.goodsListReqLock=!1;var t=this.page,a=e.goodsList||[];if("SEARCH_RESULT_GOODS"===this.data.resultDataType){if(1===this.page&&!e.searchResultAmount)return this.setData({noResult:!0}),(0,h.TrackingRecord)({op:"impr",page_section:"no_result_hint",page_name:"search_result",query:this.searchValue}),void this.loadRankList();this.cacheSeachGoodsList=this.cacheSeachGoodsList.concat(a),this.page+=1;for(var s=e.searchResultAmount||0,r="",i=[],o=0;o<e.goodsList.length;++o){var c=e.goodsList[o].goodsId,n={goods_id:c,idx:o};e.goodsList[o].ad&&(n.ad=e.goodsList[o].ad),i.push(n),r+=c+"",o!=e.goodsList.length-1&&(r+=",")}(0,h.TrackingRecord)({op:"event",event:"search_keywords",page_index:t,page_size:e.curRawGoodsListSize,page_name:"search_result",query:this.searchValue,result_count:s,goods_ids:r}),(0,h.TrackingRecord)({op:"impr",page_name:"search_result",page_section:"goods_list",page_element:"goods",query:this.searchValue,items:JSON.stringify(i)}),e.curRawGoodsListSize<=0&&this.setData({canLoadMore:!1}),this.setData({searchResultAmount:s,loadingMoreVisible:!1,loadingVisible:!1,resultListVisible:!0}),this.fillSearchResultData(1==t)}else this.page+=1,this.cacheRankGoodsList=this.cacheRankGoodsList.concat(a),0===a.length&&this.setData({canLoadMore:!1}),this.setData({loadingMoreVisible:!1,loadingVisible:!1,resultListVisible:!0}),this.fillSearchResultData(1==t)},focusInput:function(e){this.loadSearchSuggestions(),this.setData({searchIsEditing:!0,showTypeList:!1})},onReachBottom:function(){this.data.isLoading||this.fillSearchResultData()},fillSearchResultData:function(e){var t=this,s=this.data.resultList||[];e&&(s=[]);var r=void 0;r="SEARCH_RESULT_GOODS"===this.data.resultDataType?this.cacheSeachGoodsList||[]:this.cacheRankGoodsList||[];var c=s.length;if(r.length>c){var n=s.length+20;s=r.slice(0,n),this.setData({resultList:s}),0===c&&(this.isInitRect()||setTimeout(function(){wx.canIUse&&wx.canIUse("createSelectorQuery")&&wx.createSelectorQuery().selectAll("#impr-id").boundingClientRect(function(e){t.initRect(e,function(e){t.imprItems(e)})}).exec()},500),t.updateScrollTop(0));var h=[];s.slice(c).forEach(function(e,t){2==e.customerNum&&h.push(e.goodsId)}),(0,i.default)(o.default.mark(function e(){var s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.default.loadLocalGroups(h,t.data.localGroupsMap,t);case 3:s=e.sent,t.setData({localGroupsMap:s}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}))}else this.data.canLoadMore&&("SEARCH_RESULT_GOODS"===this.data.resultDataType?this.loadSearchList():this.loadRankList())},loadSearchList:function(){var e=this;this.setData({resultDataType:"SEARCH_RESULT_GOODS",isLoading:!0}),this.getSearchResultGoods(e)},getSearchResultGoods:i.default.wrap(o.default.mark(function e(t){var a,s,i,c,n,u,d,g,p,f;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.goodsListReqLock){e.next=3;break}return e.abrupt("return");case 3:if(t.goodsListReqLock=!0,a=t.searchValue,s=t.page,i=50,c=1===t.page,n=t.requery,u=l[t.lastSortType].param,a&&s&&i){e.next=7;break}return e.abrupt("return");case 7:return a=encodeURIComponent(a),d=r.default.search+a+"&page="+s+"&size="+i+"&sort="+u+"&requery="+n,g=h.Request.requestDataWithUrl("GET",d,null,!0),e.next=12,h.Request.runMainRequestForPage(g,t);case 12:p=e.sent,f=t.formatSearchResultGoods(p,c),t.processDataReady(f),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0),t.requestError();case 21:case"end":return e.stop()}},e,this,[[0,17]])})),requestError:function(){this.goodsListReqLock=!1,this.$showToast("网络出错"),1===this.page&&this.setData({showError:!0,loadingVisible:!1})},formatSearchResultGoods:function(e,t){var a={};a.searchResultAmount=e.total||0,a.goodsList=[];var s=e.items||[];return t&&(this.cacheSeachGoodsList=[]),s.forEach(function(e){a.goodsList.push(u.default.formatData(e))}),a.goodsList=h.DataUtil.objectArrayDuplicateRemove(a.goodsList,"goodsId"),a.curRawGoodsListSize=s.length,a.qc=e.qc||"",a},loadRankList:function(){var e=this;this.setData({resultDataType:"RANK_LIST_GOODS",isLoading:!0}),this.getRankListGoods(e)},getRankListGoods:i.default.wrap(o.default.mark(function e(t){var a,s,i,c,n,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.goodsListReqLock){e.next=3;break}return e.abrupt("return");case 3:if(t.goodsListReqLock=!0,a=t.page,s=50,i=1===this.page,a&&s){e.next=7;break}return e.abrupt("return");case 7:return c=r.default.rankList+"?page="+a+"&size="+s,e.next=10,h.Request.apiRequest("GET",c,null,!0);case 10:n=e.sent,u=t.formatRankListGoods(n,i),t.processDataReady(u),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])})),formatRankListGoods:function(e,t){var a={};a.goodsList=[];var s=e.goods_list||[];return t&&(this.cacheRankGoodsList=[]),s.forEach(function(e){a.goodsList.push(u.default.formatData(e))}),a.goodsList=h.DataUtil.objectArrayDuplicateRemove(a.goodsList,"goodsId"),a.curRawGoodsListSize=s.length,a},onOriSearchKeyClicked:function(e){e.currentTarget.dataset.key;this.requery=1,this.searchGoods()},editSearchValue:function(e){var t=e.detail.value;"string"==typeof t&&(this.oriSearchKey=t.trim(),this.setData({searchKey:t.trim()})),this.loadSearchSuggestions()},loadHotSearchTags:function(){var e=this;(0,i.default)(o.default.mark(function t(){var a,s;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=h.Request.requestDataWithUrl("GET",r.default.searchHotQuery,null,!0),t.next=4,h.Request.runMainRequestForPage(a,e);case 4:(s=t.sent).items&&s.items.length>0&&e.setData({hotSearchTags:s.items}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}},t,this,[[0,8]])}))},loadSearchSuggestions:function(){var e=this,t=this;this.searchSuggstionTimer&&clearTimeout(this.searchSuggstionTimer),this.searchSuggstionTimer=setTimeout(function(){e.data.searchKey?(0,i.default)(o.default.mark(function e(){var a,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=r.default.searchSuggestions+"?"+h.UrlUtil.buildQuery({query:t.data.searchKey}),e.next=4,h.Request.apiRequest("GET",a,null,!0);case 4:(s=e.sent).suggest&&(t.setData({searchSuggestions:s.suggest}),(0,h.TrackingRecord)({op:"event",event:"rec_query_show",page_name:"search_result",query:t.data.searchKey,rec_query:s.suggest.join(",")})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})):e.setData({searchSuggestions:[]})},200)},loadPage:function(){this.initPageData(),this.loadHotSearchTags();var e=t.default.getSearchValueArray()||[];this.setData({searchHistoryValues:e}),this.windowHeight||(this.windowHeight=h.SystemInfo.getWindowHeightSync()),this.windowHeight&&this.setData({scrollContainerHeight:this.windowHeight}),this.searchValue?(this.setData({searchIsEditing:!1,shouldFocusInput:!1}),this.requery=0,this.searchGoods()):(wx.stopPullDownRefresh(),this.setData({searchIsEditing:!0}))},reLoad:function(){this.setData({loadingVisible:!0,showError:!1}),this.requery=0,this.searchGoods()},onUnload:function(){},onHide:function(){this.setData({showTypeList:!1})},onLoad:function(e){e.xcx_ad&&this.setData({isShowNavigation:!0}),e.src&&e.campaign&&this.setData({AdvertisementCome:!0}),this.searchValue=this.$urlQueryObj.search_key,this.loadPage()},imprItems:function(e){var t=this;e.forEach(function(e){var a=t.data.resultList||[];if(e<a.length){var s=a[e]||{},r={op:"impr",page_section:"goods_list",page_element:"goods",idx:e,goods_id:s.goodsId,query:t.searchValue};l[t.sortType]&&(r.sort=l[t.sortType].param),s.transData&&(s.transData.ad&&(r.ad=JSON.stringify(s.transData.ad)),s.transData.p_rec&&(r.p_rec=JSON.stringify(s.transData.p_rec)),s.transData.p_search&&(r.p_search=JSON.stringify(s.transData.p_search))),(0,h.TrackingRecord)(r)}})}};(0,h.PddPage)(d,{pageName:"search_result"}); 
 			}); 	require("pages/search_result/search_result.js");
 		__wxRoute = 'pages/catgoods/catgoods';__wxRouteBegin = true; 	define("pages/catgoods/catgoods.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function a(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var e=t(require("../../components/toast/toast.js")),i=t(require("../../components/bubble/bubble")),o=t(require("../../constants/bottomTab")),s=t(require("../../models/format/grid_item_goods")),r=(t(require("../../common/page_util")),t(require("../../common/gotop_util"))),n=t(require("../../storage/ram_manager")),d=(t(require("../../common/logger_util")),require("../../common/index")),u=(t(require("../../libs/es6-promise.min")),t(require("../../libs/co/we-index"))),c=t(require("../../libs/regenerator-runtime/runtime")),h=t(require("../../configs/api")),p={cachAllCatgoods:[],tabbarLineAnimData:{},tabbarTextAnimData:{},catgoodsDispatchIds:{},tabsReqRunningArr:[],catgoodsManagers:[],backupTabStatus:[],data:{extraTransX:0,aniDuration:300,tabbarLineAnimData:{},catBtnWidth:d.Util.rpxToPx(75),fontWidth:d.Util.rpxToPx(30),singleGapWidth:d.Util.rpxToPx(60),firstGapWidth:d.Util.rpxToPx(40),curTabIndex:0,tabbarOptInfos:[],topTabbarVisible:!1,scrollLeft:0,catWindowOpen:!1,showError:!1,scrollTop:0,tabStatus:[],bubble:{isShow:!0,top:"104rpx"},catgoodsList:[],notFirstEnterPage:!1,goTopClass:!1,bottomTab:o.default.bottomTab},onShareAppMessage:function(t){var a="拼多多，拼得多省得多";return this.$urlQueryObj.opt_name&&(a=this.$urlQueryObj.opt_name),this.$generateShareContent({title:a,queries:{opt_type:this.$urlQueryObj.opt_type,opt_id:this.$urlQueryObj.opt_id}})},onReady:function(){this.$urlQueryObj.opt_name&&wx.setNavigationBarTitle({title:this.$urlQueryObj.opt_name})},onReachBottom:function(t){var a=this.data.curTabIndex;(this.data.tabStatus[a]||{}).canLoadMore&&this.fillCatgoodsListData(a)},onPageScroll:function(t){var a=t.scrollTop;r.default.showGoTopBtn(a,this),this.updateScrollTop(a)},changeCurTabIndex:function(t,e,i){var o;if(t=parseInt(t,10),!isNaN(t)&&(t!==this.data.curTabIndex||e)){this.hasLastIndex=!i;var s=this.data.tabbarOptInfos||[];this.scrollTabbarToMiddle(t);var n=this.data.curTabIndex,d=this.cachAllCatgoods[n]||[],u=this.cachAllCatgoods[t]||[];this.setData((o={curTabIndex:t,goTopClass:!1},a(o,"catgoodsList["+n+"]",d.slice(0,8)),a(o,"catgoodsList["+t+"]",[]),o));this.data.tabStatus;var c=this,h=function(e){if(e>=0&&e<s.length){var i=c.data.tabStatus;i[e]&&i[e].offset?e==t&&setTimeout(function(){c.setData(a({},"catgoodsList["+t+"]",u.slice(0,8))),setTimeout(function(){r.default.goTop(!0)},100)},100):c.getCatgoodsData(c,e)}};h(t),h(t-1),h(t+1),this.clearLastImprList(),this.updateScrollTop(0)}},getCatIndexByOptInfo:function(t,a){var e=-1;return(this.data.tabbarOptInfos||[]).forEach(function(i,o){t==i.optType&&a==i.optId&&(e=o)}),e},clickTabItem:function(t){this.hideCatsWindow();var a=parseInt(t.currentTarget.dataset.index);isNaN(a)||this.changeCurTabIndex(a,!1,!0)},scrollTabbarToMiddle:function(t){var a=0,e=this.data.tabbarOptInfos||[];e.forEach(function(e,i){i<=t&&(a+=i===t?e.tabItemWidth/2:e.tabItemWidth)});var i=this.data.singleGapWidth*t+this.data.firstGapWidth,o=a+i,s=(this.data.scrollLeft,Math.floor(o-this.data.windowWidth/2));s<0&&(s=0);var r=this.data.tabbarLineAnimData,n=wx.createAnimation({duration:0,timingFunction:"ease-out"}),d=e[t],u=0,c=0;d&&(c=d.tabItemWidth,u=Math.floor(o-c/2)+this.data.extraTransX),n.width(0).translate3d(u,0,0).step(),this.tabbarLineAnimation&&(this.tabbarLineAnimation.width(c).translate3d(u,0,0).step(),r=this.tabbarLineAnimation.export()),this.setData({tabbarLineAnimData:this.hasLastIndex?n.export():r,scrollLeft:s}),this.hasLastIndex&&(this.hasLastIndex=!1,n.width(c).translate3d(u,0,0).step(),this.setData({tabbarLineAnimData:n.export()}))},getReqFlag:function(t,a,e){return[t,a,e].join("#")},getTabOnly:u.default.wrap(c.default.mark(function t(a,e){var i,o,s,r,n,u,p,l,b,f,g,m;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=void 0,o=void 0,s=void 0,t.prev=1,null==e&&(e=a.data.curTabIndex),a.data.tabStatus[e].canLoadMore){t.next=5;break}return t.abrupt("return");case 5:if(i=a.$urlQueryObj.opt_type,o=a.$urlQueryObj.opt_id,i&&o){t.next=9;break}return t.abrupt("return");case 9:return r=a.data.tabStatus[e]||{},s=r.offset||0,n="index"===a.$urlQueryObj.refer_page_name,u=d.DataUtil.formatByPos(n?h.default.noV4Catgoods:h.default.catgoods,o)+"?"+d.UrlUtil.buildQuery({opt_type:i,offset:s,size:100,sort_type:"DEFAULT"}),1==a.$urlQueryObj.is_push&&(u+="&is_push=1"),p=d.Request.requestDataWithUrl("GET",u,null,!0),t.next=17,d.Request.runMainRequestForPage(p,a.$pageName);case 17:(l=t.sent).opt_infos&&this.lastTabIndex>l.opt_infos.length&&(this.lastTabIndex=0),b=a.formatCatgoodsData(l,i,o,s),f=b.optInfos||[],g=b.rootOptType,m=b.rootOptId,b.rootOptType==a.$urlQueryObj.opt_type&&0===a.data.tabbarOptInfos.length&&a.initTabStatus(f,g,m),this.changeCurTabIndex(a.lastTabIndex,!0,!1),t.next=30;break;case 27:t.prev=27,t.t0=t.catch(1),a.requestTagGoodsError(e,s);case 30:case"end":return t.stop()}},t,this,[[1,27]])})),getCatgoodsData:u.default.wrap(c.default.mark(function t(a,e){var i,o,s,r,n,u,p,l,b,f,g;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=void 0,o=void 0,s=void 0,r=void 0,t.prev=1,null==e&&(e=a.data.curTabIndex),a.data.tabStatus[e].canLoadMore){t.next=5;break}return t.abrupt("return");case 5:if(0===e?(i=a.$urlQueryObj.opt_type,o=a.$urlQueryObj.opt_id):(n=a.data.tabbarOptInfos[e]||{},i=n.optType,o=n.optId),i&&o){t.next=8;break}return t.abrupt("return");case 8:if(u=a.data.tabStatus[e]||{},s=u.offset||0,r=a.getReqFlag(i,o,s),!(a.tabsReqRunningArr.indexOf(r)>=0)){t.next=13;break}return t.abrupt("return");case 13:return a.tabsReqRunningArr.push(r),p="index"===a.$urlQueryObj.refer_page_name,l=d.DataUtil.formatByPos(p?h.default.noV4Catgoods:h.default.catgoods,o)+"?"+d.UrlUtil.buildQuery({opt_type:i,offset:s,size:100,sort_type:"DEFAULT"}),1==a.$urlQueryObj.is_push&&(l+="&is_push=1"),b=d.Request.requestDataWithUrl("GET",l,null,!0),t.next=20,d.Request.runMainRequestForPage(b,a.$pageName);case 20:f=t.sent,g=a.formatCatgoodsData(f,i,o,s),a.processCatgoodsDataReady(g),t.next=28;break;case 25:t.prev=25,t.t0=t.catch(1),a.requestTagGoodsError(e,s,r);case 28:case"end":return t.stop()}},t,this,[[1,25]])})),requestTagGoodsError:function(t,e,i){if(i){var o=this.tabsReqRunningArr.indexOf(i);o>=0&&this.tabsReqRunningArr.splice(o,1)}if(0===e){var s;this.setData((s={},a(s,"tabStatus["+t+"].showError",!0),a(s,"tabStatus["+t+"].loadMoreVisible",!1),a(s,"tabStatus["+t+"].loadingVisible",!1),a(s,"showError",!0),s))}},reLoad:function(){var t,e=this,i=this.data.curTabIndex;this.setData((t={},a(t,"tabStatus["+i+"].showError",!1),a(t,"tabStatus["+i+"].loadingVisible",!0),a(t,"showError",!1),t)),this.getCatgoodsData(e,i)},formatCatgoodsData:function(t,a,e,i){var o=t.goods_list||[],r=t.opt_infos||[],n={goodsList:[],optInfos:[],rootOptType:a,rootOptId:e,offset:i};return o.forEach(function(t){n.goodsList.push(s.default.formatData(t))}),r.forEach(function(t){n.optInfos.push({key:"optinfo-"+t.id,optId:parseInt(t.id,10)||0,optType:parseInt(a,10)+1,optName:t.opt_name,priority:t.priority})}),n.curRawGoodsListSize=o.length,n},processCatgoodsDataReady:function(t){wx.stopPullDownRefresh();var e=this.getReqFlag(t.rootOptType,t.rootOptId,t.offset),i=this.tabsReqRunningArr.indexOf(e);i>=0&&this.tabsReqRunningArr.splice(i,1);var o=this.getCatIndexByOptInfo(t.rootOptType,t.rootOptId);if(t.errorCode){var s=t.errorMsg;if(this.toast&&s&&this.toast.setText(s).show(),0==t.offset){if(o<0)return;var r=this.backupTabStatus[o];r&&this.setData(a({},"tabStatus["+o+"]",r))}}else{var n=t.goodsList||[],u=t.optInfos||[],c=t.rootOptType,h=t.rootOptId;if(t.rootOptType==this.$urlQueryObj.opt_type&&0===this.data.tabbarOptInfos.length&&this.initTabStatus(u,c,h),null!=(o=this.getCatIndexByOptInfo(t.rootOptType,t.rootOptId))&&o>=0){!Array.isArray(this.cachAllCatgoods[o])&&(this.cachAllCatgoods[o]=[]),this.cachAllCatgoods[o]=d.DataUtil.objectArrayDuplicateRemove(this.cachAllCatgoods[o].concat(n),"goodsId");var p=this.data.tabStatus[o]||{};p.offset=p.offset||0;var l=p.offset;p.offset+=100,p.loadingVisible=!1,p.loadMoreVisible=!0,p.showError=!1,p.canLoadMore=t.curRawGoodsListSize>0,this.fillCatgoodsListData(o,p,0==l)}}},initTabStatus:function(t,a,e){var i=this,o=this;t=[{key:"optinfo-"+e,optId:parseInt(e,10),optName:"全部",optType:parseInt(a,10)}].concat(t);var s=this.data.tabStatus||[],r=0;t.map(function(t,a){s[a]||(s[a]={},s[a].loadingVisible=!0,s[a].canLoadMore=!0);var e=0;return t.optName.split("").forEach(function(t){/[\u4e00-\u9fa5]/.test(t)?e++:e+=.5}),t.tabItemWidth=Math.floor(e*i.data.fontWidth),r+=t.tabItemWidth,t});var n=this.data.firstGapWidth;r+=this.data.singleGapWidth*(t.length-1)+n;var d=this.data.windowWidth-this.data.catBtnWidth,u=0;r+n<d&&(u=(d-r)/2);var c=this.data.tabbarTextAnimData;this.tabbarTextAnimation&&(this.tabbarTextAnimation.translate3d(0,0,1).step(),c=this.tabbarTextAnimation.export()),this.setData({tabbarOptInfos:t,topTabbarVisible:!0,tabStatus:s,tabbarLineAnimData:this.tabbarLineAnimation.export()||{},tabbarTextAnimData:c,extraTransX:u}),this.getCatgoodsData(o,1)},fillCatgoodsListData:function(t,a,e){var i=this,o=this.cachAllCatgoods[t]||[],s=this.data.catgoodsList[t]||[];e&&(s=[]);var r=s.length;if(o.length>r){var n=void 0;n=0===r?8:s.length+20,s=o.slice(0,n);var u={};if(u["catgoodsList["+t+"]"]=s,u.notFirstEnterPage=!0,a){var c=this.data.tabStatus[t]||{};c=d.ObjectUtil.assign(c,a),u["tabStatus["+t+"]"]=c}this.setData(u),0===r&&(this.isInitRect()?(this.clearLastImprList(),this.updateScrollTop(0)):setTimeout(function(){wx.canIUse&&wx.canIUse("createSelectorQuery")&&wx.createSelectorQuery().selectAll("#impr-id").boundingClientRect(function(t){i.initRect(t,function(t){i.imprItems(t)})}).exec()},500))}else this.getCatgoodsData(i,t)},openCatsWindow:function(){this.setData({catWindowOpen:!0})},hideCatsWindow:function(){this.setData({catWindowOpen:!1})},preventTouchMove:function(){},gotoGoodsDetail:function(t){var a=t.currentTarget.dataset,e=a.index;if(a){var i=a.goodsId;if(i){var o=t.currentTarget.dataset.goodsItem;this.transGoodsData=o,d.Navigation.forward("/pages/goods/goods?goods_id="+i);var s={op:"click",event:"goods_list_clk",page_name:"opt",page_section:"goods_list",page_element:"goods",goods_id:i,idx:e};o.ad&&(s.ad=JSON.stringify(o.ad)),o.p_rec&&(s.p_rec=JSON.stringify(o.p_rec)),o.p_search&&(s.p_search=JSON.stringify(o.p_search)),(0,d.TrackingRecord)(s)}}},loadPage:function(){var t=this;this.data.notFirstEnterPage||this.setData({windowHeight:d.SystemInfo.getWindowHeightSync(),windowWidth:d.SystemInfo.getWindowWidthSync()}),this.tabbarLineAnimation||(this.tabbarLineAnimation=wx.createAnimation({duration:300,timingFunction:"ease-out"})),this.tabbarTextAnimation||(this.tabbarTextAnimation=wx.createAnimation({duration:300,timingFunction:"ease-out"}));var a=this.data.curTabIndex||0;this.initCatTabStatus(a),this.lastTabIndex>0?this.getTabOnly(t,a):this.getCatgoodsData(t,a)},initCatTabStatus:function(t){var e=this.data.tabStatus[t]?this.data.tabStatus[t]:{};this.backupTabStatus[t]=e,e.canLoadMore=!0,e.offset=0,this.setData(a({},"tabStatus["+t+"]",e))},pvTracking:function(){var t={op:"pv"};this.$urlQueryObj.src&&this.$urlQueryObj.campaign&&(t=Object.assign({op:"pv",event:"come_from_search",page_name:"catgoods"},this.$urlQueryObj)),(0,d.TrackingRecord)(t),this.$firstTimeTrackRecord.pv=!0},onHide:function(){i.default.close(this)},onUnload:function(){i.default.close(this)},onShow:function(){i.default.init(this,!1,"",1),n.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},onLoad:function(t){var a=this;this.pvTracking(),t.src&&t.campaign&&(this.setData({AdvertisementCome:!0}),t.nosalenumber&&this.setData({nosalenumber:!0})),t&&(this.lastTabIndex=parseInt(this.$urlQueryObj.tab_index||0,10)),this.toast||(this.toast=new e.default({setDataFunc:function(t){a.setData({toastData:t})}})),this.loadPage(),d.User.requireLogin()},imprItems:function(t){var a=this,e=a.data.curTabIndex||0,i=a.data.catgoodsList[e]||[],o=a.$urlQueryObj.opt_type,s=a.$urlQueryObj.opt_id;t.forEach(function(t){if(t<i.length){var a=i[t]||{},e={op:"impr",page_section:"goods_list",page_element:"goods",idx:t,goods_id:a.goodsId,opt_type:o,opt_id:s};a.transData&&(a.transData.ad&&(e.ad=JSON.stringify(a.transData.ad)),a.transData.p_rec&&(e.p_rec=JSON.stringify(a.transData.p_rec)),a.transData.p_search&&(e.p_search=JSON.stringify(a.transData.p_search))),(0,d.TrackingRecord)(e)}})}};(0,d.PddPage)(p,{pageName:"catgoods",notUseCommonPV:!0}); 
 			}); 	require("pages/catgoods/catgoods.js");
 		__wxRoute = 'pages/subject/subject';__wxRouteBegin = true; 	define("pages/subject/subject.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=e(require("../../common/request")),i=e(require("../../common/std_format")),a=(e(require("../../constants/share_info")),e(require("../../common/object_util")),e(require("../../components/bubble/bubble"))),o=(e(require("../../common/page_util")),e(require("../../common/gotop_util"))),s=(e(require("../../common/logger_util")),require("../../common/index")),r=e(require("../../storage/ram_manager")),n=e(require("../../configs/api")),d=(require("../../constants/share"),e(require("../../controller/group"))),u=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),c=e(require("../../libs/regenerator-runtime/runtime")),l=e(require("../../components/big_sales/big_sales")),m=(e(require("../../storage/user_storage")),e(require("../../components/navigation_modal/navigation_modal.js"))),h=["1243","2742"],g={desc:"拼多多",columnNum:"2"},p={scrollTopValue:0,winHeight:0,navigation_modal:null,onShareAppMessage:function(e){var t={subject_id:this.$urlQueryObj.subject_id},i="";e&&("menu"==e.from?i="top_forward":"subject-share-btn"==e.target.dataset.subRefer&&(i="subject_share")),this.data.isComeFromAd&&(t=this.$urlQueryObj);var a={title:this.data.desc,queries:t,referStr:i};if("2742"==this.$urlQueryObj.subject_id){var o=["http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/share/subjectid2742_close.png","http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/share/subjectid2742_iPhone.png","http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/share/subjectid2742_paper.png"],s=Math.floor(Math.random()*o.length);a.imageUrl=o[s]}return this.$generateShareContent(a)},share:function(e){(0,s.TrackingRecord)({op:"click",event:"share_btn_clk",page_name:"subject",page_element:"share_btn",subject_id:this.data.subjectId})},data:{pageName:"subject",size:20,page:1,scrollTop:0,subjectId:"",banner:"",topCls:"",toTopCls:"",noOrderText:"",showMidLoading:!0,isLoadingMore:!1,list:[],localGroups:null,columnNum:"0",cacheScrollTop:0,isFirstEnter:!0,goTopClass:!1,showError:!1,bannerHidden:!0,bannerHeight:"410rpx",isComeFromAd:!1,templeName:"gridItemV1",btnText:"去开团",showShareBtn:!1},componentsAddRootFunc:function(e,t){e&&"function"==typeof t&&(this[e]=t)},onLoad:function(e){this.pvTracking();var t=this;this.navigation_modal=new m.default({setDataFunc:function(e){t.setData({navigationData:e})},addRootFunc:s.Util.bind(t.$componentsAddRootFunc,t),arr:[3,2,1,0]}),e&&this.setData({subjectId:this.$urlQueryObj.subject_id,withCid:!!e.cid}),e.goods_id&&e.goods_id.length>0?(this.$pageName="commercial_middle",wx.setNavigationBarTitle({title:"拼多多"}),this.setData({adGoodsId:e.goods_id,isComeFromAd:!0,bannerHidden:!0,desc:g.desc,columnNum:g.columnNum,templeName:"gridItemV2",bannerHeight:"0px"}),this.requestAdGoods(e.goods_id)):(this.requestHeadIcon(),this.requestList(!0),this.winWidth=s.SystemInfo.getWindowWidthSync()),this.winHeight=s.SystemInfo.getWindowHeightSync(),"2742"==this.$urlQueryObj.subject_id&&this.setData({lotterySubject:!0})},onUnload:function(){a.default.close(this)},onShow:function(){var e=this;this.data.isFirstEnter&&this.setData({isFirstEnter:!1}),a.default.init(this,!1,"",1),r.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking(),"2742"==e.$urlQueryObj.subject_id||e.data.withCid||(e.$BigSalesModal||(e.$BigSalesModal=new l.default({setDataFunc:function(t){e.setData(t)},addRootFunc:s.Util.bind(e.componentsAddRootFunc,e)})),e.$BigSalesModal.showBigSalesFloat()),e.setData({showShareBtn:!0})},initRemaindTime:function(){this.data.list.forEach(function(e,t){e.remaindTime=1e3*e.luckyEndTime-Date.parse(new Date)})},onHide:function(){a.default.close(this),this.navigation_modal&&this.navigation_modal.hide()},reLoad:function(){this.setData({showError:!1,page:1,noOrderText:""}),this.data.list=[],this.data.isComeFromAd?this.requestAdGoods(this.data.adGoodsId):(this.requestHeadIcon(),this.requestList(!1))},onPageScroll:function(e){var t=parseInt(e.scrollTop);this.scrollTopValue=t,o.default.showGoTopBtn(t,this),"commercial_middle"===this.$pageName&&this.updateScrollTop(t)},onReachBottom:function(e){this.data.isComeFromAd||this.requestList(!1)},clickBanner:function(){},requestHeadIcon:function(){var e=this.data,i=s.DataUtil.formatByPos(n.default.subjectRollMessage,e.subjectId),a=this,o=t.default.requestDataWithUrl("GET",i,null,!0);t.default.runMainRequestForPage(o,a).then(function(e){var t=parseInt(e.banner_width_2),i=parseInt(e.banner_height_2)/t,o=Math.floor(i*a.winWidth);!isNaN(o)&&isFinite(o)||(o=140),"2742"===a.data.subjectId?(wx.setNavigationBarTitle({title:"1分拼好货"}),e.desc="限量一分抽豪礼，百分百有奖",a.data.templeName="subjectItem"):(wx.setNavigationBarTitle({title:e.subject||"拼多多"}),a.data.templeName=e.column_num+""=="1"?"SingleListItemV2":"gridItemV1"),a.setData({banner:e.banner_2,bannerHidden:!e.banner_2||0==e.banner_2.length,subject:e.subject,desc:e.desc,columnNum:e.column_num+"",templeName:a.data.templeName,bannerHeight:o+"px"})},function(e){a.setData({banner:"",showError:!0})})},onReady:function(){this.setData({windowHeight:s.SystemInfo.getWindowHeightSync()}),"2742"==this.$urlQueryObj.subject_id&&"lottery_share"==this.$urlQueryObj.lottery_share&&this.$showToast("拼团成功即送88元现金券，快来开团赢好礼吧")},requestList:function(e){var i=this.data,a=i.page,o=i.size,r=i.subjectId,d=s.DataUtil.formatByPos(n.default.subjectGoodsApi,r,a,o);if(1==this.$urlQueryObj.is_push&&(d+="&is_push=1"),!i.isLoadingMore){this.setData({isLoadingMore:!0}),e&&this.setData({showMidLoading:!0});var u=t.default.requestDataWithUrl("GET",d,null,!0),c=this;t.default.runMainRequestForPage(u,c).then(function(e){c.formatListData(e),e&&(e.goods_list.length<i.size?c.setData({page:a+1,noOrderText:"没有更多的商品了..."}):c.setData({page:a+1})),c.setData({isLoadingMore:!1,showMidLoading:!1})},function(e){c.setData({isLoadingMore:!1,showMidLoading:!1,showError:!0})})}},formatListData:function(e,t){if(e&&Array.isArray(e.goods_list)){var a=this,o=[],r=this.data.list,n=this.data.subjectId;e.goods_list.forEach(function(t){var n={};n.goodsId=t.goods_id,n.isApp=t.is_app,n.goodsName=t.goods_name.trim(),n.imgUrl=t.hd_thumb_url?s.ImageUtil.cdnCompress(t.hd_thumb_url):s.ImageUtil.cdnCompress(t.thumb_url),n.price=i.default.price(t.price||t.group.price,100),n.original_price=t.price||t.group.price,n.normal_price=t.normal_price,n.market_price=t.market_price,n.marketPrice=i.default.price(t.market_price,100),n.discount=i.default.price((t.market_price||t.normal_price)-(t.price||t.group.price),100),t.cnt&&(n.soldQuantity=i.default.sales(t.cnt)),t.sales&&(n.soldQuantity=i.default.sales(t.sales)),n.timeSpanDesc=i.default.timeSpan(t.time,e.server_time)+"前",n.countGroup=t.customer_num||t.group.customer_num,n.trackLogFields=t.track_log_fields||null,"0"===n.price?n.isFreeTrial=!0:n.isFreeTrial=!1,"2742"===a.data.subjectId&&(n.luckyEndTime=1*t.lucky_end_time,n.remaindTime=1e3*t.lucky_end_time-Date.parse(new Date),a.renderCountDown(n)),r.push(n),o.push(n.goodsId)}),r=s.DataUtil.objectArrayDuplicateRemove(r,"goodsId",function(e){return 1==e.isApp}),this.setData({list:r}),(1==this.data.columnNum&&-1===h.indexOf(n)||this.data.isComeFromAd)&&this.requestLocalGroup(o)}},requestAdGoods:function(e){var i=this,a=s.DataUtil.formatByPos(n.default.getAdSubject,e),o=this;this.setData({showMidLoading:!0});var r=t.default.requestDataWithUrl("GET",a,null,!0);t.default.runMainRequestForPage(r,o).then(function(e){0===o.data.list.length&&(i.isInitRect()||setTimeout(function(){wx.canIUse&&wx.canIUse("createSelectorQuery")&&wx.createSelectorQuery().selectAll("#impr-id").boundingClientRect(function(e){o.initRect(e,function(e){o.imprItems(e)})}).exec()},500)),o.formatListData(e),o.setData({showMidLoading:!1,noOrderText:"没有更多的商品了..."})},function(e){o.setData({showMidLoading:!1,showError:!0})})},requestLocalGroup:function(e){var t=this;(0,u.default)(c.default.mark(function i(){var a,o;return c.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.prev=0;case 1:if(!(e.length>0)){i.next=9;break}return a=e.splice(0,60),i.next=5,d.default.loadLocalGroups(a,t.data.localGroups,t);case 5:o=i.sent,t.setData({localGroups:o}),i.next=1;break;case 9:i.next=14;break;case 11:i.prev=11,i.t0=i.catch(0),console.error(i.t0);case 14:case"end":return i.stop()}},i,this,[[0,11]])}))},pvTracking:function(){var e={op:"pv",subject_id:this.$urlQueryObj.subject_id};(0,s.TrackingRecord)(e),this.$firstTimeTrackRecord.pv=!0},gotoGoodsDetail:function(e){var t=e.currentTarget.dataset,i=t.goodsId,a=s.DataUtil.checkByKey(this.data.list,i,"goodsId"),o=parseInt(t.index),r=this;this.transGoodsData={goodsId:i,preGroupPrice:a.original_price,preSinglePrice:a.normal_price,preMarketPrice:a.market_price,goodsName:a.goodsName,customerNum:a.countGroup};var n={event:"subject_goods_clk",goods_id:i,idx:o,op:"click",page_section:"goods_list",subject_id:this.$urlQueryObj.subject_id,page_element:"goods",page_sn:10085,page_el_sn:99413};a.trackLogFields&&(n.ad=JSON.stringify(a.trackLogFields)),(0,s.TrackingRecord)(n,function(){var e="/pages/goods/goods?goods_id="+i+"&subject_id="+r.$urlQueryObj.subject_id;r.forward(e)})},forward:function(e){e.indexOf("/pages/goods/goods")>=0&&(e.indexOf("?")>=0?e+="&":e+="?",e+=s.UrlUtil.buildQuery({et:this.$urlQueryObj.et,src:this.$urlQueryObj.src,cid:this.$urlQueryObj.cid,campaign:this.$urlQueryObj.campaign,subject_id:this.$urlQueryObj.subject_id})),s.Navigation.forward(e)},renderCountDown:function(e){e.remaindTime=e.remaindTime-1e3;var t=s.TimeUtil.getPackagedTimeFromTimeBucket(e.remaindTime);if(e.remaindTime<=0&&(e.timeOut=!0,t={days:0,hours:0,minutes:0,seconds:0}),!(e.timeOut&&e.remaindTime<0&&e.hadDraw)){var i="";e.timeOut&&e.remaindTime<0?i="活动结束":t.days>1?i="仅剩"+t.days+"天"+(t.hours>0?t.hours+"小时":""):t.days>0?i="最后"+t.days+"天":t.hours>0?i="最后"+t.hours+"小时":t.minutes>0?i="最后"+t.minutes+"分钟":t.seconds>0&&(i="最后1分钟"),e.drawText=i}},imprItems:function(e){var t=this;e.forEach(function(e){var i=t.data.list||[];if(e<i.length){var a=i[e]||{},o={op:"impr",page_name:"commercial_middle",page_section:"goods_list",page_element:"goods",idx:e,goods_id:a.goodsId,page_sn:10085,page_el_sn:99413};a.trackLogFields&&(o.ad=JSON.stringify(a.trackLogFields)),(0,s.TrackingRecord)(o)}})},navigationTrackingRecord:function(e){var t={op:"click",page_section:"pop_list",page_element:e};(0,s.TrackingRecord)(t)},showNavigationModal:function(){this.navigation_modal&&(this.navigation_modal.show(),this.navigationTrackingRecord("quick_btn"))},hideNavigationModal:function(){this.navigation_modal&&this.navigation_modal.hide()}};(0,s.PddPage)(p,{pageName:"subject",notUseCommonPV:!0}); 
 			}); 	require("pages/subject/subject.js");
 		__wxRoute = 'pages/subjects/subjects';__wxRouteBegin = true; 	define("pages/subjects/subjects.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var a=t(require("../../components/bubble/bubble")),s=require("../../constants/subjects"),i=require("../../common/index"),o=(t(require("../../common/logger_util")),t(require("./subjects_spike"))),r=t(require("../../constants/ui/base64/pull_down_triangle")),n=t(require("../../common/object_util")),c=t(require("../../common/preload")),u=t(require("../../constants/tracking/subjects_collection")),l=t(require("../../storage/ram_manager")),d=t(require("../../configs/api")),p=(t(require("../../libs/es6-promise.min")),t(require("../../libs/co/we-index"))),h=t(require("../../libs/regenerator-runtime/runtime")),b=t(require("../../models/format/grid_item_goods")),f=(t(require("../../common/page_util")),t(require("../../common/gotop_util"))),g=(require("../../common/message"),t(require("../../controller/group"))),m=t(require("../../components/segment/segment.js")),T=t(require("../../components/big_sales/big_sales")),j=t(require("../../components/navigation_modal/navigation_modal.js")),I={1:"SmallMixinPromotion",2:"LargeMixinPromotion",3:"subejct-scroll"},x={setDataObject:{},winHeight:0,cacheDataList:{},dispatchIds:{},listReqLock:{},spikeGoodsScrollLeftPoint:[],spikeTimeLineScrollLeft:[],renderListDataRepo:[],mixInfos:[],allGoodsListCache:[],segmentControl:null,navigation_modal:null,data:{pageName:"subjects",isFirstEnter:!0,curTabIndex:0,sortEnable:!1,subject:"",desc:"",subjectsId:"",topTab:[{showError:!1,size:20,showSortWrapper:!1,sortTypeIndex:0,scrollTop:0,lastScrollTop:0,presetItem:!0}],currentTab:{page:0},$tabsData:[],pageLoading:!0,isShowBlackLoading:!1,isQuickBuyClick:!1,showCls:"show",current:0,isShowWifiError:!1,bubble:{top:"104rpx"},sortTypeData:s.SortTypeData,firstEnter:!0,localGroupsMap:{},curTimeLineIndex:0,timeLineScrollLeft:0,cacheSpikeGoodsScrollLeft:0,spikeGoodsScrollLeft:0,Rpx270:i.Util.rpxToPx(270),Rpx180:i.Util.rpxToPx(180),timeLineLock:!1,showSpike:!1,pullDownTriangle:r.default,contentList:[],goTopClass:!1,showShareBtn:!1},onShareAppMessage:function(t){var e=this.data.curTabIndex,a=this.data.topTab[e].desc,s="";return t&&("menu"==t.from?s="top_forward":"subject-share-btn"==t.target.dataset.subRefer&&(s="subjects_share")),this.$generateShareContent({title:a,queries:{subjects_id:this.$urlQueryObj.subjects_id},referStr:s})},share:function(t){(0,i.TrackingRecord)({op:"click",event:"share_btn_clk",page_name:"subjects",page_element:"share_btn",subjects_id:this.$urlQueryObj.subjects_id})},onReady:function(){this.winHeight=i.SystemInfo.getWindowHeightSync(),this.winWidth=i.SystemInfo.getWindowWidthSync(),this.$urlQueryObj&&"lottery_share_success"===this.$urlQueryObj.from&&this.$showToast("优惠券到账啦，买这些最划算~")},componentsAddRootFunc:function(t,e){t&&"function"==typeof e&&(this[t]=e)},onLoad:function(t){var e=this;this.navigation_modal=new j.default({setDataFunc:function(t){e.setData({navigationData:t})},addRootFunc:i.Util.bind(e.$componentsAddRootFunc,e),arr:[3,2,1,0]});var a={tabsData:this.data.$tabsData,alignType:"align-gap"};this.segmentControl=new m.default(a,this),this.subjectsCollectionId=parseInt(this.$urlQueryObj.subjects_id,10),this.lastTabIndex=parseInt(this.$urlQueryObj.tab_index||0,10),this.lastTabIndex=this.lastTabIndex>0?this.lastTabIndex:0,this.lastSortType=parseInt(this.$urlQueryObj.sort_type||0,10),this.setDataObject={},this.subjectInfo=s.SubjectsSpikeInfo[t.subjects_id]||{},this.subjectCollectionGoodsApi=1==this.$urlQueryObj.is_push?d.default.subjectCollectionGoodsApi+"&is_push=1":d.default.subjectCollectionGoodsApi,isNaN(this.subjectsCollectionId)||(this.setDataObject.sortEnable=!!this.subjectInfo.sortEnable),t.xcx_scene&&(this.setDataObject.xcxScene=t.xcx_scene),t.cid&&(this.setDataObject.withCid=!0),this.pvTracking(),s.SubjectsSpikeInfo[this.subjectsCollectionId]&&(this.setDataObject=n.default.assign(this.setDataObject,{quickEntranceIndex:this.subjectsCollectionId,title:s.SubjectsSpikeInfo[this.subjectsCollectionId].title,subTitle:s.SubjectsSpikeInfo[this.subjectsCollectionId].subTitle,spikeTitle:s.SubjectsSpikeInfo[this.subjectsCollectionId].spikeTitle})),this.setDataObject=n.default.assign(this.setDataObject,{scrollViewWidth:i.SystemInfo.getWindowWidthSync(),subjectsId:t.subjects_id,withNoNavigationModel:t.with_no_navigation_model,curTabIndex:e.lastTabIndex}),this.data=n.default.assign(this.data,this.setDataObject),c.default.preloadPage(t.subjects_id,this.preloadTopTabsDetail,this.requestTagGoodsError,this.loadPage,this)},onUnload:function(){a.default.close(this),l.default.isSpecialOfferSubjects=!1,c.default.preloadUnlock(this.$urlQueryObj.subjects_id),c.default.preloadUnlock(this.$urlQueryObj.subjects_id+"_error")},reLoad:function(){var t,a=l.default.CPPage,s=a.data.curTabIndex||0,i=(a.data.topTab[s]||{}).sortTypeIndex||0;a.setDataObject={},a.setDataObject=n.default.assign(a.setDataObject,(t={},e(t,"topTab["+s+"].showError",!1),e(t,"topTab["+s+"].loadingVisible["+i+"]",!0),t)),a.data.topTab[0].presetItem?(0,p.default)(h.default.mark(function t(){return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,[a.requestTopTabsDetail(a),a.setSubjectsSpikeDetail(a)];case 2:return t.next=4,a.loadSubjectsGoodsDetail(a,0,0);case 4:case"end":return t.stop()}},t,this)})):a.changeTabIndex(s)},onShow:function(){a.default.init(this,!1,"",1),this.data.isFirstEnter&&this.setData({isFirstEnter:!1}),l.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking();var t=this;t.$BigSalesModal||(t.$BigSalesModal=new T.default({setDataFunc:function(e){t.setData(e)},addRootFunc:i.Util.bind(t.componentsAddRootFunc,t)})),this.data.withCid||t.$BigSalesModal.showBigSalesFloat(),t.setData({showShareBtn:!0})},pvTracking:function(){var t={op:"pv",event:"subjects_show",page_name:"subjects",subjects_id:this.subjectsCollectionId};(0,i.TrackingRecord)(t),this.$firstTimeTrackRecord.pv=!0},onHide:function(){a.default.close(this),this.navigation_modal&&this.navigation_modal.hide()},timeLineScroll:function(){},switchSpikeTimeLine:function(t){var e=parseInt(t.currentTarget.dataset.index,10),a=this.spikeGoodsScrollLeftPoint||[];if(!(isNaN(e)||e===this.data.curTimeLineIndex||e<0||e>=a.length)){this.setData({timeLineLock:!0,curTimeLineIndex:e});this.data.cacheSpikeGoodsScrollLeft;this.setData({spikeGoodsScrollLeft:a[e]||0}),this.setData({timeLineLock:!1})}},spikeGoodsScroll:function(t){for(var e=this,a=parseInt(t.detail.scrollLeft,10),s=this.data.Rpx270+46,i=this.spikeGoodsScrollLeftPoint||[],o=this.data.curTimeLineIndex,r=1;r<i.length;r++)if(a+s>=i[r-1]&&a+s<i[r]){o=r-1;break}a>=i[i.length-1]-this.winWidth+100&&(o=i.length-1),this.data.timeLineLock?this.data.cacheSpikeGoodsScrollLeft=a:this.data.curTimeLineIndex!=o?this.cacheScrollInfo?this.cacheScrollInfo={curTimeLineIndex:o,cacheSpikeGoodsScrollLeft:a,timeLineScrollLeft:this.spikeTimeLineScrollLeft[o]}:(this.cacheScrollInfo={curTimeLineIndex:o,cacheSpikeGoodsScrollLeft:a,timeLineScrollLeft:this.spikeTimeLineScrollLeft[o]},setTimeout(function(){e.setData(e.cacheScrollInfo),e.cacheScrollInfo=null},330)):this.data.cacheSpikeGoodsScrollLeft=a},spikeGoodsScrollToLower:function(){this.setData({curTimeLineIndex:this.spikeGoodsScrollLeftPoint.length-1})},generateSubjectsInfoAPI:function(){var t=this.subjectInfo;t.isSpecialOfferSubjects&&!t.doubleSelect?l.default.isSpecialOfferSubjects=!0:l.default.isSpecialOfferSubjects=!1;var e=this.data.subjectsId,a=t.isGenTianType?t.genTianId:e,s=t.hasSpecialUrl?d.default[t.tabUrl]:d.default.promotionCollection;return t.isSpecialOfferSubjects?s:i.DataUtil.formatByPos(s,a)},loadPage:function(t){var e=this,a=e.lastTabIndex,s=e.lastSortType;(0,p.default)(h.default.mark(function i(){var o;return h.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!t){i.next=5;break}return i.next=3,[e.setSubjectsSpikeDetail(e),e.loadSubjectsGoodsDetail(e,a,s)];case 3:i.next=9;break;case 5:return i.next=7,[e.requestTopTabsDetail(e),e.setSubjectsSpikeDetail(e)];case 7:return i.next=9,e.loadSubjectsGoodsDetail(e,a,s);case 9:for(o=1;o<=4;o++)e.reqCatlistData(a+o);case 10:case"end":return i.stop()}},i,this)}))},preloadTopTabsDetail:function(t){var a=l.default.CPPage;t&&t.list&&0!=t.list.length?(a.lastTabIndex>=t.list.length&&(a.lastTabIndex=0),a.setDataObject=n.default.assign(a.setDataObject,{subject:t.name,desc:t.list[0].desc}),a.formatTopTabsData(t),wx.setNavigationBarTitle({title:t.name}),a.loadPage(!0)):a.setData(e({},"topTab[0].showError",!0))},requestTopTabsDetail:p.default.wrap(h.default.mark(function t(e){var a,s,o;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.generateSubjectsInfoAPI(),s=i.Request.requestDataWithUrl("GET",a,null,!0),t.next=5,i.Request.runMainRequestForPage(s,e);case 5:return o=t.sent,e.setDataObject=n.default.assign(e.setDataObject,{subject:o.name,desc:o.list[0].desc}),e.formatTopTabsData(o),wx.setNavigationBarTitle({title:o.name}),t.abrupt("return",o);case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0),e.requestTagGoodsError({tabIndex:0,sortTypeIndex:0,page:1});case 16:case"end":return t.stop()}},t,this,[[0,12]])})),requestSubjectCollectionGoods:p.default.wrap(h.default.mark(function t(e,a){var s,o;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=i.Request.requestDataWithUrl("GET",a,null,!0),t.next=4,i.Request.runMainRequestForPage(s,e);case 4:return o=t.sent,t.abrupt("return",o);case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}},t,this,[[0,8]])})),requestMixed:p.default.wrap(h.default.mark(function t(e,a,s,o,r){var n,c,u,l,p,b,f;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=e.data.topTab[r],c=0,!(n&&n.mixInfo&&n.mixInfo.length&&n.mixInfo[n.mixInfo.length-1])){t.next=7;break}c=n.mixInfo[n.mixInfo.length-1].position,t.next=8;break;case 7:return t.abrupt("return");case 8:if(u=0,e&&e.mixInfos&&e.mixInfos&&e.mixInfos[r]&&(u=e.mixInfos[r][e.mixInfos[r].length-1].position),!(u>=c&&0!=u)){t.next=12;break}return t.abrupt("return");case 12:return l=i.DataUtil.formatByPos(d.default.promotionMix,a),p=1==s?0:s*o,l=l+"?"+i.UrlUtil.buildQuery({start_position:p,end_position:(s+1)*o-1}),b=i.Request.requestDataWithUrl("GET",l,null,!0),t.next=18,i.Request.runMainRequestForPage(b,e);case 18:return f=t.sent,t.abrupt("return",f);case 22:t.prev=22,t.t0=t.catch(0),console.error(t.t0);case 25:case"end":return t.stop()}},t,this,[[0,22]])})),formatMixInfo:function(t){return(t=t||[]).map(function(t){switch(parseInt(t.type,10)){case 3:t.value=t.value||{},t.value.subjectName=t.value.subject,t.value.subjectID=t.value.subject_id,t.value.goodsList=t.value.goods_list||[],t.value.goodsList.map(function(t){return t.goodsID=t.goods_id,t.thumbUrl=i.ImageUtil.cdnCompress(t.hd_thumb_url||t.thumb_url),t.price=i.StdFormat.price(t.price,100),t.goodsName=t.short_name,t.isApp=t.is_app,t}),t.value.goodsList=i.DataUtil.objectArrayDuplicateRemove(t.value.goodsList,"goodsID",function(t){return 1==t.isApp}),delete t.value.goods_list}return t}),t.sort(function(t,e){return t&&e?t.position-e.position:0}),t},formatTopTabsData:function(t){var e=this,a=[];t.list.forEach(function(t,i){var o=[],r=[],n=[],c=[],u=[];s.SortTypeData.forEach(function(t){o.push([]),r.push(1),n.push(!1),c.push(!0),u.push(0)}),a.push({showError:!1,label:t.subject,subjectId:t.subject_id,tabId:t.tab_id,columnNum:parseInt(t.column_num,10),mixInfo:t.mix,pages:r,size:20,canLoadMore:c.concat([]),loadMoreVisible:n.concat([]),loadingVisible:n.concat([]),goodsNumber:u,showSortWrapper:!1,sortTypeIndex:0,scrollTop:0,lastScrollTop:0,desc:t.desc}),e.subjectInfo&&e.subjectInfo.doubleSelect&&(e.mixInfos[i]=e.formatMixInfo(t.mix)),e.renderListDataRepo.push(o)});var i=t.list.map(function(t){return{title:t.subject}});this.segmentControl.refreshTabsData(i),this.segmentControl.updateSelectIndex(this.lastTabIndex),this.setDataObject=n.default.assign(this.setDataObject,{topTab:a,specialStyle:parseInt(t.style||0)}),this.setDataObject=n.default.assign(this.setDataObject,this.segmentControl.$data()),this.setData(this.setDataObject)},onPageScroll:function(t){var e=parseInt(t.scrollTop);f.default.showGoTopBtn(e,this)},getTabKey:function(t,e){return[t,e].join("#")},onReachBottom:function(t){var e=this.data.curTabIndex,a=this.data.topTab[e].sortTypeIndex;this.setDataObject={},this.fillListData(e,a)},getListReqLockKey:function(t,e,a,s){return[t,e,a,s].join("#")},setSubjectsSpikeDetail:p.default.wrap(h.default.mark(function t(e){var a,r,n,c;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=(s.SubjectsSpikeInfo[e.$urlQueryObj.subjects_id]||{}).spikeUrl){t.next=4;break}return t.abrupt("return");case 4:return r=i.Request.requestDataWithUrl("GET",a,null,!0),t.next=7,i.Request.runSecondaryRequestForPage(r,e);case 7:if(n=t.sent,c=o.default.formatData(n),this.spikeGoodsScrollLeftPoint=[],!(c.goodsList&&c.goodsList.length>0)){t.next=14;break}e.setData({showSpike:!0,spikeGoodsList:c.goodsList||[],timelineList:c.timelineList||[]}),t.next=16;break;case 14:return e.setData({showSpike:!1}),t.abrupt("return");case 16:return e.setSpikeScrollLeftPoint(),t.abrupt("return");case 20:t.prev=20,t.t0=t.catch(0),console.error(t.t0);case 23:case"end":return t.stop()}},t,this,[[0,20]])})),setSpikeScrollLeftPoint:function(){var t=this.data.timelineList||[],e=0;this.spikeGoodsScrollLeftPoint[0]=0,e+=12;for(var a=0;a<t.length-1;a++){var s=t[a];e+=s.len*this.data.Rpx270+12*(s.len-1),e+=46,this.spikeGoodsScrollLeftPoint[a+1]=e-6,a<2?this.spikeTimeLineScrollLeft[a]=0:a>=2&&a<=t.length-3?this.spikeTimeLineScrollLeft[a]=(a-1)*this.data.Rpx180:a>t.length-3&&(this.spikeTimeLineScrollLeft[a]=(t.length-4)*this.data.Rpx180)}},loadSubjectsGoodsDetail:p.default.wrap(h.default.mark(function t(a,o,r){var n,c,u,l,p,f,g,m,T,j,I,x,S,D,k,v,L,_,w;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setDataObject={},o=o||0,n=a.data.topTab[o],r=r||n.sortTypeIndex||0,c=s.SortTypeData[r].sortTypeName,u=a.subjectsCollectionId,l=n.pages[r]||1,p=n.size||50,f=n.subjectId,g=a.data.subjectsId,m=a.getListReqLockKey(o,r,l,p),T=a.subjectInfo,!a.listReqLock[m]){t.next=14;break}return t.abrupt("return");case 14:if(!(isNaN(f)&&isNaN(u)||!c)){t.next=16;break}return t.abrupt("return");case 16:if(!isNaN(n.tabId)||!isNaN(f)){t.next=18;break}return t.abrupt("return");case 18:if(n.canLoadMore[r]){t.next=21;break}return this.setData(e({},"topTab["+o+"].canRenderMore["+r+"]",!1)),t.abrupt("return");case 21:if(a.listReqLock[m]=!0,1===l&&(a.setDataObject["topTab["+o+"].loadingVisible["+r+"]"]=!0),j=T.hasSpecialUrl?d.default[T.goodsUrl]:a.subjectCollectionGoodsApi,j=T.doubleSelect&&f?a.subjectCollectionGoodsApi:j,I=T.isGenTianType?T.genTianId:g,x=T.isGenTianType||T.isSpecialOfferSubjects?n.tabId:f,x=T.doubleSelect?f||x:x,S=T.isGenTianType?i.DataUtil.formatByPos(j,I,x,l,p):T.isSpecialOfferSubjects?i.DataUtil.formatByPos(j,x,l,p):i.DataUtil.formatByPos(j,x,c,l,p),S=T.doubleSelect&&f?i.DataUtil.formatByPos(j,x,c,l,p):S,t.prev=30,D=[],!T.isSpecialOfferSubjects){t.next=38;break}return t.next=35,[a.requestSubjectCollectionGoods(a,S)];case 35:D=t.sent,t.next=41;break;case 38:return t.next=40,[a.requestSubjectCollectionGoods(a,S),a.requestMixed(a,f,l,p,o)];case 40:D=t.sent;case 41:return k=D[0]||{},v=D[1]||[],T.doubleSelect||(a.mixInfos[o]=a.mixInfos[o]||[],a.mixInfos[o]=a.mixInfos[o].concat(a.formatMixInfo(v))),L=k.goods_list||[],_=L.length<=0,w=L.map(function(t){return b.default.formatData(t)}),a.processSubjectsGoods({sortTypeIndex:r,tabIndex:o,goodsList:w,goodsNumber:k.size,isLoadAll:_,page:l,size:p}),t.abrupt("return",k);case 48:t.prev=48,t.t0=t.catch(30),console.error(t.t0),a.requestTagGoodsError({tabIndex:o,sortTypeIndex:r,page:l,lockKey:m});case 52:case"end":return t.stop()}},t,this,[[30,48]])})),requestTagGoodsError:function(t){if(this.$showToast("网络出错"),t.lockKey&&(this.listReqLock[t.lockKey]=!1),1===t.page){var a;this.setData((a={},e(a,"topTab["+t.tabIndex+"].showError",!0),e(a,"topTab["+t.tabIndex+"].loadingVisible["+t.sortTypeIndex+"]",!1),a))}else if(t.error_msg){var s;this.setData((s={},e(s,"topTab[0].showError",!0),e(s,"topTab[0].loadingVisible[0]",!1),s))}},processSubjectsGoods:function(t){var a,s=this,o=this,r=t.tabIndex,c=this.data.topTab[r],u=t.sortTypeIndex||0,l=t.page||1,d=t.size||20,b=this.getListReqLockKey(r,u,l,d);this.listReqLock[b]=!1;var f=this.getTabKey(r,u),m=Array.isArray(this.allGoodsListCache[f])?this.allGoodsListCache[f]:[];this.allGoodsListCache[f]=m.concat(t.goodsList);var T=this.allGoodsListCache[f];T=i.DataUtil.objectArrayDuplicateRemove(T,"goodsId",function(t){return 1==t.isApp});var j=this.execMix(r,T);if(this.cacheDataList[f]=j,t.isLoadAll&&1===l){var x=[],S="gridItemV1";1===c.columnNum&&(S="SingleListItemV2"),this.mixInfos[r].forEach(function(t){var e=I[t.type];if(e&&t.value&&s.checkCompatibility(S,e)){t.position=parseInt(t.position,10);var a=t.value;a.itemName=e,x.push(a)}}),this.cacheDataList[f]=x}else if(t.isLoadAll)this.setData(e({},"topTab["+r+"].canLoadMore["+u+"]",!t.isLoadAll));else if(1===c.columnNum){var D=[];t.goodsList.forEach(function(t,e){t.goodsId&&D.push(t.goodsId)}),(0,p.default)(h.default.mark(function t(){var e;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.default.loadLocalGroups(D,o.data.localGroupsMap,o);case 3:e=t.sent,e=n.default.assign(e,o.data.localGroupsMap),o.setData({localGroupsMap:e}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}},t,this,[[0,8]])}))}this.setDataObject=n.default.assign(this.setDataObject,(a={},e(a,"topTab["+r+"].showError",!1),e(a,"topTab["+r+"].pages["+u+"]",l+1),e(a,"topTab["+r+"].loadMoreVisible["+u+"]",!0),e(a,"topTab["+r+"].canLoadMore["+u+"]",!t.isLoadAll),e(a,"topTab["+r+"].loadingVisible["+u+"]",!1),e(a,"topTab["+r+"].goodsNumber["+u+"]",t.goodsNumber||0),e(a,"topTab["+r+"].showSortWrapper",!1),e(a,"topTab["+r+"].sortTypeIndex",u),e(a,"pageLoading",!1),e(a,"firstEnter",!1),a)),this.fillListData(r,u,1===l)},fillListData:function(t,a,s){var i=this,o=this.getTabKey(t,a),r=this.cacheDataList[o]||[],c=(this.data.topTab[t],[]);this.renderListDataRepo&&this.renderListDataRepo[t]&&(c=this.renderListDataRepo[t][a]||[]),s&&(c=[]);var u=c.length;if(!(r.length<=0))if(r.length>u){var l=c.length+(0===u?8:20);c=r.slice(0,l),t===this.data.curTabIndex?(this.setDataObject.contentList=c,this.setDataObject=n.default.assign(this.setDataObject,e({},"topTab["+t+"].canRenderMore["+a+"]",!0)),this.setData(this.setDataObject)):this.setData(this.setDataObject),this.renderListDataRepo[t][a]=c;c.slice(u)}else this.loadSubjectsGoodsDetail(i,t,a)},checkCompatibility:function(t,e){return!(!t||!e)&&(!(["gridItemV1"].indexOf(t)<0&&[I[1]].indexOf(e)>=0)&&!(["SingleListItemV2","superSpikeListItemV2"].indexOf(t)<0&&[I[2],I[3]].indexOf(e)>=0))},execMix:function(t,e){var a=this;e=e||[];var s=this.data.topTab[t],i=this.mixInfos[t]||[],o="gridItemV1",r=!1;1===s.columnNum&&(o="SingleListItemV2",r=!0),1===this.data.specialStyle&&(o="subjectItem");var n=[];return e.forEach(function(t,e){t.itemName=o,t.withLocalGroups=r,n.push(t)}),i.forEach(function(t){var e=I[t.type];if(e&&a.checkCompatibility(o,e)){t.position=parseInt(t.position,10);var s=t.value;if(s.itemName=e,t.position>=n.length)return;isNaN(t.position)||(n[t.position].isMixInfoBefore=!0,n.splice(t.position,0,s))}}),n},showSortSelect:function(){var t=this.getCurrentIndex();(this.data.topTab[t]||{}).showSortWrapper?this.setData(e({},"topTab["+t+"].showSortWrapper",!1)):this.setData(e({},"topTab["+t+"].showSortWrapper",!0))},defaultClick:function(){},hideSortWrapper:function(){var t=this.getCurrentIndex();(this.data.topTab[t]||{}).showSortWrapper&&this.setData(e({},"topTab["+t+"].showSortWrapper",!1))},selectSortType:function(t){var a=this,s=parseInt(t.currentTarget.dataset.sortIndex,10),o=this.getCurrentIndex(),r=this.data.topTab[o],c=t.currentTarget.dataset.sortName;if(this.setDataObject={},!isNaN(s)){var l;this.setDataObject=n.default.assign(this.setDataObject,(l={},e(l,"topTab["+o+"].showSortWrapper",!1),e(l,"topTab["+o+"].sortTypeIndex",s),l)),1===r.pages[s]?((0,i.TrackingRecord)(n.default.assign({},u.default.SortTypeClick,{subjects_id:this.subjectsCollectionId,subject_id:r.subjectId,sort_type:c})),this.loadSubjectsGoodsDetail(a,o,s)):this.renderListDataRepo&&this.renderListDataRepo[o]&&(this.setDataObject.contentList=this.renderListDataRepo[o][s],this.setData(this.setDataObject))}},getCurrentIndex:function(){return this.data.curTabIndex},tabScroll:function(t){},didClickSegmentTab:function(t){var e=parseInt(t.currentTarget.dataset.index,10);if(e!==this.data.curTabIndex){this.setDataObject={},this.segmentControl.updateSelectIndex(e),this.changeTabIndex(e);var a=this.data.topTab[e]||{},s=l.default.isSpecialOfferSubjects?{subjects_id:this.subjectsCollectionId,tab_id:e}:{subjects_id:this.subjectsCollectionId,subject_id:a.subjectId};(0,i.TrackingRecord)(n.default.assign({},u.default.TopBarClick,s))}},changeTabIndex:function(t){var a=this;if(t=parseInt(t,10),!isNaN(t)){var s=this.data.topTab;this.data.curTabIndex=t,this.setDataObject.curTabIndex=t,this.setDataObject=n.default.assign(this.setDataObject,this.segmentControl.$data()),this.setData(this.setDataObject);var o=s[t]||{};a.setData(e({contentList:[]},"topTab["+t+"].loadMoreVisible["+o.sortTypeIndex+"]",!1)),(0,p.default)(h.default.mark(function e(){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.reqCatlistData(t);case 2:a.reqCatlistData(t-1),a.reqCatlistData(t+1);case 4:case"end":return e.stop()}},e,this)}));var r={subjects_id:this.subjectsCollectionId};l.default.isSpecialOfferSubjects?r.tab_id=t:r.subject_id=o.subjectId,(0,i.TrackingRecord)(n.default.assign({},u.default.GoodsListImpr,r))}},reqCatlistData:p.default.wrap(h.default.mark(function t(a){var s,i,o,r;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s=this,i=this.data.topTab,!(a<0||a>=i.length)){t.next=4;break}return t.abrupt("return");case 4:if(o=i[a]||{},r=o.sortTypeIndex||0,1!==o.pages[r]){t.next=11;break}return t.next=9,this.loadSubjectsGoodsDetail(this,a,r);case 9:t.next=12;break;case 11:a===this.data.curTabIndex&&(this.renderListDataRepo[a][r]=this.renderListDataRepo[a][r].slice(0,8),setTimeout(function(){s.setData(e({contentList:s.renderListDataRepo[a][r]},"topTab["+a+"].loadMoreVisible["+r+"]",!0)),setTimeout(function(){f.default.goTop(!0)},100)},100));case 12:case"end":return t.stop()}},t,this)})),forwardGoodsDetail:function(t,e){var a=t.currentTarget.dataset,s=this.getCurrentIndex(),o=this.data.topTab[s];if(a){var r=a.index,c=a.goodsId;if(c){var d=t.currentTarget.dataset.goodsItem;if(this.transGoodsData=d,e){var p=a.subjectId;(0,i.TrackingRecord)({op:"click",event:"goods_clk",page_name:"subjects",page_section:"nested_subject_list",page_element:"goods",subjects_id:this.subjectsCollectionId,subject_id:o.subjectId,nested_subject_id:p})}else{var h={subjects_id:this.subjectsCollectionId,sort_type:o.sortTypeName,idx:r,goods_id:c,page_section:a.refer||"goods_list"};l.default.isSpecialOfferSubjects?h.tab_id=s:h.subject_id=o.subjectId,this.data.isQuickBuyClick?(this.setData({isQuickBuyClick:!1}),(0,i.TrackingRecord)(n.default.assign({},u.default.GoodsBuyButtonClick,h))):(0,i.TrackingRecord)(n.default.assign({},u.default.GoodsClick,h))}var b="/pages/goods/goods?"+i.UrlUtil.buildQuery({goods_id:c,subjects_id:this.subjectsCollectionId});i.Navigation.forward(b)}}},gotoGoodsDetail:function(t){this.forwardGoodsDetail(t,!1)},gotoSubGoodsDetail:function(t){this.forwardGoodsDetail(t,!0)},quickBuyClick:function(t){this.data.isQuickBuyClick||this.setData({isQuickBuyClick:!0})},gotoSubject:function(t){var e=t.currentTarget.dataset.subjectId;e&&i.Navigation.forward("/pages/subject/subject?subject_id="+e);var a=this.getCurrentIndex(),s=this.data.topTab[a];(0,i.TrackingRecord)({op:"click",event:"more_click",page_name:"subjects",page_section:"nested_subject_list",page_element:"more",subjects_id:this.subjectsCollectionId,subject_id:s.subjectId,nested_subject_id:e})},navigationTrackingRecord:function(t){var e={op:"click",page_section:"pop_list",page_element:t};(0,i.TrackingRecord)(e)},showNavigationModal:function(){this.navigation_modal&&(this.navigation_modal.show(),this.navigationTrackingRecord("quick_btn"))},hideNavigationModal:function(){this.navigation_modal&&this.navigation_modal.hide()}};(0,i.PddPage)(x,{pageName:"subjects",notUseCommonPV:!0}); 
 			}); 	require("pages/subjects/subjects.js");
 		__wxRoute = 'pages/comments/comments';__wxRouteBegin = true; 	define("pages/comments/comments.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=e(require("../../common/request")),a=e(require("../../common/url_util")),s=e(require("../../common/navigation")),i=e(require("../../storage/user_storage")),r=require("../../common/index"),o=e(require("../../common/upload_file")),n=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),u=e(require("../../libs/regenerator-runtime/runtime")),d=e(require("../../configs/api")),m=require("../../common/message"),c=e(require("../../configs/app_config")),l={data:{isAdditionalComments:!1,goodsId:"",orderSn:"",thumbUrl:"",type:"",referPageName:"",stars:5,wuliuStars:0,taiduStars:0,submitting:!1,commentImgs:[],words:["很不满意","不满意","一般","满意","很满意"],imageUploaderShow:!0,commentImgsCount:0,canSelImgsCount:6,loadingVisible:!1},onLoad:function(e){e=a.default.parseQuery(e),this.setData({goodsName:e.goods_name,goodsId:e.goods_id,orderSn:e.order_sn,thumbUrl:e.thumb_url,type:e.type,isAdditionalComments:e.isAdditionalComments})},reLoad:function(){this.setData({stars:5})},clickStar:function(e){var t=e.currentTarget.dataset.stars;this.setData({stars:t})},clickWuLiuStar:function(e){var t=e.currentTarget.dataset.stars;this.setData({wuliuStars:t})},clickTaiduStar:function(e){var t=e.currentTarget.dataset.stars;this.setData({taiduStars:t})},chooseCommentImg:o.default.chooseCommentImg,delCommentImg:o.default.delCommentImg,showCommentImg:o.default.showCommentImg,submitAdditionComments:function(e){var a=this,i=this.data,r=e.detail.value.textarea;if(i.submitting)this.$showToast("正在上传，请不要重复提交");else if(0!==r.trim().length)if(r.length>500)this.$showToast("评论应在500字以内");else{var o={order_sn:i.orderSn,comment:r.trim()},n=i.commentImgs;n.length>0&&(o.pictures=n),this.setData({submitting:!0}),t.default.apiRequest("POST","order/goods/review/append",o).then(function(e){e.success?(a.setData({btnText:"已评价"}),m.Message.emit(m.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_ADDITIONAL_COMMENT"}),a.$showToast("感谢您的评价！",{hideToastFunc:function(){s.default.back(0)}})):a.$showToast("评价失败"),a.setData({submitting:!1})},function(e){a.$showToast("评价失败"),a.setData({submitting:!1})})}else this.$showToast("追加评价内容不能为空")},submitComments:function(e){var a=this,r=this.data,o=e.detail.value.textarea,n=5===r.wuliuStars&&5===r.taiduStars&&5===r.stars&&o.trim().length>0;if(r.submitting)this.$showToast("正在上传，请不要重复提交");else if(r.stars<=0||r.wuliuStars<=0||r.taiduStars<=0)this.$showToast("您还没有选择星级评分");else if(o.length>500)this.$showToast("评论应在500字以内");else{var u={goods_id:r.goodsId,order_sn:r.orderSn,desc_score:r.stars,logistics_score:r.wuliuStars,service_score:r.taiduStars,comment:o.trim()},d=r.commentImgs;d.length>0&&(u.pictures=d),this.setData({loadingVisible:!0,submitting:!0}),t.default.apiRequest("POST","v2/order/goods/review",u).then(function(e){if(e.rating_id&&parseInt(e.rating_id,10)>0){var t=i.default.getUserLocalInfo(),r=t&&t.nickName&&t.avatarUrl&&n;r&&a.gotoShareImage(e.rating_id,o.trim(),t),a.$showToast(r?"生成图片中，与好友分享吧":"感谢您的评价！",{hideToastFunc:function(){m.Message.emit(m.KEYS.LOCAL_MANAGE_ORDERS,{behavior:"ORDER_COMMENT"}),r||s.default.back(0)}})}else a.$showToast("评价失败");a.setData({loadingVisible:!1,submitting:!1})},function(e){a.$showToast("评价失败"),a.setData({loadingVisible:!1,submitting:!1})})}},gotoShareImage:function(e,i,o){var m={share_id:r.DataUtil.getRandomString(),share_channel:"message",share_form:"csv1",share_result:"success",refer_share_btn:"share_pic",goods_id:this.data.goodsId,eval_id:e,eval_value:i},l={value:JSON.stringify(m)},g=this;(0,n.default)(u.default.mark(function r(){var n,m,h,f,_,v;return u.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n={user_name:o.nickName,head_pic:o.avatarUrl,eval_id:e,eval_value:i,goods_id:g.data.goodsId},r.prev=2,m=c.default.apiGZDomain+d.default.encodeAlias,h=t.default.requestDataWithUrl("GET",m,l,!0),r.next=7,t.default.runSecondaryRequestForPage(h,g);case 7:f=r.sent,n.__p=f.toString(),r.next=13;break;case 11:r.prev=11,r.t0=r.catch(2);case 13:_=a.default.buildQuery(n),v="/pages/comment_share/comment_share?"+_,s.default.redirectForward(v),r.next=21;break;case 18:r.prev=18,r.t1=r.catch(0),console.error(r.t1);case 21:case"end":return r.stop()}},r,this,[[0,18],[2,11]])}))}};(0,r.PddPage)(l,{pageName:"comments"}); 
 			}); 	require("pages/comments/comments.js");
 		__wxRoute = 'pages/tzfree_list/tzfree_list';__wxRouteBegin = true; 	define("pages/tzfree_list/tzfree_list.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=e(require("./tzfree_list_data")),r=require("../../common/index"),a=e(require("../../common/gotop_util")),o=e(require("../../libs/co/we-index")),s=e(require("../../libs/regenerator-runtime/runtime")),i=e(require("../../configs/api")),n=(e(require("../../constants/coupons")),e(require("../../storage/ram_manager"))),u={data:t.default,onLoad:function(e){var t=parseInt(e.coupon_expire_time,10)||0,r=new Date(1e3*t),a=r.getFullYear(),o=r.getMonth()+1;o=o<10?"0"+o:o;var s=r.getDate();s=s<10?"0"+s:s;var i=parseInt(Date.now()/1e3,10),n="personal"===e.refer_page_name?"我的免单券":"团长免单";this.setData({paramExpireTime:a+"-"+o+"-"+s,showExpireTime:t>i,paramIsGetNew:e.get_coupon+""=="1",paramReferPageName:e.refer_page_name,title:n,expireTime:t,canLoadMore:!0,goTopClass:!1}),this.setTitle(n),this.requestFreeList(),this.requestCouponListDetail()},onShow:function(e){this.setData({canLoadMore:!0})},onHide:function(e){this.clearGroupCountDown()},clearGroupCountDown:function(){null!=this.countDown&&clearTimeout(this.countDown),this.countDown=null},setLeftTimeCountdown:function(){var e=this,t=parseInt(Date.now()/1e3,10),a=1e3*(this.data.expireTime-t-this.deltaTime);a<0&&(a=0);var o=r.TimeUtil.transferToTime(a),s=o.split(":");if(o=s.slice(0,s.length-1).join(":")+":"+s[s.length-1],this.setData({transferedTimeStr:o,leftTime:a}),!(a<=0)){this.clearGroupCountDown();!function t(){e.countDown=setTimeout(function(){var a=e.data.leftTime-1e3,o=r.TimeUtil.transferToTime(a),s=o.split(":");o=s.slice(0,s.length-1).join(":")+":"+s[s.length-1],e.setData({leftTime:a,transferedTimeStr:o,leftTimesArray:s}),a>0&&t()},1e3)}()}},setTitle:function(e){wx.setNavigationBarTitle({title:e})},onReady:function(){this.setData({windowHeight:r.SystemInfo.getWindowHeightSync()})},onPageScroll:function(e){var t=e.scrollTop;a.default.showGoTopBtn(t,this)},onReachBottom:function(e){this.data.isShowFreeCls?this.requestFreeList():this.requestRecommend()},requestFreeList:function(){var e=this,t=this.data,a="free_coupon_goods_list?page="+t.freePage+"&size="+t.freeSize;if(!t.freeIsRequest&&t.canLoadMore){this.setData({freeIsRequest:!0});var o=r.Request.requestDataWithUrl("GET",a);r.Request.runMainRequestForPage(o,this).then(function(r){var a=parseInt(r.useable_coupons_count,10);if(a+""=="0")e.setData({isShowRecCls:"show"}),e.requestRecommend();else{var o=e.formatFreeData(r.goods_list),s=!0;o.length<t.freeSize&&(s=!1),e.setData({canLoadMore:s,loadingVisible:!1,isShowFreeCls:"show",freeIsRequest:!1,freePage:t.freePage+1,freeDataList:t.freeDataList.concat(o)})}e.setData({couponCount:a})},function(t){e.setData({freeIsRequest:!1})})}},getMinOverTime:function(e){for(var t=Number.MAX_VALUE,r=0;r<e.length;++r){var a=e[r].end_time;t>a&&(t=a)}return t},requestCouponListDetail:function(){var e=this;(0,o.default)(s.default.mark(function t(){var a,o,n,u,c;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=Date.parse(new Date)/1e3,o=r.DataUtil.formatByPos(i.default.tzfreeCoupons),n=r.Request.requestDataWithUrl("GET",o),t.next=6,r.Request.runSecondaryRequestForPage(n,e);case 6:u=t.sent,e.deltaTime=u.server_time-parseInt(Date.now()/1e3,10),u.list&&u.list.length>0&&(c=e.getMinOverTime(u.list),e.setData({expireTime:c,showExpireTime:!0}),e.setLeftTimeCountdown()),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0);case 14:case"end":return t.stop()}},t,this,[[0,11]])}))},formatFreeData:function(e){var t=[];return e instanceof Array?(e.forEach(function(e){t.push({goodsId:e.goods_id,imgUrl:r.ImageUtil.cdnCompress(e.hd_thumb_url||e.thumb_url||e.image_url),goodsName:e.goods_name,salePrice:r.StdFormat.price(e.group.price,100)})}),t):t},requestRecommend:function(){var e=this,t=this.data,a="rec_order_list?offset="+t.recOffset+"&count="+t.recCount;if(!t.recIsRequest&&t.canLoadMore){this.setData({recIsRequest:!0});var o=r.Request.requestDataWithUrl("GET",a);r.Request.runSecondaryRequestForPage(o,this.$pageName).then(function(a){var o=e.formatRecData(a.list),s=!0;o.length<t.recCount&&(s=!1);var i=r.DataUtil.objectArrayDuplicateRemove(t.recDataList.concat(o),"goodsId",function(e){return 1==e.isApp});e.setData({loadingVisible:!1,canLoadMore:s,recIsRequest:!1,recOffset:t.recOffset+t.recCount,recDataList:i})},function(t){e.setData({recIsRequest:!1})})}},formatRecData:function(e){var t=[];return e instanceof Array?(e.forEach(function(e){t.push({goodsId:e.goods_id,imgUrl:r.ImageUtil.cdnCompress(e.hd_thumb_url||e.thumb_url),goodsName:e.goods_name,price:r.StdFormat.price(e.price,100),soldQuantity:r.StdFormat.sales(e.sales),customerNum:parseInt(e.customer_num,10),isApp:e.is_app})}),t):t},gotoGoodsDetail:function(e){var t=e.currentTarget.dataset.goodsId;r.Navigation.forward("/pages/goods/goods?goods_id="+t);var a=this.$urlQueryObj.refer_channel_cid;"group_success_download_lucky_xcx"!==a&&"group_success_download_normal_xcx"!==a&&"group_success_rec_lucky_xcx"!==a&&"group_success_rec_normal_xcx"!==a||n.default.rpTest||(n.default.rpTest="0")}};(0,r.PddPage)(u,{pageName:"tzfree_list"}); 
 			}); 	require("pages/tzfree_list/tzfree_list.js");
 		__wxRoute = 'pages/lottery_list/lottery_list';__wxRouteBegin = true; 	define("pages/lottery_list/lottery_list.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=e(require("../../common/url_util")),r=(e(require("../../common/util")),e(require("../../common/image_util"))),s=e(require("../../common/std_format")),i=(e(require("../../components/toast/toast.js")),e(require("../../constants/groups"))),o=require("../../common/index"),a=e(require("../../configs/api")),u=e(require("../../common/request")),l=(e(require("../../common/page_util")),e(require("../../constants/order"))),n=(e(require("../../controller/formid_controller")),{Default:"已开奖",Win:"申请成功",Lose:"申请失败",FreeTrialComplete:"活动结束"}),c=l.default.LotteryStatus;(0,o.PddPage)({data:{isFreeTrial:!1,lotteryStatusLabel:n.Default,luckyUserList:[],showUserList:[],visible:!1,loadingVisible:!0,isLoadingMore:!1,localGroups:null,list:[],size:20,page:1,noMoreText:"",goTopClass:!1,subjectId:"2742",hidePage:!0,btnText:"去开团",isMoreThanShow:!1,showAll:!0,lotteryResult:"",coupon_title:""},setPageTitile:function(){var e=this.data.isFreeTrial?"申请结果":"中奖名单";wx.setNavigationBarTitle({title:e})},onShareAppMessage:function(e){var t=this;this.dismissPopup();var r=["@所有人，我中了88元大奖！快来抢！","[有人@你]我中了88元大奖！再不抢就没了！","抢疯啦！我中了88元大奖！快来试试手气！"],s=Math.floor(3*Math.random());return this.$generateShareContent({title:r[s],path:"/pages/subject/subject",imageUrl:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/lottery/lottery_share_pop.png",referStr:"red_packet_share",queries:{subject_id:"2742",lottery_share:"lottery_share"},successCallback:function(){t.$forward("spike",{from:"lottery_share_success"})},failCallback:function(){t.$showToast("分享到群才能获得88元优惠券哦")}})},loadPage:function(){var e=this,t=this.$urlQueryObj.lucky_id;if(t){var r=a.default.luckyDrawResult+t;u.default.apiRequest("GET",r).then(function(t){var r=e.formatLuckyDrawResult(t);e.processLuckyDrawResult(r)},function(t){var r={errorCode:t.error_code,errorMsg:t.error_msg};e.processLuckyDrawResult(r)})}e.requestList(!0),0==this.winLottery?this.status==l.default.OrderCombinedStatus.UnshippedRefunding||this.status==l.default.OrderCombinedStatus.UnshippedRefunded||this.status==l.default.OrderCombinedStatus.Confirmed&&this.lotteryStatus==c.Complete?this.lotteryResult="second_prize":this.lotteryResult="failed_unpaid":1==this.winLottery&&(this.lotteryResult="first_prize")},formatLuckyDrawResult:function(e){var t=void 0,i=e.detail;if(i){var o=function(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.customer_num>1&&0!==parseInt(r.is_open,10))return e[t]}return{}}(i.group);t={imgUrl:r.default.cdnCompress(i.thumb_url),goodsName:i.goods_name,marketPrice:s.default.price(i.market_price,100),salePrice:s.default.price(o.price,100),eventType:parseInt(i.event_type,10)}}var a=[];return e.list&&e.list.forEach(function(e){a.push({avatar:r.default.getAvatarURL(e.avatar)||r.default.getCDNImgURL("base/logo.jpg"),nickName:e.nickname||"游客",orderSn:e.order_sn,mobile:e.mobile.substr(0,3)+"****"+e.mobile.substr(7)})}),{goods:t,luckyUserList:a,luckyInfo:e.lucky_info,totalLuckyNum:e.total||a.length}},processLuckyDrawResult:function(e){if(e)if(e.errorCode){var t=e.errorMsg||"";this.$showToast(t)}else{var r=e.goods.eventType===i.default.EventType.FREE_TRIAL,s=void 0;if(r){var o=e.luckyInfo;s=o?1===parseInt(o.status,10)?n.Win:n.Lose:n.FreeTrialComplete}var a="";a="second_prize"==this.lotteryResult?"恭喜您获得代金券":"failed_unpaid"==this.lotteryResult?"拼团失败，送你红包！":"",this.setData({goods:e.goods,luckyUserList:e.luckyUserList,showUserList:e.luckyUserList,luckyInfo:e.luckyInfo,totalLuckyNum:e.totalLuckyNum,isFreeTrial:r,rewardListTitle:r?"申请成功名单":"一等奖名单",lotteryStatusLabel:s||n.Default,visible:!0,loadingVisible:!1,hidePage:!1,isMoreThanShow:e.luckyUserList.length>5,showListNum:5,showAll:!(e.luckyUserList.length>5),showTitle:e.luckyUserList.length>5?"展示全部":"收起",lotteryResult:this.lotteryResult,coupon_title:a}),this.setPageTitile(),wx.stopPullDownRefresh()}},onReachBottom:function(){0==this.data.noMoreText.length&&this.requestList(!1)},requestList:function(e){var t=this.data,r=t.page,s=t.size,i="v2/subject/"+t.subjectId+"/goods?page="+r+"&size="+s;if(!t.isLoadingMore){this.setData({isLoadingMore:!0}),e&&this.setData({loadingVisible:!0});var o=u.default.requestDataWithUrl("GET",i,null,!0),a=this;u.default.runMainRequestForPage(o,this).then(function(e){a.formatListData(e),e&&(e.goods_list.length<t.size?a.setData({page:r+1,noMoreText:"没有更多的商品了..."}):a.setData({page:r+1})),a.setData({isLoadingMore:!1,showMidLoading:!1})},function(e){a.setData({isLoadingMore:!1,showMidLoading:!1,showError:!0})})}},showHideList:function(){var e=this;e.setData({showAll:!e.data.showAll}),setTimeout(function(){e.setData({showTitle:e.data.showAll?"收起":"展示全部"})},800)},formatListData:function(e,t){if(e&&Array.isArray(e.goods_list)){var i=[],o=this.data.list;this.data.subjectId;e.goods_list.forEach(function(t){if(!(1e3*t.lucky_end_time<=Date.parse(new Date))){var a={};a.goodsId=t.goods_id,a.goodsName=t.goods_name.trim(),a.imgUrl=t.hd_thumb_url?r.default.cdnCompress(t.hd_thumb_url):r.default.cdnCompress(t.thumb_url),a.price=s.default.price(t.price||t.group.price,100),a.original_price=t.price||t.group.price,a.normal_price=t.normal_price,a.market_price=t.market_price,a.marketPrice=s.default.price(t.market_price,100),a.discount=s.default.price((t.market_price||t.normal_price)-(t.price||t.group.price),100),a.soldQuantity=s.default.sales(t.cnt),a.timeSpanDesc=s.default.timeSpan(t.time,e.server_time)+"前",a.countGroup=t.customer_num||t.group.customer_num,"0"===a.price?a.isFreeTrial=!0:a.isFreeTrial=!1,a.luckyEndTime=1*t.lucky_end_time,a.remaindTime=1e3*t.lucky_end_time-Date.parse(new Date),a.remaindTimeDesc="仅剩"+parseInt(a.remaindTime/864e5)+"天 "+parseInt(a.remaindTime%864e5/36e5)+"小时",o.push(a),i.push(a.goods_id)}}),this.setData({list:o})}},gotoGoodsDetail:function(e){var t=e.currentTarget.dataset,r=t.goodsId,s=o.DataUtil.checkByKey(this.data.list,r,"goodsId"),i=parseInt(t.index),a=this;this.transGoodsData={goodsId:r,preGroupPrice:s.original_price,preSinglePrice:s.normal_price,preMarketPrice:s.market_price,goodsName:s.goodsName,customerNum:s.countGroup};var u={op:"click",event:"goods_clk",page_name:"lottery_list",page_section:"goods_list",page_element:"goods",lucky_id:this.$urlQueryObj.lucky_id,goods_id:r,idx:i};(0,o.TrackingRecord)(u,function(){a.forward("/pages/goods/goods?goods_id="+r)})},forward:function(e){e.indexOf("/pages/goods/goods")>=0&&(e.indexOf("?")>=0?e+="&":e+="?",e+=t.default.buildQuery({et:this.$urlQueryObj.et})),o.Navigation.forward(e)},goToCouponList:function(e){var t={op:"click",event:"coupon_btn_clk",page_name:"lottery_list",page_element:"coupon_btn",lucky_id:this.$urlQueryObj.lucky_id};if((0,o.TrackingRecord)(t),"second_prize"!==this.lotteryResult&&"failed_unpaid"!==this.lotteryResult&&this.setData({scrollToViewId:"draw-goods"}),this.lotteryResult)switch(this.lotteryResult){case"first_prize":this.$showToast("一等奖已经是你的哟，可不要太贪心。");break;case"second_prize":this.showSharePopup();break;case"failed_unpaid":this.gotoHongbao()}else this.$showToast("赶紧参加1分抽奖，赢取88元优惠券~");this.$uploadFormId(e,!1)},gotoHongbao:function(){this.$forward("open_envelope")},showSharePopup:function(){this.setData({showPopup:!0});var e={op:"impr",page_section:"red_packet"};(0,o.TrackingRecord)(e)},dismissPopup:function(){this.setData({showPopup:!1})},hookClick:function(){},didClickSharebtn:function(){var e={op:"click",page_section:"red_packet",page_element:"share_btn"};(0,o.TrackingRecord)(e)},onLoad:function(e){wx.hideShareMenu&&wx.hideShareMenu();e&&(e.ignore_scene=1,this.$urlQueryObj.status&&(this.status=this.$urlQueryObj.status),this.$urlQueryObj.win_lottery&&(this.winLottery=this.$urlQueryObj.win_lottery),this.$urlQueryObj.lottery_status&&(this.lotteryStatus=this.$urlQueryObj.lottery_status),this.$urlQueryObj.lottery_result&&(this.lotteryResult=this.$urlQueryObj.lottery_result)),this.loadPage()}},{pageName:"lottery_list"}); 
 			}); 	require("pages/lottery_list/lottery_list.js");
 		__wxRoute = 'pages/coupons/coupons';__wxRouteBegin = true; 	define("pages/coupons/coupons.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function o(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}e(require("../../components/toast/toast.js"));var t=e(require("../../common/util")),n=e(require("../../common/url_util")),s=e(require("../../common/gotop_util")),a=e(require("../../constants/coupons")),i=e(require("../../common/system_info")),r=e(require("../../models/format/coupons_format")),u=e(require("../../common/data_util")),c=e(require("../../common/request")),p=e(require("../../components/segment/segment.js")),l=e(require("../../configs/api")),d=e(require("../../libs/co/we-index")),h=e(require("../../libs/regenerator-runtime/runtime")),f=require("../../common/index"),g={segmentControl:null,scrollTopValues:{},scrollChanges:{},inRequest:[],data:{couponsScrollHeight:0,scrollTopValue:0,couponsTab:[],curSwiperItem:0,goTopClass:!1,$tabsData:[{title:"未使用"},{title:"已使用"},{title:"已过期"}],curTabIndex:0,superpositionCoupon:{count:0},superpositionCouponUsed:{count:0}},getInitialCouponsTab:function(){var e=this,o=[{tabName:"未使用",className:"available-coupon-list"},{tabName:"已使用",className:"used-coupon-list"},{tabName:"已过期",className:"out-coupon-list"}];o.map(function(o,t){return o.show=!1,o.page=1,o.coupons=[],o.loadMoreVisible=!1,o.canLoadMore=!0,o.scrollTopValue=0,o.noCoupon=!1,o.loadingVisible=!0,e.scrollTopValues[t]=0,e.scrollChanges[t]=!0,o}),this.setData({couponsTab:o})},requestCouponListDetail:d.default.wrap(h.default.mark(function e(o,t){var n,s,a,i,p,d,f,g,m,b,C,T,_,q,v,w,x;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null==o&&(o=this.data.curTabIndex),n=this.data.couponsTab[this.data.curTabIndex].page||1,s=20,a=[n,20,o].join("$"),!((i=this.inRequest.indexOf(a))>=0)){e.next=8;break}return e.abrupt("return");case 8:return this.inRequest.push(a),p=[l.default.avaCouponsHideFreeCoupons,l.default.usedCouponsHideFreeCoupons,l.default.expiredCouponsHideFreeCoupons],d=u.default.formatByPos(p[o],n,s),f=c.default.requestDataWithUrl("GET",d),e.next=14,c.default.runMainRequestForPage(f,t);case 14:return g=e.sent,m=g.server_time||parseInt(Date.now()/1e3,10),b=g.coupons||[],C={couponsCatIndex:o,coupons:(0,r.default)(b,o,m),reqFlag:a,loadAll:b.length<s},(0==this.data.superpositionCoupon.count||0==this.data.superpositionCouponUsed.count)&&g.superposition_coupon_info&&g.superposition_coupon_info.superposition_coupon&&(T=g.superposition_coupon_info.superposition_coupon,_=g.superposition_coupon_info.superposition_coupon_num,T.count=parseInt(_,10)||0,q=(0,r.default)([T],o,m)[0],0==o?this.setData({superpositionCoupon:q}):1==o&&this.setData({superpositionCouponUsed:q})),t.processCoupons(C),e.abrupt("return",C);case 24:e.prev=24,e.t0=e.catch(0),v=this.data.couponsTab[this.data.curTabIndex].page||1,(w=[v,20,o].join("$"))&&(x=this.inRequest.indexOf(w))>=0&&this.inRequest.splice(x,1),console.error(e.t0);case 30:case"end":return e.stop()}},e,this,[[0,24]])})),processCoupons:function(e){try{var t;if(e.reqFlag){var n=this.inRequest.indexOf(e.reqFlag);n>=0&&this.inRequest.splice(n,1)}if(e.errorCode)return void this.$showToast(e.errorMsg);var s=e.couponsCatIndex,a=this.data.couponsTab[s],i=a.coupons||[],r=this.data.superpositionCoupon.count||this.data.superpositionCouponUsed.count||0;this.setData((t={},o(t,"couponsTab["+s+"].coupons",i.concat(e.coupons||[])),o(t,"couponsTab["+s+"].page",0===e.coupons.length?a.page:a.page+1),o(t,"couponsTab["+s+"].canLoadMore",!e.loadAll),o(t,"couponsTab["+s+"].loadMoreVisible",!0),o(t,"couponsTab["+s+"].loadingVisible",!1),o(t,"couponsTab["+s+"].noCoupon",1===a.page&&0===e.coupons.length&&0===r),t))}catch(e){console.error(e)}},scroll:function(e){var o=e.detail.scrollTop,t=this.data.curTabIndex;this.scrollTopValues[t]=o;var n=o<this.winHeight;this.scrollChanges[t]!=n&&(this.scrollChanges[t]=n,s.default.showGoTopBtn(this.scrollTopValues[t],this))},couponListLower:function(){var e=this,o=this.data.curTabIndex;this.data.couponsTab[o].canLoadMore&&(0,d.default)(h.default.mark(function t(){var n;return h.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,[e.requestCouponListDetail(o,e)];case 3:n=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},goTop:function(){this.setData({scrollTop:0})},loadPage:function(){var e=this,o={tabsData:this.data.$tabsData};this.segmentControl=new p.default(o,this);var n=f.ObjectUtil.assign({scrollContainerHeight:i.default.getWindowHeightSync(),couponsScrollHeight:i.default.getWindowHeightSync()-t.default.rpxToPx(80)},this.segmentControl.$data());this.setData(n),(0,d.default)(h.default.mark(function o(){var t;return h.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,[e.requestCouponListDetail(0,e),e.requestCouponListDetail(1,e),e.requestCouponListDetail(2,e)];case 3:t=o.sent,o.next=9;break;case 6:o.prev=6,o.t0=o.catch(0),console.error(o.t0);case 9:case"end":return o.stop()}},o,this,[[0,6]])}))},swiperChange:function(e){var o=parseInt(e.detail.current,10);isNaN(o)||(this.segmentControl.updateSelectIndex(o),this.setData(this.segmentControl.$data()))},didClickSegmentTab:function(e){var o=e.currentTarget.dataset,t=parseInt(o.index,10),n=f.ObjectUtil.assign({curSwiperItem:t},this.segmentControl.$data());this.setData(n)},onReady:function(){this.winHeight=i.default.getWindowHeightSync()},onLoad:function(e){this.getInitialCouponsTab(),this.loadPage()},toCouponUsage:function(e){this.$forward("coupon_usage")},toMatch:function(e){var o=e.currentTarget.dataset,t=o.mallId,s=o.isFree,i=o.isApp,r=o.isCategory,u=o.linkUrl,c=o.isOut,p=o.isFrozen,l=o.type===a.default.CouponBatchType.superimposedCoupon,d=o.index,h=o.couponId;if(!p){if(!c)if(l)this.$forward("promotion_main");else if(t>0)this.$forward("mall_page",{mall_id:t});else if(s)this.$forward("tzfree_list");else if(r&&u){var g=u.indexOf("?"),m=u.slice(g+1),b=u.split(".")[0],C={};C=n.default.parseUrlQueryStr(m),this.$forward(b,C)}else if(i)this.$showToast("只能在App中使用哦");else{var T=o.minAmount,_=o.batchName,q=o.discount;this.$forward("coupon_newbee",{coupon_id:h,min_amount:T,batch_name:_,discount:q})}(0,f.TrackingRecord)({op:"click",page_name:"my_coupons",page_section:"coupon_list",page_element:"coupon",coupon_id:h,idx:d})}}};(0,f.PddPage)(g,{pageName:"coupons"}); 
 			}); 	require("pages/coupons/coupons.js");
 		__wxRoute = 'pages/spike/spike';__wxRouteBegin = true; 	define("pages/spike/spike.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var a=require("../../common/index"),i=(t(require("../../common/logger_util")),t(require("../../configs/api"))),o=t(require("../../constants/tracking/subjects")),s=t(require("../../storage/ram_manager")),r=t(require("../../models/format/spike_goods")),n=require("../../common/message"),d=(t(require("../../libs/es6-promise.min")),t(require("../../libs/co/we-index"))),c=t(require("../../libs/regenerator-runtime/runtime")),u=t(require("../../common/gotop_util")),l=t(require("../../controller/spike_controller")),g=[{dateName:"今日秒杀",datekey:"today"},{dateName:"明日预告",datekey:"tomorrow"},{dateName:"后日预告",datekey:"all_after"}],b={isSettingRemind:!1,cacheGoodsList:[],loadingLock:{},tabTimes:[],goodsLastOneIndex:[],updateSecondTimer:null,globalSecond:0,isOnHideStatus:!1,data:{currentTab:0,dateTabItem:g,dateTabBorderId:g.length,pageName:"spike",topTabData:[],scrollTopValue:0,isFirstEnter:!0,globalSecond:"00"},onShareAppMessage:function(t){var e=this.$urlQueryObj.type||"SPIKE";return this.$generateShareContent({title:"限时秒杀",queries:{type:e}})},onLoad:function(t){var a=this,i=parseInt(t.current_tab||0,10);this.setData({currentTab:i}),this.pvTracking(),this.initTopTabData(),this.getSpikeGoodsDate(this,i),this.getNotificationData(this,i),this.spikeOff=n.Message.on(n.KEYS.WAIT_FOR_SPIKE_SHOW,function(t){var i,o=a.checkGoodsData(t,"goodsId");if(o){var s=o.tabIndex,r=o.timesIndex,n=o.goodsIndex;a.setData((i={},e(i,"topTabData["+s+"].timeList.["+r+"].goodsList["+n+"].buttonClass","ts-remind-btn"),e(i,"topTabData["+s+"].timeList.["+r+"].goodsList["+n+"].buttonType","remind"),i))}})},onShow:function(){this.isOnHideStatus=!1,this.data.isFirstEnter&&this.setData({isFirstEnter:!1}),s.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},initTopTabData:function(){var t=this.data.topTabData,e=this;g.forEach(function(a,i){var o={dateName:a.dateName,datekey:a.datekey,timeList:[],page:1,size:30,canLoadMore:!0,loadMoreVisible:!1,loadingVisible:!1,showError:!1};t[i]=o,e.tabTimes[i]=[],e.goodsLastOneIndex[i]=[]})},clickDateTabItem:function(t){var e=t.currentTarget.dataset||{},i=parseInt(e.index,10);this.setData({currentTab:i}),0===i&&(this.data.topTabData[i].timeList=[],this.data.topTabData[i].page=1,this.data.topTabData[i].canLoadMore=!0,this.tabTimes[i]=null),this.data.topTabData[i]&&1===this.data.topTabData[i].page&&this.getSpikeGoodsDate(this,i),this.delayScrollTop(300),(0,a.TrackingRecord)({op:"click",tab_idx:i,page_name:"seckill",page_section:"tab_list",page_element:"tab"})},delayScrollTop:function(t){setTimeout(function(){u.default.goTop(!0)},t)},onPageScroll:function(t){if(t){var e=parseInt(t.scrollTop);u.default.showGoTopBtn(e,this)}},onReachBottom:function(){this.getSpikeGoodsDate(this,this.data.currentTab)},reLoad:function(){var t,a=this.data.currentTab;this.setData((t={},e(t,"topTabData["+a+"].loadingVisible",!0),e(t,"topTabData["+a+"].showError",!1),t)),this.getSpikeGoodsDate(this,a)},onPullDownRefresh:function(){this.page=1,this.loadSpikeGoodsDetail(this)},onReady:function(){this.$urlQueryObj.type;wx.setNavigationBarTitle({title:"限时抢购"}),this.$urlQueryObj&&"lottery_share_success"===this.$urlQueryObj.from&&this.$showToast("优惠券到账啦，买这些最划算~")},getSpikeGoodsDate:d.default.wrap(c.default.mark(function t(o,s){var r,n,d,u,l,g,b,m,p,h,f;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=o.data.topTabData[s]||{},n=r.page||1,d=r.size||30,u=r.datekey,l=[u,n,d].join("#"),t.prev=5,u&&r.canLoadMore&&!o.loadingLock[l]){t.next=8;break}return t.abrupt("return");case 8:return o.setData(e({},"tab["+s+"].loadingVisible",!0)),o.loadingLock[l]=!0,g=a.DataUtil.formatByPos(i.default.getSpikeGoodsData,u,n,d),b=a.Request.requestDataWithUrl("GET",g,null,!0),t.next=14,a.Request.runMainRequestForPage(b,o);case 14:if(m=t.sent,isNaN(m.error_code)&&!m.error_msg){t.next=19;break}return o.setData((p={},e(p,"tab["+s+"].loadingVisible",!1),e(p,"tab["+s+"].showError",!0),p)),o.loadingLock[l]=!1,t.abrupt("return");case 19:h=o.formatSpikeData(m||{},s,r),o.processSpikeGoodsData({tabData:h,tabIndex:s,lockKey:l}),t.next=28;break;case 23:t.prev=23,t.t0=t.catch(5),o.setData((f={},e(f,"topTabData["+s+"].loadingVisible",!1),e(f,"topTabData["+s+"].showError",!0),f)),o.loadingLock[l]=!1,console.error(t.t0);case 28:case"end":return t.stop()}},t,this,[[5,23]])})),getNotificationData:d.default.wrap(c.default.mark(function t(e,o){var s,r,n,d;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=a.DataUtil.formatByPos(i.default.spikeTodayTextNotification),r=a.Request.requestDataWithUrl("GET",s),t.next=5,a.Request.runMainRequestForPage(r,e);case 5:n=t.sent,d=n.data,e.setData({spikeNotificationArr:d}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0);case 13:case"end":return t.stop()}},t,this,[[0,10]])})),formatSpikeData:function(t,e,a){var i=t.items||[],o=this.tabTimes[e]||[],s=this;return t.times.length<=0?"timeNull":(o.length<=0&&((o=r.default.formatTimeData(t.times,e)).forEach(function(t,i){Array.isArray(a.timeList)||(a.timeList=[]),a.timeList.push({timeLine:t.timeLine,title:t.title,timerText:t.timerText,timerNumObj:t.timerNumObj,isPast:t.isPast,time:t.time,spikeTitleIcon:t.spikeTitleIcon,canShow:!1,goodsList:[],salesOut:0===e?[]:null}),s.goodsLastOneIndex[e][i]={}}),s.globalSecond=o[0].timerNumObj.intSeconds,s.tabTimes[e]=o,clearInterval(s.updateSecondTimer),s.updateSecondTimer=null),i.length<=0?{}:(i.forEach(function(t){if(1==t.type){var i=r.default.formatGoodsData(t.data,o);i.tabIndex=e;var s=a.timeList[i.timesIndex];switch(!0){case i.isFarFuture:e>=2&&(a.canLoadMore=!1);break;case i.isForbidden:break;case i.isSalesOut:!Array.isArray(s.salesOut)&&(s.salesOut=[]),s.salesOut.push(i);break;default:!Array.isArray(s.goodsList)&&(s.goodsList=[]),s.goodsList.push(i)}}else{for(var n=0;n<3;n++)t.data.goods[n]=r.default.formatGoodsData(t.data.goods[n],o),t.data.goods[n].tabIndex=e;a.timeList[t.data.goods[0].timesIndex].goodsList.push(t.data)}}),a.timeList.forEach(function(t,a){t.goodsList.length<=0||["salesOut","goodsList"].forEach(function(i){if(t[i]&&Array.isArray(t[i])&&!(t[i].length<=0)){t.canShow=!0;var o=t[i][t[i].length-1],r=s.goodsLastOneIndex[e][a][i];r&&(t[i][r].isListLastOne=!1),o&&(o.isListLastOne=!0,s.goodsLastOneIndex[e][a][i]=t[i].length-1)}})}),a))},processSpikeGoodsData:function(t){var a=t.tabData,i=t.tabIndex,o=t.lockKey,s=this;if(this.loadingLock[o]=!1,!a||Object.keys(a).length<1){var r;this.setData((r={},e(r,"topTabData["+i+"].canLoadMore",!1),e(r,"topTabData["+i+"].loadingVisible",!1),r))}else if("timeNull"!=a){a.loadingVisible=!1,a.page++,null===this.updateSecondTimer&&(this.updateSecondTimer=setInterval(function(){if(s.globalSecond--,s.globalSecond<0)return s.globalSecond=59,void s.updateMinutesHours(s.globalSecond);var t=s.globalSecond;t<10&&(t="0"+t),s.isOnHideStatus||s.setData({globalSecond:t})},1e3));var n=this.globalSecond;n<10&&(n="0"+n),this.setData(e({globalSecond:n},"topTabData["+i+"]",a))}else{var d;this.setData((d={},e(d,"topTabData["+i+"].showError",!0),e(d,"topTabData["+i+"].loadingVisible",!1),d))}},updateMinutesHours:function(t){for(var a,i=this.data.currentTab,o=this.tabTimes[i]||[],s=this.data.topTabData[i],r=this,n=0;n<o.length;n++){var d=o[n];if(d.timerNumObj.intMinutes--,d.timerNumObj.intSeconds--,d.timerNumObj.intMinutes<0&&s.timeList[n].canShow){d.timerNumObj.intMinutes=59,d.timerNumObj.intHours--;var c=d.timerNumObj.intHours;if(c<0)return r.data.topTabData[i].timeList=[],r.data.topTabData[i].page=1,r.data.topTabData[i].canLoadMore=!0,r.tabTimes[i]=null,void r.getSpikeGoodsDate(r,i);c<10&&(c="0"+c),d.timerNumObj.intHours=c}var u=d.timerNumObj.intMinutes;u<10&&(u="0"+u),d.timerNumObj.minutes=u,s.timeList[n].timerNumObj=d.timerNumObj}this.setData((a={},e(a,"topTabData["+i+"]",s),e(a,"globalSecond",t),a))},forwardGoods:function(t,e){var i=t.currentTarget.dataset.goodsId,s=t.currentTarget.dataset.quantity,r=t.currentTarget.dataset.currentCanBuy,n=t.currentTarget.dataset.current,d=t.currentTarget.dataset.goodsIndex;this.transGoodsData=t.currentTarget.dataset.transData;var c="haitao"==this.$urlQueryObj.refer_page_name,u="";if("btn"==e){if(u=c?"haitao_seckill_btn_clk":"seckill_btn_clk",r&&i){var l=a.ObjectUtil.assign({},o.default.spikeBtnClickParams,{page_element:"quick_buy_btn",goods_id:i});l.event=u,l.idx=d,l.tab_idx=this.data.currentTab,(0,a.TrackingRecord)(l)}else if(!n&&i){var g=a.ObjectUtil.assign({},o.default.spikeBtnClickParams,{page_element:"future_buy_btn",goods_id:i});g.event=u,g.idx=d,g.tab_idx=this.data.currentTab,(0,a.TrackingRecord)(g)}else if(!r&&n&&i&&s){var b=a.ObjectUtil.assign({},o.default.spikeItemClickParams,{page_element:s<0?"seckill_no":"seckill",goods_id:i});b.event=u,b.idx=d,b.tab_idx=this.data.currentTab,(0,a.TrackingRecord)(b)}}else u=c?"haitao_seckill_goods_clk":"seckill_goods_clk",(0,a.TrackingRecord)({op:"click",event:u,page_name:"seckill",page_section:"goods_list",page_element:"seckill",goods_id:i,idx:d,tab_idx:this.data.currentTab});i&&a.Navigation.forward("/pages/goods/goods?goods_id="+i)},goodsItemClicked:function(t){this.forwardGoods(t,"item")},brandGoodsClick:function(t){var e=t.currentTarget.dataset;if(e){var i=e.brandId,o=e.index,s=e.goodsId;(0,a.TrackingRecord)({op:"click",page_section:"goods_list",page_element:"spike_brand",spike_brand_id:i,tab_idx:this.data.currentTab,idx:o,goods_id:s})}},brandClick:function(t){var e=t.currentTarget.dataset&&t.currentTarget.dataset.brandId;e&&this.$forward("brand_spike",{spike_brand_id:e})},onHide:function(){this.isOnHideStatus=!0},onUnload:function(){clearInterval(this.updateSecondTimer),this.spikeOff()},pvTracking:function(){(0,a.TrackingRecord)({op:"pv",event:"seckill_show"}),this.$firstTimeTrackRecord.pv=!0},checkGoodsData:function(t,e){var a=void 0,i=!0;return((this.data.topTabData||[])[this.data.currentTab].timeList||[]).every(function(o){if(o.isPast||o.goodsList.length<=0)return!0;var s=!0;return(o.goodsList||[]).every(function(o,r){return t!==o[e]||(o.goodsIndex=r,a=o,s=!1,i=!1,!1)}),s}),a},goodsRemindSetup:function(t){var i=this,o=t.currentTarget&&t.currentTarget.dataset,s=o.onlyKey,r=o.goodsId,n=o.goodsIndex,d=this.checkGoodsData(s,"onlyKey"),c=void 0;if(d){var u,g=d.tabIndex,b=d.timesIndex;e(u={},"topTabData["+g+"].timeList.["+b+"].goodsList["+n+"].buttonClass","ts-remind-btn"),e(u,"topTabData["+g+"].timeList.["+b+"].goodsList["+n+"].buttonType","remind"),c=u}l.default.goodsRemindSetup(t,d,i,c,function(){(0,a.TrackingRecord)({op:"click",page_name:"seckill",page_section:"goods_list",page_element:"remind_me_btn",tab_idx:i.data.currentTab,goods_id:r,idx:n})})},formClick:function(){}};(0,a.PddPage)(b,{pageName:"spike",notUseCommonPV:!0}); 
 			}); 	require("pages/spike/spike.js");
 		__wxRoute = 'pages/haitao_spike/haitao_spike';__wxRouteBegin = true; 	define("pages/haitao_spike/haitao_spike.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var o=require("../../common/index"),i=(e(require("../../common/logger_util")),e(require("../../configs/api"))),a=e(require("../../constants/tracking/subjects")),s=e(require("../../storage/ram_manager")),r=e(require("../../models/format/spike_list_goods")),n=require("../../common/message"),d=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),l=e(require("../../libs/regenerator-runtime/runtime")),c=e(require("../../common/gotop_util")),u=e(require("../../controller/formid_controller")),p={SPIKE:{title:"限时秒杀",route:i.default.spikeList,shareMsg:{title:"限时秒杀"}},HAITAO_SPIKE:{title:"限时疯抢",route:i.default.haitaoSpikeList,shareMsg:{title:"限时疯抢"}}},g={page:1,dispatchIds:{},loadMoreLock:!1,cacheGoodsList:[],beforeGoodsStartTime:0,isSettingRemind:!1,data:{pageName:"spike",spikeGoods:[],canLoadMore:!0,loadMoreVisible:!1,loadingVisible:!0,scrollTop:0,scrollTopValue:0,isFirstEnter:!0,scrollContainerHeight:0},onShareAppMessage:function(e){var t=this.$urlQueryObj.type||"SPIKE";return this.$generateShareContent({title:p[t].shareMsg.title,queries:{type:t}})},loadSpikeGoodsDetail:d.default.wrap(l.default.mark(function e(t){var a,s,r,n,d,c,u,g;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=t.page,s=50,r=1===t.page,n=(p[t.$urlQueryObj.type||"SPIKE"]||{}).route||i.default.spikeList,!t.loadMoreLock){e.next=4;break}return e.abrupt("return");case 4:return t.loadMoreLock=!0,d=o.DataUtil.formatByPos(n,a,s),c=o.Request.requestDataWithUrl("GET",d,null,!0),e.next=9,o.Request.runMainRequestForPage(c,t);case 9:u=e.sent,g=t.formSpikeGoodsData(u,a,r),wx.stopPullDownRefresh&&wx.stopPullDownRefresh(),t.processSpikeListGoods(g),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])})),formSpikeGoodsData:function(e,t,i){var a=this.cacheGoodsList,s=this;i&&(a=[]);var n=e.goods||[],d=e.server_time||parseInt(Date.now()/1e3,10),l=0===n.length;n.forEach(function(e,o){a.push((0,r.default)(e,{beforeGoodsTime:s.beforeGoodsStartTime||0,isFirstGoods:0===o&&1===t,isPageFirstGoods:0===o,isPagefinalGood:o===n.length-1,isFinalGood:l&&o===n.length-1,pageIndex:t,serverTime:d})),1!==e.is_app&&(s.beforeGoodsStartTime=parseInt(e.start_time,10)||0)}),a=o.DataUtil.objectArrayDuplicateRemove(a,"onlyKey",function(e){return 1==e.isApp});for(var c=0,u=0;u<a.length-1;u++){var p=a[u];if(p.startTime>d)break;c=Math.max(c,p.startTime)}return a[0]&&a[0].startTime<=d&&(a[0].time=o.TimeUtil.formatTime(new Date(1e3*c),"hh:mm")),this.cacheGoodsList=a,{goods:a,isLoadAll:l}},onPageScroll:function(e){if(e){var t=parseInt(e.scrollTop);c.default.showGoTopBtn(t,this)}},onReachBottom:function(){var e=this;this.data.canLoadMore&&this.loadSpikeGoodsDetail(e)},onPullDownRefresh:function(){this.page=1,this.loadSpikeGoodsDetail(this)},onReady:function(){var e=this.$urlQueryObj.type||"SPIKE";wx.setNavigationBarTitle({title:p[e].title})},loadPage:function(){var e=this;this.setData({scrollContainerHeight:o.SystemInfo.getWindowHeightSync()}),this.loadSpikeGoodsDetail(e)},forwardGoods:function(e,t){var i=e.currentTarget.dataset.goodsId,s=e.currentTarget.dataset.quantity,r=e.currentTarget.dataset.currentCanBuy,n=e.currentTarget.dataset.current;this.transGoodsData=e.currentTarget.dataset.transData;var d="haitao"==this.$urlQueryObj.refer_page_name,l="";if("btn"==t){if(l=d?"haitao_seckill_btn_clk":"seckill_btn_clk",r&&i){var c=o.ObjectUtil.assign({},a.default.spikeBtnClickParams,{page_element:"quick_buy_btn",goods_id:i});c.event=l,(0,o.TrackingRecord)(c)}if(!n&&i){var u=o.ObjectUtil.assign({},a.default.spikeBtnClickParams,{page_element:"future_buy_btn",goods_id:i});u.event=l,(0,o.TrackingRecord)(u)}if(!r&&n&&i&&s){var p=o.ObjectUtil.assign({},a.default.spikeItemClickParams,{page_element:s<0?"seckill_no":"seckill",goods_id:i});p.event=l,(0,o.TrackingRecord)(p)}}else l=d?"haitao_seckill_goods_clk":"seckill_goods_clk",(0,o.TrackingRecord)({op:"click",event:l,page_name:"seckill",page_section:"goods_list",page_element:"seckill",goods_id:i});i&&o.Navigation.forward("/pages/goods/goods?goods_id="+i)},itemClicked:function(e){this.forwardGoods(e,"item")},processSpikeListGoods:function(e){this.loadMoreLock=!1,e.errorCode?this.$showToast(e.errorMsg):(this.setData({loadingVisible:!1,loadMoreVisible:!0,spikeGoods:e.goods||[],canLoadMore:!e.isLoadAll}),this.page++)},onUnload:function(){n.Message.off(n.KEYS.WAIT_FOR_SPIKE_SHOW)},onLoad:function(e){this.pvTracking(),this.loadPage()},onShow:function(){var e=this;this.data.isFirstEnter&&this.setData({isFirstEnter:!1}),n.Message.on(n.KEYS.WAIT_FOR_SPIKE_SHOW,function(i){var a,s=o.DataUtil.checkIndexByKey(e.data.spikeGoods,i,"goodsId");e.setData((a={},t(a,"spikeGoods["+s+"].buttonClass","spike-button-remind"),t(a,"spikeGoods["+s+"].buttonType","remind"),a))}),s.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},pvTracking:function(){(0,o.TrackingRecord)({op:"pv",event:"seckill_show"}),this.$firstTimeTrackRecord.pv=!0},goodsRemindSetup:function(e){var t=this,i=e.detail&&e.detail.formId,a=e.currentTarget&&e.currentTarget.dataset||{},r=a.onlyKey,n=a.buttonType,d=a.itemKey,l=a.goodsId,c=o.DataUtil.checkByKey(this.data.spikeGoods,r,"onlyKey"),p=(o.User.getUserLocalInfo()||{}).nickName,g=void 0;switch(n){case"on":this.forwardGoods(e,"btn");break;case"off":return;case"remind":switch(g=o.DataUtil.accMul(c.startTime,1e3),!0){case g-Date.parse(new Date)<0:return void this.$showToast("商品限时抢购中，请点击商品前往抢购");case g-Date.parse(new Date)<18e4:return void this.$showToast("商品即将开抢，请点击商品前往抢购")}this.$showToast("已设提醒，开抢前3分钟自动提醒，请您留意微信消息");break;case"coming":if(this.isSettingRemind||s.default.spikeRemindGoodsIds.indexOf(l.toString())>=0)return;switch(g=o.DataUtil.accMul(c.startTime,1e3),!0){case g-Date.parse(new Date)<0:return void this.$showToast("商品限时抢购中，请点击商品前往抢购");case g-Date.parse(new Date)<18e4:return void this.$showToast("商品即将开抢，请点击商品前往抢购")}var h={scene:1,form_id:i,template_info:{nick_name:p,goods_id:l,goods_name:c.goodsName,original_price:o.DataUtil.accMul(c.marketPrice,100),discount_price:o.DataUtil.accMul(c.salePrice,100),start_time:g}};this.isSettingRemind=!0,u.default.upload(h,o.Util.bind(this.setRemind,this,l,d,g),function(){t.$showToast("设置失败，请稍后重试")})}},formClick:function(){},setRemind:function(e,o,i,a){var r;this.isSettingRemind=!1,!0===a.data||!0===a.success?(this.$showToast("已设提醒，开抢前3分钟自动提醒，请您留意微信消息"),s.default.spikeRemindGoodsIds.push(e.toString()),this.setData((r={},t(r,"spikeGoods["+o+"].buttonClass","spike-button-remind"),t(r,"spikeGoods["+o+"].buttonType","remind"),r))):a.error_code&&"2000101"===a.error_code&&this.$showToast("商品即将开抢，请点击商品前往抢购")}};(0,o.PddPage)(g,{pageName:"haitao_spike",notUseCommonPV:!0}); 
 			}); 	require("pages/haitao_spike/haitao_spike.js");
 		__wxRoute = 'pages/mall_page/mall_page';__wxRouteBegin = true; 	define("pages/mall_page/mall_page.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=e(require("../../common/navigation")),a=e(require("../../common/system_info")),r=(e(require("../../common/util")),e(require("../../common/data_util"))),o=e(require("../../models/format/grid_item_goods")),s=(e(require("../../constants/ui/base64/pull_down_triangle")),e(require("../../components/toast/toast.js")),e(require("../../models/format/mall_info"))),i=e(require("../../constants/storage_keys")),n=e(require("../../common/gotop_util")),l=require("../../common/index"),c=e(require("../../configs/api")),d=(e(require("../../storage/user_storage.js")),e(require("../../storage/ram_manager"))),u=e(require("../../libs/co/we-index")),p=e(require("../../libs/regenerator-runtime/runtime")),g=e(require("../../configs/request_errors")),h=g.default.couponErrorHint,f={FIRST:"已加入收藏,可在您的个人中心查看",DEFAULT:"已加入收藏",LIKE_MALL:"收藏店铺成功"},m={ErrorMessage:{44025:["不能领取更多了","去看看别的券吧"],44026:["该券太火爆","全部已被领完"],44027:["好可惜，领券失败","领券活动刚刚结束哦"]},mallId:"",data:{pageName:"mall_page",mallInfo:{},mallCoupons:[],couponsShow:!1,descShow:!1,descWrapShow:!1,sortType:"default",params:{page:1,size:50},dataList:[],loadingVisible:!0,hidden:!1,needLoadBg:!0,listLoading:!1,flag:!0,scrollTopValue:0,scrollContainerHeight:a.default.getWindowHeightSync(),topShow:!1,noMoreData:!1,hasLiked:!1,mallCouponToastData:{receiveSuccess:!1,toastVisible:!1,mainToast:"",subToast:""},loadingText:"正在加载",goTopClass:!1},loadPage:function(){this.checkMerchantCoupon(this.mallId,this),this.getMallDetail(this.mallId,this),this.getMallCategory(this.mallId,this),this.getListData(),this.getMallGroup()},checkMerchantCoupon:u.default.wrap(p.default.mark(function e(t,a){var r,o,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=l.Request.requestDataWithUrl("GET",c.default.checkMerchantCoupon,{mall_id:t,check_merchant_coupon:"no"},!1),e.next=4,l.Request.runSecondaryRequestForPage(r,a);case 4:return o=e.sent,(i=s.default.formatMallCouponData(o)).forEach(function(e,t){e.canTakenCount>0?(e.receiveBtnEnable=!0,e.receiveBtnText="领取"):(e.receiveBtnEnable=!1,e.receiveBtnText="已领取"),e.takenOut||(a.showCouponArea=!0)}),this.setData({mallCoupons:i,showCouponArea:a.showCouponArea}),e.abrupt("return",o);case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])})),getMallGroup:function(){var e=this;(0,u.default)(p.default.mark(function t(){var a;return p.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getMallGroupInfo(e);case 3:a=t.sent,e.setData({mallGroupData:a}),e.HasleftTime&&a.length>1&&e.expireTimeCount(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}},t,this,[[0,8]])}))},getMallGroupInfo:u.default.wrap(p.default.mark(function e(t){var a,r,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=c.default.getMallGroup,e.next=4,l.Request.apiRequest("POST",a,{mall_id:t.mallId},!0);case 4:return r=e.sent,o=t.formatGroupData(r),e.abrupt("return",o);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),t.$showToast("加载出错");case 13:case"end":return e.stop()}},e,this,[[0,9]])})),formatGroupData:function(e){var t=e.result,a=[];this.HasleftTime=!1;var r=!0,o=!1,s=void 0;try{for(var i,n=t[Symbol.iterator]();!(r=(i=n.next()).done);r=!0){var c=i.value,d={},u=1e3*(c.expire_time-c.server_time),p=l.TimeUtil.transferToTime(u).split(":");u>0&&(this.HasleftTime=!0),d.leftTimeDesc=p.slice(0,p.length-1).join(":")+":"+p[p.length-1],d.leftTime=u,d.avatar=c.avatar?c.avatar:"",d.expireTime=c.expire_time?c.expire_time:"",d.goodsId=c.goods_id?c.goods_id:"",d.goodsName=c.goods_name?c.goods_name:"",d.groupOrderId=c.group_order_id?c.group_order_id:"",d.hdThumbUrl=c.hd_thumb_url?c.hd_thumb_url:"",d.minOnSaleGroupPrice=c.min_on_sale_group_price?l.StdFormat.price(c.min_on_sale_group_price,100):"",d.nickName=c.nickname?c.nickname.slice(0,1)+"*"+(c.nickname.length>1?c.nickname.slice(-1):""):"",d.serverTime=c.server_time?c.server_time:"",d.soldQuantity=c.sold_quantity?c.sold_quantity:"",d.thumbUrl=c.thumb_url?c.thumb_url:"",a.push(d)}}catch(e){o=!0,s=e}finally{try{!r&&n.return&&n.return()}finally{if(o)throw s}}return a},mallGroupSrcoll:function(e){this.isScrolling=!0},expireTimeCount:function(){var e=this;e.HasleftTime&&(e.timeCount=setTimeout(function(){var t=e.data.mallGroupData;e.HasleftTime=!1;for(var a in t){var r=t[a].leftTime-1e3;if(!(r<=0)){var o=l.TimeUtil.transferToTime(r).split(":");e.HasleftTime=!0,t[a].leftTime=r,t[a].leftTimeDesc=o.slice(0,o.length-1).join(":")+":"+o[o.length-1]}}e.data.mallGroupData=t,e.isScrolling||e.setData({mallGroupData:t}),e.isScrolling=!1,e.expireTimeCount()},1e3))},reLoad:function(){this.setData({showError:!1,params:{page:1,size:50},flag:!0,needLoadBg:!1,loadingVisible:!0,categoryShow:!1,noMoreData:!1}),this.loadPage()},onPageScroll:function(e){var t=parseInt(e.scrollTop);if(this.scrollTopValue=t,n.default.showGoTopBtn(t,this),wx.createSelectorQuery){var a=this,r=wx.createSelectorQuery();r.select(".mall_sort_wrapper").boundingClientRect(),r.selectViewport().scrollOffset(),r.exec(function(e){e&&e[0]&&e[0].top<0?a.data.segmentFloat||a.setData({segmentFloat:!0}):a.data.segmentFloat&&a.setData({segmentFloat:!1}),e&&e[0]&&e[1]&&(a.sortScrollTop=e[0].top+e[1].scrollTop)})}},onReachBottom:function(e){var t={};t.size=this.data.params.size,t.page=this.data.params.page+1,this.setData({params:t}),this.getListData()},doLikeOrCancelLikeMall:u.default.wrap(p.default.mark(function e(t,a,r){var o,s;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a&&!r.likeMallsRequestLock){e.next=3;break}return e.abrupt("return");case 3:return r.likeMallsRequestLock=!0,o=t?c.default.doLikeMall:c.default.unLikeMall,e.next=7,l.Request.apiRequest("POST",o+a);case 7:(s=e.sent)&&(d.default.likeMallsIds[a]=t),r.setData({hasLiked:!!d.default.likeMallsIds[a]}),t?(r.$showToast(d.default.isFirstShowLikeHint?f.FIRST:f.LIKE_MALL),d.default.isFirstShowLikeHint=!1):(d.default.likeMallsList=l.DataUtil.removeItemByKey(d.default.likeMallsList,"mallId",a),r.$showToast("取消收藏成功")),r.likeMallsRequestLock=!1,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0),r.$showToast("加载出错");case 18:case"end":return e.stop()}},e,this,[[0,14]])})),mallLike:function(){var e=this.mallId;if(e){var t=!d.default.likeMallsIds[e],a=this;(0,u.default)(p.default.mark(function r(){return p.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,a.doLikeOrCancelLikeMall(t,e,a);case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),console.error(r.t0);case 8:case"end":return r.stop()}},r,this,[[0,5]])}));var r=t?"0":"1";this.headerClickTracking(99796,"like_btn",r)}},mallCustomService:function(e){var a=this.mallId;if(a){var r="/pages/custom_service/custom_service?mall_id="+a;t.default.forward(r),this.$uploadFormId(e,!1),this.headerClickTracking(null,"customer_service",null)}},descWrapShow:function(e){return e.length/Math.floor((a.default.getWindowWidthSync()-20)/13)>3},clickShareBtn:function(e){this.headerClickTracking(null,"mall_share_btn",null)},onShareAppMessage:function(e){var t=this.data.mallInfo.mallName,a="";return e&&("menu"==e.from?a="top_forward":"mall-share-btn"==e.target.dataset.subRefer&&(a="mall_share",t="发现一间好店【"+this.data.mallInfo.mallName+"】,推荐给你")),this.$generateShareContent({title:t,queries:{mall_id:this.$urlQueryObj.mall_id},referStr:a})},getMallDetail:u.default.wrap(p.default.mark(function e(t,a){var r,o,i,n,d;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=a.data.goodsInfo,o=l.DataUtil.formatByPos(c.default.mallInfo,t),i=l.Request.requestDataWithUrl("GET",o,{check_merchant_coupon:"no"},!0),e.next=6,l.Request.runSecondaryRequestForPage(i,a);case 6:return n=e.sent,d=s.default.formatData(n),a.processMallInfo(d),e.abrupt("return",d);case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}},e,this,[[0,12]])})),processMallInfo:function(e){var t=this;e&&(e.errorCode?this.$showToast(e.errorMsg):(this.setData({mallInfo:e,descWrapShow:t.descWrapShow(e.mallDesc)}),this.imprTracking()))},imprTracking:function(){if(!d.default.isFromAppOnShow||!this.$firstTimeTrackRecord.impr){var e=this.data.mallInfo;(0,l.TrackingRecord)({op:"impr",page_name:"mall",page_sn:10039,page_el_sn:99566,mall_id:e.mallId,is_like:this.data.hasLiked?"1":"0",sort:this.data.sortType}),this.$firstTimeTrackRecord.impr=!0}},couponTostShow:function(e,t){var a=this,r={};r.single=!t,r.toastVisible=!0,r.mainToast=e,r.subToast=t,this.setData({mallCouponToastData:r}),setTimeout(function(){a.setData({"mallCouponToastData.toastVisible":!1})},1500)},getCoupon:function(e){var t=e.detail.target.dataset.item,a=e.detail.target.dataset.index,r=function(e){(0,l.TrackingRecord)({op:"click",page_sn:10039,page_name:"mall",page_el_sn:99797,is_success:e,mall_id:t.mall_id,batch_id:t.batchId,idx:a})};if(t.receiveBtnEnable&&!this.gettingCoupon){var o=this,s={mall_id:t.mallId,batch_id:t.batchId},i=t.startTime+"-"+t.endTime+"可用";(0,u.default)(p.default.mark(function e(){var n,c;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o.gettingCoupon=!0,n=l.Request.requestDataWithUrl("POST","take_merchant_coupon",s),e.next=5,l.Request.runMainRequestForPage(n,this);case 5:(c=e.sent)&&c.error_code?(o.handleGetCouponError(o,c,t,a),r(0)):(o.couponTostShow(h.success,i),r(1)),o.gettingCoupon=!1,e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),e.t0&&e.t0.error_code&&(o.handleGetCouponError(o,e.t0,t,a),r(0)),o.gettingCoupon=!1;case 15:case"end":return e.stop()}},e,this,[[0,10]])}))}},handleGetCouponError:function(e,t,a,r){var o=void 0;if(t&&(o=h[t.error_code]),o){var s=o.split("，");s.length>1?e.couponTostShow(s[0],s[1]):e.couponTostShow(o)}else e.couponTostShow(h.fail);var i=e.data.mallCoupons;i[r].receiveBtnEnable=!1,t&&44025===t.error_code?i[r].receiveBtnText="已领取":t&&t.error_code===g.default.CouponTakenOut.code&&(i[r].receiveBtnText="已抢光"),e.setData({mallCoupons:i})},showDesc:function(){this.setData({descShow:!0}),this.headerClickTracking(99171,null,null)},closeDesc:function(){this.setData({descShow:!1})},showCategory:function(){this.setData({categoryShow:!0})},selectSortType:function(e){var t=e.currentTarget.dataset.sortType;if(t&&t!=this.data.sortType){this.setData({params:{page:1,size:50},sortType:t,flag:!0,needLoadBg:!1,loadingVisible:!0,categoryShow:!1,noMoreData:!1}),this.getListData(),wx.pageScrollTo&&this.data.segmentFloat&&wx.pageScrollTo({scrollTop:this.sortScrollTop});var a={default:99176,id:99174,_price:99172,_sales:99175,price:99173};(0,l.TrackingRecord)({op:"click",page_sn:10039,page_el_sn:a[t],mall_id:this.mallId,sort:t,is_like:this.data.hasLiked?"1":"0"})}},selectCategory:function(e){var t=e.currentTarget.dataset.item,a=e.currentTarget.dataset.index;t&&a!=this.data.categoryIndex?(this.setData({params:{page:1,size:50},flag:!0,needLoadBg:!1,loadingVisible:!0,categoryIndex:a,categoryShow:!1,noMoreData:!1}),this.getListData(),(0,l.TrackingRecord)({op:"click",page_sn:10039,page_el_sn:99726,is_like:this.data.hasLiked?"1":"0",idx:a,sort:this.data.sortType,mall_id:this.mallId})):this.setData({categoryShow:!1})},topBannerChange:function(e){var t=e.detail.current;this.setData({curBannerIndex:t})},getMallCategory:u.default.wrap(p.default.mark(function e(t,a){var r,o,s,i,n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=l.DataUtil.formatByPos(c.default.mallCategory,t),o=l.Request.requestDataWithUrl("GET",r,null,!0),e.next=5,l.Request.runMainRequestForPage(o,a);case 5:if((s=e.sent).error_code){e.next=18;break}if(!s.category_list){e.next=17;break}e.t0=p.default.keys(s.category_list);case 9:if((e.t1=e.t0()).done){e.next=17;break}if(i=e.t1.value,0!==s.category_list[i].category_id||0==i){e.next=15;break}return n=s.category_list.splice(i,1),s.category_list.unshift(n[0]),e.abrupt("break",17);case 15:e.next=9;break;case 17:a.setData({categoryIndex:0,curBannerIndex:0,bannerList:s.banner_list,categoryList:s.category_list});case 18:e.next=23;break;case 20:e.prev=20,e.t2=e.catch(0),console.error(e.t2);case 23:case"end":return e.stop()}},e,this,[[0,20]])})),getListData:function(){var e=this.data.params,t=this,a=0,s=0;this.data.categoryList&&this.data.categoryList[this.data.categoryIndex]&&(a=this.data.categoryList[this.data.categoryIndex].category_id||0,s=this.data.categoryList[this.data.categoryIndex].type||0);var i=r.default.formatByPos(c.default.mallCatGoods,this.mallId,a,s,e.page,e.size,this.data.sortType);this.data.flag&&(1==this.mallId&&(i=l.DataUtil.formatByPos(c.default.subjectGoodsApi,2742,e.page,e.size)),1===t.data.params.page?t.setData({listLoading:!1,flag:!1}):t.setData({listLoading:!0,flag:!1}),l.Request.apiRequest("GET",i,null,!0).then(function(e){if(0!==e.goods_list.length){e.goods_list=e.goods_list.map(function(e,a){return e=o.default.formatData(e),1==t.mallId&&(e.nosalenumber=!0),e});var a=[];a=1===t.data.params.page?e.goods_list:t.data.dataList.concat(e.goods_list),a=l.DataUtil.objectArrayDuplicateRemove(a,"goodsId",function(e){return 1==e.isApp}),t.setData({dataList:a}),1===t.data.params.page&&t.setData({loadingVisible:!1,hidden:!0}),t.data.dataList.length>=Number(t.data.mallInfo.goodsNum)||e.goods_list.length<t.data.params.size?t.setData({loadingVisible:!1,listLoading:!1,flag:!1,noMoreData:!0}):t.setData({flag:!0,listLoading:!0,loadingVisible:!1})}else t.setData({loadingVisible:!1,listLoading:!1,flag:!1,hidden:!0,noMoreData:!0})},function(e){t.$showToast("加载出错"),t.setData({showError:!0,flag:!0,loadingVisible:!1})}))},gotoGoodsDetail:function(e){var a=e.currentTarget.dataset.goodsItem;this.transGoodsData=a;var r=e.currentTarget.dataset.index,o="/pages/goods/goods?"+l.UrlUtil.buildQuery({goods_id:a.goodsId});t.default.forward(o),(0,l.TrackingRecord)({op:"click",page_name:"mall",page_sn:10039,page_section:"goods_list",page_el_sn:99755,page_element:"goods",idx:r,goods_id:a.goodsId,mall_id:this.mallId})},clickBannerImage:function(e){var a=e.currentTarget.dataset.goodsId;if(a){var r="/pages/goods/goods?goods_id="+a;t.default.forward(r),(0,l.TrackingRecord)({op:"click",page_sn:10039,page_el_sn:99244,is_like:this.data.hasLiked?"1":"0",sort:this.data.sortType,mall_id:this.mallId})}},preLoadGoodsPage:function(e){var t=getCurrentPages(),a=void 0;if(t.length>1&&(a=t[t.length-2]),a&&a.transGoodsData){var r=a.transGoodsData;r&&r.mallId==e&&wx.setNavigationBarTitle({title:r.mallName})}},pvTracking:function(){var e={op:"pv",page_sn:10039,page_name:"mall",mall_id:this.$urlQueryObj.mall_id};(0,l.TrackingRecord)(e),this.$firstTimeTrackRecord.pv=!0},headerClickTracking:function(e,t,a){var r={op:"click",page_name:"mall",page_sn:10039,mall_id:this.mallId};a&&(r.is_cancel=a),e&&(r.page_el_sn=e),t&&(r.page_element=t),(0,l.TrackingRecord)(r)},onLoad:function(e){this.pvTracking();var t=void 0;e&&(t=l.UrlUtil.parseQuery(e).mall_id,this.mallId=t,l.UrlUtil.parseQuery(e).from_like&&this.showShareTips()),t&&this.setData({hasLiked:d.default.likeMallsIds[t]}),this.preLoadGoodsPage(t),this.loadPage()},onReady:function(){},onShow:function(){var e=this.mallId;if(e){var t=d.default.likeMallsIds[e];t!=!!this.data.hasLiked&&this.setData({hasLiked:t})}d.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking(),this.data.mallInfo.mallId&&this.imprTracking()},goToMallGroup:function(){this.$forward("mall_group",{mall_id:this.mallId}),(0,l.TrackingRecord)({op:"click",page_sn:10039,page_el_sn:99242,is_like:this.data.hasLiked?"1":"0",sort:this.data.sortType,mall_id:this.mallId})},clickGroupItem:function(e){var t=e.currentTarget.dataset.groupOrderId;this.$forward("group",{group_order_id:t})},goToGoodsInfo:function(e){var t=this,a=e.currentTarget.dataset.groupOrderId,r=e.currentTarget.dataset.goodsId,o=e.currentTarget.dataset.index;(0,u.default)(p.default.mark(function o(){var s,i,n,l,c,d;return p.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,t.getGroupOrderDetail(a,t);case 3:s=o.sent,i=s.group_order_info.group_status,n=s.self_order_info,l=s.leader_order_info,c=n&&n.uid===l.uid?2:n?1:0,d=e.currentTarget.dataset.isMallGroup,t.$forward("goods",{goods_id:r,group_order_id:a,status:i,groupRole:c,hideMinLeftTimeLocalGroup:d}),o.next=15;break;case 12:o.prev=12,o.t0=o.catch(0),console.error(o.t0);case 15:case"end":return o.stop()}},o,this,[[0,12]])})),(0,l.TrackingRecord)({op:"click",page_sn:10039,page_el_sn:99241,mall_id:this.mallId,group_order_id:a,idx:o})},getGroupOrderDetail:u.default.wrap(p.default.mark(function e(t,a){var r,o,s;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=l.DataUtil.formatByPos(c.default.groupOrder,t),o=l.Request.requestDataWithUrl("GET",r),e.next=5,l.Request.runSecondaryRequestForPage(o,a);case 5:return s=e.sent,e.abrupt("return",s);case 9:e.prev=9,e.t0=e.catch(0),a.setData({showError:!0,loadingVisible:!1}),a.$showToast("加载出错");case 13:case"end":return e.stop()}},e,this,[[0,9]])})),onHide:function(){},showShareTips:u.default.wrap(p.default.mark(function e(){var t,a,r,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.prev=1,a=Date.parse(new Date),r=i.default.GOODS_FROM_LIKE_DATE,e.next=6,l.StorageUtil.getStorage(r);case 6:(!(o=e.sent)||a-o>2592e5)&&(wx.setStorage({key:r,data:a}),t.setData({shareTipsVisible:!0}),setTimeout(function(){t.setData({shareTipsVisible:!1})},5e3)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:case"end":return e.stop()}},e,this,[[1,10]])}))};(0,l.PddPage)(m,{pageName:"mall_page",notUseCommonPV:!0}); 
 			}); 	require("pages/mall_page/mall_page.js");
 		__wxRoute = 'pages/goods_express/goods_express';__wxRouteBegin = true; 	define("pages/goods_express/goods_express.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}var a=t(require("../../common/navigation")),e=t(require("../../common/system_info")),s=(t(require("../../common/util")),t(require("../../common/request"))),i=(t(require("../../common/std_format")),t(require("../../common/url_util"))),r=(t(require("../../common/time_util")),t(require("../../common/image_util")),t(require("../../common/data_util")),t(require("../../models/format/grid_item_goods"))),o=(t(require("../../constants/ui/base64/pull_down_triangle")),require("../../common/index")),n={SelfLogisticsShippingID:180,OverseaExpressShippingID:149},l={SelfExpress:"商家自建物流无法跟踪<br>请咨询商家",NotSupport:"暂不支持此订单的物流跟踪",Timeout:"此订单的物流查询已超时<br>请稍后再试",QueryFail:"没有查询到物流信息",OverseaExpress:"该海外快递暂无法跟踪<br>请咨询商家"},d={data:{goodsId:"",params:{offset:0,size:20},flag:!0,needLoadBg:!0,loadingVisible:!0,loadingText:"正在加载...",listLoading:!1,topShow:!1,tracking_number:"",shipping:{},thumb_url:"",orderSn:"",state:!1,dataList:[],showCopyBtn:!!wx.setClipboardData,isSelfExpress:!1,error:!0},scrollBottom:function(){if(this.data.flag){var t={};t.size=this.data.params.size,t.offset=this.data.params.offset+t.size,80===t.offset&&this.setData({listLoading:!1}),this.setData({params:t,flag:!1}),this.getDataList()}},goTop:function(){this.setData({scrollTop:0})},scroll:function(t){var a=t.detail;if(a){var e=parseInt(a.scrollTop);e>=this.data.scrollContainerHeight&&!this.data.topShow&&this.setData({topShow:!0}),e<this.data.scrollContainerHeight&&this.data.topShow&&this.setData({topShow:!1})}},preLoadGoodsPage:function(t){var a=getCurrentPages(),e=void 0;if(a.length>1&&(e=a[a.length-2]),e&&e.transGoodsData){var s=e.transGoodsData;s&&s.mallId==t&&wx.setNavigationBarTitle({title:s.mallName})}},loadPage:function(){this.getExpressData(),this.getDataList()},getExpressData:function(){var t=this,a="order/"+this.data.orderSn+"/shipping";s.default.apiRequest("GET",a).then(function(a){var e=a.is_support,s=a.shipping;t.serverTime=a.server_time;var i=parseInt(s.shipping_id,10),r=i===n.SelfLogisticsShippingID,o=i===n.OverseaExpressShippingID;null==e&&(e=!0),s&&s.traces&&s.traces.length>0&&(e=!0);var d=!1,p="";r?(p=l.SelfExpress,d=!0):o?(e=!0,p=l.OverseaExpress,d=!0):e||(p=l.NotSupport,d=!0);var u=r||o||!e;t.setData({isSupport:e,shipping:s,noTraceLabel:p,noError:d,isSpl:u,isSelfExpress:r}),t.shippingData(s)},function(t){})},shippingData:function(t){var a="",e=[],s=this.data.isSpl,i="",r=this.data.noError,o=this.data.thumb_url,d=this.data.tracking_number,p=this.data.shippingName,u=this.data.state,h=t.is_cngg_support&&t.traces&&t.traces.length>1,g=!1;if(t){if(a=t.shipping_name||p||"",d=t.tracking_number||d||"",t.thumb_url||o||"",e=t.traces||[],t.shipping_id===n.SelfLogisticsShippingID?(i=l.SelfExpress,r=!0):t.shipping_id===n.OverseaExpressShippingID?(i=l.OverseaExpress,r=!0):e.length<=0&&("物流信息加载不成功，再试试吧~",i=l.QueryFail,r=!0),e.length>3&&(u=!0,e=e.slice(0,3)),e[0]&&"SIGN"!=e[0].status){var c=new Date;c.setFullYear(2017,11,10),c.setHours(0,0,0);var m=new Date;m.setFullYear(2017,11,16),m.setHours(0,0,0);var f=1e3*this.serverTime;if(f>c.getTime()&&f<m.getTime()){var _=e[0].time,v=new Date(_).getTime()/1e3+172800;this.serverTime>v&&(g=!0)}}}else a=p||"",d=d||"",o||"",a.toString().length<=0&&(a="获取物流信息失败"),"获取物流信息失败",s=!0,i=l.Timeout,r=!0;this.setData({state:u,error:r,noTraceLabel:i,isNewbieExpress:h,shipmentProvider:a,isSpl:s,traces:e,loadingVisible:!1,showDelaySale:g})},toCustomService:function(t){var a=this.data.mallId;a&&this.$forward("custom_service",{mall_id:a})},callPhone:function(t){var a=t.currentTarget.dataset.phone;wx.makePhoneCall({phoneNumber:a})},stateChange:function(){var t=!this.data.state,a=this.data.shipping.traces;t?(a=a.slice(0,3),this.goTop()):a=a,this.setData({state:t,traces:a})},getDataList:function(){var t=this,a=this,e=this.data.params.offset,o=this.data.params.size;if(!(e>=100)){var n="recommendation/express?";n+=i.default.buildQuery({order_sn:this.data.orderSN,offset:e,count:o,goods_id:this.data.shipping.goods_id}),s.default.apiRequest("GET",n).then(function(s){if(0===e&&t.setData({listLoading:!0}),s.list&&s.list.length>0){var i=s.list.map(function(t,a){return t=r.default.formatData(t)});t.setData({dataList:a.data.dataList.concat(i),flag:!0})}else t.setData({flag:!1})},function(t){})}},copyOrderSn:function(){var t=this;this.data.showCopyBtn&&wx.setClipboardData({data:t.data.shipping.tracking_number+"",success:function(a){wx.getClipboardData({success:function(a){a.data===t.data.shipping.tracking_number+""&&t.$showToast("复制成功")}})}})},pageChange:function(t){var a=this.data.orderSn,e=this.data.tracking_number;this.data.thumb_url;this.$forward("express_complaint",{order_sn:a,tracking_number:e})},gotoGoodsDetail:function(t){var e=t.currentTarget.dataset.goodsItem;this.transGoodsData=e;var s="/pages/goods/goods?"+i.default.buildQuery({goods_id:e.goodsId});a.default.forward(s)},onLoad:function(t){if(t){var a=i.default.parseQuery(t),e=a.order_sn,s=a.thumb_url,r=a.tracking_number,o=a.shipping_name,n=a.mall_id;this.setData({thumb_url:s,orderSn:e,tracking_number:r,shipping_name:o,mallId:n})}this.loadPage()},onReady:function(){this.setData({scrollContainerHeight:e.default.getWindowHeightSync()})},goToOpenEnv:function(){this.$forward("open_envelope"),(0,o.TrackingRecord)({op:"click",page_element:"banner"})}};(0,o.PddPage)(d,{pageName:"goods_express"}); 
 			}); 	require("pages/goods_express/goods_express.js");
 		__wxRoute = 'pages/haitao/haitao';__wxRouteBegin = true; 	define("pages/haitao/haitao.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var o,i=t(require("../../components/bubble/bubble")),a=require("../../common/index"),s=t(require("../../configs/api")),n=t(require("../../controller/group")),r=t(require("../../common/gotop_util")),c=t(require("../../models/format/grid_item_goods")),l=(t(require("../../libs/es6-promise.min")),t(require("../../libs/co/we-index"))),u=t(require("../../libs/regenerator-runtime/runtime")),d=t(require("../../components/big_sales/big_sales")),h=[{type:0,title:"商品分类",tip:"应有尽有",titleColor:"#ff70b0",textIconClass:" category-text-icon",img:a.ImageUtil.getCDNImgURL("haitao/haitao_opt_entrance_img.png"),pageName:"catgoods",query:{opt_id:12,opt_type:1,opt_name:"进口海淘"}},{type:1,title:"限时疯抢",tip:"",titleColor:"#ff70b0",textIconClass:" spike-text-icon",img:"",pageName:"haitao_spike",query:{type:"HAITAO_SPIKE"}},{type:2,title:"特价爆款",tip:"全球精选特价专区",titleColor:"#FC6504",textIconClass:" recommend-text-icon",img:"",pageName:"subjects",query:{subjects_id:16}}],g=(o={deltaTime:0,page:1,goodsListReqLock:!1,haitaoGoodsDispatchId:null,cacheNoMixGoodsList:[],cacheGoodsList:[],defaultClick:function(){},data:{visible:!0,loadingMoreVisible:!1,serviceList:[{title:"正品保障",iconFontClass:"service-quality"},{title:"包税包邮",iconFontClass:"service-postage"},{title:"极速发货",iconFontClass:"service-top-speed"}],showError:!1,entranceData:[h[0],h[2]],haitaoList:[],loadingVisible:!0,triggerSeeAll:!1,canLoadMore:!0,goTopClass:!1,localGroupsMap:{}},onShareAppMessage:function(t){return this.$generateShareContent({title:"海淘专区"})},onReady:function(){this.winHeight=a.SystemInfo.getWindowHeightSync()},gotoGoodsDetail:function(t){var e=t.currentTarget.dataset;if(e){var o=e.goodsId;if(o){var i=t.currentTarget.dataset.goodsItem;this.transGoodsData=i,this.$forward("goods",{goods_id:o})}}},gotoSubGoodsDetail:function(t){this.gotoGoodsDetail(t)},clickBannerPart:function(t){var e=parseInt(t.currentTarget.dataset.type,10);if(!isNaN(e)&&e>=0&&e<h.length){var o=h[e]||{},i=o.pageName,a=o.query||{};i&&this.$forward(i,a)}},onShow:function(){i.default.init(this,!1,"",1),this.setCountDown();var t=this;t.$BigSalesModal||(t.$BigSalesModal=new d.default({setDataFunc:function(e){t.setData(e)},addRootFunc:a.Util.bind(t.componentsAddRootFunc,t)})),t.$BigSalesModal.showBigSalesFloat()},onHide:function(){i.default.close(this),this.clearCountDown()},loadHaitaoGoodsList:function(){if(!this.goodsListReqLock&&this.data.canLoadMore){var t=this;this.getHaitaoGoodsList(t)}},getHaitaoGoodsList:l.default.wrap(u.default.mark(function t(e){var o,i,n,r,c,l,d;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.goodsListReqLock){t.next=3;break}return t.abrupt("return");case 3:return e.goodsListReqLock=!0,o=e.page,i=50,n=1===o,r=a.DataUtil.formatByPos(s.default.haitaoGoodsList,o,i),c=a.Request.requestDataWithUrl("GET",r,null,!0),t.next=7,a.Request.runMainRequestForPage(c,this);case 7:l=t.sent,d=e.formatHaitaoGoodsList(l,n),e.processHaitaoGoods(d),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0),e.requestError();case 16:case"end":return t.stop()}},t,this,[[0,12]])})),requestError:function(){this.goodsListReqLock=!1,1===this.page&&this.setData({showError:!0,loadingVisible:!1})},formatHaitaoGoodsList:function(t,e){var o=t.goods_list||[],i=[],s=[];return(t.home_recommend_subjects||[]).forEach(function(t){var e={subjectID:t.subject_id,subjectName:t.subject,position:parseInt(t.position,10),goodsList:[],tpl:"subejct-scroll"};(t.goods_list||[]).forEach(function(t){e.goodsList.push({goodsID:t.goods_id,goodsName:t.short_name,thumbUrl:a.ImageUtil.cdnCompress(t.hd_thumb_url||t.thumb_url),price:a.StdFormat.price(t.price,100)})}),s.push(e)}),e&&(this.cacheNoMixGoodsList=[]),o.forEach(function(t){var e=c.default.formatData(t);e.tpl="SingleListItemV2",i.push(e)}),i=a.DataUtil.objectArrayDuplicateRemove(i,"goodsId"),this.cacheNoMixGoodsList=this.cacheNoMixGoodsList.concat(i),this.cacheNoMixGoodsList=a.DataUtil.objectArrayDuplicateRemove(this.cacheNoMixGoodsList,"goodsId",function(t){return 1==t.isApp}),{allGoodsList:this.cacheNoMixGoodsList,subjectsData:s,loadAll:o.length<=0}},processHaitaoGoods:function(t){this.goodsListReqLock=!1,this.setData({canLoadMore:!t.loadAll,loadingVisible:!1});var e=t.allGoodsList||[],o=t.subjectsData,i=this.execMix([].concat(e),o);this.cacheGoodsList=i,this.fillListData(1===this.page),this.page++},onReachBottom:function(){this.fillListData()},onPageScroll:function(t){var e=parseInt(t.scrollTop,10);r.default.showGoTopBtn(e,this)},fillListData:function(t){var e=this,o=this.cacheGoodsList||[],i=this.data.haitaoList||[];t&&(i=[]);var a=i.length;if(o.length>a){var s=i.length+20;i=o.slice(0,s),this.setData({loadingMoreVisible:!0,haitaoList:i});var r=[];i.slice(a).forEach(function(t,e){t.goodsId&&2==t.customerNum&&r.push(t.goodsId)}),(0,l.default)(u.default.mark(function t(){var o;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.default.loadLocalGroups(r,e.data.localGroupsMap,e);case 3:o=t.sent,e.setData({localGroupsMap:o}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}},t,this,[[0,7]])}))}else this.loadHaitaoGoodsList()},execMix:function(t,e){return e.forEach(function(e){isNaN(e.position)||t.splice(e.position,0,e)}),t},gotoSubject:function(t){var e=t.currentTarget.dataset.subjectId;e&&this.$forward("subject",{subject_id:e})},loadBannerInfo:function(){var t=this,e=a.Request.requestDataWithUrl("GET",s.default.haitaoBanner,null,!0);a.Request.runMainRequestForPage(e,this).then(function(e){var o=parseInt(e.have_spike_goods,10);o=1===o?1:0,h[1].img=a.ImageUtil.cdnCompress(e.spike_thumb_url),h[2].img=a.ImageUtil.cdnCompress(e.promotion_goods_url);var i=1e3*parseInt(e.server_time,10);isNaN(i)&&(i=Date.now()),t.deltaTime=i-Date.now(),t.setData({visible:!0,nextSpikeTime:parseInt(e.next_spike_time,10)||0,entranceData:[h[o],h[2]]}),t.setCountDown()},function(e){t.setData({showError:!0,loadingVisible:!1}),t.$showToast(e.error_msg)})},setCountDown:function(){var t=this,e=this.data.nextSpikeTime,o=Date.now()+this.deltaTime;if(e){var i=1e3*e-o;if(!(i<=0)){this.setData({triggerSeeAll:!1,leftTimesArray:a.TimeUtil.transferToTime(i).split(":")}),null!=this.countDown&&this.clearCountDown();!function e(){t.countDown=setTimeout(function(){i-=1e3,t.setData({leftTimesArray:a.TimeUtil.transferToTime(i).split(":")}),i>0?e():(t.setData({triggerSeeAll:!0}),t.clearCountDown())},1e3)}()}}},reLoad:function(){this.loadPage()},loadPage:function(){this.setData({loadingVisible:!0,showError:!1}),this.loadBannerInfo(),this.loadHaitaoGoodsList()}},e(o,"reLoad",function(){this.loadPage()}),e(o,"componentsAddRootFunc",function(t,e){t&&"function"==typeof e&&(this[t]=e)}),e(o,"onLoad",function(t){this.loadPage()}),e(o,"clearCountDown",function(){clearTimeout(this.countDown),this.countDown=null}),e(o,"onUnload",function(){i.default.close(this),this.clearCountDown()}),o);(0,a.PddPage)(g,{pageName:"haitao"}); 
 			}); 	require("pages/haitao/haitao.js");
 		__wxRoute = 'pages/after_sales/after_sales';__wxRouteBegin = true; 	define("pages/after_sales/after_sales.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}e(require("../../components/toast/toast.js")),e(require("../../constants/coupons"));var a=e(require("../../configs/api")),r=e(require("../../libs/co/we-index")),s=e(require("../../libs/regenerator-runtime/runtime")),n=e(require("../../components/segment/segment.js")),o=require("../../common/index"),i={segmentControl:null,inRequest:[],data:{pageScrollHeight:0,scrollTopValue:0,afterSalesTab:function(){var e=[{tabName:"全部",range:"all"},{tabName:"待用户处理",range:"pending"}];return e.map(function(e){return e.show=!1,e.page=1,e.offset=0,e.groupList=[],e.loadMoreVisible=!1,e.canLoadMore=!0,e.scrollTopValue=0,e.noGroupList=!1,e.loadingVisible=!0,e}),e}(),curSwiperItem:0,$tabsData:[{title:"全部"},{title:"待用户处理"}],curTabIndex:0},requestGroupListDetail:r.default.wrap(s.default.mark(function e(t,r,n){var i,u,l,f,d,c,p,g,h;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null==t&&(t=r.data.curTabIndex),n&&r.data.afterSalesTab&&r.data.afterSalesTab[t]&&(r.data.afterSalesTab[t].offset=0),i=r.data.afterSalesTab[t],u=i.range,l=i.offset,f=10,d=[u,l,f,t].join("$"),!(r.inRequest.indexOf(d)>=0)){e.next=10;break}return e.abrupt("return",{});case 10:return this.inRequest.push(d),c=o.DataUtil.formatByPos(a.default.afterSales,u,l,f),e.next=14,o.Request.apiRequest("GET",c);case 14:return p=e.sent,wx.stopPullDownRefresh&&wx.stopPullDownRefresh(),g=p.after_sales_list,h=r.formatGroupList(g),n&&r.data.afterSalesTab&&r.data.afterSalesTab[t]&&(r.data.afterSalesTab[t].groupList=[]),r.processGroupList({groupList:h,reqFlag:d,groupCatIndex:t,loadAll:g.length<f}),e.abrupt("return",p);case 23:e.prev=23,e.t0=e.catch(0);case 25:case"end":return e.stop()}},e,this,[[0,23]])})),formatGroupList:function(e){var t={0:"初始化",1:"申请收到，商家处理中",2:"平台处理中",3:"平台处理中",4:"退款中",5:"退款成功",6:"申请已撤销",7:"申请被驳回",8:"申请结束",9:"退款被驳回，待用户处理",10:"待用户发货",11:"商家处理中",12:"退款失败",13:"退款关闭"};return e.map(function(e){e.order_amount=o.StdFormat.price(e.order_amount,100),e.refund_amount=o.StdFormat.price(e.refund_amount,100),e.status_text=t[e.after_sales_status]||""}),e},processGroupList:function(e){var a;if(e.reqFlag){var r=this.inRequest.indexOf(e.reqFlag);r>=0&&this.inRequest.splice(r,1)}if(e.errorCode)this.$showToast(e.errorMsg);else{var s=e.groupCatIndex,n=this.data.afterSalesTab[s],o=n.groupList||[];this.setData((a={},t(a,"afterSalesTab["+s+"].groupList",o.concat(e.groupList||[])),t(a,"afterSalesTab["+s+"].offset",n.offset+10),t(a,"afterSalesTab["+s+"].canLoadMore",!e.loadAll),t(a,"afterSalesTab["+s+"].loadMoreVisible",!0),t(a,"afterSalesTab["+s+"].loadingVisible",!1),t(a,"afterSalesTab["+s+"].noGroupList",1===n.page&&0===e.groupList.length),a))}},afterSalesListLower:function(){var e=this,t=this.data.curTabIndex;this.data.afterSalesTab[t].canLoadMore&&(0,r.default)(s.default.mark(function a(){var r;return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,[e.requestGroupListDetail(t,e)];case 3:r=a.sent,a.next=8;break;case 6:a.prev=6,a.t0=a.catch(0);case 8:case"end":return a.stop()}},a,this,[[0,6]])}))},openMoneyPath:function(e){var t=e.currentTarget.dataset.order_sn,a=e.currentTarget.dataset.id;null==t||t.length<=0||null==a||a.length<=0||this.$forward("money_path",{order_sn:t,id:a})},applyRefundDetail:function(e){var t=e.currentTarget.dataset.after_sales_id;null==t||t.length<=0||this.$forward("afterSalesStatus_detail",{after_sales_id:t})},loadPage:function(){var e=this,t={tabsData:this.data.$tabsData};this.segmentControl=new n.default(t,this);var a=o.ObjectUtil.assign({scrollContainerHeight:o.SystemInfo.getWindowHeightSync(),pageScrollHeight:o.SystemInfo.getWindowHeightSync()-o.Util.rpxToPx(80)},this.segmentControl.$data());this.setData(a),(0,r.default)(s.default.mark(function t(){var a,r,n;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,[e.requestGroupListDetail(0,e),e.requestGroupListDetail(1,e)];case 3:a=t.sent,(r=a[1])&&(n=parseInt(r.pending_total_unread)>0,e.segmentControl.setDedDot(1,n)),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}},t,this,[[0,9]])}))},reloadButtonAction:function(){var e=this.data.curTabIndex;this.setData(t({},"afterSalesTab["+e+"].scrollTopValue",0)),wx.startPullDownRefresh&&wx.startPullDownRefresh(),this.requestGroupListDetail(e,this,!0)},swiperChange:function(e){var t=parseInt(e.detail.current,10);isNaN(t)||(this.segmentControl.updateSelectIndex(t),this.setData(this.segmentControl.$data()))},didClickSegmentTab:function(e){var t=e.currentTarget.dataset,a=parseInt(t.index,10),r=o.ObjectUtil.assign({curSwiperItem:a},this.segmentControl.$data());this.setData(r)},onLoad:function(e){this.loadPage()}};(0,o.PddPage)(i,{pageName:"after_sales"}); 
 			}); 	require("pages/after_sales/after_sales.js");
 		__wxRoute = 'pages/money_path/money_path';__wxRouteBegin = true; 	define("pages/money_path/money_path.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e){return e<10?"0"+e:e}e(require("../../components/toast/toast.js"));var r=e(require("../../configs/api")),a=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),n=e(require("../../libs/regenerator-runtime/runtime")),i=require("../../common/index"),o={dispatchIds:{},inRequest:[],data:{pageScrollHeight:0,scrollTopValue:0,loadingVisible:!0,orderSn:"",id:"",type:"",refund_amount:"",refund_pay_type_name:"",refund_pay_type:"",nickname:"",avatar:"",lastOperateTypeTitle:"",totalArr:[],refund_type:"",return_account:""},requestGroupListDetail:a.default.wrap(n.default.mark(function e(a,o,s){var u,p,d,c,l,_,f,y,m,h,g,v,q,T,b,x;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,u=s.data.orderSn,p=s.data.id,d=[u,p].join("$"),!(s.inRequest.indexOf(d)>=0)){e.next=6;break}return e.abrupt("return",{});case 6:return this.inRequest.push(d),c=i.DataUtil.formatByPos(r.default.moneyPath,u,p),e.next=10,i.Request.apiRequest("GET",c);case 10:l=e.sent,_=i.StdFormat.price(l.refund_amount,100),f=l.order_user_vo.refund_pay_type_name,y=l.order_user_vo.refund_pay_type,m=l.refund_type,h=l.order_user_vo.nickname,g=l.order_user_vo.avatar,v=l.flow,q=v[v.length-1],T=q.operate_type,b=l.return_account,x="",v.length<3&&v.push({operate_type:3,operate_desc:"到账成功",operate_time:0,comment:!1,nocomment:!0}),v.map(function(e){var r=i.TimeUtil.getTimeMaterialFromTimePoint(e.operate_time);e.operate_time=r.year+"-"+t(parseInt(r.month))+"-"+t(parseInt(r.date))+" "+t(parseInt(r.hours))+":"+t(parseInt(r.minutes))}),3==T?x="已退到："+b:2==T?x="已退款，"+f+"处理中":4==T&&(x="到账失败"),s.processGroupList({refund_amount:_,refund_pay_type_name:f,refund_pay_type:y,refund_type:m,nickname:h,avatar:g,lastOperateTypeTitle:x,totalArr:v,return_account:b,reqFlag:d}),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),console.log(e.t0);case 31:case"end":return e.stop()}},e,this,[[0,28]])})),processGroupList:function(e){if(e.reqFlag){var t=this.inRequest.indexOf(e.reqFlag);t>=0&&(this.inRequest=this.inRequest.splice(t,1))}e.errorCode?this.$showToast(e.errorMsg):this.setData({loadingVisible:!1,refund_amount:e.refund_amount,refund_pay_type_name:e.refund_pay_type_name,refund_pay_type:e.refund_pay_type,refund_type:e.refund_type,nickname:e.nickname,avatar:e.avatar,lastOperateTypeTitle:e.lastOperateTypeTitle,totalArr:e.totalArr,return_account:e.return_account})},loadPage:function(){var e=this;this.setData({scrollContainerHeight:i.SystemInfo.getWindowHeightSync(),pageScrollHeight:i.SystemInfo.getWindowHeightSync()-i.Util.rpxToPx(80)}),(0,a.default)(n.default.mark(function t(){var r;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,[e.requestGroupListDetail(e.data.orderSn,e.data.id,e)];case 3:r=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},onLoad:function(){var e=this.$urlQueryObj.order_sn,t=this.$urlQueryObj.id||this.$urlQueryObj.after_sales_id,r=this.$urlQueryObj.type;this.data.orderSn,this.data.id,this.data.type;this.setData({orderSn:e,id:t,type:r}),this.loadPage()}};(0,i.PddPage)(o,{pageName:"money_path"}); 
 			}); 	require("pages/money_path/money_path.js");
 		__wxRoute = 'pages/afterSalesStatus_detail/afterSalesStatus_detail';__wxRouteBegin = true; 	define("pages/afterSalesStatus_detail/afterSalesStatus_detail.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}e(require("../../components/toast/toast.js"));var t=e(require("../../configs/api")),a=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),s=e(require("../../libs/regenerator-runtime/runtime")),r=require("../../common/index"),i={dispatchIds:{},inRequest:[],question_type:0,cat_id:0,shippingStatus:0,refundModifyType:null,data:{pageScrollHeight:0,scrollTopValue:0,loadingVisible:!0,after_sales_id:"",mall_logo:"",mall_name:"",mall_id:"",created_time:"",order_sn:"",goods_name:"",refund_amount:"",afterSalesTypeText:"",after_sales_type:"",shipping_status:"",after_sales_status:"",after_sales_status_TEXT:"",after_sales_infos:"",after_sales_info_text:"",after_sales_info_arr:[],version:null,userShipStatus:"",returnGoodOperateType:"",afterSaleComment:"",roleType:"",showBottomMenu:!1,operateTypeStatus:!0,magnifyIcon:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/return/magnify_icon_2x.png",returnArrow:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/return/arrow_icon_2x.png",showComplaintMain:!0,showReturnAddr:!1,rootMarginBottom:160,remainTimeInfo:{},operator_role:1,operate_type:0,leave_Msg_Class:"leaveMsg",isShowLeaveMsg:!0},requestGroupListDetail:a.default.wrap(s.default.mark(function e(a){var i,o,n,_,l,u,d,f;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=a.data.after_sales_id,o=10,n=[10,i].join("$"),!(a.inRequest.indexOf(n)>=0)){e.next=6;break}return e.abrupt("return",{});case 6:return this.inRequest.push(n),_=r.DataUtil.formatByPos(t.default.afterSalesDetail,i),e.next=10,r.Request.apiRequest("GET",_);case 10:return l=e.sent,u=a.formatGroupList(l),a.processGroupList({groupListInfo:u,reqFlag:n,loadAll:l.length<o}),d="order/"+l.order_sn,e.next=16,r.Request.apiRequest("GET",d);case 16:return f=e.sent,this.shippingStatus=f.shipping_status,this.setData({orderTime:f.order_time}),e.abrupt("return",l);case 22:e.prev=22,e.t0=e.catch(0),console.error(e.t0);case 25:case"end":return e.stop()}},e,this,[[0,22]])})),formatGroupList:function(e){var t=this,a={0:"投诉",1:"仅退款",2:"退货退款",3:"换货"},s={0:"",1:"未收到货",2:"已收到货"},i={0:"初始化",1:"申请已提交，商家处理中",2:"已申请介入，拼多多处理中",3:"您已发货，拼多多处理中",4:"商家逾期未处理，退款中",5:"退款成功",6:"申请已撤销",7:"拼多多拒绝了申请",8:"客服审核通过",9:"商家拒绝退款",10:"商家同意退货，请您及时发货",11:"您已发货，商家处理中",12:"未及时处理，可重新申请",13:"退款关闭"},o={65:"未按承诺时间发货",66:"多拍/错拍/不想要",79:"其他",97:"质量问题",99:"卖家发错货",100:"货物与描述不符",101:"收到商品少件/破损或污渍",102:"假冒品牌",103:"不喜欢/效果不好",104:"多拍/错拍/不想要",111:"其他",193:"未按承诺时间发货",194:"快递无跟踪记录",195:"空包裹/少货",196:"快递一直未送达",197:"多拍/错拍/不想要",198:"缺货",207:"其他",257:"坏果/烂果",258:"尺寸问题/不喜欢/不合适",81:"质量问题",83:"卖家发错货",84:"货物与描述不符",85:"收到商品少件/破损或污渍",86:"假冒品牌",87:"不喜欢/效果不好",88:"多拍/错拍/不想要",95:"其他"},n={1:"用户",2:"商家",3:"拼多多",4:"系统"},_="",l={},u="",d=1,f=0,p=e.after_sales_flows;if(p&&p.length>0){for(var h=!1,c=0;c<p.length;c++){var m=p[c];if(m.operate_type&&20==m.operate_type){l=m,h=!0;break}}0==h&&p&&p.length>0&&(l=p[0]),_=p[0].comment,u=n[d=p[0].operator_role],f=p[0].operate_type}var g=this,y=function(){var t,a,s,i=(new Date).getTime(),o=1e3*e.expire_time-i;if(!(o<=0)){var n=r.TimeUtil.getPackagedTimeFromTimeBucket(o,"");t=n.days,a=n.hours,s=n.minutes,g.setData({remainTimeInfo:{remainDays:t,remainHours:a,remainMinutes:s}})}};y(),setInterval(function(){y()},6e4);var v=e.after_sales_status,T=i[v],w="",S=s[e.user_ship_status]||"",M=!0;2==v?3==d&&(T="发起申请，拼多多处理中"):3==v?3==d&&(T="发起申请，拼多多处理中"):10==v&&33==f&&(T="拼多多同意退货，请您及时退货给商家"),4==v?7==f?(T="拼多多通过了申请，退款中",w="leaveMsg leaveMsg-green"):4==f?(T="商家通过申请，退款中",w="leaveMsg leaveMsg-green",S=""):(T="商家逾期未处理，退款中",w="leaveMsg"):w=7==v?"leaveMsg leaveMsg-orange":"leaveMsg",(3==v||5==v||6==v||10==v||11==v||12==v||2==v&&3==d||!_)&&(M=!1),this.setData({afterSalesTypeText:a[e.after_sales_type]||"",after_sales_status_TEXT:T,afterSaleComment:_,leavMsgInfo:l,roleType:u,userShipStatus:S,after_sales_type:e.after_sales_type,after_sales_status:v,operator_role:d,operate_type:f,leave_Msg_Class:w,user_ship_status:e.user_ship_status,isShowLeaveMsg:M}),e.after_sales_infos.map(function(e){0!==e.question_type&&""===t.data.after_sales_info_text&&(t.setData({after_sales_info_text:o[e.question_type]}),t.question_type=e.question_type),0!==e.refund_amount&&""===t.data.refund_amount&&t.setData({refund_amount:r.StdFormat.price(e.refund_amount,100)})});var x=e.after_sales_flows,q=x[0].operate_type;this.setData({returnGoodOperateType:q}),x.map(function(e){3===e.operate_type&&t.setData({operateTypeStatus:!1})});var I=x[0].created_time;return this.setData({created_time:I}),e},processGroupList:function(e){if(e.reqFlag){var t=this.inRequest.indexOf(e.reqFlag);t>=0&&(this.inRequest=this.inRequest.splice(t,1))}if(e.errorCode)this.$showToast(e.errorMsg);else{var a=e.groupListInfo.after_sales_status,s=this.data.showBottomMenu;2!=a&&3!=a&&11!=a||(s=!0),this.cat_id=e.groupListInfo.cat_id_1,this.setData({mall_logo:e.groupListInfo.mall_logo,mall_name:e.groupListInfo.mall_name,mall_id:e.groupListInfo.mall_id,order_sn:e.groupListInfo.order_sn,goods_name:e.groupListInfo.goods_name,goods_image:e.groupListInfo.goods_image,shipping_status:e.groupListInfo.shipping_status,after_sales_status:e.groupListInfo.after_sales_status,loadingVisible:!1,version:e.groupListInfo.version,showBottomMenu:s})}},magnifyAddr:function(){this.setData({showComplaintMain:!1,showReturnAddr:!0,rootMarginBottom:0})},hideReturnAddr:function(){this.setData({showComplaintMain:!0,showReturnAddr:!1,rootMarginBottom:160})},modifyAfterSales:function(e){this.$forward("refund_money",{after_sales_id:this.data.after_sales_id,order_sn:this.data.order_sn,after_sales_type:"modifyApply",refund_type:this.refundModifyType})},reapplyAfterSales:function(e){this.$forward("refund_money",{after_sales_id:this.data.after_sales_id,order_sn:this.data.order_sn,after_sales_type:"reapply"})},applyRevokeBtn:function(e){var t=this;this.$showModal({content:"退款申请仅可以撤销1次，您确定要撤销申请？",cancelText:"暂不撤销",confirmText:"确认撤销",success:function(e){e.confirm&&t.applyRevokDetermine()}})},negotiateInfo:function(e){var t=e.currentTarget.dataset.after_sales_id,a=e.currentTarget.dataset.from_tag;null==t||t.length<=0||this.$forward("negotiate",{after_sales_id:t,from_tag:a,order_sn:this.data.order_sn})},applyRevokDetermine:function(){var e=this,i=e.data.after_sales_id,o={operate_desc:"",version:e.data.version},n=r.DataUtil.formatByPos(t.default.cancelAfterSales,i);(0,a.default)(s.default.mark(function t(){var a;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.Request.apiRequest("POST",n,o);case 2:"ok"==(a=t.sent).result?e.$forward("afterSalesStatus_detail",{after_sales_id:i}):e.$showToast(a.error_msg);case 4:case"end":return t.stop()}},t,this)}))},fillTheReturnInformation:function(e){this.$forward("fill_return_information",{after_sales_id:this.data.after_sales_id,version:this.data.version})},platformIntervention:function(e){var t=this,a=this.data.after_sales_status;1==a||11==a?this.$showToast("亲，商家需要一定的时间处理您的申请，建议您先与商家沟通解决。如果您的问题仍没得到解决，商家拒绝您的申请后可申请拼多多介入。",{showDuration:3e3}):9==a?1==this.data.shipping_status&&1==this.data.after_sales_type&&2==this.data.user_ship_status&&[101,102,111].indexOf(this.question_type)<0?t.$showModal({title:"",cancelText:"返回",confirmText:"退款退货",content:"若未与商家达成仅退款协议，拼多多暂无法支持仅退款请求，请申请退货退款",success:function(e){e.confirm&&(t.refundModifyType=2,t.modifyAfterSales())}}):1==this.data.shipping_status&&1==this.data.after_sales_type&&1==this.data.user_ship_status?80!=this.cat_id&&2==this.shippingStatus?t.$showModal({title:"",cancelText:"返回",confirmText:"退款退货",content:"亲，物流信息显示您已签收，为了更快更好地解决您地售后问题，建议您申请退货退款 ",success:function(e){e.confirm&&(t.refundModifyType=2,t.modifyAfterSales())}}):80!=this.cat_id?t.$showModal({title:"",showCancel:!1,confirmText:"确定",content:"亲，您购买的商品已发货，建议您先与商家协商解决。如果您的问题仍没有得到解决，您可以在发货3天后，或物流信息显示您已签收时，要求拼多多介入处理"}):this.$forward("platform_intervention",{after_sales_id:this.data.after_sales_id,version:this.data.version}):this.$forward("platform_intervention",{after_sales_id:this.data.after_sales_id,version:this.data.version}):this.$forward("platform_intervention",{after_sales_id:this.data.after_sales_id,version:this.data.version})},refundMoneyTrace:function(e){var t=this.data.after_sales_id,a=this.data.order_sn;this.$forward("money_path",{after_sales_id:t,order_sn:a})},hasChat:function(e){var t=this.data.mall_id,a={orderSn:this.data.order_sn,goodsName:this.data.goods_name,src:this.data.goods_image,status:this.data.after_sales_status_TEXT,orderTime:this.data.orderTime},s="/pages/custom_service/custom_service?mall_id="+t;s=s+"&"+r.UrlUtil.buildQuery(a),r.Navigation.forward(s),this.$uploadFormId(e,!1),(0,r.TrackingRecord)({op:"click",page_name:"complaint_detail",page_element:"contact_seller_btn"})},loadPage:function(){var e=this;r.SystemInfo.getWindowHeightSync(),r.SystemInfo.getWindowHeightSync(),r.Util.rpxToPx(80);this.setData({scrollContainerHeight:r.SystemInfo.getWindowHeightSync(),pageScrollHeight:r.SystemInfo.getWindowHeightSync()-r.Util.rpxToPx(80)}),(0,a.default)(s.default.mark(function t(){var a;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.requestGroupListDetail(e);case 3:a=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},onLoad:function(e){var t=e.after_sales_id;this.setData({after_sales_id:t}),this.loadPage()}};(0,r.PddPage)(i,{pageName:"afterSalesStatus_detail"}); 
 			}); 	require("pages/afterSalesStatus_detail/afterSalesStatus_detail.js");
 		__wxRoute = 'pages/refund_money/refund_money';__wxRouteBegin = true; 	define("pages/refund_money/refund_money.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}e(require("../../components/toast/toast.js"));var t=e(require("../../configs/api")),a=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),s=e(require("../../libs/regenerator-runtime/runtime")),i=(e(require("../../storage/user_storage")),e(require("../../common/upload_file"))),n=require("../../common/index"),r={inRequest:[],after_sales_id:"",after_sales_type:"",version:"",data:{restStringLen:170,refundTypeArr:["我要退货退款","我要退款（无需退货）"],receiptStatus:["点击选择货物状态","未收到货","已收到货"],index1:0,index2:0,index3:0,map1:[],map2:[],map3:[],map4:[],isDisplay:!1,complaintTypeEntryStatus:!1,order_sn:"",order_amount:"",mobile:"",shipping_status:"",loadingVisible:!0,input_order_amount:"",after_sales_trigger:"",rightPhone:!0,ishidden:!0,commentImgs:[],imageUploaderShow:!0,uploadingTitle:!0,commentImgsCount:0,canSelImgsCount:3,shipping_amount:"",selectMap:[],responsiblePerson:"",maxRefundAmount:"",isShowFreight:!0,payMent:"",questionDescText:"",user_ship_status:""},requestGroupListDetail:a.default.wrap(s.default.mark(function e(a){var i,r,o,u,d,p,l,_,h,f,m,c,g,y,x,D,v,q,T,b,w;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=10,r=a.data.order_sn,o=[r,i].join("$"),!(a.inRequest.indexOf(o)>=0)){e.next=6;break}return e.abrupt("return",{});case 6:if(a.inRequest.push(o),u=n.DataUtil.formatByPos(t.default.afterSalesFormSelect,r),d=void 0,p=void 0,l=void 0,"reapply"!=a.after_sales_type&&"modifyApply"!=a.after_sales_type){e.next=26;break}return _=n.DataUtil.formatByPos(t.default.afterSalesDetail,a.after_sales_id),e.next=15,n.Request.apiRequest("GET",_);case 15:return 9==(d=e.sent).after_sales_status&&(a.after_sales_type="reapply"),e.next=20,n.Request.apiRequest("GET",u);case 20:p=e.sent,a.version=d.version,(h=d.after_sales_infos).map(function(e){0!==e.refund_amount&&""===a.data.input_order_amount&&a.setData({input_order_amount:parseFloat(n.StdFormat.price(e.refund_amount,100)).toFixed(2)}),""!=e.user_phone&&""===a.data.mobile&&(l=e.user_phone),""!=e.question_desc&&""===a.data.questionDescText&&a.setData({questionDescText:e.question_desc}),0===e.question_type||a.data.questionType||a.setData({questionType:e.question_type})}),e.next=34;break;case 26:return f=n.DataUtil.formatByPos(t.default.afterSalesForm,r),e.next=29,n.Request.apiRequest("GET",f);case 29:return d=e.sent,e.next=32,n.Request.apiRequest("GET",u);case 32:p=e.sent,l=d.mobile;case 34:m=p.map1,c=p.map2,g=p.map3,y=p.map4,x=d.shipping_status,D=d.user_ship_status,v=d.after_sales_trigger,m.unshift({type:"optionzero",desc:"请选择退款原因"}),c.unshift({type:"optionzero",desc:"请选择退款原因"}),g.unshift({type:"optionzero",desc:"请选择退款原因"}),y.unshift({type:"optionzero",desc:"请选择退款原因"}),a.setData({map1:m,map2:c,map3:g,map4:y}),q=!0,q="reapply"!=a.after_sales_type&&"modifyApply"!=a.after_sales_type&&(1!=v&&""!==v),T=n.StdFormat.price(d.order_amount,100),b=n.StdFormat.price(d.shipping_amount,100),a.setData({order_amount:T,mobile:l,shipping_status:x,loadingVisible:!1,after_sales_trigger:v,shipping_amount:parseFloat(b),input_order_amount:T,complaintTypeEntryStatus:q,user_ship_status:D}),w=a.$urlQueryObj.refund_type||d.after_sales_type,1===v?a.setData({index1:1,isDisplay:!0}):a.setData({index1:2==w?0:1,isDisplay:2!=w}),a.selectMapChange(),a.maxRefundAmountChange(),e.next=60;break;case 57:e.prev=57,e.t0=e.catch(0),console.error(e.t0);case 60:case"end":return e.stop()}},e,this,[[0,57]])})),selectMapChange:function(){var e=this.data.user_ship_status,t=this.data.shipping_status,a=this.data.after_sales_trigger,s=this.data.map1,i=this.data.map2,n=this.data.map3,r=this.data.map4,o=this.data.index1,u=this.data.index2,d=this.data.index3;2==t||2==e?u=2:1==a&&0==u&&(u=1);var p=void 0;p=0==t?r:1==o?1==u?i:2==u?s:i:n;for(var l=0;l<p.length;l++){var _=p[l];if(this.data.questionType==_.type){d=l;break}}this.setData({index1:o,index2:u,index3:d,selectMap:p})},responsiblePersonChange:function(e){66===e||88===e||104===e||197===e?this.setData({responsiblePerson:0}):this.setData({responsiblePerson:1}),this.maxRefundAmountChange()},maxRefundAmountChange:function(){var e=this.data.index1,t=this.data.index2,a=(this.data.index3,this.data.shipping_status),s=this.data.after_sales_trigger,i=this.data.order_amount,r=parseFloat(this.data.shipping_amount),o=this.data.responsiblePerson;0!==r?0===a&&1===s||0===a&&1===e||1===a&&1===e&&2===t&&1===o||1===a&&1===s&&2===t&&1===o||1===a&&1===s&&1===t||1===a&&1===e&&1===t||1===a&&0===e&&1===o?this.setData({maxRefundAmount:parseFloat(i),input_order_amount:parseFloat(i),payMent:n.DataUtil.accSub(i,r),isShowFreight:!0}):1===a&&1===e&&2===t&&0===o||1===a&&1===s&&2===t&&0===o||1===a&&0===e&&0===o||2===a&&1===e&&0===o?this.setData({maxRefundAmount:n.DataUtil.accSub(i,r),input_order_amount:n.DataUtil.accSub(i,r),payMent:n.DataUtil.accSub(i,r),isShowFreight:!1}):this.setData({maxRefundAmount:parseFloat(i),input_order_amount:parseFloat(i),payMent:n.DataUtil.accSub(i,r),isShowFreight:!0}):this.setData({maxRefundAmount:parseFloat(i),input_order_amount:parseFloat(i)})},loadPage:function(){var e=this;(0,a.default)(s.default.mark(function t(){var a;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.requestGroupListDetail(e);case 3:a=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},refundForm:function(e){var i,r=this,o=r.data.rightPhone,u=r.data.shipping_status,d=e.detail.value,p=this.data.index1,l=this.data.index2,_=(this.data.index3,parseInt(d.question_type)),h=n.DataUtil.accMul(d.refund_amount,100),f=[],m=1,c=d.question_desc;if(i=0==p?2:1,m=0==u?1:1==l?1:2==l?2:1,0==u||"0"!=d.user_ship_status)if("optionzero"!=d.question_type)if(0!=r.checkRefundMoney(d.refund_amount))if(""!=d.question_desc)if(""!=d.user_phone&&0!=o){r.setData({loadingVisible:!0}),d.after_sales_type=i,d.question_type=_,d.refund_amount=h,d.images=f,d.user_ship_status=m,d.user_question_desc=c,"reapply"!=this.after_sales_type&&"modifyApply"!=this.after_sales_type||(d.version=this.version);var g="";"reapply"==this.after_sales_type?g=n.DataUtil.formatByPos(t.default.reapplyAfterSales,r.after_sales_id):"modifyApply"==this.after_sales_type?(g=n.DataUtil.formatByPos(t.default.modifyAfterSales,r.after_sales_id),d.after_sales_id=this.after_sales_id,d.user_phone=d.user_phone,d.new_refund_amount=d.refund_amount,d.question_desc=c,delete d.user_question_desc,delete d.refund_amount):g=n.DataUtil.formatByPos(t.default.afterSalesCreate),(0,a.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.Request.apiRequest("POST",g,d);case 2:t=e.sent,r.setData({loadingVisible:!1}),t.error_msg?r.$showToast(t.error_msg):(wx.showToast({title:"提交成功",icon:"success",duration:2e3}),setTimeout(function(){"modifyApply"==r.after_sales_type||"reapply"==r.after_sales_type?r.$forward("afterSalesStatus_detail",{after_sales_id:r.after_sales_id}):r.$back("order",1)},1e3));case 5:case"end":return e.stop()}},e,this)})).catch(function(e){r.setData({loadingVisible:!1}),r.$showToast(e.error_msg)})}else r.$showToast("请输入正确的手机号");else r.$showToast("请输入退款说明");else r.$showToast("请输入退款金额");else r.$showToast("请选择退款原因");else r.$showToast("请选择收货状态")},refundsGoodMoney:function(e){this.setData({complaintTypeEntryStatus:!1,isDisplay:!1,index1:0}),this.selectMapChange(),this.maxRefundAmountChange()},refundsMoney:function(e){this.setData({complaintTypeEntryStatus:!1,isDisplay:!0,index1:1}),this.selectMapChange(),this.maxRefundAmountChange()},refundType:function(e){var t=this,a=e.detail.value;t.setData({index1:parseInt(a),index2:0,index3:0,ishidden:!0}),0==e.detail.value?t.setData({isDisplay:!1}):t.setData({isDisplay:!0}),t.selectMapChange(),t.maxRefundAmountChange()},receiptStatus:function(e){this.setData({index2:parseInt(e.detail.value),index3:0,ishidden:!0}),this.selectMapChange(),this.maxRefundAmountChange()},reasonsReturn:function(e){var t=this,a=t.data.shipping_amount,s=t.data.selectMap;t.setData({index3:parseInt(e.detail.value)});var i=s[e.detail.value].type;84===i?t.setData({ishidden:!1}):t.setData({ishidden:!0}),t.responsiblePersonChange(i),0!==a&&t.maxRefundAmountChange()},checkRefundMoney:function(e){return!!e&&/^((?:[0-9]\d*))(?:\.\d{1,2})?$/.test(e)},blurChange:function(e){var t=this,a=t.data.shipping_amount,s=e.detail.value;if(t.checkRefundMoney(s)){var i=parseFloat(s);if(0!==a)i>parseFloat(t.data.order_amount)&&(t.$showToast("退款金额不能大于订单金额"),t.setData({input_order_amount:""}));else{var n=parseFloat(t.data.order_amount);console.log(n),i>n&&(t.$showToast("退款金额不能大于订单金额"),t.setData({input_order_amount:""}))}}else""==s?t.$showToast("请输入退款金额"):(t.$showToast("请输入正确的数字"),t.setData({input_order_amount:""}))},regPhone:function(e){var t=e.detail.value;/^1[34578]\d{9}$/.test(t)?this.setData({rightPhone:!0}):(this.$showToast("请输入正确的手机号"),this.setData({rightPhone:!1}))},inputStringChange:function(e){var t=e.detail.value.length,a=170-parseInt(t);this.setData({restStringLen:a})},chooseCommentImg:i.default.chooseCommentImg,delCommentImg:i.default.delCommentImg,showCommentImg:i.default.showCommentImg,onLoad:function(e){var t=e.order_sn;e.after_sales_id&&(this.after_sales_id=e.after_sales_id),this.after_sales_type=e.after_sales_type,wx.setNavigationBarTitle&&wx.setNavigationBarTitle({title:"修改申请"}),this.setData({order_sn:t}),this.loadPage()}};(0,n.PddPage)(r,{pageName:"refund_money"}); 
 			}); 	require("pages/refund_money/refund_money.js");
 		__wxRoute = 'pages/express_complaint/express_complaint';__wxRouteBegin = true; 	define("pages/express_complaint/express_complaint.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}e(require("../../components/toast/toast.js"));var t=e(require("../../configs/api")),a=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),r=e(require("../../libs/regenerator-runtime/runtime")),s=require("../../common/index"),i={dispatchIds:{},inRequest:[],data:{pageScrollHeight:0,scrollTopValue:0,curTabIndex:0,curSwiperItem:0,restStringLen:170,_value:"",isDisabled:!1,isinputString:!1,loadingVisible:!0,express_complaintArr:[],order_sn:"",tracking_number:""},requestGroupListDetail:a.default.wrap(r.default.mark(function e(a){var i,n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=s.DataUtil.formatByPos(t.default.express_complaint),e.next=4,s.Request.apiRequest("GET",i);case 4:n=e.sent,a.setData({loadingVisible:!1,express_complaintArr:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),loadPage:function(){var e=this;this.setData({scrollContainerHeight:s.SystemInfo.getWindowHeightSync(),pageScrollHeight:s.SystemInfo.getWindowHeightSync()-s.Util.rpxToPx(80)}),(0,a.default)(r.default.mark(function t(){var a;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,[e.requestGroupListDetail(e)];case 3:a=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},complaintSubmit:function(e){var i=this,n=e.detail.value,o=n.mobile;if(n.complaint_type_id=parseFloat(n.complaint_type_id),n.order_sn=i.data.order_sn,n.tracking_number=i.data.tracking_number,!/^1[34578]\d{9}$/.test(o)&&""!=o)return this.$showToast("请输入正确的手机号"),!1;i.setData({loadingVisible:!0});var u=s.DataUtil.formatByPos(t.default.express_complaint_form);(0,a.default)(r.default.mark(function e(){var t;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Request.apiRequest("POST",u,n);case 2:!0===(t=e.sent).status?(i.setData({loadingVisible:!1}),i.$showToast("感谢您的反馈,我们会尽快核实物流情况"),setTimeout(function(){i.$back("goods_express",1)},2e3)):i.setData({loadingVisible:!0});case 4:case"end":return e.stop()}},e,this)}))},inputStringChange:function(e){var t=e.detail.value.length,a=170-parseInt(t);this.setData({restStringLen:a}),0!=t?this.setData({isinputString:!0}):this.setData({isinputString:!1})},radioChange:function(e){var t=parseFloat(e.detail.value);this.setData({_value:t,isDisabled:!0})},onPullDownRefresh:function(){this.loadPage(),wx.stopPullDownRefresh()},onLoad:function(e){var t=e.order_sn,a=e.tracking_number;this.setData({order_sn:t,tracking_number:a}),this.loadPage()}};(0,s.PddPage)(i,{pageName:"express_complaint"}); 
 			}); 	require("pages/express_complaint/express_complaint.js");
 		__wxRoute = 'pages/economical_brand/economical_brand';__wxRouteBegin = true; 	define("pages/economical_brand/economical_brand.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var a=t(require("../../components/bubble/bubble")),s=require("../../common/index"),o=(t(require("../../storage/ram_manager")),t(require("../../configs/request_errors"))),i=t(require("../../configs/api")),r=(t(require("../../libs/es6-promise.min")),t(require("../../libs/co/we-index"))),n=t(require("../../libs/regenerator-runtime/runtime")),c=t(require("../../common/gotop_util")),d=t(require("../../components/segment/segment.js")),u=t(require("../../models/format/grid_item_goods")),l=t(require("../../controller/group")),p=t(require("../../components/big_sales/big_sales")),h={1:"SmallMixinPromotion",2:"LargeMixinPromotion",3:"subejct-scroll"},b=o.default.couponErrorHint,f={winHeight:0,cacheDataList:{},listReqLock:{},spikeGoodsScrollLeftPoint:[],renderListDataRepo:{},allGoodsListCache:[],mixInfos:[],segmentControl:null,data:{isFirstEnter:!0,curTabIndex:0,sortEnable:!1,subject:"",desc:"",subjectsId:"",topTab:[{size:5,showSortWrapper:!1,sortTypeIndex:0,scrollTop:0,lastScrollTop:0,presetItem:!0}],currentTab:{page:0},isShowBlackLoading:!1,isQuickBuyClick:!1,showCls:"show",current:0,showError:!1,bubble:{top:"104rpx"},firstEnter:!0,contentList:[],goTopClass:!1,$tabsData:[],mallCouponToastData:{},showShareBtn:!1},onShareAppMessage:function(t){var e="";return t&&("menu"==t.from?e="top_forward":"subject-share-btn"==t.target.dataset.subRefer&&(e="subjects_share")),this.$generateShareContent({title:this.data.subject,queries:{subjects_id:this.$urlQueryObj.subjects_id},referStr:e})},share:function(t){(0,s.TrackingRecord)({op:"click",event:"share_btn_clk",page_element:"share_btn"})},onReady:function(){this.winHeight=s.SystemInfo.getWindowHeightSync()},onLoad:function(t){var e={tabsData:this.data.$tabsData,alignType:"align-gap"};this.segmentControl=new d.default(e,this),this.subjectsCollectionId=parseInt(this.$urlQueryObj.subjects_id,10),this.lastTabIndex=parseInt(this.$urlQueryObj.tab_index||0,10);var a=s.ObjectUtil.assign({scrollViewWidth:s.SystemInfo.getWindowWidthSync(),subjectsId:t.subjects_id,curTabIndex:this.lastTabIndex},this.segmentControl.$data());this.setData(a),this.loadPage(this.lastTabIndex,this.lastSortType)},onUnload:function(){a.default.close(this)},reLoad:function(t){var a,s=this.data.curTabIndex||0,o=(this.data.topTab[s],this);this.setData((a={},e(a,"topTab["+s+"].loadingVisible",!0),e(a,"showError",!1),a)),this.data.topTab[0].presetItem||t?(0,r.default)(n.default.mark(function t(){var a;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.requestTopTabsDetail(o);case 2:return t.next=4,o.loadSubjectsGoodsDetail(o,s);case 4:return this.setData((a={},e(a,"topTab[0].loadingVisible",!0),e(a,"showError",!1),a)),t.next=7,o.reqCatlistData(s+1);case 7:case"end":return t.stop()}},t,this)})):this.changeTabIndex(s)},componentsAddRootFunc:function(t,e){t&&"function"==typeof e&&(this[t]=e)},onShow:function(){a.default.init(this,!1,"",1),this.data.isFirstEnter&&this.setData({isFirstEnter:!1});var t=this;t.$BigSalesModal||(t.$BigSalesModal=new p.default({setDataFunc:function(e){t.setData(e)},addRootFunc:s.Util.bind(t.componentsAddRootFunc,t)})),t.$BigSalesModal.showBigSalesFloat(),t.setData({showShareBtn:!0})},onHide:function(){a.default.close(this)},loadPage:function(t){var e=this;(0,r.default)(n.default.mark(function a(){return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.requestTopTabsDetail(e);case 2:return a.next=4,e.loadSubjectsGoodsDetail(e,t);case 4:return a.next=6,e.reqCatlistData(t+1);case 6:case"end":return a.stop()}},a,this)}))},requestTopTabsDetail:r.default.wrap(n.default.mark(function t(e){var a,o;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=i.default.economicalBrandTabInfo,t.next=4,s.Request.apiRequest("GET",a,null,!0);case 4:return o=t.sent,e.formatTopTabsData(o),t.abrupt("return");case 9:t.prev=9,t.t0=t.catch(0),e.requestTagGoodsError({tabIndex:0,page:1,size:50});case 12:case"end":return t.stop()}},t,this,[[0,9]])})),formatTopTabsData:function(t){var e=this,a=[];t.list.forEach(function(t,s){a.push({isBrand:t.is_brand,label:t.subject,subjectId:t.subject_id,page:1,size:1==t.is_brand?5:20,columnNum:parseInt(t.column_num,10),mixInfo:t.mix||[],canLoadMore:!0,canLoadMoreTitle:!0,loadMoreVisible:!1,loadingVisible:!0,scrollTop:0,lastScrollTop:0}),e.renderListDataRepo[s]=[]}),wx.setNavigationBarTitle({title:t.name});var o=t.list.map(function(t){return{title:t.subject}});this.segmentControl.refreshTabsData(o),this.setData(s.ObjectUtil.assign({subject:t.name,desc:t.list[0].desc,topTab:a},this.segmentControl.$data()))},onPageScroll:function(t){var e=t.scrollTop;c.default.showGoTopBtn(e,this)},onReachBottom:function(t){var e=this.data.curTabIndex,a=this.data.topTab[e].sortTypeIndex;this.fillListData(e,a)},loadSubjectsGoodsDetail:r.default.wrap(n.default.mark(function t(a,o){var r,c,d,l,p,h,b,f,m,g,T,_,I,v;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o=o||0,r=a.data.topTab[o],c=r.page||1,d=r.size||50,l=r.subjectId,p=[o,c,d].join("#"),r.canLoadMore||this.setData(e({},"topTab["+o+"].canLoadMoreTitle",!1)),!a.listReqLock[p]&&r.canLoadMore&&!isNaN(l)){t.next=10;break}return t.abrupt("return");case 10:if(a.listReqLock[p]=!0,1===c&&a.setData(e({},"topTab["+o+"].loadingVisible",!0)),h=void 0,h=1==r.isBrand?s.DataUtil.formatByPos(i.default.economicalBrandGoodsInfo,l)+"?"+s.UrlUtil.buildQuery({page:c,size:d}):s.DataUtil.formatByPos(i.default.subjectGoodsApi,l,c,d),t.prev=14,b=[],1!=r.isBrand){t.next=25;break}return t.next=19,s.Request.apiRequest("GET",h,null,!0);case 19:b=t.sent,f=b.list||[],m=f.map(function(t,e){return a.formatBrandItemData(t)}),a.processBrandGoods({tabIndex:o,brandList:m,page:c,size:d}),t.next=33;break;case 25:return t.next=27,[s.Request.apiRequest("GET",h,null,!0),a.requestMixed(a,l,c,d,o)];case 27:b=t.sent,g=b[0]||{},T=b[1]||[],a.mixInfos[o]=a.mixInfos[o]||[],a.mixInfos[o]=a.mixInfos[o].concat(a.formatMixInfo(T)),_=g.goods_list||[],I=_.length<=0,v=_.map(function(t){var e=u.default.formatData(t);return e.priceDiscount=Math.floor(100*s.DataUtil.accDiv(e.price,e.marketPrice))/10,e}),a.processSubjectsGoods({tabIndex:o,goodsList:v,goodsNumber:g.size,isLoadAll:I,page:c,size:d});case 33:return t.abrupt("return",b);case 36:t.prev=36,t.t0=t.catch(14),console.error(t.t0),a.requestTagGoodsError({tabIndex:o,page:c,size:d});case 40:t.next=45;break;case 42:t.prev=42,t.t1=t.catch(0),console.error(t.t1);case 45:case"end":return t.stop()}},t,this,[[0,42],[14,36]])})),requestMixed:r.default.wrap(n.default.mark(function t(e,a,o,r,c){var d,u,l,p,h,b,f;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,d=e.data.topTab[c],u=0,!(d&&d.mixInfo&&d.mixInfo.length&&d.mixInfo[d.mixInfo.length-1])){t.next=7;break}u=d.mixInfo[d.mixInfo.length-1].position,t.next=8;break;case 7:return t.abrupt("return");case 8:if(l=0,e&&e.mixInfos&&e.mixInfos&&e.mixInfos[c]&&(l=e.mixInfos[c][e.mixInfos[c].length-1].position),!(l>=u&&0!=l)){t.next=12;break}return t.abrupt("return");case 12:return p=s.DataUtil.formatByPos(i.default.promotionMix,a),h=1==o?0:o*r,p=p+"?"+s.UrlUtil.buildQuery({start_position:h,end_position:(o+1)*r-1}),b=s.Request.requestDataWithUrl("GET",p,null,!0),t.next=18,s.Request.runMainRequestForPage(b,e);case 18:return f=t.sent,t.abrupt("return",f);case 22:t.prev=22,t.t0=t.catch(0),console.error(t.t0);case 25:case"end":return t.stop()}},t,this,[[0,22]])})),formatBrandItemData:function(t){var e={brandId:t.brand_id,brand:t.brand||"",logo:s.ImageUtil.cdnCompress(t.logo)||"",desc:t.desc||"",startTime:parseInt(t.start_time),endTime:parseInt(t.end_time),goodsList:this.formatBrandGoodsData(t.goods_list||[]),couponInfo:this.formatBrandCouponsData(t.coupon_info||[]),subjectId:t.subject_id};return e.remainingTime=s.TimeUtil.timeSpan(Date.parse(new Date)/1e3,e.endTime),e.remainingTime=e.remainingTime.slice(0,e.remainingTime.length-1),e},formatBrandGoodsData:function(t){return t.map(function(t){var e={goodsId:t.goods_id,hdThumbURL:s.ImageUtil.cdnCompress(t.hd_thumb_url)||"",thumbURL:t.thumb_url||"",goodsName:t.goods_name||"",shortName:t.short_name||"",groupPrice:s.StdFormat.price(t.group_price,100),marketPrice:s.StdFormat.price(t.market_price,100)};return e.priceDiscount=Math.floor(100*s.DataUtil.accDiv(e.groupPrice,e.marketPrice))/10,e})},formatMixInfo:function(t){return(t=t||[]).map(function(t){switch(parseInt(t.type,10)){case 3:t.value=t.value||{},t.value.subjectName=t.value.subject,t.value.subjectID=t.value.subject_id,t.value.goodsList=t.value.goods_list||[],t.value.goodsList.map(function(t){return t.goodsID=t.goods_id,t.thumbUrl=s.ImageUtil.cdnCompress(t.hd_thumb_url||t.thumb_url),t.price=s.StdFormat.price(t.price,100),t.goodsName=t.short_name,t.isApp=t.is_app,t}),t.value.goodsList=s.DataUtil.objectArrayDuplicateRemove(t.value.goodsList,"goodsID",function(t){return 1==t.isApp}),delete t.value.goods_list}return t}),t.sort(function(t,e){return t&&e?t.position-e.position:0}),t},formatBrandCouponsData:function(t){return t.map(function(t){var e={batchName:t.batch_name||"",catId:t.cat_id,discount:s.StdFormat.price(t.discount,100),displayType:t.display_type,duration:t.duration,startTime:parseInt(t.start_time),endTime:parseInt(t.end_time),couponId:t.id,batchId:t.id,isTakenOut:!!t.is_taken_out,linkURL:t.link_url||"",mallId:t.mall_id,minAmount:t.min_amount,ruleDesc:t.rule_desc||"",type:t.type};return e.effectiveDate=s.TimeUtil.formatTime(e.endTime,"yyyy.MM.dd"),e.startTimeDesc=s.TimeUtil.formatTime(e.startTime,"yyyy.MM.dd"),e.timeDesc=e.startTimeDesc+"-"+e.effectiveDate+"可用",e.isTakenOut?e.takeText="已抢光":e.takeText="领取",e.batchName=e.batchName.slice(0,e.batchName.indexOf("减"))+"立减",e})},requestTagGoodsError:function(t){this.$showToast("网络出错");var a=[t.tabIndex,t.page,t.size].join("#");if(this.listReqLock[a]=!1,1===t.page){var s;this.setData((s={},e(s,"topTab["+t.tabIndex+"].loadingVisible",!1),e(s,"showError",!0),s))}},processBrandGoods:function(t){var a,s=t.tabIndex,o=t.page||1,i=[s,o,t.size||20].join("#");this.listReqLock[i]=!1,this.allGoodsListCache[s]=Array.isArray(this.allGoodsListCache[s])?this.allGoodsListCache[s]:[],this.allGoodsListCache[s]=Array.isArray(t.brandList)?this.allGoodsListCache[s].concat(t.brandList):this.allGoodsListCache[s],this.fillListData(s,1===o);var r=t.brandList.length<=0,n=this.data.topTab[s];n&&1!=n.isBrand&&(r=!(t.brandList[0]&&t.brandList[0].goodsList&&t.brandList[0].goodsList.length>=20)),this.setData((a={},e(a,"topTab["+s+"].page",o+1),e(a,"topTab["+s+"].loadMoreVisible",!0),e(a,"topTab["+s+"].canLoadMore",!r),e(a,"topTab["+s+"].canLoadMoreTitle",!r),e(a,"topTab["+s+"].loadingVisible",!1),e(a,"firstEnter",!1),e(a,"showError",!1),a))},processSubjectsGoods:function(t){var a,o=this,i=this,c=t.tabIndex,d=this.data.topTab[c],u=t.page||1,p=[c,u,t.size||PAGE_SIZE].join("#");this.listReqLock[p]=!1;var b=Array.isArray(this.allGoodsListCache[c])?this.allGoodsListCache[c]:[];this.allGoodsListCache[c]=b.concat(t.goodsList);var f=this.allGoodsListCache[c];f=s.DataUtil.objectArrayDuplicateRemove(f,"goodsId",function(t){return 1==t.isApp});var m=this.execMix(c,f);if(this.cacheDataList[c]=m,t.isLoadAll&&1===u){var g=[],T="gridItemV1";1===d.columnNum&&(T="SingleListItemV2"),this.mixInfos[c].forEach(function(t){var e=h[t.type];if(e&&t.value&&o.checkCompatibility(T,e)){t.position=parseInt(t.position,10);var a=t.value;a.itemName=e,g.push(a)}}),this.cacheDataList[c]=g}else if(t.isLoadAll)this.setData(e({},"topTab["+c+"].canLoadMore",!t.isLoadAll));else if(1===d.columnNum){var _=[];t.goodsList.forEach(function(t,e){t.goodsId&&_.push(t.goodsId)}),(0,r.default)(n.default.mark(function t(){var e;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.default.loadLocalGroups(_,i.data.localGroupsMap,i);case 3:e=t.sent,e=Object.assign(e,i.data.localGroupsMap),i.setData({localGroupsMap:e}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}},t,this,[[0,8]])}))}this.setData((a={showError:!1},e(a,"topTab["+c+"].page",u+1),e(a,"topTab["+c+"].loadMoreVisible",!0),e(a,"topTab["+c+"].canLoadMore",!t.isLoadAll),e(a,"topTab["+c+"].loadingVisible",!1),a)),this.fillListData(c,1===u)},fillListData:function(t,e){var a=this.data.topTab[t],s=this,o=this.lastTabIndex==t,i=(a.isBrand?this.allGoodsListCache[t]:this.cacheDataList[t])||[],r=this.renderListDataRepo[t];e&&(r=[]);var n=r.length;i.length>n||!o?this.renderListDataFn(t,n,r,i,o):o&&this.loadSubjectsGoodsDetail(s,t)},renderListDataFn:function(t,a,s,o,i){var r=this,n=r.data.topTab[t];if(i){var c=void 0;c=n&&1==n.isBrand&&o.length-s.length>=10?s.length+(0===a?6:10):o.length-s.length>=24?s.length+20:o.length,s=o.slice(0,c)}else s=n&&1==n.isBrand&&o.length>=10?o.slice(0,6):o.length>=24?o.slice(0,20):o;var d=0,u=[];if(n&&1!=n.isBrand?s.forEach(function(t,e){d=Math.floor(e/10),u.push(t)}):s.forEach(function(t,e){d=Math.floor(e/10),u[d]=Array.isArray(u[d])?u[d]:[],u[d].push(t)}),t===this.data.curTabIndex)if(this.lastTabIndex=t,i&&0!==d)if(n&&1!=n.isBrand)this.setData({contentList:u});else if(1===d){var l;this.setData((l={},e(l,"contentList[0]",u[0]),e(l,"contentList["+d+"]",u[d]),l))}else{var p,h=d-1;this.setData((p={},e(p,"contentList["+h+"]",u[h]),e(p,"contentList["+d+"]",u[d]),p))}else i?this.setData({contentList:u}):(this.setData(e({contentList:[]},"topTab["+t+"].canLoadMoreTitle",!0)),setTimeout(function(){r.setData({contentList:u})},100));this.renderListDataRepo[t]=s},checkCompatibility:function(t,e){return!(!t||!e)&&(!(["gridItemV1"].indexOf(t)<0&&[h[1]].indexOf(e)>=0)&&!(["SingleListItemV2","superSpikeListItemV2"].indexOf(t)<0&&[h[2],h[3]].indexOf(e)>=0))},execMix:function(t,e){var a=this;e=e||[];var s=this.data.topTab[t],o=this.mixInfos[t]||[],i="gridItemV1",r=!1;1===s.columnNum&&(i="SingleListItemV2",r=!0),1===this.data.specialStyle&&(i="subjectItem");var n=[];return e.forEach(function(t,e){t.itemName=i,t.withLocalGroups=r,n.push(t)}),o.forEach(function(t){var e=h[t.type];if(e&&a.checkCompatibility(i,e)){t.position=parseInt(t.position,10);var s=t.value;if(s.itemName=e,t.position>=n.length)return;isNaN(t.position)||n.splice(t.position,0,s)}}),n},didClickSegmentTab:function(t){var e=parseInt(t.currentTarget.dataset.index,10);if(e!==this.data.curTabIndex){this.changeTabIndex(e);var a=this.data.topTab[e];(0,s.TrackingRecord)({op:"click",event:"tab_clk",page_name:"economical_brand",page_section:"top_tab",page_element:"subject",tab_subject_id:a.subjectId,idx:e})}},changeTabIndex:function(t){if(!isNaN(t)){this.data.topTab;var e=s.ObjectUtil.assign({curTabIndex:t},this.segmentControl.$data());this.setData(e),this.reqCatlistData(t),this.reqCatlistData(t+1)}},reqCatlistData:function(t){var e=this.data.topTab;t<0||t>=e.length||(1===(e[t]||{}).page?this.loadSubjectsGoodsDetail(this,t):this.fillListData(t))},gotoGoodsDetail:function(t){var e=t.currentTarget.dataset||{},a=e.goodsId,o=e.index,i=e.brandId,r=e.brandIndex,n=e.subjectId;a&&(this.$forward("goods",{goods_id:a}),(0,s.TrackingRecord)({op:"click",event:"goods_clk",page_name:"economical_brand",page_section:"brand",page_element:"goods",brand_id:i,brand_idx:r,tab_subject_id:n,goods_id:a,idx:o}))},gotoBrandPage:function(t){var e=t.currentTarget.dataset||{},a=e.brandId,o=e.subjectId,i=e.index;a&&(this.$forward("brand",{brand_id:a,subject_id:o}),(0,s.TrackingRecord)({op:"click",event:"look_more_clk",page_name:"economical_brand",page_section:"brand",page_element:"more",brand_id:a,brand_idx:i,tab_subject_id:o}))},takeCoupon:function(t){var e=this,a=t.currentTarget.dataset||{},o=a.brandId,c=a.mallId,d=a.batchId,u=a.brandIndex,l=a.subjectId,p=a.timeDesc;if(c&&d){var h={mall_id:c,batch_id:d},f=i.default.takeMerchantCoupon;this.isTakingCoupon||(this.isTakingCoupon=!0,(0,r.default)(n.default.mark(function t(){var a,i;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.Request.apiRequest("POST",f,h);case 3:a=t.sent,e.isTakingCoupon=!1,i=0,!a.error_code&&a.result?(e.couponTostShow(b.success,p),i=1):e.haddleCouponError(a),(0,s.TrackingRecord)({op:"click",event:"coupon_clk",page_name:"economical_brand",page_section:"brand",page_element:"coupon",batch_id:d,brand_id:o,brand_idx:u,tab_subject_id:l,is_success:i}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0),t.t0&&t.t0.error_code&&e.haddleCouponError(t.t0);case 14:case"end":return t.stop()}},t,this,[[0,10]])})))}},haddleCouponError:function(t){var e=void 0;if(t&&(e=b[t.error_code]),e){var a=e.split("，");a.length>1?this.couponTostShow(a[0],a[1]):this.couponTostShow(e)}else this.couponTostShow(b.fail)},couponTostShow:function(t,e){var a=this,s={};s.single=!e,s.toastVisible=!0,s.mainToast=t,s.subToast=e,this.setData({mallCouponToastData:s}),setTimeout(function(){a.setData({"mallCouponToastData.toastVisible":!1})},1500)},gotoSubject:function(t){var e=t.currentTarget.dataset.subjectId;e&&s.Navigation.forward("/pages/subject/subject?subject_id="+e)},gotoSubGoodsDetail:function(t){var e=(t.currentTarget.dataset||{}).goodsId;e&&this.$forward("goods",{goods_id:e})}};(0,s.PddPage)(f,{pageName:"economical_brand"}); 
 			}); 	require("pages/economical_brand/economical_brand.js");
 		__wxRoute = 'pages/fill_return_information/fill_return_information';__wxRouteBegin = true; 	define("pages/fill_return_information/fill_return_information.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}e(require("../../components/toast/toast.js"));var t=e(require("../../configs/api")),a=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),s=e(require("../../libs/regenerator-runtime/runtime")),r=(e(require("../../storage/user_storage")),e(require("../../common/upload_file"))),n=require("../../common/index"),o={inRequest:[],data:{pageScrollHeight:0,scrollTopValue:0,restStringLen:170,courierCompany:["请选择快递公司","中通快递","韵达速递","圆通速递","申通快递","百世快递","天天快递","中国邮政","快捷快递","优速快递","邮政EMS","顺丰速运","全峰快递","安能快递","国通快递","宅急送","德邦快递","其他"],courierCompanyIndex:0,loadingVisible:!0,moneyRgeStatus:!0,rightPhone:!0,commentImgs:[],imageUploaderShow:!0,uploadingTitle:!0,commentImgsCount:0,canSelImgsCount:3,version:"",after_sales_id:"",freight:"",afterSalesStatus:"",platFormOperateType:""},requestGroupListDetail:a.default.wrap(s.default.mark(function e(r){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{(0,a.default)(s.default.mark(function e(){var a,o,i,u;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.DataUtil.formatByPos(t.default.afterSalesDetail,r.data.after_sales_id),e.next=3,n.Request.apiRequest("GET",a);case 3:o=e.sent,i=o.after_sales_status,r.setData({afterSalesStatus:i,loadingVisible:!1}),(u=o.after_sales_flows).map(function(e){33===e.operate_type&&r.setData({platFormOperateType:e.operate_type})});case 8:case"end":return e.stop()}},e,this)}))}catch(e){console.log(e)}case 1:case"end":return e.stop()}},e,this)})),loadPage:function(){var e=this;this.setData({scrollContainerHeight:n.SystemInfo.getWindowHeightSync(),pageScrollHeight:n.SystemInfo.getWindowHeightSync()-n.Util.rpxToPx(80)}),(0,a.default)(s.default.mark(function t(){var a;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,[e.requestGroupListDetail(e)];case 3:a=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},refundForm:function(e){var r=this,o=e.detail.value;o.images=r.data.commentImgs.map(function(e){return e.url}),o.version=parseInt(r.data.version),o.after_sales_id=parseInt(r.data.after_sales_id);var i=n.DataUtil.formatByPos(t.default.fillReturnForm,r.data.after_sales_id);0!==r.data.courierCompanyIndex?""!=o.tracking_number?33===r.data.platFormOperateType?""!=o.express_fee?""!=o.question_desc?(r.setData({loadingVisible:!0}),(0,a.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.Request.apiRequest("POST",i,o);case 2:(t=e.sent).result?(r.setData({loadingVisible:!1}),wx.showToast({title:"提交成功",icon:"success",duration:2e3}),setTimeout(function(){r.$forward("afterSalesStatus_detail",{after_sales_id:r.data.after_sales_id})},1e3)):r.$showToast(t.error_msg);case 4:case"end":return e.stop()}},e,this)}))):r.$showToast("请输入退款留言"):r.$showToast("请输入邮费"):""!=o.question_desc?(r.setData({loadingVisible:!0}),(0,a.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.Request.apiRequest("POST",i,o);case 2:(t=e.sent).result?(r.setData({loadingVisible:!1}),wx.showToast({title:"提交成功",icon:"success",duration:2e3}),setTimeout(function(){r.$forward("afterSalesStatus_detail",{after_sales_id:r.data.after_sales_id})},800)):r.$showToast(t.error_msg);case 4:case"end":return e.stop()}},e,this)}))):r.$showToast("请输入退款留言"):r.$showToast("请输入快递单号"):r.$showToast("请选择快递公司")},courierCompanychange:function(e){this.setData({courierCompanyIndex:parseInt(e.detail.value)})},freightCheck:function(e){return!!e&&/^((?:[0-9]\d*))(?:\.\d{1,2})?$/.test(e)},blurChange:function(e){var t=this,a=e.detail.value;""!=a?t.freightCheck(a)||(t.$showToast("请输入正确的数字"),t.setData({freight:""})):t.$showToast("请输入运费")},inputStringChange:function(e){var t=e.detail.value.length,a=170-parseInt(t);this.setData({restStringLen:a})},chooseCommentImg:r.default.chooseCommentImg,delCommentImg:r.default.delCommentImg,showCommentImg:r.default.showCommentImg,onLoad:function(e){var t=e.version,a=e.after_sales_id;this.setData({version:t,after_sales_id:a}),this.loadPage()}};(0,n.PddPage)(o,{pageName:"fill_return_information"}); 
 			}); 	require("pages/fill_return_information/fill_return_information.js");
 		__wxRoute = 'pages/negotiate/negotiate';__wxRouteBegin = true; 	define("pages/negotiate/negotiate.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}e(require("../../components/toast/toast.js"));var t=e(require("../../configs/api")),a=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),s=e(require("../../libs/regenerator-runtime/runtime")),r=e(require("../../common/upload_file")),o=require("../../common/index"),n={inRequest:[],data:{restStringLen:170,formStatus:!1,order_sn:"",ishidden:!0,imageUploaderShow:!0,uploadingTitle:!0,question_desc:"",version:"",maxAmount:"",loadingVisible:!0,after_sales_trigger:"",commentImgs:[],after_sales_id:"",negotiateList:[],scrollTop:0,operateType:{0:"用户申请退货退款",1:"用户添加描述和凭证",2:"用户修改信息",3:"用户撤销售后单",4:"商家通过售后单",5:"商家驳回售后单",6:"平台分配受理人",7:"客服申请退款",8:"客服修改退款金额",9:"客服驳回售后单",10:"系统退款成功",11:"商家逾期未处理，自动退款中",12:"商家要求退货",13:"商家添加凭证",14:"平台添加备注",15:"商家逾期未处理，流转平台",16:"商家申请退货后，同意退款，退款中",17:"商家申请退货后，驳回，流向平台",18:"商家申请退货后，处理预期，自动退款",19:"异常商家，流转平台",20:"用户确认退货",21:"用户修改退款申请",22:"用户申请平台介入",23:"商家申请平台介入",24:"商家同意退款退货",25:"用户处理逾期，退款失败",26:"用户发货逾期，退款失败"},questions_text:{65:"未按承诺时间发货",66:"多拍/错拍/不想要",79:"其他",97:"质量问题",99:"卖家发错货",100:"货物与描述不符",101:"收到商品少件/破损或污渍",102:"假冒品牌",103:"不喜欢/效果不好",104:"多拍/错拍/不想要",111:"其他",193:"未按承诺时间发货",194:"快递无跟踪记录",195:"空包裹/少货",196:"快递一直未送达",197:"多拍/错拍/不想要",198:"缺货",207:"其他",257:"坏果/烂果",258:"尺寸问题/不喜欢/不合适",81:"质量问题",83:"卖家发错货",84:"货物与描述不符",85:"收到商品少件/破损或污渍",86:"假冒品牌",87:"不喜欢/效果不好",88:"多拍/错拍/不想要",95:"其他"},user_avatar:"",mall_logo:"",pinduoduo_logo:"http://omsproductionimg.yangkeduo.com/goods/733a8d8950/100/100/22fde6b724e0ec413d91ccb7c813f773.jpg",showInputDesc:!0,showInputArea:!1,showMsgList:!0,from_tag:"",commentImgsCount:0,canSelImgsCount:3},loadPage:function(){var e=this;(0,a.default)(s.default.mark(function t(){var a;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,[e.getNegotiateList(e),e.getSaleAfterSelect(e)];case 3:a=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},getNegotiateList:a.default.wrap(s.default.mark(function e(a){var r,n,i,u,l,d;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=a.data.after_sales_id,n=o.DataUtil.formatByPos(t.default.afterSalesDetail,r),e.next=5,o.Request.apiRequest("GET",n);case 5:i=e.sent,u=i.after_sales_flows,l=i.after_sales_status,d=i.version,1!=l&&2!=l&&3!=l&&11!=l&&a.setData({showInputDesc:!1,showInputArea:!1}),a.setData({negotiateList:u,order_sn:i.order_sn,user_avatar:i.user_avatar,mall_logo:i.mall_logo,version:d,loadingVisible:!1}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}},e,this,[[0,13]])})),getSaleAfterSelect:a.default.wrap(s.default.mark(function e(a){var r,n,i,u,l,d,f,c,m,p,g;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=a.data.order_sn,n=o.DataUtil.formatByPos(t.default.afterSalesFormSelect,r),e.next=5,o.Request.apiRequest("GET",n);case 5:i=e.sent,u={},l=i.map1,d=i.map2,f=i.map3,c=i.map4,u=a.parseMap(l,u),u=a.parseMap(d,u),u=a.parseMap(f,u),u=a.parseMap(c,u),m=a.data.negotiateList;for(p in m)m[p].flow_info.question_type&&(g=m[p].flow_info.question_type,m[p].question_desc=i[g]);a.setData({negotiateList:m}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.log(e.t0);case 23:case"end":return e.stop()}},e,this,[[0,20]])})),parseMap:function(e,t){for(var a in e)t[e[a].type]=e[a].desc;return t},sendMsg:function(e){var r=this,n=e.detail.value;if(n.question_desc){var i=r.data.commentImgs,u=[];if(i.length>0)for(var l in i)u.push(i[l].url);n.images=u,n.version=r.data.version,r.setData({loadingVisible:!0}),n.after_sales_id=parseInt(r.data.after_sales_id);var d=r.data.after_sales_id,f=o.DataUtil.formatByPos(t.default.afterSaleAppend,d);(0,a.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Request.apiRequest("POST",f,n);case 2:"ok"==(t=e.sent).result?(r.setData({loadingVisible:!1}),wx.showToast({title:"提交成功",icon:"success",duration:2e3}),"leav-msg-btn"!==r.data.from_tag?setTimeout(function(){r.$forward("negotiate",{after_sales_id:d})},2e3):setTimeout(function(){r.$forward("afterSalesStatus_detail",{after_sales_id:d})},2e3)):r.$showToast(t.error_msg);case 4:case"end":return e.stop()}},e,this)}))}else r.$showToast("请输入问题描述")},showInputArea:function(){this.setData({showInputDesc:!1,showInputArea:!0})},chooseCommentImg:r.default.chooseCommentImg,delCommentImg:r.default.delCommentImg,showCommentImg:r.default.showCommentImg,onLoad:function(e){var t=e.order_sn,a=e.after_sales_trigger,s=e.from_tag,r={order_sn:t,after_sales_trigger:a,from_tag:s};"leav-msg-btn"===s&&(r.showInputDesc=!1,r.showInputArea=!0,r.showMsgList=!1),this.setData(r);var o=e.after_sales_id;this.setData({after_sales_id:o}),this.loadPage()}};(0,o.PddPage)(n,{pageName:"negotiate"}); 
 			}); 	require("pages/negotiate/negotiate.js");
 		__wxRoute = 'pages/brand/brand';__wxRouteBegin = true; 	define("pages/brand/brand.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}var e=t(require("../../components/bubble/bubble")),a=require("../../common/index"),r=(t(require("../../storage/ram_manager")),t(require("../../configs/request_errors"))),o=t(require("../../configs/api")),i=t(require("../../common/gotop_util")),s=(t(require("../../libs/es6-promise.min")),t(require("../../libs/co/we-index"))),n=t(require("../../libs/regenerator-runtime/runtime")),d=r.default.couponErrorHint,c={winHeight:0,scrollChange:!1,listReqLock:{},spikeGoodsScrollLeftPoint:[],renderListDataRepo:{},allGoodsListCache:[],data:{scrollLeft:0,isShowBlackLoading:!1,isQuickBuyClick:!1,current:0,isShowWifiError:!1,bubble:{top:"104rpx"},firstEnter:!0,contentList:[],goTopClass:!1,loadingVisible:!0,showError:!1},onShareAppMessage:function(t){return this.$generateShareContent({title:this.data.subject,queries:{brand_id:this.$urlQueryObj.brand_id,subject_id:this.$urlQueryObj.subject_id}})},onReady:function(){this.winHeight=a.SystemInfo.getWindowHeightSync()},onLoad:function(t){var e=this,a=t.subject_id;this.subjectId=a,(0,s.default)(n.default.mark(function t(){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,[e.loadBrandDetail(e),e.loadBrandGoodsDetail(e)];case 2:case"end":return t.stop()}},t,this)}))},onUnload:function(){e.default.close(this)},reLoad:function(t){var e=this;this.setData({showError:!1,loadingVisible:!0}),(0,s.default)(n.default.mark(function t(){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,[e.loadBrandDetail(e),e.loadBrandGoodsDetail(e)];case 2:case"end":return t.stop()}},t,this)}))},onShow:function(){e.default.init(this,!1,"",1),this.data.isFirstEnter&&this.setData({isFirstEnter:!1})},onHide:function(){e.default.close(this)},onPageScroll:function(t){var e=t.scrollTop;i.default.showGoTopBtn(e,this)},onReachBottom:function(t){!1!==this.data.canLoadMore&&this.fillListData()},loadBrandDetail:s.default.wrap(n.default.mark(function t(e){var r,i,s,d,c;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=e.subjectId,i=e.data.page||1,r){t.next=5;break}return t.abrupt("return");case 5:return 1===i&&e.setData({loadingVisible:!0}),s=a.DataUtil.formatByPos(o.default.brandSubjectBrandDetail,r),t.prev=7,t.next=10,a.Request.apiRequest("GET",s,null,!0);case 10:return d=t.sent,c=e.formatBrandItemData(d.data),e.setData(c),t.abrupt("return");case 16:t.prev=16,t.t0=t.catch(7),console.error(t.t0),e.requestTagGoodsError({page:i});case 20:t.next=25;break;case 22:t.prev=22,t.t1=t.catch(0),console.error(t.t1);case 25:case"end":return t.stop()}},t,this,[[0,22],[7,16]])})),loadBrandGoodsDetail:s.default.wrap(n.default.mark(function t(e){var r,i,s,d,c,u,l;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=e.subjectId,i=e.data.page||1,s=e.data.size||20,d=[i,s].join("#"),!e.listReqLock[d]&&r){t.next=7;break}return t.abrupt("return");case 7:return e.listReqLock[d]=!0,c=a.DataUtil.formatByPos(o.default.brandSubjectGoodsDetail,r)+"?"+a.UrlUtil.buildQuery({page:i,size:s}),t.prev=9,t.next=12,a.Request.apiRequest("GET",c,null,!0);case 12:return u=t.sent,l=e.formatBrandGoodsData(u.goods_list),e.processSubjectsGoods({goodsList:l,page:i,size:s}),t.abrupt("return");case 18:t.prev=18,t.t0=t.catch(9),console.error(t.t0),e.requestTagGoodsError({page:i,size:s});case 22:t.next=27;break;case 24:t.prev=24,t.t1=t.catch(0),console.error(t.t1);case 27:case"end":return t.stop()}},t,this,[[0,24],[9,18]])})),formatBrandItemData:function(t){var e={brandId:t.brand_id,brand:t.brand||"",logo:a.ImageUtil.cdnCompress(t.logo)||"",desc:t.desc||"",startTime:parseInt(t.start_time),endTime:parseInt(t.end_time),couponInfo:this.formatBrandCouponsData(t.coupon_info||[]),subjectId:t.subject_id};return e.remainingTime=a.TimeUtil.timeSpan(Date.parse(new Date)/1e3,e.endTime),e.remainingTime=e.remainingTime.slice(0,e.remainingTime.length-1),e},formatBrandGoodsData:function(t){return t.map(function(t){var e={goodsId:t.goods_id,hdThumbURL:a.ImageUtil.cdnCompress(t.hd_thumb_url)||"",thumbURL:t.thumb_url||"",goodsName:t.goods_name||"",shortName:t.short_name||"",groupPrice:a.StdFormat.price(t.group_price,100),marketPrice:a.StdFormat.price(t.market_price,100)};return e.priceDiscount=Math.floor(100*a.DataUtil.accDiv(e.groupPrice,e.marketPrice))/10,e})},formatBrandCouponsData:function(t){return t.map(function(t){var e={batchName:t.batch_name||"",catId:t.cat_id,discount:a.StdFormat.price(t.discount,100),displayType:t.display_type,duration:t.duration,startTime:parseInt(t.start_time),endTime:parseInt(t.end_time),couponId:t.id,batchId:t.id,isTakenOut:!!t.is_taken_out,linkURL:t.link_url||"",mallId:t.mall_id,minAmount:t.min_amount,ruleDesc:t.rule_desc||"",type:t.type};return e.effectiveDate=a.TimeUtil.formatTime(e.endTime,"yyyy.MM.dd"),e.startTimeDesc=a.TimeUtil.formatTime(e.startTime,"yyyy.MM.dd"),e.timeDesc=e.startTimeDesc+"-"+e.effectiveDate+"可用",e.isTakenOut?e.takeText="已抢光":e.takeText="领取",e})},requestTagGoodsError:function(t){if(this.$showToast("网络出错"),t.page&&t.size){var e=[t.page,t.size].join("#");this.listReqLock[e]=!1}1===t.page&&this.setData({showError:!0,loadingVisible:!1})},processSubjectsGoods:function(t){var e=t.page||1,a=[e,t.size||20].join("#");this.listReqLock[a]=!1,this.allGoodsListCache=Array.isArray(this.allGoodsListCache)?this.allGoodsListCache:[],this.allGoodsListCache=Array.isArray(t.goodsList)?this.allGoodsListCache.concat(t.goodsList):this.allGoodsListCache,this.fillListData(1===e);var r=!Array.isArray(t.goodsList)||!t.goodsList||t.goodsList.length<=0||t.goodsList.length<20;this.setData({showError:!1,page:e+1,loadMoreVisible:!0,canLoadMore:!r,loadingVisible:!1})},fillListData:function(t){if(!1!==this.data.canLoadMore){var e=this,a=this.allGoodsListCache||[],r=this.renderListDataRepo||[];t&&(r=[]);var o=r.length;a.length>o?this.renderListDataFn(o,r,a):this.loadBrandGoodsDetail(e)}},renderListDataFn:function(t,e,a){var r=e.length+(0===t?10:20);e=a.slice(0,r),this.setData({goodsList:e}),this.renderListDataRepo=e},tabScroll:function(){},setTopUnderline:function(t){var e=0,a="",r=0;this.data.topTab.forEach(function(o,i){i<t&&(e+=o.labelWidth),i===t&&(a=o.label,r=o.labelWidth)}),this.setData({underlineLeft:e,underlineText:a,underlineWidth:r})},gotoGoodsDetail:function(t){var e=t.currentTarget.dataset||{},r=e.goodsId,o=e.brandId,i=e.subjectId;r&&(this.$forward("goods",{goods_id:r}),(0,a.TrackingRecord)({op:"click",event:"goods_clk",page_name:"brand",page_section:"goods_list",page_element:"goods",goods_id:r,brand_id:o,subject_id:i}))},takeCoupon:function(t){var e=this,r=t.currentTarget.dataset||{},i=r.brandId,c=r.mallId,u=r.batchId,l=r.timeDesc;if(c&&u){var h={mall_id:c,batch_id:u},p=o.default.takeMerchantCoupon;this.isTakingCoupon||(this.isTakingCoupon=!0,(0,s.default)(n.default.mark(function t(){var r,o;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=0,t.prev=1,t.next=4,a.Request.apiRequest("POST",p,h);case 4:o=t.sent,e.isTakingCoupon=!1,!o.error_code&&o.result?e.couponTostShow(d.success,l):e.haddleCouponError(o),(0,a.TrackingRecord)({op:"click",event:"coupon_clk",page_name:"brand",page_section:"coupon_list",page_element:"coupon",batch_id:u,brand_id:i,subject_id:e.$urlQueryObj.subject_id,is_success:r}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),console.error(t.t0),t.t0&&t.t0.error_code&&e.haddleCouponError(t.t0);case 14:case"end":return t.stop()}},t,this,[[1,10]])})))}},haddleCouponError:function(t){var e=void 0;if(t&&(e=d[t.error_code]),e){var a=e.split("，");a.length>1?this.couponTostShow(a[0],a[1]):this.couponTostShow(e)}else this.couponTostShow(d.fail)},couponTostShow:function(t,e){var a=this,r={};r.single=!e,r.toastVisible=!0,r.mainToast=t,r.subToast=e,this.setData({mallCouponToastData:r}),setTimeout(function(){a.setData({"mallCouponToastData.toastVisible":!1})},1500)},setTopScroll:function(t){var e=0;this.data.topTab.forEach(function(a,r){r<t&&(e+=a.labelWidth)});var a=parseInt(e/2-150,10);a<0&&(a=0),this.setData({scrollLeft:a})}};(0,a.PddPage)(c,{pageName:"economical_brand"}); 
 			}); 	require("pages/brand/brand.js");
 		__wxRoute = 'pages/coupon_newbee/coupon_newbee';__wxRouteBegin = true; 	define("pages/coupon_newbee/coupon_newbee.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function o(o){return o&&o.__esModule?o:{default:o}}var t=o(require("../../common/request")),e=o(require("../../common/std_format")),s=(o(require("../../constants/share_info")),o(require("../../common/object_util")),require("../../common/index")),i=(o(require("../../storage/ram_manager")),require("../../constants/share"),{data:{size:50,page:0,scrollTop:0,couponId:"",minAmount:"",banner:"",topCls:"",toTopCls:"",noOrderText:"",showMidLoading:!0,isLoadingMore:!1,list:[],columnNum:"0",showCls:"",cacheScrollTop:0,isFirstEnter:!0},onLoad:function(o){o&&this.setData({couponId:this.$urlQueryObj.coupon_id,minAmount:parseInt(this.$urlQueryObj.min_amount,10),batchName:this.$urlQueryObj.batch_name,discount:parseInt(this.$urlQueryObj.discount,10)}),this.requestList(!0)},onShow:function(){this.data.isFirstEnter&&this.setData({isFirstEnter:!1})},bodyScroll:function(o){var t=o.detail.scrollTop;this.setData({cacheScrollTop:t})},goTop:function(){this.setData({scrollTop:1}),this.setData({scrollTop:0})},scrollToLower:function(){this.requestList(!1)},onReady:function(){this.setData({windowHeight:s.SystemInfo.getWindowHeightSync()})},requestList:function(o){var e=this,s=this.data,i="recommendation/coupon?offset="+50*s.page+"&count="+s.size+"&coupon_id="+s.couponId,a={prices:[{min:100*s.minAmount,max:-1}]};s.isLoadingMore||(this.setData({isLoadingMore:!0}),o&&this.setData({showMidLoading:!0}),t.default.apiRequest("POST",i,a).then(function(o){if(e.formatListData(o),o){var t=Object.keys(o.goods_list)[0];o.goods_list[t].length<s.size?e.setData({page:s.page+1,noOrderText:"到底了，还有更多实惠好货，"}):e.setData({page:s.page+1})}e.setData({isLoadingMore:!1,showMidLoading:!1,showCls:"show"})},function(o){e.setData({isLoadingMore:!1,showMidLoading:!1})}))},formatListData:function(o){var t=this;if(o){var i=[],a=this.data.list,n=Object.keys(o.goods_list)[0];o.goods_list[n].forEach(function(o){o.imgUrl=o.hd_thumb_url?o.hd_thumb_url:o.thumb_url,o.priceDis=s.DataUtil.accSub(e.default.price(o.price||o.min_on_sale_group_price,100),t.data.discount),o.soldQuantity=e.default.sales(o.sales),o.countGroup=o.customer_num,a.push(o),i.push(o.goods_id)}),a=s.DataUtil.objectArrayDuplicateRemove(a,"goods_id",function(o){return 1==o.is_app}),this.setData({list:a})}},goodTap:function(o){var t=o.currentTarget.dataset,e=t.goodsId,i=t.goods,a=t.itemIndex,n=this;this.transGoodsData={goodsId:e,goodsName:i.goods_name,customerNum:i.countGroup},n.forward("/pages/goods/goods?goods_id="+e),(0,s.TrackingRecord)({op:"click",event:"goods_clk",page_name:this.$pageName,page_element:"goods",page_section:"goods_list",coupon_id:this.data.couponId,idx:a-1})},forward:function(o){o.indexOf("/pages/goods/goods")>=0&&(o.indexOf("?")>=0?o+="&":o+="?",o+=s.UrlUtil.buildQuery({et:this.$urlQueryObj.et})),s.Navigation.forward(o)},toIndex:function(){this.$forward("index")}});(0,s.PddPage)(i,{pageName:"coupon_newbee"}); 
 			}); 	require("pages/coupon_newbee/coupon_newbee.js");
 		__wxRoute = 'pages/platform_intervention/platform_intervention';__wxRouteBegin = true; 	define("pages/platform_intervention/platform_intervention.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}e(require("../../components/toast/toast.js"));var t=e(require("../../configs/api")),a=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),s=e(require("../../libs/regenerator-runtime/runtime")),o=e(require("../../common/upload_file")),n=require("../../common/index"),r={inRequest:[],data:{pageScrollHeight:0,scrollTopValue:0,restStringLen:170,loadingVisible:!1,moneyRgeStatus:!0,rightPhone:!0,commentImgs:[],imageUploaderShow:!0,uploadingTitle:!0,commentImgsCount:0,canSelImgsCount:3,version:"",after_sales_id:""},refundForm:function(e){var o=this,r=e.detail.value;r.images=o.data.commentImgs.map(function(e){return e.url}),r.after_sales_id=parseInt(o.data.after_sales_id),r.version=parseInt(o.data.version),console.log(r);var i=n.DataUtil.formatByPos(t.default.applyPlatformIntervention,o.data.after_sales_id);console.log(i),""!=r.question_desc?(o.setData({loadingVisible:!0}),(0,a.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.Request.apiRequest("POST",i,r);case 2:(t=e.sent).result?(o.setData({loadingVisible:!1}),wx.showToast({title:"提交成功",icon:"success",duration:2e3}),setTimeout(function(){o.$forward("afterSalesStatus_detail",{after_sales_id:o.data.after_sales_id})},800)):o.$showToast(t.error_msg);case 4:case"end":return e.stop()}},e,this)}))):o.$showToast("请输入问题描述")},inputStringChange:function(e){var t=e.detail.value.length,a=170-parseInt(t);this.setData({restStringLen:a})},chooseCommentImg:o.default.chooseCommentImg,delCommentImg:o.default.delCommentImg,showCommentImg:o.default.showCommentImg,onLoad:function(e){console.log(e);var t=e.version,a=e.after_sales_id;this.setData({version:t,after_sales_id:a})}};(0,n.PddPage)(r,{pageName:"platform_intervention"}); 
 			}); 	require("pages/platform_intervention/platform_intervention.js");
 		__wxRoute = 'pages/limited_free/limited_free';__wxRouteBegin = true; 	define("pages/limited_free/limited_free.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=e(require("../../configs/api")),i=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),r=(e(require("../../components/toast/toast.js")),e(require("../../libs/regenerator-runtime/runtime"))),s=require("../../common/index"),n={data:{limRuleLine:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/goods/free_line_icon%402x.png",goodsId:"",activityId:"",userInfos:[]},loadPage:function(){var e=this;e.getFreeWinner(e)},getFreeWinner:i.default.wrap(r.default.mark(function e(i){var n,a,o;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=i.data.goodsId,a=i.data.activityId,e.next=5,s.Request.apiRequest("GET",t.default.getFreeWinnerList,{activity_id:a,goods_id:n},!0);case 5:return o=e.sent,i.processFreeWinner(o),e.abrupt("return",o);case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}},e,this,[[0,10]])})),processFreeWinner:function(e){if(e.user_infos){var t=e.activity_begin_time,i=e.activity_end_time,r=s.TimeUtil.formatTime(t,"MM.dd hh:mm"),n=s.TimeUtil.formatTime(i,"MM.dd hh:mm"),a=e.user_infos?e.user_infos:[];a=this.parseData(a),this.setData({startTimeDesc:r,endTimeDesc:n,userInfos:a})}else this.$showToast(e.error_msg)},parseData:function(e){if(e.length>0){for(var t in e){var i=e[t].order_sn.split("-");e[t].order_sn_head=i[0]+"-",e[t].order_sn_end=i[1]}return e}},onLoad:function(e){var t=e.goods_id,i=e.activity_id;t&&i&&this.setData({goodsId:t,activityId:i}),this.loadPage()}};(0,s.PddPage)(n,{pageName:"limited_free"}); 
 			}); 	require("pages/limited_free/limited_free.js");
 		__wxRoute = 'pages/comment_share/comment_share';__wxRouteBegin = true; 	define("pages/comment_share/comment_share.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var a=require("../../common/index"),t=(e(require("../../configs/api")),e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),s=e(require("../../libs/regenerator-runtime/runtime")),i={backgroundImageLoadFinish:!1,shareImageLoadFinish:!1,goodsId:"",titles:["无懈可击的一件宝贝，不要错过哦！","我很满意，希望你也喜欢","我的五星好评，你怎会错过？","来！看看我给出满分的商品~","挑剔如我，也给出满分好评的宝贝"],data:{UIVisible:!1},onShareAppMessage:function(e){var a="";e&&("menu"==e.from?a="top_forward":"comment-share-btn"==e.target.dataset.subRefer&&(a="share_pic"));var t=this;return this.$generateShareContent({title:t.getShareTitle(),path:"/pages/goods/goods",queries:{goods_id:this.goodsId},referStr:a})},onReady:function(){this.winHeight=a.SystemInfo.getWindowHeightSync()},onLoad:function(e){e=a.UrlUtil.parseQuery(e),this.goodsId=e.goods_id||"",this.evalId=e.eval_id||"",this.requestShareImage(e)},requestShareImage:function(e){this.setData({loadingVisible:!0});var t=this;a.Request.apiRequest("POST","access/Image/GetImage",e,!1,{forceUseApiGZ:!0}).then(function(e){e.result&&e.result.share_pic_url&&e.result.share_pic_url.length>0?t.setData({shareImage:e.result.share_pic_url}):t.$showToast("图片生成失败")},function(e){t.$showToast("图片生成失败")})},getShareTitle:function(){var e=Math.floor(Math.random()*this.titles.length);return this.titles[e]},showUI:function(){this.shareImageLoadFinish&&this.backgroundImageLoadFinish&&this.setData({UIVisible:!0,loadingVisible:!1})},backgroundLoad:function(){this.backgroundImageLoadFinish=!0,this.showUI()},shareImageLoad:function(){this.shareImageLoadFinish=!0,this.showUI()},previewImage:function(){var e=this;wx.previewImage&&wx.previewImage({urls:[e.data.shareImage]}),(0,a.TrackingRecord)({op:"click",event:"share_pic_clk",page_name:"comment_share",page_element:"share_pic",refer_goods_id:this.goodsId,refer_eval_id:this.evalId})},loadBGImageError:function(){this.$showToast("图片生成失败")},loadShareImageError:function(){this.data.shareImage&&this.data.shareImage.length>0&&this.$showToast("图片生成失败")},trackingClick:function(e){(0,a.TrackingRecord)({op:"click",event:"btn_clk",page_name:"comment_share",page_element:e,refer_goods_id:this.goods_id,refer_eval_id:this.evalId})},share:function(){this.trackingClick("invent_btn")},save:function(){var e=this;this.$showToast("保存图片中"),this.trackingClick("save_pic_btn"),(0,t.default)(s.default.mark(function t(){var i,r;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.setData({loadingVisible:!0}),t.next=4,a.User.authorize("scope.writePhotosAlbum");case 4:if(!(i=t.sent)){t.next=15;break}return t.next=8,a.Util.downloadFile(e.data.shareImage);case 8:return r=t.sent,t.next=11,a.User.saveImageToPhotosAlbum(r);case 11:e.$showToast("保存成功，可在相册中查看"),(0,a.TrackingRecord)({op:"impr",event:"popup_impr",page_name:"comment_share",page_element:"save_success_popup",refer_goods_id:e.goods_id,refer_eval_id:e.evalId}),t.next=16;break;case 15:a.User.showAuthorizeModelDialog("scope.writePhotosAlbum");case 16:e.setData({loadingVisible:!1}),t.next=24;break;case 19:t.prev=19,t.t0=t.catch(0),console.error(t.t0),e.setData({loadingVisible:!1}),e.$showToast("图片保存失败");case 24:case"end":return t.stop()}},t,this,[[0,19]])}))}};(0,a.PddPage)(i,{pageName:"comment_share"}); 
 			}); 	require("pages/comment_share/comment_share.js");
 		__wxRoute = 'pages/coupon_usage/coupon_usage';__wxRouteBegin = true; 	define("pages/coupon_usage/coupon_usage.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../common/index"),s={data:{usageList:[],showMidLoading:!1},onLoad:function(e){this.requestUsage()},requestUsage:function(){var s=this;this.setData({showMidLoading:!0});var a=e.Request.requestDataWithUrl("GET","backend/coupon_desc",{},!1,{forceUseApiGZ:!0});e.Request.runMainRequestForPage(a,this).then(function(e){s.setData({usageList:e,showMidLoading:!1})},function(e){s.setData({showMidLoading:!1}),e.error_code&&e.error_msg&&s.$showToast(e.error_msg)})}};(0,e.PddPage)(s,{pageName:"coupon_usage"}); 
 			}); 	require("pages/coupon_usage/coupon_usage.js");
 		__wxRoute = 'pages/limit_challenge/limit_challenge';__wxRouteBegin = true; 	define("pages/limit_challenge/limit_challenge.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../common/index"),a={data:{loadingVisible:!0},onLoad:function(){e.Navigation.redirectForward("/pages/open_envelope/open_envelope")}};(0,e.PddPage)(a,{pageName:"limit_challenge"}); 
 			}); 	require("pages/limit_challenge/limit_challenge.js");
 		__wxRoute = 'pages/custom_service/custom_service';__wxRouteBegin = true; 	define("pages/custom_service/custom_service.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=require("../../common/index"),a=require("../../common/message"),i=e(require("../../common/wx_socket")),r=e(require("../../storage/user_storage")),o=require("../../controller/custom_service"),n=e(require("../../components/bubble/bubble")),d=e(require("../../configs/api")),l=e(require("../../common/upload_file")),c=(e(require("../../constants/order")),e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),u=e(require("../../libs/regenerator-runtime/runtime")),h=e(require("../../storage/ram_manager")),g={mallName:"",statusName:"",mallUid:0,isOffical:!1,chatList:[],shouldFocusInput:!1,inputValue:"",hasMoreHistoryMessage:!0,curHistoryMessageIndex:0,isRequestingMessage:!1,sentMessageList:{},page:1,nextOffset:0,isRequestAllOrder:!1,data:{mallId:0,mallImgUrl:"",roleImgUrl:"",chatList:[],editValue:"",extraBtnList:[{fontIcon:"icon-set-deal",txt:"我的订单"},{fontIcon:"icon-get-image",txt:"图片"},{fontIcon:"icon-uploadimage",txt:"拍照"}],isShowExtra:!1,isShowSendBtn:!1,isShowOrderSku:!1,showLess:!0,showBottom:!0,ordersList:[],canLoadMore:null,uiLayoutList:{},containerCls:"",orderMsgContent:""},onLoad:function(e){this.pvTracking(),e=s.UrlUtil.parseQuery(e);var t="goods_detail"==h.default.referPageName||"goods_comments"==h.default.referPageName,o="order_detail"==h.default.referPageName||"afterSalesStatus_detail"==h.default.referPageName,d=(new Date).getTime(),l={isFromGoods:t,isFromOrder:o,cardInfo:e,ts:parseInt(d/1e3),msg_id:d};this.setData({mallId:e.mall_id,cardBox:l}),this.isOffical=1===parseInt(e.mall_id);var c=r.default.getUserLocalInfo();c&&this.setData({roleImgUrl:c.avatarUrl});var u=this;i.default.reset(),i.default.connectToSocket(function(){n.default.close(),u.onAuthSuccess(1,100),u.getMallOnlineCustomerService()}),this.msgHandler=a.Message.on(a.KEYS.CUSTOM_SERVICE_MESSAGE,function(e){switch(e.response){case"faq_list":"ok"==e.result&&u.processFaqList(e);break;case"assign_conversation":"ok"==e.result&&u.onAssignChat(e);break;case"list":"ok"==e.result&&u.processChatList(e);break;case"mall_online_customer_service":if("ok"==e.result){u.statusName=e.online.length>0?"[在线] ":"[离线] ";var t=u.statusName+u.mallName;wx.setNavigationBarTitle({title:t})}break;case"send_message":case"send_cmd":"ok"==e.result&&u.onSendMessage(e);break;case"send_faq":"ok"==e.result?u.processFaqAnswer(e):u.sendFaqFail(e);break;case"push":"ok"==e.result&&e.message.from.mall_id===u.data.mallId&&u.processPushMessage(e);break;case"send_comment":if("ok"===e.result){u.processSendComment(e);break}break;case"ui_layout":"ok"===e.result&&u.processUILayout(e)}}),this.socketErrorHandler=a.Message.on(a.KEYS.RECONNECT_ERROR,function(){0===u.data.chatList&&u.setData({loadingVisible:!1,showError:!0})}),this.getMallInfo()},getMallInfo:function(){function e(e){t.setData({mallImgUrl:e.logo}),t.mallName=e.mall_name;var s=t.statusName+t.mallName;wx.setNavigationBarTitle({title:s});var a=t.data.chatList;if(a.length>0){for(var i=0;i<a.length;++i)t.formatMsgImgUrl(a[i]);t.setData({chatList:a})}}var t=this,s=o.CustomServiceController.getMallInfo(this.data.mallId);s?e(s):o.CustomServiceController.getMallInfos(new Array(this.data.mallId),function(t){e(t[0])})},onShow:function(e){h.default.isLastPageService=!0,h.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},pvTracking:function(){(0,s.TrackingRecord)({op:"pv",page_name:"talk"}),this.$firstTimeTrackRecord.pv=!0},clear:function(){"function"==typeof this.msgHandler&&(this.msgHandler(),this.msgHandler=null),"function"==typeof this.socketErrorHandler&&(this.socketErrorHandler(),this.socketErrorHandler=null)},onUnload:function(){this.clear(),h.default.isLastPageService=!1},onHide:function(e){},onAuthSuccess:function(e,t){this.assignChat(),this.getChatList(),this.isOffical&&this.getUILayout()},markRead:function(e){var t={cmd:"mark_read",conversation:{role:"mall",uid:this.data.mallId,ts:e.ts,msg_id:e.msg_id}};i.default.sendSocketMessage(t)},assignChat:function(){var e={cmd:"assign_conversation",conversation:{mall_id:this.data.mallId}};i.default.sendSocketMessage(e)},onAssignChat:function(e){e.conversation&&(this.mallId=e.conversation.mall_id,this.mallUid=e.conversation.uid)},leaveChat:function(){var e={cmd:"leave_conversation",conversation:{mall_id:this.data.mallId}};i.default.sendSocketMessage(e)},toCardDetail:function(e){var t=e.currentTarget.dataset.type;if(1==t){var s=e.currentTarget.dataset.orderSn;this.$forward("order",{ordersn:s})}else if(3==t){var a=e.currentTarget.dataset.groupLink.split("=")[1].split("&")[0];this.$forward("group",{group_order_id:a})}else{var i=e.currentTarget.dataset.goodsId;this.$forward("goods",{goods_id:i})}},sendCardTracking:function(e){(0,s.TrackingRecord)({op:"click",page_name:"talk",page_section:e,page_element:"send",mall_id:this.mallId})},sendCard:function(e){var t=e.currentTarget.dataset;if(t){var s=t.info,a=-1,i={},r="",o="";s.isFromGoods&&(o="goods_info",a=0,i={customerNumber:s.cardInfo.customerNum,goodsID:s.cardInfo.goodsId,goodsName:s.cardInfo.goodsName,goodsPrice:s.cardInfo.groupPrice,goodsThumbUrl:s.cardInfo.src,ts:s.ts},r="http://mobile.yangkeduo.com/goods.html?goods_id="+s.cardInfo.goodsId),s.isFromOrder&&(o="order_info",a=1,i={goodsName:s.cardInfo.goodsName,goodsThumbUrl:s.cardInfo.src,orderSequenceNo:s.cardInfo.orderSn,orderStatus:s.cardInfo.status,orderTime:s.cardInfo.orderTime,ts:s.ts},r="订单编号:"+s.cardInfo.orderSn),this.sendMessage(r,0,i,a),this.sendCardTracking(o)}},sendMessage:function(e,t,s,a){var r={cmd:"send_message",client:"wxapp",message:{from:{role:"user",uid:i.default.getUid()},to:{role:"mall",mall_id:this.mallId,uid:this.mallUid},content:e,type:t},version:2};void 0!==a&&(r.message.sub_type=a),s&&(r.message.info=s);var o=this;i.default.sendSocketMessage(r,function(){var e={request_id:r.request_id,isLoading:!1,isTimeOut:!0};o.onSendMessage(e)}),this.preSendMessage(r)},clickTimeoutMsg:function(e){var t=e.currentTarget.dataset.requestId;if(t){var s=this.sentMessageList[t];s.isLoading=!0;var a=this;this.onSendMessage(s),i.default.sendSocketMessage(s,function(){var e={request_id:s.request_id,isLoading:!1,isTimeOut:!0};a.onSendMessage(e)})}},findLastMsgTime:function(){var e=this.data.chatList;return e.length>0?e[e.length-1].ts:null},onSendMessage:function(e){for(var t=this.data.chatList,s=0;s<t.length;++s){var a=t[s];if(a.request_id&&a.request_id===e.request_id){var i=!1;a.isTimeOut!==e.isTimeOut&&(a.isTimeOut=e.isTimeOut,i=!0),a.isLoading!==e.isLoading&&(a.isLoading=e.isLoading,i=!0),i&&this.setData({chatList:t});break}}},judgeIfGetFaq:function(e){if(1!==e.is_faq){var t=new Date,s=Math.floor(parseInt(t.getTime())/1e3);if(this.isOffical)Math.abs(s-parseInt(e.ts))>=7200&&this.getFaqList();else{var a=new Date(1e3*parseInt(e.ts));(t.getDay()!==a.getDay()||Math.abs(s-parseInt(e.ts))>=86400)&&this.getFaqList()}}},getFaqList:function(){var e={cmd:"faq_list",mall_id:this.data.mallId};i.default.sendSocketMessage(e)},processFaqList:function(e){var t={from:{role:"mall",mall_id:e.mall_id,uid:this.mallUid},to:{role:"user",uid:i.default.getUid()},type:0,is_faq:1,msg_id:e.msg_id,ts:e.ts,info:e};this.addMessage(t),this.markRead(e)},sendClickedAction:function(e,t){var s={cmd:e,message:{from:{role:"user",uid:i.default.getUid()},to:{role:"mall",mall_id:this.mallId,uid:this.mallUid},type:0,content:t.content}};for(var a in t)"content"!==a&&(s[a]=t[a]);i.default.sendSocketMessage(s),this.preSendMessage(s)},preSendMessage:function(e){this.sentMessageList[e.request_id]=e;var t=e.message,s=parseInt(Date.now()/1e3);t.ts=s,t.msg_id=s;var a=this.findLastMsgTime()||0,i=this.formatMessage(t,a);if(t.request_id=e.request_id,t.isLoading=!0,i){var r=this.data.chatList;r.push(t),this.setData({chatList:r}),this.scrollTo(s)}},sendFaq:function(e){var t={cmd:"send_faq",message:{from:{role:"user",uid:i.default.getUid()},to:{role:"mall",mall_id:this.mallId,uid:this.mallUid},content:e,type:0}};i.default.sendSocketMessage(t),this.sentMessageList[t.request_id]=t.message},processFaqAnswer:function(e){var t=this.sentMessageList[e.request_id];if(t){t.ts=e.ts,t.msg_id=e.question_msg_id;var s=this.findLastMsgTime()||0,a=this.formatMessage(t,s);a&&this.data.chatList.push(a)}var i=e.answer_msg;this.addMessage(i,t.ts),e.msg_id=e.answer_msg_id,this.markRead(e)},sendFaqFail:function(e){var t=this.sentMessageList[e.request_id];if(t){var s=new Date,a=Math.floor(parseInt(s.getTime()/1e3));t.ts=a,t.msg_id=a;var i=this.findLastMsgTime()||0,r=this.formatMessage(t,i);if(r){var o=this.data.chatList;o.push(r),this.setData({chatList:o,scrollToViewId:"msg"+r.msg_id})}}},processSendComment:function(e){var t=this.sentMessageList[e.request_id];if(t){var s=new Date,a=Math.floor(parseInt(s.getTime())/1e3);t.ts=a,t.msg_id=a,t.type=0,t.from={role:"mall",mall_id:this.data.mallId,uid:this.mallUid},t.to={role:"user",uid:i.default.getUid()},this.addMessage(t)}},getChatList:function(){var e={cmd:"list",list:{start_index:this.curHistoryMessageIndex,size:10,with:{role:"mall",id:this.data.mallId}}};i.default.sendSocketMessage(e),this.isRequestingMessage=!0},processChatList:function(e){var s=this;if(e){"object"!==t(e.chatList)&&(e.chatList=[]),this.hasMoreHistoryMessage=e.has_more,this.curHistoryMessageIndex+=10;var a=this.data.chatList,i=e.messages,r=0,o=this.findLastMsgTime()||0,n=0===a.length;if(0===a.length){if(i.length>0){var d=function(e){for(var t=0;t<e.length;++t)if("user"!==e[t].from.role)return e[t];return null}(i);d&&this.markRead(d),r=i[0].msg_id,this.judgeIfGetFaq(i[0])}}else r=a[0].msg_id,o=a[0].ts;for(var l=0;l<i.length;++l){var c=this.formatMessage(i[l],o);c&&(a.unshift(i[l]),o=c.ts)}n&&(this.data.cardBox.isFromGoods||this.data.cardBox.isFromOrder)&&a.push(this.formatMessage(this.data.cardBox,o)),r>0?this.setData({chatList:a,scrollToViewId:"msg"+r}):this.setData({chatList:a}),setTimeout(function(){s.isRequestingMessage=!1},500),this.setData({loadingVisible:!1})}},processPushMessage:function(e){this.markRead(e.message),this.addMessage(e.message)},addMessage:function(e,t){var s=this.formatMessage(e,t);if(s){var a=this.data.chatList;a.push(s),this.setData({chatList:a,scrollToViewId:"msg"+s.msg_id})}},getTimeStr:function(e){var t=new Date(1e3*parseInt(e)),s=new Date,a=parseInt(s.getTime())/1e3,i=s.getDate(),r=t.getDate(),o=Math.abs(parseInt(e)-a),n=function(e){return parseInt(e)<10?"0"+e:e},d=n(t.getHours()),l=n(t.getMinutes());if(i==r&&o<86400)return d+":"+l;n(t.getFullYear());var c=n(t.getMonth()+1)+"-"+n(r);return c+=" "+d+":"+l},formatMsgImgUrl:function(e){"object"===t(e.to)&&("user"===e.to.role?this.isOffical&&2===e.identity?e.imgUrl="http://pinduoduoimg.yangkeduo.com/chat_avatar/chat_avatar_service.png":e.imgUrl=this.data.mallImgUrl:e.imgUrl=this.data.roleImgUrl)},formatMessage:function(e,t){if(e.isShowTime=Math.abs(parseInt(t,10)-parseInt(e.ts,10))>300,e.timeStr=this.getTimeStr(e.ts),1==e.is_rich_text){for(var s=e.rich_text.content,a=new Array,i=0;i<s.length;++i)"text"!=s[i].type&&a.push(s[i]);e.rich_text.content=a,0==a.length&&(e.is_rich_text=0)}else 1===e.type&&(e.show=!1);return e.info&&e.info.orderTime&&(e.info.orderTime=this.getTimeStr(e.info.orderTime)),this.formatMsgImgUrl(e),e.request_id&&delete e.request_id,e},getUILayout:function(){var e={cmd:"ui_layout",mall_id:this.data.mallId};i.default.sendSocketMessage(e)},processUILayout:function(e){var t=e.ui.bottom_button;this.setData({uiLayoutList:t}),this.handleContainerCls()},getMallOnlineStatus:function(){var e={cmd:"mall_online_status",mall_id:this.data.mallId};i.default.sendSocketMessage(e)},getMallOnlineCustomerService:function(){var e={cmd:"mall_online_customer_service",mall_id:this.data.mallId};i.default.sendSocketMessage(e)},faqClicked:function(e){var t=e.currentTarget.dataset;if(t){var a=t.item,i=t.index,r=a.info.faq_list[i].question;this.sendFaq(r),(0,s.TrackingRecord)({op:"click",page_name:"talk",page_section:"question_list",page_element:r,mall_id:this.mallId})}},commentClicked:function(e){var t=e.currentTarget.dataset;if(t){t.index;var s=new Array;s.push(0);var a={cmd:"send_comment",message:{content:"聊天结束，您对本次服务的评价："+t.comment,msg_id:t.msgId,info:{result:s}}};i.default.sendSocketMessage(a),this.sentMessageList[a.request_id]=a.message}},richTextClicked:function(e){var t=e.currentTarget.dataset;if(t){var a=t.action,i=(t.index,t.params);if(!i)return;if("send_cmd"==a||"send_message"==a)this.sendClickedAction(a,i);else{if("self_service"==i.web_key&&this.$forward("self_service"),"self_message_progress"==i.web_key&&this.$forward("self_message_progress"),"goods_express"==i.web_key){var r={};i.search.split("&").forEach(function(e){var t=e.split("=");t[1]&&("thumb_url"==t[0]&&(t[1]=s.UrlUtil.parseQuery({thumb_url:t[1]}).thumb_url),r[t[0]]=t[1])}),this.$forward("goods_express",r)}if("complaint"==i.web_key){var o={order_sn:i.search.split("&")[0].split("=")[1],after_sales_type:"apply"};this.$forward("refund_money",o)}if("complaint_detail"==i.web_key){var n={after_sales_id:i.search.split("&")[1].split("=")[1]};this.$forward("afterSalesStatus_detail",n)}if("sub_questions"==i.web_key){var d={page_name:"common_qa",id:i.search.split("&")[0].split("=")[1],type_desc:decodeURIComponent(i.search.split("&")[1].split("=")[1])};s.Util.toWeb(d,this)}}"等待人数"===i.content&&(0,s.TrackingRecord)({op:"click",page_name:"talk",page_section:"main",page_element:"wait_btn",mall_id:this.mallId})}},scrollToTop:function(e){this.hasMoreHistoryMessage&&!this.isRequestingMessage&&(this.getChatList(),this.isRequestingMessage=!0)},scrollTo:function(e){this.setData({scrollToViewId:"msg"+e})},edit:function(e){"string"==typeof e.detail.value&&(this.inputValue=e.detail.value,this.data.isShowSendBtn&&0===this.inputValue.length?this.setData({isShowSendBtn:!1}):!this.data.isShowSendBtn&&this.inputValue.length>0&&this.setData({isShowSendBtn:!0}))},focusInput:function(e){var t=this.data.chatList;t.length>0&&this.scrollTo(t[t.length-1].msg_id)},sendAction:function(){0!==this.inputValue.length?(this.sendMessage(this.inputValue,0),this.clearEditValue()):this.$showToast("发送内容不能为空")},confirm:function(e){this.sendAction()},send:function(e){this.$uploadFormId(e,!1),this.sendAction()},handleContainerCls:function(){var e="",t=this.data.uiLayoutList.length>0,s=this.data.isShowExtra;s&&t?e=" show-both":s?e=" show-extra":t&&(e=" show-ui-layout"),this.setData({containerCls:e})},onScrollTap:function(e){this.data.isShowExtra&&this.setData({isShowExtra:!1}),this.handleContainerCls()},onFoldBtnClicked:function(){var e=!this.data.isShowExtra;this.setData({isShowExtra:e}),this.handleContainerCls()},onExtraItemClicked:function(e){var t=e.currentTarget.dataset,s=(t.index,t.txt),a=t.mallId,i=this;if("图片"===s)l.default.chooseUploadImg(1,function(e){i.onChooseUploadImg(e)});else if("拍照"===s)try{wx.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["camera"],success:function(e){i.onChooseUploadImg(e)},fail:function(e){console.error(e)}})}catch(e){console.error(e)}else{i.onFoldBtnClicked();var r=[i.page,10,a].join("$");null!=i.data.canLoadMore&&i.data.canLoadMore&&(r=[i.page-1,10,a].join("$")),this.nowPage==r?i.data.ordersList.length>0?(i.setData({isShowOrderSku:!0}),i.data.ordersList.length<=2&&i.setData({showBottom:!0,showLess:!1})):i.$showToast("您在该店铺内暂无订单"):(this.page=1,this.nextOffset=0,i.requestAllOrders(a,!1))}},requestAllOrders:function(e,t){this.isRequestAllOrder=!0,this.opeate="";var a=this.page||1,i=this.nextOffset,r=s.DataUtil.formatByPos(d.default.chatOrders,a,10,e,i),n=this;(0,c.default)(u.default.mark(function e(){var s;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.SelfService.requestOrders(r);case 3:(s=e.sent)&&n.processOrdersList({reqFlag:r,ordersList:s.formatData,ordersListInfo:s.data,loadAll:s.formatData.length<10,isConcat:t,title:"请选择店铺订单",loadMoreTxt:"查看更多订单"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}))},processOrdersList:function(e){this.setData({loadingVisible:!1});var t=this;if(e.ordersListInfo.errorCode)this.$showToast(e.ordersListInfo.errorMsg);else{t.nowPage=e.reqFlag;var s=t.data.ordersList||[];if(e.ordersList.length>0){t.nextOffset=e.ordersListInfo.next_offset||0,t.page=e.loadAll?t.page:t.page+1;var a=null;a=e.isConcat?s.concat(e.ordersList||[]):e.ordersList,t.setData({orderTitle:e.title,loadMoreTxt:e.loadMoreTxt,isShowOrderSku:!0,ordersList:a,canLoadMore:!e.loadAll,orderMsgContent:e.msgContent}),t.data.ordersList.length<=2&&t.setData({showBottom:!0,showLess:!1,canLoadMore:!e.loadAll})}else if(t.setData({canLoadMore:!1}),s.length<=0){var i="您在该店铺内暂无订单";"refund_goods"==this.opeate?i="当前暂无可售后订单":"refund_money"==this.opeate?i="当前暂无可售后订单":"push_delivery"==this.opeate&&(i="当前暂无待发货订单"),t.$showToast(i)}}},loadMoreList:function(){if(this.data.canLoadMore)if(this.isRequestAllOrder){var e=this.data.mallId;this.requestAllOrders(e,!0)}else this.requestOpeateOrder(!0)},closeOrderSku:function(){this.setData({isShowOrderSku:!1,showLess:!0,showBottom:!0})},showMoreOrders:function(){this.setData({showLess:!1,showBottom:!1})},clickOrders:function(){},clickOrdersSku:function(e){var t=e.currentTarget.dataset;if(t){var s=t.index,a=parseInt((new Date).getTime()/1e3),i=this.data.ordersList[s],r={goodsID:i.goods_id,goodsName:i.goods_name,goodsPrice:i.goods_price,goodsThumbUrl:i.thumb_url,orderSequenceNo:i.order_sn,orderStatus:i.order_status_desc,orderTime:i.order_time,ts:a},o="订单编号:"+i.order_sn;this.sendMessage(o,0,r,1);var n=t.msg;n&&this.sendMessage(n,0),this.sendCardTracking("order_info")}this.closeOrderSku()},clickOther:function(){this.closeOrderSku()},onChooseUploadImg:function(e){var t=this;if(e&&e.tempFiles){this.setData({loadingVisible:!0});var s=this,a=!0,i=!1,r=void 0;try{for(var o,n=e.tempFiles[Symbol.iterator]();!(a=(o=n.next()).done);a=!0){var d=o.value;l.default.uploadImg(d,function(e){s.sendMessage(e.url,1),t.setData({loadingVisible:!1})},function(e){s.$showToast(e),t.setData({loadingVisible:!1})})}}catch(e){i=!0,r=e}finally{try{!a&&n.return&&n.return()}finally{if(i)throw r}}}},clearEditValue:function(){this.inputValue="",this.setData({editValue:"",isShowSendBtn:!1})},previewImg:function(e){var t=e.currentTarget.dataset.url;wx.previewImage({current:t,urls:[t]})},onImgLoaded:function(e){var t=e.currentTarget.dataset;if(t)for(var s=t.msgId,a=this.data.chatList,i=(a[a.length-1].msg_id,0);i<a.length;++i)if(a[i].msg_id===s){a[i].show=!0,this.setData({chatList:a});var r=this.data.scrollToViewId;this.setData({scrollToViewId:r});break}},requestOpeateOrder:function(e){this.isRequestAllOrder=!1;var t=s.DataUtil.formatByPos(d.default.chatOnlineOrders,this.opeate,this.mallId,this.page,10,this.nextOffset),a=this;(0,c.default)(u.default.mark(function s(){var i;return u.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,o.SelfService.requestOrders(t);case 3:(i=s.sent)&&a.processOrdersList({reqFlag:t,ordersList:i.formatData,ordersListInfo:i.data,loadAll:i.formatData.length<10,isConcat:e,title:a.opeateTitle,loadMoreTxt:"查看更多可售后订单",msgContent:a.opeateMsgContent}),s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.error(s.t0);case 10:case"end":return s.stop()}},s,this,[[0,7]])}))},notFundOrders:function(e){this.sendFaq("没有找到订单",0),this.closeOrderSku()},onUILayoutItemClicked:function(e){e.currentTarget.dataset.clickAction;var t=e.currentTarget.dataset.index,s=["refund_goods","refund_money","push_delivery"],a=["请选择要退货订单","请选择要退款订单","请选择待发货订单"],i=["我要退货退款","我要退款","催发货"];this.setData({ordersList:"",loadingVisible:!0}),this.page=1,this.opeate=s[t],this.opeateTitle=a[t],this.opeateMsgContent=i[t],this.requestOpeateOrder(!1)},reLoad:function(e){this.curHistoryMessageIndex=1,this.setData({showError:!1,chatList:[]}),i.default.connectToSocket(),this.onAuthSuccess(1,100),this.getMallInfo()},onMallItemClicked:function(e){this.$forward("mall_page",{mall_id:this.data.mallId}),(0,s.TrackingRecord)({op:"click",page_name:"talk",page_section:"main",page_element:"head_image",mall_id:this.data.mallId})}};(0,s.PddPage)(g,{pageName:"custom_service",notUseCommonPV:!0}); 
 			}); 	require("pages/custom_service/custom_service.js");
 		__wxRoute = 'pages/custom_service_list/custom_service_list';__wxRouteBegin = true; 	define("pages/custom_service_list/custom_service_list.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=require("../../common/index"),s=require("../../common/message"),o=t(require("../../common/wx_socket")),r=(t(require("../../storage/user_storage")),require("../../controller/custom_service")),a=(t(require("../../libs/co/we-index")),t(require("../../libs/regenerator-runtime/runtime")),t(require("../../common/navigation"))),i=t(require("../../components/bubble/bubble")),c=t(require("../../storage/ram_manager")),u={mallUid:0,conversations:[],hasMoreContact:!0,curContactIndex:1,isInRequest:!1,needRefresh:!1,data:{mallId:465342,mallImgUrl:"",roleImgUrl:"",contactList:[],showEmpty:!1,showError:!1},onLoad:function(t){this.pvTracking();var e=this;this.msgHandler=s.Message.on(s.KEYS.CUSTOM_SERVICE_MESSAGE,function(t){switch(t.response){case"latest_conversations":"ok"==t.result&&e.processConversations(t);break;case"push":case"send_faq":case"send_message":case"send_cmd":e.needRefresh=!0}}),this.socketErrorHandler=s.Message.on(s.KEYS.RECONNECT_ERROR,function(){e.setData({loadingVisible:!1,showError:!0})})},onShow:function(t){this.needRefresh&&(this.hasMoreContact=!0,this.isInRequest=!1,this.curContactIndex=1,this.setData({contactList:[]})),this.needRefresh=!1;var e=this;o.default.reset(),o.default.connectToSocket(function(){i.default.close(),e.getLatestConversations(e.curContactIndex,15)}),c.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},clear:function(){this.timeOut&&(clearTimeout(this.timeOut),this.timeOut=null),"function"==typeof this.msgHandler&&(this.msgHandler(),this.msgHandler=null),"function"==typeof this.socketErrorHandler&&(this.socketErrorHandler(),this.socketErrorHandler=null)},onHide:function(t){this.timeOut&&(clearTimeout(this.timeOut),this.timeOut=null)},onUnload:function(t){this.clear()},pvTracking:function(){(0,n.TrackingRecord)({op:"pv",page_name:"chat_list"}),this.$firstTimeTrackRecord.pv=!0},getLatestConversations:function(t,e){if(this.hasMoreContact&&!this.isInRequest){var n={cmd:"latest_conversations",page:t,size:e,status:"unread"};o.default.sendSocketMessage(n,function(){this.isInRequest=!1}),this.isInRequest=!0}},getMallId:function(t){return t.from.role.indexOf("mall")>=0?t.from.mall_id||t.from.uid:t.to.mall_id||t.to.uid},processConversations:function(t){if(this.isInRequest=!1,!t||"object"!==e(t.conversations)||0===t.conversations.length)return this.setData({loadingVisible:!1,showError:!1}),1===this.curContactIndex&&this.setData({contactList:[],showEmpty:!0}),void(t&&(this.hasMoreContact=t.has_more));this.hasMoreContact=t.has_more,this.conversations=t.conversations,this.processList(),this.curContactIndex+=1;for(var n=new Array,s=0;s<t.conversations.length;++s){var o=this.getMallId(t.conversations[s]);n.push(o)}var a=this;r.CustomServiceController.getMallInfos(n,function(t){a.processContactList(n,t)},function(){})},processList:function(){for(var t=new Array,e=0;e<this.conversations.length;++e){var n=this.conversations[e];if(n){var s=this.formatConversation(n);t.push(s)}}var o=this.data.contactList.concat(t);this.setData({showError:!1,loadingVisible:!1,contactList:1===this.curContactIndex?t:o,showEmpty:0===o.length})},processContactList:function(t,e){for(var n=this.data.contactList,s=0;s<n.length;++s){var o=function(t){for(var n=0;n<e.length;++n)if(e[n].mall_id===parseInt(t))return e[n];return null}(n[s].mallId);o&&(n[s].mallName=o.mall_name||"",n[s].mallLogo=o.logo||"")}this.setData({loadingVisible:!1,contactList:n})},getConversation:function(t){for(var e=0;e<this.conversations.length;++e){var n=this.conversations[e];if(t==this.getMallId(n))return n}return null},getTimeStr:function(t){var e=new Date(1e3*parseInt(t)),n=new Date,s=parseInt(n.getTime())/1e3,o=n.getDate(),r=e.getDate(),a=Math.abs(parseInt(t)-s),i=function(t){return parseInt(t)<10?"0"+t:t};return o==r&&a<86400?i(e.getHours())+":"+i(e.getMinutes()):i(e.getFullYear())+"/"+i(e.getMonth()+1)+"/"+r},formatConversation:function(t){var e={};e.mallId=parseInt(this.getMallId(t)),e.content=t.content;var n=t.ts;return e.type=t.type,e.contentStr=t.content,0===t.sub_type||2===t.sub_type?e.contentStr="[商品信息]":1===t.sub_type?e.contentStr="[订单信息]":1===t.type&&(e.contentStr="[图片]"),e.timeStr=this.getTimeStr(n),e.unReadCount=t.unread_count||0,e},mallClicked:function(t){var e=t.currentTarget.dataset.mallId,n="/pages/custom_service/custom_service?mall_id="+e;a.default.forward(n);for(var s=0;s<this.data.contactList.length;++s)if(this.data.contactList[s].mallId===e){this.setData({contactList:this.data.contactList});break}},scrollToLower:function(t){this.hasMoreContact&&this.getLatestConversations(this.curContactIndex,15)},reLoad:function(t){this.hasMoreContact=!0,this.curContactIndex=1,this.isInRequest=!1,this.setData({showError:!1});var e=this;o.default.connectToSocket(function(){e.getLatestConversations(e.curContactIndex,15)})}};(0,n.PddPage)(u,{pageName:"custom_service_list",notUseCommonPV:!0}); 
 			}); 	require("pages/custom_service_list/custom_service_list.js");
 		__wxRoute = 'pages/self_service/self_service';__wxRouteBegin = true; 	define("pages/self_service/self_service.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var r=require("../../common/index"),t=require("../../controller/custom_service"),s=e(require("../../configs/api")),a=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),o=e(require("../../libs/regenerator-runtime/runtime")),i={page:1,nextOffset:0,inRequest:{},data:{selfServiceList:[{url:"http://imsproduction.oss-cn-shanghai.aliyuncs.com/0b5eda377e471b76d95a2423b234ceb1.png",desc:"我要退货退款"},{url:"http://imsproduction.oss-cn-shanghai.aliyuncs.com/ed5841b2b391b5fe25bfb2309bd8b346.png",desc:"我要退款"},{url:"http://imsproduction.oss-cn-shanghai.aliyuncs.com/8179e24edbce8a8feaeca5b8e6cd5cb9.png",desc:"我要催发货"}],sortedList:[],ordersList:[],canLoadMore:null,loadingVisible:!0},requestHotProblems:a.default.wrap(o.default.mark(function e(t){var s,a,i,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s="api/colombo/problem/list?is_home=1",e.next=4,r.Request.apiRequest("GET",s);case 4:if(a=e.sent,t.setData({loadingVisible:!1}),!a.errorCode){e.next=9;break}return t.$showToast(a.errorMsg),e.abrupt("return");case 9:return i=a.problem_list,n=[[i[12],i[14],i[17],i[21],i[23],i[25],i[34]]],t.setData({sortedList:n}),e.abrupt("return");case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])})),viewFAQ:function(e){var t=e.currentTarget.dataset.listItem;if(0==t.parent_id){var s={page_name:"common_qa",type_desc:t.type_desc,id:t.id};r.Util.toWeb(s,this)}else r.Util.toWeb({page_name:"qa_detail",id:t.id},this)},toAllQuestions:function(){var e={page_name:"common_qa"};r.Util.toWeb(e,this)},clickSelfServiceList:function(e){var i=this;i.setData({loadingVisible:!0}),i.data.ordersList=[];var n=e.currentTarget.dataset.index,c="";c=0===n?"refund_goods":1===n?"refund_money":"push_delivery";var d=r.DataUtil.formatByPos(s.default.selfServiceOrders,c,606,this.page,20,this.nextOffset);(0,a.default)(o.default.mark(function e(){var r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.SelfService.requestOrders(d);case 3:(r=e.sent)&&i.processOrdersList({that:i,reqFlag:d,ordersList:r.formatData,ordersListInfo:r.data,operate:c,loadAll:r.formatData.length<20}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}))},processOrdersList:function(e){var r=e.that;if(r.inRequest[e.reqFlag]=!1,r.setData({loadingVisible:!1}),e.ordersListInfo.errorCode)r.$showToast(e.ordersListInfo.errorMsg);else if(e.ordersList.length>0)r.$forward("choose_orders",{operate:e.operate});else{var t="您暂无此类订单";t="refund_goods"==e.operate?"当前暂无可退货退款订单":"refund_money"==e.operate?"当前暂无可退款订单":"当前暂无待发货订单",r.$showToast(t)}},onLoad:function(){var e=this;e.requestHotProblems(e)}};(0,r.PddPage)(i,{pageName:"self-service"}); 
 			}); 	require("pages/self_service/self_service.js");
 		__wxRoute = 'pages/choose_orders/choose_orders';__wxRouteBegin = true; 	define("pages/choose_orders/choose_orders.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var r=require("../../common/index"),t=e(require("../../configs/api")),s=require("../../controller/custom_service"),a=e(require("../../common/navigation")),o=e(require("../../common/gotop_util")),n=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),i=e(require("../../libs/regenerator-runtime/runtime")),d={page:1,nextOffset:0,inRequest:{},data:{ordersList:[],canLoadMore:null,loadingVisible:!0,goTopClass:!1},onLoad:function(e){var r=this,t="自助服务";t="refund_goods"==e.operate?"请选择要退货退款的订单":"refund_money"==e.operate?"请选择要退款的订单":"请选择要催发货的订单",r.operate=e.operate,wx.setNavigationBarTitle({title:t}),this.operate=e.operate,this.requestOrders()},requestOrders:function(){var e=this,a=r.DataUtil.formatByPos(t.default.selfServiceOrders,this.operate,"606",this.page,20,this.nextOffset);(0,n.default)(i.default.mark(function r(){var t;return i.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,s.SelfService.requestOrders(a);case 3:(t=r.sent)&&e.processOrdersList({that:e,reqFlag:a,ordersList:t.formatData,ordersListInfo:t.data,loadAll:t.formatData.length<20}),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),console.error(r.t0);case 10:case"end":return r.stop()}},r,this,[[0,7]])}))},processOrdersList:function(e){var r=e.that;if(r.inRequest[e.reqFlag]=!1,r.setData({loadingVisible:!1}),e.ordersListInfo.errorCode)r.$showToast(e.ordersListInfo.errorMsg);else{r.nowPage=e.reqFlag;var t=r.data.ordersList||[];if(e.ordersList.length>0)r.nextOffset=e.ordersListInfo.next_offset||0,r.page=e.loadAll?r.page:r.page+1,r.setData({ordersList:t.concat(e.ordersList||[]),canLoadMore:!e.loadAll});else if(r.setData({canLoadMore:!1}),t.length<=0){var s="您暂无此类订单";s="refund_goods"==r.operate?"当前暂无可退货退款订单":"refund_money"==r.operate?"当前暂无可退款订单":"当前暂无待发货订单",r.$showToast(s)}}},notFundOrders:function(){r.Util.toWeb({page_name:"qa_detail",id:89},this)},requestOrderInfo:n.default.wrap(i.default.mark(function e(t,s){var a,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a="order/"+s,e.next=4,r.Request.apiRequest("GET",a);case 4:return o=e.sent,e.abrupt("return",o);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),clickOrders:function(e){this.clickOrdersSku(e)},requestServiceTicket:n.default.wrap(i.default.mark(function e(s){var a,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.default.selfServiceTicket,e.next=4,r.Request.apiRequest("POST",a,{order_sn:s});case 4:return o=e.sent,e.abrupt("return",o);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),clickOrdersSku:function(e){var t=this,s=e.currentTarget.dataset;if(s){var o=s.index,d=this.data.ordersList[o],u=d.order_sn;if(null==u||u.length<=0)return;(0,n.default)(i.default.mark(function e(){var s,o,n,c,l,f,p,g;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.requestServiceTicket(u);case 3:if(!(s=e.sent).ticket_id){e.next=8;break}t.$showModal({title:"",content:"您对该订单申请过自助服务，是否查看？",cancelText:"取消",confirmText:"查看",success:function(e){e.confirm&&t.$forward("selfMessageProgress_detail",{ticketId:s.ticket_id})}}),e.next=23;break;case 8:if("push_delivery"!=t.operate){e.next=14;break}o=r.UrlUtil.buildQuery({order_sn:u,tel:d.mobile,type_id:48}),n="/pages/self_message/self_message?"+o,a.default.forward(n),e.next=23;break;case 14:if("退款处理中"!=d.order_status_desc){e.next=19;break}"refund_goods"==t.operate&&(c=r.UrlUtil.buildQuery({order_sn:u,tel:d.mobile,type_id:46}),l="/pages/self_message/self_message?"+c,a.default.forward(l)),"refund_money"==t.operate&&(f=r.UrlUtil.buildQuery({order_sn:u,tel:d.mobile,type_id:47}),p="/pages/self_message/self_message?"+f,a.default.forward(p)),e.next=23;break;case 19:return e.next=21,t.requestOrderInfo(t,u);case 21:g=e.sent,t.$forward("refund_money",{order_sn:u,after_sales_trigger:g.after_sales_trigger,after_sales_type:"apply"});case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),console.error(e.t0);case 28:case"end":return e.stop()}},e,this,[[0,25]])}))}},loadMoreList:function(){this.data.canLoadMore&&this.requestOrders()},onReachBottom:function(){this.loadMoreList()},onPageScroll:function(e){var r=parseInt(e.scrollTop,10);o.default.showGoTopBtn(r,this)}};(0,r.PddPage)(d,{pageName:"choose_orders"}); 
 			}); 	require("pages/choose_orders/choose_orders.js");
 		__wxRoute = 'pages/selfMessageProgress_detail/selfMessageProgress_detail';__wxRouteBegin = true; 	define("pages/selfMessageProgress_detail/selfMessageProgress_detail.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var r=require("../../common/index"),t=e(require("../../configs/api")),a=e(require("../../libs/co/we-index")),s=e(require("../../libs/regenerator-runtime/runtime")),i={data:{loadingVisible:!0},requestServiceMessage:a.default.wrap(s.default.mark(function e(a,i){var n,o;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.default.selfServiceMessage+"?ticket_id="+i,e.next=4,r.Request.apiRequest("GET",n);case 4:if(o=e.sent,a.setData({loadingVisible:!1}),!o.errorCode){e.next=9;break}return a.$showToast(o.errorMsg),e.abrupt("return");case 9:a.requestOrderInfo(a,o.order_sn),o.created_time=r.TimeUtil.formatTime(o.created_at,"yyyy-MM-dd hh:mm:ss"),o.history_record.forEach(function(e){e.created_time=r.TimeUtil.formatTime(e.created_at,"yyyy-MM-dd hh:mm:ss")}),a.setData({message:o}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])})),requestOrderInfo:a.default.wrap(s.default.mark(function e(t,a){var i,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a){e.next=3;break}return e.abrupt("return");case 3:return i="order/"+a,e.next=6,r.Request.apiRequest("GET",i);case 6:if(n=e.sent,t.setData({loadingVisible:!1}),!n.errorCode){e.next=11;break}return t.$showToast(n.errorMsg),e.abrupt("return");case 11:n&&n.after_sales&&n.after_sales.after_sales_id&&t.setData({after_sales_id:n.after_sales.after_sales_id}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])})),toSelfMessage:function(){this.$forward("self_message",{ticketId:this.ticketId})},toAfterSales:function(){this.$forward("afterSalesStatus_detail",{after_sales_id:this.data.after_sales_id})},previewImg:function(e){var r=e.currentTarget.dataset.url;wx.previewImage({current:r,urls:[r]})},onLoad:function(e){var r=this,t=e.ticketId;r.ticketId=t,r.requestServiceMessage(r,t)}};(0,r.PddPage)(i,{pageName:"selfMessageProgress_detail"}); 
 			}); 	require("pages/selfMessageProgress_detail/selfMessageProgress_detail.js");
 		__wxRoute = 'pages/self_message_progress/self_message_progress';__wxRouteBegin = true; 	define("pages/self_message_progress/self_message_progress.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=require("../../common/index"),r=e(require("../../configs/api")),a=e(require("../../common/gotop_util")),i=e(require("../../libs/co/we-index")),o=e(require("../../libs/regenerator-runtime/runtime")),s=(require("../../controller/custom_service"),e(require("../../storage/ram_manager"))),n={page:0,inRequest:{},data:{ticketList:[],canLoadMore:null,loadingVisible:!0,goTopClass:!1},requestServiceTicketList:i.default.wrap(o.default.mark(function e(a){var i,s,n,c,u,l,d;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=a.page||0,s=20,n=[i,20].join("$"),!a.inRequest[n]){e.next=6;break}return e.abrupt("return");case 6:return a.inRequest[n]=!0,c=t.DataUtil.formatByPos(r.default.selfServiceTicketList,i,s),e.next=10,t.Request.apiRequest("GET",c);case 10:if(u=e.sent,a.inRequest[n]=!1,a.setData({loadingVisible:!1}),!u.errorCode){e.next=16;break}return a.$showToast(u.errorMsg),e.abrupt("return");case 16:u&&u.ticket_list.length>0&&u.ticket_list.forEach(function(e){e.created_time=a.formatTime(e.created_at)}),l=u.ticket_list.length<s,d=a.data.ticketList||[],u.ticket_list.length>0?(a.page=l?a.page:a.page+1,a.setData({ticketList:d.concat(u.ticket_list||[]),canLoadMore:!l})):a.setData({canLoadMore:!1}),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),console.error(e.t0);case 25:case"end":return e.stop()}},e,this,[[0,22]])})),formatTime:function(e){var t=new Date(1e3*e),r=t.getMonth()+1,a=t.getDate(),i=t.getHours(),o=t.getMinutes();return r=r<10?"0"+r:r,a=a<10?"0"+a:a,i=i<10?"0"+i:i,o=o<10?"0"+o:o,r+"月"+a+"日 "+i+":"+o},loadMoreList:function(){var e=this;e.data.canLoadMore&&e.requestServiceTicketList(e)},onReachBottom:function(){this.loadMoreList()},onPageScroll:function(e){var t=parseInt(e.scrollTop,10);a.default.showGoTopBtn(t,this)},toDetail:function(e){var t=this,r=e.currentTarget.dataset.ticketId;r&&t.$forward("selfMessageProgress_detail",{ticketId:r})},onLoad:function(e){var t=this;t.requestServiceTicketList(t)},onShow:function(){s.default.isLastPageService=!0},onUnload:function(){s.default.isLastPageService=!1}};(0,t.PddPage)(n,{pageName:"self_message_progress"}); 
 			}); 	require("pages/self_message_progress/self_message_progress.js");
 		__wxRoute = 'pages/self_message/self_message';__wxRouteBegin = true; 	define("pages/self_message/self_message.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=require("../../common/index"),r=e(require("../../configs/api")),a=e(require("../../storage/ram_manager")),s=e(require("../../common/upload_file")),n=e(require("../../libs/co/we-index")),i=e(require("../../libs/regenerator-runtime/runtime")),o={data:{commentImgs:[],showQuestionsPanel:!1,questionsList:[],restStringLen:170,rightPhone:!0,loadingVisible:!0},requestServiceMessage:n.default.wrap(i.default.mark(function e(a,s){var n,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=r.default.selfServiceMessage+"?ticket_id="+s,e.next=4,t.Request.apiRequest("GET",n);case 4:if(o=e.sent,a.setData({loadingVisible:!1,enableSubmit:!0}),!o.errorCode){e.next=9;break}return a.$showToast(o.errorMsg),e.abrupt("return");case 9:o.created_time=t.TimeUtil.formatTime(o.created_at,"yyyy-MM-dd hh:mm:ss"),o.tel_hidden=o.tel.slice(0,3)+"****"+o.tel.slice(7,11),a.setData({message:o,tel:o.tel,tel_hidden:o.tel_hidden,type_desc:o.type_desc,type_id:o.type_id,restStringLen:a.data.restStringLen-o.question.length}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])})),requestServiceProblems:n.default.wrap(i.default.mark(function e(a){var s,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=r.default.selfServiceProblems+"?"+a,e.next=4,t.Request.apiRequest("GET",s);case 4:return n=e.sent,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),inputStringChange:function(e){var t=e.detail.value.length,r=170-parseInt(t);this.setData({restStringLen:r,enableSubmit:t>0})},regPhone:function(e){var t=e.detail.value;""==t||/^1[34578]\d{9}$/.test(t)?this.setData({rightPhone:!0}):this.setData({rightPhone:!1})},chooseCommentImg:s.default.chooseCommentImg,delCommentImg:s.default.delCommentImg,previewImg:function(e){var t=e.currentTarget.dataset.url;wx.previewImage({current:t,urls:[t]})},questionType:function(){var e=this;e.data.questionsList.length>0?e.setData({showQuestionsPanel:!0}):(0,n.default)(i.default.mark(function t(){var r;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.requestServiceProblems(e.param);case 3:r=t.sent,e.setData({questionsList:r.problem_list,showQuestionsPanel:!0}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}},t,this,[[0,7]])}))},chooseType:function(e){var t=e.currentTarget.dataset;if(t){var r=t.index;this.setData({type_id:this.data.questionsList[r].id,type_desc:this.data.questionsList[r].type_desc})}this.closePanel()},closePanel:function(){this.setData({showQuestionsPanel:!1})},selfServiceForm:function(e){var a=this,s=a.data.rightPhone,o=e.detail.value;if(0!=s)if(""!=o.question){if(o.type_id=parseInt(o.type_id),a.data.commentImgs.length>0){var u=[];a.data.commentImgs.forEach(function(e){var t={url:e.url};u.push(t)}),o.attach_url=u}else"update"==a.operate&&a.data.message.attach_url.length>0&&(o.attach_url=a.data.message.attach_url);""==o.tel&&(o.tel=a.data.tel),"create"==a.operate?(o.goods_name=a.goods_name,o.mall_id=a.mall_id,o.order_sn=a.order_sn):o.ticket_id=a.ticket_id,a.setData({loadingVisible:!0}),(0,n.default)(i.default.mark(function e(){var s,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.DataUtil.formatByPos(r.default.postSelfServiceMessage,a.operate),e.next=3,t.Request.apiRequest("POST",s,o);case 3:n=e.sent,a.setData({loadingVisible:!1}),n.error_msg?a.$showToast(n.error_msg):a.$showModal({title:"留言提交成功",content:"拼多多会尽快核实，并通过微信公众号“拼多多”或者手机拼多多通知您处理结果，感谢您的支持。",showCancel:!1,confirmText:"知道了",success:function(e){e.confirm&&a.$forward("personal")}});case 6:case"end":return e.stop()}},e,this)})).catch(function(e){a.setData({loadingVisible:!1}),a.$showToast(e.error_msg)})}else a.$showToast("请输入");else a.$showToast("请输入正确的手机号")},requestOrderInfo:n.default.wrap(i.default.mark(function e(r,a){var s,n;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s="order/"+a,e.next=4,t.Request.apiRequest("GET",s);case 4:return n=e.sent,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),preventTouchMove:function(){},onLoad:function(e){var r=this;if(e=t.UrlUtil.parseQuery(e),"choose_orders"==a.default.referPageName){var s=e.tel,o=e.type_id,u="";u=46==o?"我要退货退款":47==o?"我要退款":"我要催发货",r.order_sn=e.order_sn;var c=s.slice(0,3)+"****"+s.slice(7,11);(0,n.default)(i.default.mark(function e(){var t;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.requestOrderInfo(r,r.order_sn);case 2:t=e.sent,r.goods_name=t.order_goods[0].goods_name,r.mall_id=t.mall_id;case 5:case"end":return e.stop()}},e,this)})),r.setData({tel:s,type_desc:u,type_id:o,tel_hidden:c,loadingVisible:!1,enableSubmit:!1}),r.param="group=1",r.operate="create"}else{var l=e.ticketId;l&&(r.ticket_id=l),r.requestServiceMessage(r,l),r.param="parent_id=0",r.operate="update"}}};(0,t.PddPage)(o,{pageName:"self_message"}); 
 			}); 	require("pages/self_message/self_message.js");
 		__wxRoute = 'pages/open_envelope/open_envelope';__wxRouteBegin = true; 	define("pages/open_envelope/open_envelope.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}e(require("../../common/url_util")),e(require("../../common/util")),e(require("../../common/image_util"));var t=e(require("../../common/std_format")),r=(e(require("../../components/toast/toast.js")),e(require("../../constants/groups")),require("../../common/index")),o=e(require("../../configs/api")),a=e(require("../../common/request")),s=(e(require("../../common/page_util")),e(require("../../constants/order")),e(require("../../controller/formid_controller")),e(require("../../models/format/grid_item_goods"))),n=e(require("../../storage/user_storage")),i=e(require("../../storage/ram_manager")),u=e(require("../../libs/co/we-index")),c=e(require("../../libs/regenerator-runtime/runtime")),d=(require("../../common/message"),e(require("../../common/gotop_util"))),l=e(require("../../components/big_sales/big_sales")),p={40010:"错误的请求参数",40011:"不在活动时间",40012:"您有1个50元红包未拆开，快让朋友一起拆",40013:"今天拆红包的次数超过限制啦",40014:"您今天帮朋友拆红包次数达到上限了，快拆个新红包吧",40015:"您已帮他拆过红包",40016:"您不能帮自己拆红包哦",40017:"该红包已过期啦~快开个红包给朋友拆",40018:"该红包已被拆开，快开个红包给朋友拆",40019:"该红包不存在,正在开一新红包...",40020:"该红包正在被拆开，请稍等..."};(0,r.PddPage)({components:[],requestingSubjectLock:!1,subjectReqData:{subjectId:"3198",sortTypeName:"PRIORITY",page:1,size:50},setTimes:0,countTime:0,allGoodsListCache:[],isATest:!0,isFirstEnter:!0,scrollTop:0,data:{showMidLoading:!0,isLoadingMore:!1,list:[],size:20,page:1,showSendEnvelope:!1,showRuleModal:!1,showShareModal:!1,showInvite:!1,showConfirmModal:!1,goodsList:[],canGoodsLoadMore:!0,goTopClass:!1,showAniSec:!1,imgSignUrl:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/open_envelope/open_env_goods_icon.png",isLogin:!1},onShareAppMessage:function(e){this.userId||(this.userId=n.default.getUserId());var t={group_id:this.groupId,uid:this.userId},r=this,o="top_forward";return e&&"menu"!=e.from&&(o="share_btn"),this.$generateShareContent({title:r.shareDesc?r.shareDesc:"每次瓜分现金红包50元，每人领取次数无上限",referStr:o,queries:t,imageUrl:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/big_sales/open_env_share_img.png",successCallback:function(){r.$showToast("已发送邀请。分享3个微信群，拆开红包概率达98%")}})},didClickGetUserInfoBtn:function(e){if(wx.canIUse&&wx.canIUse("button.open-type.getUserInfo")){var t=e.currentTarget.dataset||{};this.btnAction=t.action}else this.$showToast("您的微信版本过低，建议升级微信获得更好体验")},getUserInfoHandler:function(e){var t=this;if(e&&e.detail&&e.detail.userInfo){var o=e.detail.userInfo;r.User.saveNickNameAndAvatarUrl(o),r.User.requireLogin(function(e){t.loadPage(),t.btnAction&&t[t.btnAction]()},null)}else this.dealRefuseAuth()},loadPage:function(){var e=this;e.groupId=e.$urlQueryObj.group_id?e.$urlQueryObj.group_id:null,e.localUserInfo=r.User.getUserLocalInfo()||{};var t=!!n.default.getUserId(),o=!t&&!e.groupId,a=!t&&e.groupId;this.setData({isLogin:t,showSendEnvelope:o,showInvite:a}),e.getGroupDetail(),e.getGotCouponList(),e.countDownTime();var s=new l.default({setDataFunc:function(t){e.setData(t)}}).checkInBigSales();e.setData({inBigSalesFlag:s}),e.abTest(),(0,u.default)(c.default.mark(function t(){var r,o,a;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getShareDesc();case 3:r=t.sent,o=r.length,a=Math.floor(o*Math.random()),r[a]&&(e.shareDesc=r[a]),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}},t,this,[[0,9]])}))},onLoad:function(e){var t=this;this.pvTracking(),r.User.requireLogin(function(e){t.loadPage()},function(){t.loadPage()})},getGroupDetail:function(){var e=this;e.groupId?(0,u.default)(c.default.mark(function t(){var r,o;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getGroupInfo(e);case 3:if(r=t.sent,o={showMidLoading:!1},r.data&&r.data.group_snapshot||setTimeout(function(){e.getLatestEnvGroup()},3e3),!r||!r.error_code){t.next=10;break}return e.$showToast(p[r.error_code]),e.setData({showMidLoading:!1}),t.abrupt("return");case 10:e.processGroupData(r),e.setData(o),e.getJoinCondition(r),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),console.error(t.t0);case 18:case"end":return t.stop()}},t,this,[[0,15]])})):e.getLatestEnvGroup()},abTest:function(){this.subjectReqData.subjectId="2742",this.setData({imgSignUrl:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/new_song/new_song_recommend_sign.png"}),this.isATest=!1,this.fillListData()},getGotCouponList:function(){var e=this;(0,u.default)(c.default.mark(function r(){var o,a,s,n,i,u,d,l,p;return c.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.reqGotCouponList(e);case 3:if(!(o=r.sent)||!o.data){r.next=26;break}for(a=[],s=!0,n=!1,i=void 0,r.prev=9,u=o.data[Symbol.iterator]();!(s=(d=u.next()).done);s=!0)l=d.value,p={nickName:l.nick_name,money:t.default.price(l.money,100)},a.push(p);r.next=17;break;case 13:r.prev=13,r.t0=r.catch(9),n=!0,i=r.t0;case 17:r.prev=17,r.prev=18,!s&&u.return&&u.return();case 20:if(r.prev=20,!n){r.next=23;break}throw i;case 23:return r.finish(20);case 24:return r.finish(17);case 25:e.gotCouponList=a;case 26:r.next=31;break;case 28:r.prev=28,r.t1=r.catch(0),console.error(r.t1);case 31:case"end":return r.stop()}},r,this,[[0,28],[9,13,17,25],[18,,20,24]])}))},reqGotCouponList:u.default.wrap(c.default.mark(function e(t){var r,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=o.default.getGotCouponUsers,e.next=4,a.default.apiRequest("POST",r,{},!1,{forceUseApiGZ:!0,needGZToken:!0});case 4:return s=e.sent,e.abrupt("return",s);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0.error_code&&t.$showToast(p[e.t0.error_code]);case 12:case"end":return e.stop()}},e,this,[[0,8]])})),onUnload:function(){clearInterval(this.expire)},onHide:function(){clearInterval(this.expire)},getLatestEnvGroup:function(){var e=this;(0,u.default)(c.default.mark(function t(){var r,o,a;return c.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getLatestGroup();case 3:r=t.sent,o={showMidLoading:!1},a=r.participate_count,e.processGroupData(r),e.setData(o),e.getJoinCondition(r),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0),e.setData({showMidLoading:!1});case 15:case"end":return t.stop()}},t,this,[[0,11]])}))},processGroupData:function(e){if(e){var t=this;t.checkActiviyEnd(e);var o=e.data?e.data.group_snapshot:null,a={};if(o){if(o=t.formatGroupData(e),t.$urlQueryObj.group_id||4!=o.groupStatus&&2!=o.groupStatus&&3!=o.groupStatus||!t.isFirstEnter&&t.showSendEnvelopeId!=o.group_id?(o.members&&o.members.length>0&&(a.showSendEnvelope=!1,a.showInvite=!0,a.groupData=o),o.isInGroup&&1==o.groupStatus&&t.isFirstEnter&&(a.showConfirmModal=!0)):(a.showSendEnvelope=!0,t.showSendEnvelopeId=o.group_id),1!=o.groupStatus&&o.expire_time){var s=o.expire_time,n=r.TimeUtil.formatTime(s);a.transferedTimeStr=n}if(o.leftTime>0){var i=o.leftTime;t.setData({transferedTimeStr:t.getTransferedTimeStr(i),leftTime:i})}}else a.showSendEnvelope=!0,a.showInvite=!1,a.openNewEnvelope=!0;t.setData(a)}},checkActiviyEnd:function(e){var t=this,r=new Date;if(r.setFullYear(2018,0,2),r.setHours(0,0,1),e&&e.server_time)r.getTime()<1e3*e.server_time&&t.dealActivityEnd();else{var o=parseInt(Date.now()+i.default.timeDiff,10);r.getTime()<o&&t.dealActivityEnd()}},dealActivityEnd:function(){var e=this;e.$showToast("拆红包活动已结束..."),setTimeout(function(){e.$switchTab("index")},3e3)},pvTracking:function(){var e={page_sn:10102,op:"pv",page_url:"pages/open_envelope/open_envelope"};(0,r.TrackingRecord)(e),this.$firstTimeTrackRecord.pv=!0},imprTracking:function(){if(!this.$firstTimeTrackRecord.impr&&!i.default.isWaitingOpenGid){var e={op:"impr",page_name:this.$pageName,page_sn:"10102",page_el_sn:"99318"};(0,r.TrackingRecord)(e),this.$firstTimeTrackRecord.impr=!0}},confirmModalClose:function(){this.setData({showConfirmModal:!1}),this.data.groupData&&this.data.groupData.max_member&&this.$showToast("您的红包还差"+(this.data.groupData.max_member-this.data.groupData.members.length)+"人才能拆开，别忘了邀请好友一起拆哦")},getJoinCondition:function(e){e&&e.data&&e.data.join_condition&&(this.joinCondition=e.data.join_condition)},formatGroupData:function(e){var t=e&&e.data?e.data.group_snapshot:e&&e.members&&e.members.length>0?e:null;if(t&&t.members&&t.members.length>0){for(var r=this,o=[],a=t.max_member-t.members.length,s=0;s<a;s++)o.push(s);t.emptyMembers=o,r.groupId=t.group_id;var i=t.members,u=!1,c=!1,d=0,l=0,p=0;r.userId||(r.userId=n.default.getUserId());var f=!0,h=!1,g=void 0;try{for(var m,v=i[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var T=m.value;T.uid==r.userId&&(u=!0,d=T.money?T.money:0),T.is_leader&&T.uid==r.userId&&(c=!0),T.money>p&&(p=T.money,l=T.uid)}}catch(e){h=!0,g=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw g}}t.isGroupOwner=c,t.isInGroup=u,t.couponMoney=d,t.mostLuckyUserId=l;var _=1e3*(t.expire_time-e.server_time);t.leftTime=_;var w=t.max_member,L=void 0;return _>0?w==t.members.length?L=2:w>t.members.length&&(L=1):w==t.members.length?L=3:w>t.members.length&&(L=4),t.groupStatus=L,t}},countDownTime:function(){var e=this;e.expire=setInterval(function(){e.countTime++;var t=e.data.leftTime-1e3;if(t>0)e.setData({leftTime:t,transferedTimeStr:e.getTransferedTimeStr(t)});else if(0==t){var o={},a=e.data.groupData;if(a=e.formatGroupData(a),o.groupData=a,a.expire_time){var s=a.expire_time,n=r.TimeUtil.formatTime(s);o.transferedTimeStr=n}e.setData(o)}3==e.countTime&&e.gotCouponList&&e.gotCouponList.length>0&&e.gotCouponList.length>e.setTimes&&(e.countTime=0,e.setGotCoupon()),!(t>0)&&e.gotCouponList&&e.gotCouponList.length>0&&e.gotCouponList.length<=e.setTimes&&clearInterval(e.expire)},1e3)},getTransferedTimeStr:function(e){var t=r.TimeUtil.transferToTime(e),o=t.split(":");return t=o.slice(0,o.length-1).join(":")+":"+o[o.length-1]},setGotCoupon:function(){var e=this;e.gotCouponList.length>e.setTimes&&(e.gotCouponList[e.setTimes]&&(e.gotCouponList[e.setTimes].show=!0,e.gotCouponList[e.setTimes-2]&&(e.gotCouponList[e.setTimes-2].show=!1)),e.setData({gotCouponList:e.gotCouponList}),e.setTimes++)},showRuleModal:function(){this.setData({showRuleModal:!0})},preventTouchMove:function(){},hideRuleModelFn:function(){this.setData({showRuleModal:!1})},sendEnvelope:function(e){var t=this;t.setData({showMidLoading:!0}),t.$uploadFormId(e,!1),(0,u.default)(c.default.mark(function e(){var o,a,s,n,i;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createEnvGroup(t);case 3:o=e.sent,a=t.formatGroupData(o),t.setData({groupData:a,showSendEnvelope:!1,showInvite:!0,showMidLoading:!1,showConfirmModal:!0}),a.leftTime>0?(s=a.leftTime,t.setData({transferedTimeStr:t.getTransferedTimeStr(s),leftTime:s})):a.expire_time&&(n=a.expire_time,i=r.TimeUtil.formatTime(n),t.setData({transferedTimeStr:i})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t.setData({showMidLoading:!1});case 12:case"end":return e.stop()}},e,this,[[0,9]])}));try{(0,r.TrackingRecord)({op:"click",page_sn:"10102",page_el_sn:"99320"})}catch(e){}},openNewEnvelope:function(e){var t=this;t.setData({showMidLoading:!0}),(0,u.default)(c.default.mark(function o(){var a,s,n,i,u,d,l;return c.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,t.getLatestGroup();case 3:a=o.sent,s={},n=a.data?a.data.group_snapshot:null,i=a.data?a.data.participate_count:null,n?(2==(n=t.formatGroupData(a)).groupStatus||3==n.groupStatus||4==n.groupStatus?t.sendEnvelope(e):(n&&n.members&&n.members.length>0&&(s.showSendEnvelope=!1,s.showInvite=!0,s.groupData=n),1==n.groupStatus?(s.showConfirmModal=!0,u=n.leftTime,t.setData({transferedTimeStr:t.getTransferedTimeStr(n.leftTime),leftTime:n.leftTime})):n.expire_time&&(d=n.expire_time,l=r.TimeUtil.formatTime(d),s.transferedTimeStr=l),t.$uploadFormId(e,!1)),s.showMidLoading=!1):t.sendEnvelope(e),t.setData(s),t.getJoinCondition(a),o.next=16;break;case 12:o.prev=12,o.t0=o.catch(0),console.error(o.t0),t.setData({showMidLoading:!1});case 16:case"end":return o.stop()}},o,this,[[0,12]])}))},inviteFriendsOpen:function(e){this.$uploadFormId(e,!1),(0,r.TrackingRecord)({op:"click",page_sn:"10102",page_el_sn:"99317"})},joinEnvGroup:function(e){var t=this,o={op:"click",page_sn:10102,page_el_sn:"99313"};(0,r.TrackingRecord)(o),t.joinCondition&&t.joinCondition.is_helped_this_captain?t.$showToast("您已帮他拆过红包~"):(t.$uploadFormId(e,!1),(0,u.default)(c.default.mark(function e(){var r,o,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setData({showMidLoading:!0}),e.next=4,t.joinGroup(t);case 4:if(!(r=e.sent)||!r.error_code){e.next=9;break}return t.$showToast(p[r.error_code]),t.setData({showMidLoading:!1}),e.abrupt("return");case 9:o=t.formatGroupData(r),a={groupData:o,showMidLoading:!1},o&&1==o.groupStatus&&(a.showConfirmModal=!0),t.setData(a),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])})))},createEnvGroup:u.default.wrap(c.default.mark(function e(t){var s,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=o.default.createEnvGroup,t.localUserInfo.avatarUrl&&t.localUserInfo.nickName||(t.localUserInfo=r.User.getUserLocalInfo()||{}),e.next=5,a.default.apiRequest("POST",s,{image_url:t.localUserInfo.avatarUrl,nick_name:t.localUserInfo.nickName,open_id:t.localUserInfo.openId,form_id:t.formId},!1,{forceUseApiGZ:!0,needGZToken:!0});case 5:return n=e.sent,e.abrupt("return",n);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.t0.error_code&&t.$showToast(p[e.t0.error_code]);case 13:case"end":return e.stop()}},e,this,[[0,9]])})),getLatestGroup:u.default.wrap(c.default.mark(function e(t){var r,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=o.default.getLatestEnvGroup,e.next=4,a.default.apiRequest("POST",r,null,!1,{forceUseApiGZ:!0,needGZToken:!0});case 4:return(s=e.sent)&&!s.success&&this.dealRefuseAuth(),e.abrupt("return",s);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.t0.error_code&&(t.$showToast(p[e.t0.error_code]),self.setData({showMidLoading:!1}));case 13:case"end":return e.stop()}},e,this,[[0,9]])})),getGroupInfo:u.default.wrap(c.default.mark(function e(t){var r,s,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=o.default.getGroupInfo,e.next=4,a.default.apiRequest("POST",r,{group_id:t.groupId},!0,{forceUseApiGZ:!0,needGZToken:!0});case 4:return s=e.sent,this.gotGroupInfo=!0,this.gotRecommendList&&this.gotGroupInfo&&this.isFirstEnter&&(n=this,setTimeout(function(){n.dealRefuseAuth()},300)),e.abrupt("return",s);case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),e.t0.error_code&&(t.$showToast(p[e.t0.error_code]),t.setData({showMidLoading:!1}));case 14:case"end":return e.stop()}},e,this,[[0,10]])})),getShareDesc:u.default.wrap(c.default.mark(function e(t){var r,s;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=o.default.getOpenEnvShareMsg,e.next=4,a.default.apiRequest("GET",r,null,!0,{forceUseApiGZ:!0});case 4:return s=e.sent,e.abrupt("return",s);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.t0.error_code&&t.$showToast(p[e.t0.error_code]);case 12:case"end":return e.stop()}},e,this,[[0,8]])})),joinGroup:u.default.wrap(c.default.mark(function e(t){var s,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=o.default.joinGroup,t.localUserInfo.avatarUrl&&t.localUserInfo.nickName||(t.localUserInfo=r.User.getUserLocalInfo()||{}),e.next=5,a.default.apiRequest("POST",s,{group_id:t.groupId,image_url:t.localUserInfo.avatarUrl,nick_name:t.localUserInfo.nickName,open_id:t.localUserInfo.openId,form_id:t.formId},!1,{forceUseApiGZ:!0,needGZToken:!0});case 5:return n=e.sent,e.abrupt("return",n);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.t0.error_code&&t.$showToast(p[e.t0.error_code]);case 13:case"end":return e.stop()}},e,this,[[0,9]])})),goToUseCoupon:function(e){var t=i.default.CPPage;t.$forward("spike"),t.$uploadFormId(e,!1);var o={op:"click",page_sn:10102,page_el_sn:"99315"};(0,r.TrackingRecord)(o)},onShow:function(){i.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking(),this.isFirstEnter||(this.getGroupDetail(),this.countDownTime());var e=this;r.User.requireLogin(function(){e.imprTracking()},function(){e.imprTracking()})},getSubjectGoodsData:u.default.wrap(c.default.mark(function e(t){var n,i,u,d,l,p,f,h,g,m;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.requestingSubjectLock&&t.data.canGoodsLoadMore){e.next=3;break}return e.abrupt("return");case 3:return t.requestingSubjectLock=!0,n=t.subjectReqData,i=n.subjectId,u=n.sortTypeName,d=n.page,l=n.size,p=r.DataUtil.formatByPos(o.default.subjectCollectionGoodsApi,i,u,d,l),e.next=12,a.default.apiRequest("GET",p,{},!0);case 12:f=e.sent,h=f.goods_list||[],g=h.length<=0,m=h.map(function(e){return s.default.formatData(e)}),t.processSubjectsGoods({goodsList:m,isLoadAll:g,page:d}),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0);case 22:case"end":return e.stop()}},e,this,[[0,19]])})),processSubjectsGoods:function(e){this.requestingSubjectLock=!1,this.allGoodsListCache=Array.isArray(this.allGoodsListCache)?this.allGoodsListCache:[],this.allGoodsListCache=Array.isArray(e.goodsList)?this.allGoodsListCache.concat(e.goodsList):this.allGoodsListCache,this.allGoodsListCache=r.DataUtil.objectArrayDuplicateRemove(this.allGoodsListCache,"goodsId",function(e){return 1==e.isApp})||[],this.fillListData(1===e.page),this.subjectReqData.page++,this.setData({loadMoreVisible:!0,canGoodsLoadMore:!e.isLoadAll})},onReachBottom:function(e){!1!==this.data.canGoodsLoadMore&&this.fillListData()},fillListData:function(e){var t=this.allGoodsListCache||[],r=this.data.goodsList||[];e&&(r=[]);var o=r.length;t.length>o?this.renderListDataFn(o,r,t):this.getSubjectGoodsData(this)},renderListDataFn:function(e,t,r){var o=t.length+(0===e?6:20);if(t=r.slice(0,o),this.setData({goodsList:t}),this.gotRecommendList=!0,this.gotRecommendList&&this.gotGroupInfo&&this.isFirstEnter){var a=this;setTimeout(function(){a.dealRefuseAuth()},300)}},gotoGoodsDetail:function(e){var t=e.currentTarget.dataset,o=t.index,a=t.goodsId;this.$forward("goods",{goods_id:a,xcx_campaign_id_02:"d11_red_group"}),(0,r.TrackingRecord)({op:"click",page_name:"open_envelope",page_section:"goods_list",page_element:"goods",page_el_sn:"99309",idx:o,page_sn:"10102",rec_goods_id:a})},onPageScroll:function(e){if(e&&e.scrollTop){var t=parseInt(e.scrollTop);this.scrollTop=t,d.default.showGoTopBtn(t,this)}},dealRefuseAuth:function(){if(this.isFirstEnter=!1,!r.User.hasLogin()){var e=r.User.latestLoginExtraInfo();if(e&&!e.isClickWxAuthBtn){var t=this,o=wx.createSelectorQuery();o.select("#recommend_list").boundingClientRect(),o.selectViewport().scrollOffset(),o.exec(function(e){e&&e[0]&&wx.pageScrollTo({scrollTop:t.scrollTop+e[0].top})})}}}},{pageName:"open_envelope",notUseCommonPV:!0}); 
 			}); 	require("pages/open_envelope/open_envelope.js");
 		__wxRoute = 'pages/web/web';__wxRouteBegin = true; 	define("pages/web/web.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var a=require("../../common/index"),r=e(require("../../configs/app_config")),o=e(require("../../common/url_util")),t=e(require("../../common/object_util")),i=e(require("../../storage/user_storage")),u=e(require("../../common/visitor_logger")),n=e(require("../../common/logger_util")),d=e(require("../../storage/ram_manager")),m={pageName:"web",data:{},onLoad:function(e){var a=e.page_name;this.pageName=a,e=t.default.assign({},e,{app_name:r.default.appName,app_version:r.default.version,token:i.default.getAccessToken()||"",uid:i.default.getUserId()||"",trace_id:u.default.getVisitorLocalInfo().xcxTraceId||"",network:n.default.convertNetwork(d.default.networkType)});var m=r.default.apiGZDomain+"hawaii/"+a;m=m+"?"+o.default.buildQuery(e);var s=decodeURIComponent(m);this.setData({src:s})}};(0,a.PddPage)(m,{pageName:"web",notUseCommonPV:!0}); 
 			}); 	require("pages/web/web.js");
 		__wxRoute = 'pages/mall_group/mall_group';__wxRouteBegin = true; 	define("pages/mall_group/mall_group.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var r=require("../../common/index"),t=e(require("../../configs/api")),a=(e(require("../../storage/ram_manager")),e(require("../../libs/co/we-index"))),o=e(require("../../libs/regenerator-runtime/runtime")),i=(e(require("../../configs/request_errors")),{data:{mallId:"",dataList:[],loadingVisible:!0,loadingText:"正在加载"},reLoad:function(){this.setData({showError:!1,loadingVisible:!0}),this.loadPage()},onLoad:function(e){var t=void 0;e&&(t=r.UrlUtil.parseQuery(e).mall_id,this.setData({mallId:t})),this.loadPage()},loadPage:function(){this.getMallGroup()},getMallGroup:function(){var e=this;(0,a.default)(o.default.mark(function r(){var t;return o.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.getMallGroupInfo(e);case 3:t=r.sent,e.setData({mallGroupData:t,loadingVisible:!1}),e.HasleftTime&&e.expireTimeCount(),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(0),console.error(r.t0);case 11:case"end":return r.stop()}},r,this,[[0,8]])}))},getMallGroupInfo:a.default.wrap(o.default.mark(function e(a){var i,n,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=t.default.getMallGroup,e.next=4,r.Request.apiRequest("POST",i,{mall_id:a.data.mallId},!1);case 4:return n=e.sent,s=a.formatGroupData(n),e.abrupt("return",s);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),a.$showToast("加载出错"),a.setData({loadingVisible:!1,showError:!0});case 14:case"end":return e.stop()}},e,this,[[0,9]])})),formatGroupData:function(e){var t=e.result,a=[];this.HasleftTime=!1;var o=!0,i=!1,n=void 0;try{for(var s,u=t[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var l=s.value,d={},c=1e3*(l.expire_time-l.server_time),p=r.TimeUtil.transferToTime(c).split(":");c>0&&(this.HasleftTime=!0),d.leftTimeDesc=p.slice(0,p.length-1).join(":")+":"+p[p.length-1],d.leftTime=c,d.avatar=l.avatar?l.avatar:"",d.expireTime=l.expire_time?l.expire_time:"",d.goodsId=l.goods_id?l.goods_id:"",d.goodsName=l.goods_name?l.goods_name:"",d.groupOrderId=l.group_order_id?l.group_order_id:"",d.hdThumbUrl=l.hd_thumb_url?l.hd_thumb_url:"",d.minOnSaleGroupPrice=l.min_on_sale_group_price?r.StdFormat.price(l.min_on_sale_group_price,100):"",d.nickName=l.nickname?l.nickname.slice(0,1)+"*"+(l.nickname.length>1?l.nickname.slice(-1):""):"",d.serverTime=l.server_time?l.server_time:"",d.soldQuantity=l.sold_quantity?r.StdFormat.sales(l.sold_quantity):"",d.thumbUrl=l.thumb_url?l.thumb_url:"",a.push(d)}}catch(e){i=!0,n=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw n}}return a},expireTimeCount:function(){var e=this;e.HasleftTime&&(e.timeCount=setTimeout(function(){var t=e.data.mallGroupData;e.HasleftTime=!1;for(var a in t){var o=t[a].leftTime-1e3;if(!(o<=0)){var i=r.TimeUtil.transferToTime(o).split(":");e.HasleftTime=!0,t[a].leftTime=o,t[a].leftTimeDesc=i.slice(0,i.length-1).join(":")+":"+i[i.length-1]}}e.setData({mallGroupData:t}),e.expireTimeCount()},1e3))},onReady:function(){},onShow:function(){},goToMallGroup:function(){this.$forward("mall_group")},goToGoodsInfo:function(e){var t=this,i=e.currentTarget.dataset.groupOrderId,n=e.currentTarget.dataset.goodsId,s=e.currentTarget.dataset.index;(0,a.default)(o.default.mark(function e(){var r,a,s,u,l;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getGroupOrderDetail(i,t);case 3:r=e.sent,a=r.group_order_info.group_status,s=r.self_order_info,u=r.leader_order_info,l=s&&s.uid===u.uid?2:s?1:0,t.$forward("goods",{goods_id:n,group_order_id:i,status:a,groupRole:l,hideMinLeftTimeLocalGroup:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])})),(0,r.TrackingRecord)({op:"click",page_sn:10039,page_el_sn:99241,mall_id:this.data.mallId,group_order_id:i,idx:s})},getGroupOrderDetail:a.default.wrap(o.default.mark(function e(a,i){var n,s,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=r.DataUtil.formatByPos(t.default.groupOrder,a),s=r.Request.requestDataWithUrl("GET",n),e.next=5,r.Request.runSecondaryRequestForPage(s,i);case 5:return u=e.sent,e.abrupt("return",u);case 9:e.prev=9,e.t0=e.catch(0),this.setData({showError:!0,loadingVisible:!1}),i.$showToast("加载出错");case 13:case"end":return e.stop()}},e,this,[[0,9]])})),clickGroupItem:function(e){var r=e.currentTarget.dataset.groupOrderId;this.$forward("group",{group_order_id:r})},onHide:function(){}});(0,r.PddPage)(i,{pageName:"mall_group"}); 
 			}); 	require("pages/mall_group/mall_group.js");
 		__wxRoute = 'pages/brand_spike/brand_spike';__wxRouteBegin = true; 	define("pages/brand_spike/brand_spike.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var r=require("../../common/index"),a=(e(require("../../common/logger_util")),e(require("../../configs/api"))),i=(e(require("../../constants/tracking/subjects")),e(require("../../storage/ram_manager"))),n=e(require("../../models/format/spike_goods")),o=require("../../common/message"),s=(e(require("../../libs/es6-promise.min")),e(require("../../libs/co/we-index"))),d=e(require("../../libs/regenerator-runtime/runtime")),u=e(require("../../common/gotop_util")),c=e(require("../../controller/spike_controller")),l={page:1,goodsLastOneIndex:{},updateSecondTimer:null,globalSecond:0,isOnHideStatus:!1,loadingLock:{},isSettingRemind:!1,data:{canLoadMore:!1,loadingVisible:!0,pageName:"brand_spike",scrollTopValue:0,isFirstEnter:!0,globalSecond:"00",showError:!1},onShareAppMessage:function(e){return this.$generateShareContent({title:"限时秒杀",queries:{type:"SPIKE"}})},onLoad:function(e){var r=this;r.brandId=parseInt(e.spike_brand_id),this.pvTracking(),(0,s.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.getSpikeBanner(r);case 3:r.getSpikeGoodsDate(r),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}},e,this,[[0,6]])})),this.brandSpikeOff=o.Message.on(o.KEYS.WAIT_FOR_SPIKE_SHOW,function(e){var a,i=r.checkGoodsData(e,"goodsId");if(i){var n=i.goodsIndex;r.setData((a={},t(a,"timeInfo.timesObj.goodsList["+n+"].buttonClass","ts-remind-btn"),t(a,"timeInfo.timesObj.goodsList["+n+"].buttonType","remind"),a))}})},onShow:function(){this.isOnHideStatus=!1,this.data.isFirstEnter&&this.setData({isFirstEnter:!1}),i.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},onPageScroll:function(e){if(e){var t=parseInt(e.scrollTop);u.default.showGoTopBtn(t,this)}},onReachBottom:function(){this.data.canLoadMore&&this.getSpikeGoodsDate(this)},reLoad:function(){var e=this;this.setData({showError:!1,loadingVisible:!0}),(0,s.default)(d.default.mark(function t(){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getSpikeBanner(e);case 3:e.getSpikeGoodsDate(e),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},onReady:function(){wx.setNavigationBarTitle({title:"限时抢购"})},getSpikeBanner:s.default.wrap(d.default.mark(function e(t){var i,o,s;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=r.DataUtil.formatByPos(a.default.getBrandSpikeInfo,t.brandId),o=r.Request.requestDataWithUrl("GET",i,null,!0),e.next=5,r.Request.runMainRequestForPage(o,t);case 5:if(s=e.sent,isNaN(s.error_code)&&!s.error_msg){e.next=9;break}return t.setData({loadingVisible:!1,showError:!0}),e.abrupt("return");case 9:s.result.timesObj=n.default.formatTimeData([s.result.start_time],null,s.result.end_time)[0],s.result.timesObj.goodsList=[],t.globalSecond=s.result.timesObj.timerNumObj.intSeconds,clearInterval(t.updateSecondTimer),t.updateSecondTimer=null,t.setData({timeInfo:s.result}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),t.setData({loadingVisible:!1,showError:!0}),console.error(e.t0);case 21:case"end":return e.stop()}},e,this,[[0,17]])})),getSpikeGoodsDate:s.default.wrap(d.default.mark(function e(t){var i,n,o,s,u,c,l;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.page||1,n=30,o=[i,n].join("#"),e.prev=3,!t.loadingLock[o]){e.next=6;break}return e.abrupt("return");case 6:return t.loadingLock[o]=!0,s=r.DataUtil.formatByPos(a.default.getBrandSpikeGoods,t.brandId,i,n),u=r.Request.requestDataWithUrl("GET",s,null,!0),e.next=11,r.Request.runMainRequestForPage(u,t);case 11:if(c=e.sent,t.loadingLock[o]=!1,isNaN(c.error_code)&&!c.error_msg){e.next=16;break}return t.setData({showError:!0,loadingVisible:!1}),e.abrupt("return");case 16:l=t.formatSpikeData(c||{}),t.processSpikeGoodsData({tabData:l,lockKey:o}),t.setData({loadingVisible:!1}),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(3),t.setData({loadingVisible:!1,showError:!0}),t.loadingLock[o]=!1,console.error(e.t0);case 26:case"end":return e.stop()}},e,this,[[3,21]])})),formatSpikeData:function(e){var t=e.result||[],r=this;if(t.length<=0)return{};var a=this.data.timeInfo.timesObj;return t.forEach(function(e){var t=n.default.formatGoodsData(e,[a]);switch(!0){case t.isFarFuture:case t.isForbidden:break;case t.isSalesOut:!Array.isArray(a.salesOut)&&(a.salesOut=[]),a.salesOut.push(t);break;default:!Array.isArray(a.goodsList)&&(a.goodsList=[]),a.goodsList.push(t)}}),a.goodsList.length<=0?void 0:(["salesOut","goodsList"].forEach(function(e){if(a[e]&&Array.isArray(a[e])&&!(a[e].length<=0)){var t=a[e][a[e].length-1],i=r.goodsLastOneIndex[e];i&&(a[e][i].isListLastOne=!1),t&&(t.isListLastOne=!0,r.goodsLastOneIndex[e]=a[e].length-1)}}),a)},processSpikeGoodsData:function(e){var r=e.tabData,a=e.lockKey,i=this;if(this.loadingLock[a]=!1,!r||Object.keys(r).length<1)this.setData({canLoadMore:!1});else{this.page++,null===this.updateSecondTimer&&(this.updateSecondTimer=setInterval(function(){if(i.globalSecond--,i.globalSecond<0)return i.globalSecond=59,void i.updateMinutesHours(i.globalSecond);var e=i.globalSecond;e<10&&(e="0"+e),i.isOnHideStatus||i.setData({globalSecond:e})},1e3));var n=this.globalSecond;n<10&&(n="0"+n),this.setData(t({globalSecond:n},"timeInfo.timesObj",r))}},updateMinutesHours:function(e){var r,a=this,i=a.data.timeInfo.timesObj;if(i.timerNumObj.intMinutes--,i.timerNumObj.intSeconds--,i.timerNumObj.intMinutes<0){i.timerNumObj.intMinutes=59,i.timerNumObj.intHours--;var n=i.timerNumObj.intHours;if(n<0)return a.data.timeInfo={},a.page=1,a.data.canLoadMore=!0,void a.getSpikeBanner(a);n<10&&(n="0"+n),i.timerNumObj.intHours=n}var o=i.timerNumObj.intMinutes;o<10&&(o="0"+o),i.timerNumObj.minutes=o,this.setData((r={},t(r,"timeInfo.timesObj.timerNumObj",i.timerNumObj),t(r,"globalSecond",e),r))},itemClickTracking:function(e,t,a){(0,r.TrackingRecord)({op:"click",spike_brand_id:this.brandId,page_element:e,page_section:"goods_list",goods_id:t,idx:a})},forwardGoods:function(e,t){var a=e.currentTarget.dataset.goodsId,n=(e.currentTarget.dataset.quantity,e.currentTarget.dataset.currentCanBuy,e.currentTarget.dataset.current,e.currentTarget.dataset.goodsIndex);this.transGoodsData=e.currentTarget.dataset.transData;i.default.referPageName;a&&r.Navigation.forward("/pages/goods/goods?goods_id="+a),"btn"==t?this.itemClickTracking("going_btn",a,n):this.itemClickTracking("goods",a,n)},goodsItemClicked:function(e){this.forwardGoods(e,"item")},onHide:function(){this.isOnHideStatus=!0},onUnload:function(){clearInterval(this.updateSecondTimer),this.brandSpikeOff()},pvTracking:function(){(0,r.TrackingRecord)({op:"pv",spike_brand_id:this.brandId}),this.$firstTimeTrackRecord.pv=!0},checkGoodsData:function(e,t){var r=void 0,a=this.data.timeInfo.timesObj;if(!(a.isPast||a.goodsList.length<=0))return(a.goodsList||[]).every(function(a,i){return e!==a[t]||(a.goodsIndex=i,r=a,!1)}),r},goodsRemindSetup:function(e){var r,a=this,i=e.currentTarget&&e.currentTarget.dataset||{},n=i.onlyKey,o=i.goodsId,s=i.goodsIndex,d=this.checkGoodsData(n,"onlyKey"),u=(r={},t(r,"timeInfo.timesObj.goodsList["+s+"].buttonClass","ts-remind-btn"),t(r,"timeInfo.timesObj.goodsList["+s+"].buttonType","remind"),r);c.default.goodsRemindSetup(e,d,a,u,a.itemClickTracking("remind_me_btn",o,s))},formClick:function(){}};(0,r.PddPage)(l,{pageName:"brand_spike",notUseCommonPV:!0}); 
 			}); 	require("pages/brand_spike/brand_spike.js");
 		__wxRoute = 'pages/help_pay/help_pay';__wxRouteBegin = true; 	define("pages/help_pay/help_pay.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=e(require("../../common/url_util")),r=(e(require("../../common/util")),e(require("../../common/image_util")),e(require("../../common/std_format"))),a=e(require("../../components/toast/toast.js")),s=(e(require("../../constants/groups")),require("../../common/index")),o=e(require("../../configs/api")),i=e(require("../../common/request")),n=(e(require("../../common/page_util")),e(require("../../constants/order")),e(require("../../controller/formid_controller")),e(require("../../models/format/grid_item_goods"))),d=e(require("../../storage/user_storage")),u=e(require("../../storage/ram_manager")),c=e(require("../../libs/co/we-index")),l=e(require("../../libs/regenerator-runtime/runtime")),p=e(require("../../common/payment")),g=e(require("../../constants/payment")),h=e(require("../../common/gotop_util")),f=(require("../../common/message"),{isOrderOwner:{waitePay:{statusDesc:"我在拼多多上找到了很赞的商品，快来帮我付款吧~",btnText:"",bottomDesc:"如果订单发生退款，已支付金额将原路退还好友"},payed:{statusDesc:"我在拼多多上找到了很赞的商品，快来帮我付款吧~",btnText:""},canceled:{statusDesc:"我在拼多多上找到了很赞的商品，快来帮我付款吧~",btnText:""}},isNotOrderOwner:{waitePay:{statusDesc:"我在拼多多上找到了很赞的商品，快来帮我付款吧~",btnText:"立即支付"},payed:{statusDesc:"订单已经支付了，去试试0.01元抢好货吧~",btnText:"￥0.01  抢好货",bottomDesc:"记得提醒好友，成团后才会发货哦~"},canceled:{statusDesc:"来晚啦，订单已经取消，先去试试0.01元抢好货吧~",btnText:"￥0.01  抢好货"}}});(0,s.PddPage)({urlParams:{},requestingSubjectLock:!1,subjectReqData:{subjectId:"3198",sortTypeName:"PRIORITY",page:1,size:30},isFirstLoad:!0,allGoodsListCache:[],data:{showMidLoading:!0,isLoadingMore:!1,list:[],size:20,page:1,hidePage:!0,showSendEnvelope:!1,showRuleModal:!1,showShareModal:!1,showInvite:!1,showConfirmModal:!1,goodsList:[],canGoodsLoadMore:!0,statusSeal:null,showOrderInfo:!1},onShareAppMessage:function(e){var t=this.data.orderInfo||{},r={order_sn:this.orderSn,uid:this.data.orderInfo.uid,goods_id:t.goodsId,event_type:t.eventType,group_order_id:t.groupOrderId},a=this,o="top_forward";e&&"menu"!=e.from&&(o="share_btn");var i={title:"考验我们感情的时候到了，帮我付个款吧~",referStr:o,queries:r,successCallback:function(){a.$showToast("转发成功，可继续发送给其他好友")}};t.isOrderOwner||1!=t.groupStatus||(i.path="pages/order/order?friend_pay=true&group_status="+t.groupStatus+"&ordersn="+t.orderSn,i.title="团已满，赶紧重开新团，我来买单！");var n=e.target&&e.target.dataset||{},d=this.getTrackingParams("click","main",n.from);return(0,s.TrackingRecord)(d),this.$generateShareContent(i)},onLoad:function(e){var r=this,a={};e&&(a=t.default.parseQuery(e)),r.orderSn=a.order_sn,this.pvTracking(),r.loadPage()},loadPage:function(){this.getOrderInfo(),this.fillListData()},onShow:function(){var e=this;e.isFirstLoad||e.getOrderInfo(),u.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking()},getOrderInfo:function(){var e=this;(0,c.default)(l.default.mark(function t(){var r;return l.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getOrderInfoData(e);case 3:r=t.sent,e.processOrderInfo(r),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}},t,this,[[0,7]])}))},expire:function(){var e=this;if(e.expireTime>=0){var t=s.TimeUtil.transferToTime(1e3*e.expireTime).split(":");e.setData({expireTimeList:t}),0==e.expireTime&&(clearInterval(e.countExpire),e.getOrderInfo())}else clearInterval(e.countExpire)},onHide:function(){this.countExpire&&clearInterval(this.countExpire)},onUnload:function(){this.countExpire&&clearInterval(this.countExpire)},processOrderInfo:function(e){var t={goodsId:e.goods_id,eventType:e.event_type,avatar:e.avatar,gender:e.gender,goodsName:e.goods_name,groupStatus:e.group_status,nickname:e.nickname,orderAmount:r.default.price(e.order_amount,100),orderSn:e.order_sn,serverTime:e.server_time,status:e.status,thumbUrl:e.thumb_url,uid:e.uid,groupOrderId:e.group_order_id,orderTime:e.order_time};if(0==t.status&&0==t.groupStatus&&(this.expireTime=t.orderTime+86400-t.serverTime,this.expireTime>0)){this.expire();var a=this;a.countExpire&&(clearInterval(a.countExpire),a.countExpire=null),a.countExpire=setInterval(function(){a.expireTime--,a.expire()},1e3)}if(this.userId||(this.userId=d.default.getUserId()),this.userId==t.uid)t.isOrderOwner=!0;else{t.isOrderOwner=!1;var s=d.default.getUserLocalInfo();s&&s.nickName&&(this.friendName=s.nickName)}var o=void 0,i="",n="",u="",c="",l="",p=!1;if(t.isOrderOwner){var g=f.isOrderOwner;0==t.status?(i=g.waitePay.statusDesc,u=g.waitePay.bottomDesc,1==t.groupStatus&&(o="seal_full",c="price_cancel",u="该团已满，无法支付，请重新开团购买商品",n="重新开团")):t.status>=1&&t.status<=6?(o="seal_success",i=g.payed.statusDesc,l="好友已帮您代付成功！成团后才会发货哦~",n="查看拼团详情",u=g.waitePay.bottomDesc):7==t.status&&(o="seal_cancel",i=g.canceled.statusDesc,c="price_cancel",p=!0,l="您已取消订单，或者超时未支付")}else{var h=f.isNotOrderOwner,m=this.friendName?this.friendName+"，":"";0==t.status?(i=m+h.waitePay.statusDesc,n=h.waitePay.btnText,u="showPayBottomDesc",1==t.groupStatus&&(i=m+"我正在拼多多拼这个商品，帮我付款吧~如果团满了，记得通知我重新开团哦",o="seal_full",n=h.payed.btnText,u=null,c="price_cancel",p=!0,l="该团已满，无法支付，请通知好友重新开团")):t.status>=1&&t.status<=6?(o="seal_success",i=m+h.payed.statusDesc,n=h.payed.btnText,u=h.payed.bottomDesc):7==t.status&&(o="seal_cancel",i=m+h.canceled.statusDesc,n=h.canceled.btnText,c="price_cancel",p=!0,l="好友已取消订单，或者超时未支付")}t.statusDesc=i,t.btnText=n,t.bottomDesc=u,t.priceColor=c,t.middleDesc=l,this.setData({orderInfo:t,showOrderInfo:!0,statusSeal:o,showMidLoading:!1,showRecGoodsList:p,expireTimeList:this.expireTimeList}),this.userHandleLock=!1,this.isFirstLoad=!1},btnClick:function(e){var t=this.data.orderInfo,r=void 0,a={};if(0==t.status)if(0==t.groupStatus){var o=this;a.market=!0,s.User.requireLogin(function(){o.doPay()},function(){}),r=this.getTrackingParams("click","main","pay_btn")}else 1==t.groupStatus&&(this.$forward("order",{ordersn:t.orderSn,friend_pay:!0,group_status:t.groupStatus}),a.market=!1,r=this.getTrackingParams("click","main","open_btn"));else t.isOrderOwner&&(t.status>=1||t.status<=6)?(this.$forward("group",{group_order_id:t.groupOrderId}),a.market=!0,r=this.getTrackingParams("click","main","group_detail")):(this.$forward("subject",{subject_id:"2742"}),a.market=!0,r=this.getTrackingParams("click","main","going_draw"));(0,s.TrackingRecord)(r),this.$uploadFormId(e,a.market)},btnClickSubmit:function(e){if(!this.$toast){var t=this;t.$toast=new a.default({setDataFunc:function(e){t.setData({$toastData:e})}})}this.$toast.hide();var r={},s=this.data.orderInfo;s.isOrderOwner&&0==s.status&&0==s.groupStatus?r.market=!1:s.isOrderOwner||0!=s.status||1!=s.groupStatus||(r.market=!0),this.$uploadFormId(e,r.market)},doPay:function(){var e=this;e.userHandleLock||(e.userHandleLock=!0,p.default.pay(e.orderSn,function(){var t=o.default.orderPayCheck+"?order_sn="+e.orderSn;i.default.apiRequest("GET",t),e.getOrderInfo();var r={sub_op:"pay_order",friend_pay:!0},a=e.getTrackingParams("event",null,null,r);delete a.pay_status,(0,s.TrackingRecord)(a)},function(t){e.getOrderInfo()},function(t){g.default.isCancelPay(t.errMsg)&&e.getOrderInfo(),e.userHandleLock=!1}))},getOrderInfoData:c.default.wrap(l.default.mark(function e(t){var r,a,n;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=s.DataUtil.formatByPos(o.default.getFriendPayOrderInfo,t.orderSn),a=i.default.requestDataWithUrl("GET",r,null,!1),e.next=5,i.default.runMainRequestForPage(a,this);case 5:return n=e.sent,e.abrupt("return",n);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.t0.error_code&&(t.$showToast(errorMsg[e.t0.error_code]),t.setData({showMidLoading:!1}));case 13:case"end":return e.stop()}},e,this,[[0,9]])})),getSubjectGoodsData:c.default.wrap(l.default.mark(function e(t){var r,a,d,u,c,p,g,h,f,m;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.requestingSubjectLock&&t.data.canGoodsLoadMore){e.next=3;break}return e.abrupt("return");case 3:return t.requestingSubjectLock=!0,r=t.subjectReqData,a=r.subjectId,d=r.sortTypeName,u=r.page,c=r.size,p=s.DataUtil.formatByPos(o.default.subjectCollectionGoodsApi,a,d,u,c),e.next=12,i.default.apiRequest("GET",p,{},!0);case 12:g=e.sent,h=g.goods_list||[],f=h.length<=0,m=h.map(function(e){return n.default.formatData(e)}),t.processSubjectsGoods({goodsList:m,isLoadAll:f,page:u}),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0);case 22:case"end":return e.stop()}},e,this,[[0,19]])})),processSubjectsGoods:function(e){this.requestingSubjectLock=!1,this.allGoodsListCache=Array.isArray(this.allGoodsListCache)?this.allGoodsListCache:[],this.allGoodsListCache=Array.isArray(e.goodsList)?this.allGoodsListCache.concat(e.goodsList):this.allGoodsListCache,this.allGoodsListCache=s.DataUtil.objectArrayDuplicateRemove(this.allGoodsListCache,"goodsId",function(e){return 1==e.isApp})||[],this.fillListData(1===e.page),this.subjectReqData.page++,this.setData({loadMoreVisible:!0,canGoodsLoadMore:!e.isLoadAll})},onReachBottom:function(e){!1!==this.data.canGoodsLoadMore&&this.fillListData()},fillListData:function(e){var t=this.allGoodsListCache||[],r=this.data.goodsList||[];e&&(r=[]);var a=r.length;t.length>a?this.renderListDataFn(a,r,t):this.getSubjectGoodsData(this)},renderListDataFn:function(e,t,r){var a=t.length+(0===e?6:20);t=r.slice(0,a),this.setData({goodsList:t})},gotoGoodsDetail:function(e){var t=e.currentTarget.dataset,r=t.index,a=t.eventType,o=t.goodsId;this.$forward("goods",{goods_id:o,xcx_campaign_id_02:"d11_red_group"});var i={rec_goods_id:o,rec_event_type:a,idx:r},n=this.getTrackingParams("click","rec_goods_list","rec_goods",i);(0,s.TrackingRecord)(n)},onPageScroll:function(e){if(e){var t=parseInt(e.scrollTop);h.default.showGoTopBtn(t,this)}},getTrackingParams:function(e,t,r,a){var o=this.data.orderInfo||{},i={op:e,page_section:t,page_element:r,goods_id:o.goodsId,event_type:o.eventType,order_sn:this.orderSn,group_order_id:o.groupOrderId,group_status:o.groupStatus,order_amount:100*o.orderAmount,pay_status:o.status};return a&&(i=s.ObjectUtil.assign(i,a)),i},pvTracking:function(){(0,s.TrackingRecord)({op:"pv",order_sn:this.$urlQueryObj.order_sn,group_order_id:this.$urlQueryObj.group_order_id}),this.$firstTimeTrackRecord.pv=!0}},{pageName:"help_pay",notUseCommonPV:!0}); 
 			}); 	require("pages/help_pay/help_pay.js");
 		__wxRoute = 'pages/relative_recommend/relative_recommend';__wxRouteBegin = true; 	define("pages/relative_recommend/relative_recommend.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var a=t(require("../../common/request")),s=(t(require("../../common/std_format")),t(require("../../common/object_util"))),i=t(require("../../common/system_info")),r=(t(require("../../controller/group")),t(require("../../models/format/grid_item_goods"))),o=t(require("../../configs/api")),n=(t(require("../../libs/es6-promise.min")),t(require("../../libs/co/we-index"))),u=t(require("../../libs/regenerator-runtime/runtime")),d=t(require("../../common/gotop_util")),c=t(require("../../components/segment/segment.js")),l=t(require("../../storage/ram_manager")),p=require("../../common/index"),b={cacheDataList:{},allGoodsListCache:[],renderListDataRepo:[],subjectData:{size:30,page:1,subjectId:"2742"},listReqLock:{},page:1,data:{pageName:"relative_recommend",lotteryGoodsList:[],showError:!1,isLoadAll:!1,canLoadMore:!0,loadingVisible:!0,$tabsData:[],topTab:[{showError:!1,size:20,offset:0,scrollTop:0,presetItem:!0}],curTabIndex:0},getTrackingCommonParams:function(){var t={};return this.$urlQueryObj.subjects_id?t.subjects_id=this.$urlQueryObj.subjects_id:this.$urlQueryObj.subject_id?t.subject_id=this.$urlQueryObj.subject_id:this.$urlQueryObj.opt_id&&(t.opt_id=this.$urlQueryObj.opt_id),t},pvTracking:function(t){var e={op:"pv",page_url:t};e=s.default.assign(e,this.getTrackingCommonParams()),(0,p.TrackingRecord)(e)},onLoad:function(t){var e="/pages/relative_recommend/relative_recommend?"+p.UrlUtil.buildQuery(this.$urlQueryObj);this.pvTracking(e);var a=this;if(a.is_show_lottery=a.$urlQueryObj.is_show_lottery,1==a.is_show_lottery&&this.getLotterySubjectGoods(this),a.$urlQueryObj.subject_id){this.subjectId=a.$urlQueryObj.subject_id,this.setData({loadingVisible:!0}),1!=a.is_show_lottery&&this.requestHeadIcon(this.subjectId,this);var r=p.DataUtil.formatByPos(o.default.subjectGoodsApi,this.subjectId,this.page,20);1==a.$urlQueryObj.is_push&&(r+="&is_push=1"),this.requestList(r,null,this),this.winWidth=i.default.getWindowWidthSync(),this.winHeight=i.default.getWindowHeightSync()}if(a.$urlQueryObj.subjects_id||a.$urlQueryObj.opt_id){this.subjectsId=a.$urlQueryObj.subjects_id||a.$urlQueryObj.opt_id;var n={tabsData:this.data.$tabsData,alignType:"align-gap"};this.segmentControl=new c.default(n,this),this.lastTabIndex=parseInt(this.$urlQueryObj.tab_index||0,10),this.lastTabIndex=this.lastTabIndex>0?this.lastTabIndex:0,this.setDataObject={scrollViewWidth:i.default.getWindowWidthSync(),subjectsId:this.subjectsId,curTabIndex:this.lastTabIndex},this.data=s.default.assign(this.data,this.setDataObject),this.loadCatgoods=!!a.$urlQueryObj.opt_id,this.initPage()}},initPage:function(){var t=this,e=p.DataUtil.formatByPos(o.default.promotionCollection,this.subjectsId);this.loadCatgoods&&(e=p.DataUtil.formatByPos(o.default.catgoods,this.subjectsId)+"?"+p.UrlUtil.buildQuery({opt_type:1,offset:0,size:100,sort_type:"DEFAULT"})),(0,n.default)(u.default.mark(function a(){var s,i,r,n,d,c,l,b,h,f;return u.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.requestTopTabsDetail(e,t);case 2:if(s=t.lastTabIndex,t.loadCatgoods){a.next=14;break}return i=t.data.topTab[s],r=i.size||20,n=i.page||1,d=p.DataUtil.formatByPos(o.default.subjectCollectionGoodsApi,i.subjectId,"PRIORITY",n,r),1==t.$urlQueryObj.is_push&&(d+="&is_push=1"),a.next=11,t.requestList(d,s,t);case 11:for(c=1;c<=4;c++)t.reqCatlistData(s+c);a.next=18;break;case 14:s>0&&(l=t.data.topTab[s],b=p.DataUtil.formatByPos(o.default.catgoods,l.subjectId)+"?"+p.UrlUtil.buildQuery({opt_type:l.optType,offset:l.offset,size:l.size,sort_type:"DEFAULT"}),t.requestList(b,s,t)),h=t.data.topTab[s+1],f=p.DataUtil.formatByPos(o.default.catgoods,h.subjectId)+"?"+p.UrlUtil.buildQuery({opt_type:h.optType,offset:h.offset,size:h.size,sort_type:"DEFAULT"}),t.requestList(f,s+1,t);case 18:case"end":return a.stop()}},a,this)}))},requestTopTabsDetail:n.default.wrap(u.default.mark(function t(e,s){var i,o,n,d,c;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=a.default.requestDataWithUrl("GET",e,null,!0),t.next=4,a.default.runMainRequestForPage(i,s);case 4:return(o=t.sent).opt_infos&&s.lastTabIndex>o.opt_infos.length&&(s.lastTabIndex=0),o.list&&s.lastTabIndex>=o.list.length&&(s.lastTabIndex=0),s.formatTopTabsData(o),o.name&&wx.setNavigationBarTitle({title:o.name}),o.opt_infos&&o.opt_infos.length>0&&(n=o.goods_list||[],d=n.length<100,c=n.map(function(t){return r.default.formatData(t)}),s.processSubjectGoods({tabIndex:0,goodsList:c,isLoadAll:d,offset:0,lockKey:e})),t.abrupt("return",o);case 13:t.prev=13,t.t0=t.catch(0),console.error(t.t0),s.requestTagGoodsError({tabIndex:0,page:1,offset:0});case 17:case"end":return t.stop()}},t,this,[[0,13]])})),formatTopTabsData:function(t){if(t.list||t.opt_infos){var e=this,a=[];t.opt_infos&&t.opt_infos.length>0&&t.opt_infos.unshift({id:this.subjectsId,opt_name:"全部"});var i=t.list||t.opt_infos;i.forEach(function(s,i){var r={showError:!1,label:s.subject||s.opt_name,subjectId:s.subject_id||s.id,canLoadMore:!0,loadMoreVisible:!1,loadingVisible:!1,scrollTop:0};t.opt_infos?(r.offset=0,r.size=100,r.optType=0===i?1:2):(r.page=1,r.size=20),a.push(r),e.renderListDataRepo.push([])});var r=i.map(function(t){return{title:t.subject||t.opt_name}});this.segmentControl.refreshTabsData(r),this.segmentControl.updateSelectIndex(this.lastTabIndex),this.setDataObject=s.default.assign(this.setDataObject,{topTab:a}),this.setDataObject=s.default.assign(this.setDataObject,this.segmentControl.$data()),this.setData(this.setDataObject)}},requestHeadIcon:n.default.wrap(u.default.mark(function t(e,s){var i,r,n,d,c,l,b;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=p.DataUtil.formatByPos(o.default.subjectRollMessage,e),r=a.default.requestDataWithUrl("GET",i,null,!0),t.next=5,a.default.runMainRequestForPage(r,s);case 5:n=t.sent,d=parseInt(n.banner_width_2),c=parseInt(n.banner_height_2),l=c/d,b=Math.floor(l*s.winWidth),!isNaN(b)&&isFinite(b)||(b=140),wx.setNavigationBarTitle({title:n.subject||"拼多多"}),s.setData({banner:n.banner_2,bannerHidden:!n.banner_2||0==n.banner_2.length,subject:n.subject,desc:n.desc,bannerHeight:b+"px"}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0),s.setData({banner:"",showError:!0,loadingVisible:!1});case 16:case"end":return t.stop()}},t,this,[[0,12]])})),requestList:n.default.wrap(u.default.mark(function t(s,i,o){var n,d,c,l,p,b,h,f,g,_,j;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o.setDataObject={},n=20,d=o.page,c=-1,l=s,p=o.data.canLoadMore,null!=i&&(b=o.data.topTab[i],n=b.size,d=b.page,c=b.offset,p=b.canLoadMore),t.prev=7,!o.listReqLock[l]){t.next=10;break}return t.abrupt("return");case 10:if(p){t.next=13;break}return null!=i&&o.setData(e({},"topTab["+i+"].canRenderMore",!1)),t.abrupt("return");case 13:return o.listReqLock[l]=!0,null==i||0!==c&&1!==d||(o.setDataObject["topTab["+i+"].loadingVisible"]=!0),h=a.default.requestDataWithUrl("GET",s,null,!0),t.next=18,a.default.runMainRequestForPage(h,o);case 18:if(!(f=t.sent).errorCode){t.next=23;break}return o.$showToast(f.errorMsg),o.requestTagGoodsError({tabIndex:i,page:d,offset:c,lockKey:l}),t.abrupt("return");case 23:return g=f.goods_list||[],_=g.length<n,j=g.map(function(t){return r.default.formatData(t)}),o.processSubjectGoods({tabIndex:i,goodsList:j,isLoadAll:_,page:d,offset:c,lockKey:l}),t.abrupt("return",f);case 28:t.prev=28,t.t0=t.catch(7),o.requestTagGoodsError({tabIndex:i,page:d,offset:c,lockKey:l});case 31:case"end":return t.stop()}},t,this,[[7,28]])})),processSubjectGoods:function(t){var a=t.tabIndex,i=t.offset,r=t.page;if(this.listReqLock[t.lockKey]=!1,null!=a){this.data.topTab[a];var o,n=Array.isArray(this.allGoodsListCache[a])?this.allGoodsListCache[a]:[];this.allGoodsListCache[a]=n.concat(t.goodsList);var u=this.allGoodsListCache[a];u=p.DataUtil.objectArrayDuplicateRemove(u,"goodsId",function(t){return 1==t.isApp}),this.cacheDataList[a]=u,this.setData(e({},"topTab["+a+"].canLoadMore",!t.isLoadAll)),this.setDataObject=s.default.assign(this.setDataObject,(o={},e(o,"topTab["+a+"].showError",!1),e(o,"topTab["+a+"].page",void 0!=r?r+1:r),e(o,"topTab["+a+"].offset",void 0!=i?i+100:i),e(o,"topTab["+a+"].loadMoreVisible",!0),e(o,"topTab["+a+"].canLoadMore",!t.isLoadAll),e(o,"topTab["+a+"].loadingVisible",!1),o)),this.fillListData(a,1===r||0===i)}else{var d=(Array.isArray(this.data.contentList)?this.data.contentList:[]).concat(t.goodsList);d=p.DataUtil.objectArrayDuplicateRemove(d,"goodsId",function(t){return 1==t.isApp}),this.page+=1,this.initImprParams(),this.setData({contentList:d,loadingVisible:!1})}},initImprParams:function(){},fillListData:function(t,a){var i=this,r=this.cacheDataList[t]||[],n=this.data.topTab[t],u=[];this.renderListDataRepo&&(u=this.renderListDataRepo[t]||[]),a&&(u=[]);var d=u.length;if(!(r.length<=0))if(this.initImprParams(),r.length>d){var c=u.length+(0===d?8:20);u=r.slice(0,c),t===this.data.curTabIndex?(this.setDataObject.contentList=u,this.setDataObject=s.default.assign(this.setDataObject,e({},"topTab["+t+"].canRenderMore",!0)),this.setData(this.setDataObject)):this.setData(this.setDataObject),this.renderListDataRepo[t]=u}else{var l=n.size||20,b=n.page||1,h=p.DataUtil.formatByPos(o.default.subjectCollectionGoodsApi,n.subjectId,"PRIORITY",b,l);1==i.$urlQueryObj.is_push&&(h+="&is_push=1"),void 0!=n.offset&&(h=p.DataUtil.formatByPos(o.default.catgoods,n.subjectId)+"?"+p.UrlUtil.buildQuery({opt_type:n.optType,offset:n.offset,size:n.size,sort_type:"DEFAULT"})),i.requestList(h,t,i)}},imprItems:function(t){var e=this.data.contentList;t.forEach(function(t){if(t<e.length){var a=e[t]||{},s={op:"impr",page_section:"goods_list",page_element:"goods",idx:t,goods_id:a.goodsId,event_type:a.eventType};a.transData&&(a.transData.ad&&(s.ad=JSON.stringify(a.transData.ad)),a.transData.p_rec&&(s.p_rec=JSON.stringify(a.transData.p_rec)),a.transData.p_search&&(s.p_search=JSON.stringify(a.transData.p_search))),(0,p.TrackingRecord)(s)}})},didClickSegmentTab:function(t){var e=parseInt(t.currentTarget.dataset.index,10);if(e!==this.data.curTabIndex){var a=this.data.curTabIndex,s=this.data.topTab[a],i={op:"click"};this.$urlQueryObj.opt_id?(i.page_section="opt_list",i.page_element="opt",i.opt_id=s.subjectId,i.tab_opt_id=this.data.topTab[e].subjectId):(i.page_section="subject_list",i.page_element="subject",i.subjects_id=this.$urlQueryObj.subjects_id,i.subject_id=s.subjectId,i.tab_subject_id=this.data.topTab[e].subjectId),this.setDataObject={},this.segmentControl.updateSelectIndex(e),this.changeTabIndex(e),(0,p.TrackingRecord)(i)}},changeTabIndex:function(t){var a=this;if(t=parseInt(t,10),!isNaN(t)){this.data.topTab;this.data.curTabIndex=t,this.setDataObject.curTabIndex=t,this.setDataObject=s.default.assign(this.setDataObject,this.segmentControl.$data()),this.setData(this.setDataObject),a.setData(e({contentList:[]},"topTab["+t+"].loadMoreVisible",!1)),(0,n.default)(u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.reqCatlistData(t);case 2:a.reqCatlistData(t-1),a.reqCatlistData(t+1);case 4:case"end":return e.stop()}},e,this)}))}},reqCatlistData:n.default.wrap(u.default.mark(function t(a){var s,i,r,n,c,l;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s=this,i=this.data.topTab,!(a<0||a>=i.length)){t.next=4;break}return t.abrupt("return");case 4:1===(r=i[a]||{}).page||0===r.offset?(n=r.size||20,c=r.page||1,l=p.DataUtil.formatByPos(o.default.subjectCollectionGoodsApi,r.subjectId,"PRIORITY",c,n),1==s.$urlQueryObj.is_push&&(l+="&is_push=1"),void 0!=r.offset&&(l=p.DataUtil.formatByPos(o.default.catgoods,r.subjectId)+"?"+p.UrlUtil.buildQuery({opt_type:r.optType,offset:r.offset,size:r.size,sort_type:"DEFAULT"})),s.requestList(l,a,s)):a===this.data.curTabIndex&&(this.renderListDataRepo[a]=this.renderListDataRepo[a].slice(0,8),setTimeout(function(){s.setData(e({contentList:s.renderListDataRepo[a]},"topTab["+a+"].loadMoreVisible",!0)),setTimeout(function(){d.default.goTop(!0)},100)},100));case 6:case"end":return t.stop()}},t,this)})),requestTagGoodsError:function(t){if(this.$showToast("网络出错"),t.lockKey&&(this.listReqLock[t.lockKey]=!1),null==t.tabIndex||1!==t.page&&0!==t.offset){if(t.error_msg){var a;this.setData((a={},e(a,"topTab[0].showError",!0),e(a,"topTab[0].loadingVisible[0]",!1),a))}}else{var s;this.setData((s={},e(s,"topTab["+t.tabIndex+"].showError",!0),e(s,"topTab["+t.tabIndex+"].loadingVisible",!1),s))}},reLoad:function(){var t=this;if(1==t.is_show_lottery&&0==t.data.lotteryGoodsList.length&&this.getLotterySubjectGoods(this),t.subjectId){t.setData({showError:!1,loadingVisible:!0}),1!=t.is_show_lottery&&t.requestHeadIcon(t.subjectId,t);var a=p.DataUtil.formatByPos(o.default.subjectGoodsApi,t.subjectId,t.page,20);1==t.$urlQueryObj.is_push&&(a+="&is_push=1"),this.requestList(a,null,t)}if(t.subjectsId){var i,r=t.data.curTabIndex||0;t.data.topTab[r];t.setDataObject={},t.setDataObject=s.default.assign(t.setDataObject,(i={},e(i,"topTab["+r+"].showError",!1),e(i,"topTab["+r+"].loadingVisible",!0),i)),t.data.topTab[0].presetItem?t.initPage():t.changeTabIndex(r)}},onPageScroll:function(t){if(t){var e=parseInt(t.scrollTop);d.default.showGoTopBtn(e,this)}},onReachBottom:function(){if(this.subjectId){var t=p.DataUtil.formatByPos(o.default.subjectGoodsApi,this.subjectId,this.page,20);1==this.$urlQueryObj.is_push&&(t+="&is_push=1"),this.requestList(t,null,this)}if(this.subjectsId){var e=this.data.curTabIndex;this.setDataObject={},this.fillListData(e)}},getLotterySubjectGoods:n.default.wrap(u.default.mark(function t(e){var s,i,n,d,c,l,b,h,f,g;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=e.subjectData,i=s.page,n=s.size,d=s.subjectId,c=p.DataUtil.formatByPos(o.default.subjectGoodsApi,d,i,n),l=a.default.requestDataWithUrl("GET",c,null,!0),b=this,t.next=5,a.default.runMainRequestForPage(l,b);case 5:h=t.sent,f=h.goods_list||[],g=[],f.forEach(function(t){g.push(r.default.formatData(t))}),e.setData({lotteryGoodsList:g}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),e.setData({showError:!0,loadingVisible:!1}),console.error(t.t0);case 16:case"end":return t.stop()}},t,this,[[0,12]])})),gotoGoodsDetail:function(t){var e=t.currentTarget.dataset,a=e.goodsId;this.$forward("goods",{goods_id:a});var s=void 0,i=void 0,r={op:"click",page_element:"goods"};"timeLimit"===e.refer?(s=e.itemIndex,i=this.data.lotteryGoodsList[s]||{},r.page_section="spike_list"):(s=e.index,i=this.data.contentList[s]||{},r.page_section="goods_list");this.getTrackingCommonParams();r.goods_id=a,r.idx=s,r.event_type=i.eventType;var o=this.data.curTabIndex,n=this.data.topTab[o]||{};this.$urlQueryObj.opt_id?(r.opt_id=n.subjectId,r.opt_type=n.optType,r.opt_2_id=this.$urlQueryObj.opt_id):this.$urlQueryObj.subject_id?r.subject_id=this.$urlQueryObj.subject_id:(r.subjects_id=this.$urlQueryObj.subjects_id,r.subject_id=n.subjectId);var u=i.transData;u&&(u.ad&&(r.ad=JSON.stringify(u.ad)),u.p_rec&&(r.p_rec=JSON.stringify(u.p_rec)),u.p_search&&(r.p_search=JSON.stringify(u.p_search))),(0,p.TrackingRecord)(r);var d=this.$urlQueryObj.refer_channel_cid;"group_success_download_lucky_xcx"!==d&&"group_success_download_normal_xcx"!==d&&"group_success_rec_lucky_xcx"!==d&&"group_success_rec_normal_xcx"!==d||l.default.rpTest||(l.default.rpTest="1")}};(0,p.PddPage)(b,{pageName:"relative_recommend",notUseCommonPV:!0}); 
 			}); 	require("pages/relative_recommend/relative_recommend.js");
 		__wxRoute = 'package_a/footprint/footprint';__wxRouteBegin = true; 	define("package_a/footprint/footprint.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var o=require("../../common/index"),a=t(require("../../configs/api")),r=t(require("../../libs/co/we-index")),n=t(require("../../libs/regenerator-runtime/runtime")),s=t(require("../../common/time_util")),i=t(require("../../common/gotop_util")),d=t(require("../../controller/formid_controller")),c={windowHeight:0,removeGoodsIds:[],data:{title:"",paramReferPageName:"",hasFootPrint:!0,isShowRecCls:"",recIsRequest:!1,recNoMoreText:"",recOffset:0,recCount:20,recDataList:[],recCanLoadMore:!0,loadingVisible:!0},onLoad:function(t){this.requeFootPrint()},onReady:function(){this.windowHeight=o.SystemInfo.getWindowHeightSync()},onPageScroll:function(t){var e=parseInt(t.scrollTop,10);i.default.showGoTopBtn(e,this)},onReachBottom:function(){this.data.hasShowFootPrint?this.requestRecommend():this.requeFootPrint()},requeFootPrint:function(){var t=void 0,e=void 0,s=void 0,i=this;(0,r.default)(n.default.mark(function r(){var d,c,u,l,f,h,m,g,p,v,_,P,D;return n.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return d=o.Request.requestDataWithUrl("GET",a.default.myFootPrint),r.next=3,o.Request.runMainRequestForPage(d,i);case 3:if(t=r.sent,e=i.formatFootPrintData(t.goods_list),s=i.countFootPrintTimes(e),!(e.length>0&&e.length<=100)){r.next=54;break}i.requestRecommend(),c=!0,u=!1,l=void 0,r.prev=11,f=s[Symbol.iterator]();case 13:if(c=(h=f.next()).done){r.next=37;break}for(m=h.value,g=!0,p=!1,v=void 0,r.prev=18,_=m[Symbol.iterator]();!(g=(P=_.next()).done);g=!0)1==(D=P.value).showNull&&(D.isShowGrey="footprint-item-goods-name-soldout",D.isShowPink="footprint-item-goods-price-soldout");r.next=26;break;case 22:r.prev=22,r.t0=r.catch(18),p=!0,v=r.t0;case 26:r.prev=26,r.prev=27,!g&&_.return&&_.return();case 29:if(r.prev=29,!p){r.next=32;break}throw v;case 32:return r.finish(29);case 33:return r.finish(26);case 34:c=!0,r.next=13;break;case 37:r.next=43;break;case 39:r.prev=39,r.t1=r.catch(11),u=!0,l=r.t1;case 43:r.prev=43,r.prev=44,!c&&f.return&&f.return();case 46:if(r.prev=46,!u){r.next=49;break}throw l;case 49:return r.finish(46);case 50:return r.finish(43);case 51:i.setData({loadingVisible:!1,footPrintDatas:s,hasShowFootPrint:!0,noShowFootPrint:!1}),r.next=55;break;case 54:0===e.length&&(i.setData({loadingVisible:!1,noShowFootPrint:!0,hasShowFootPrint:!1,footPrintDatas:s,isShowRecCls:"show"}),i.requestRecommend());case 55:case"end":return r.stop()}},r,this,[[11,39,43,51],[18,22,26,34],[27,,29,33],[44,,46,50]])}))},countFootPrintTimes:function(t){for(var e=[],o=0;o<t.length;o++)if(0==o){var a=[];a.push(t[o]),e.push(a)}else{var r=t[o].browse_time,n=t[o-1].browse_time,s=1*e.length-1;if(r==n)e[s].push(t[o]);else{var i=[];i.push(t[o]),e.push(i)}}return e},formatFootPrintData:function(t){var e=[];(new Date).getTime();return t instanceof Array?(t.forEach(function(t){var a=0===t.is_onsale,r="";a||(r=t.has_coupon?"领券有优惠":t.quantity<200?"库存仅剩"+t.quantity+"件":""),e.push({goodsId:t.goods_id,browse_time:s.default.formatTime(t.browse_time,"MM月dd日"),imgUrl:o.ImageUtil.cdnCompress(t.hd_thumb_url||t.thumb_url),goodsName:t.goods_name,price:o.StdFormat.price(t.price,100),soldQuantity:o.StdFormat.sales(t.sold_quantity),customerNum:parseInt(t.customer_num,10),showNull:a,isShow:-1!=[0,2,3,5,6].indexOf(t.event_type)&&t.sold_quantity>0,hintMsg:r})}),e):e},requestRecommend:function(){var t=this,e=this.data,a="rec_order_list?offset="+e.recOffset+"&count="+e.recCount;if(!e.recIsRequest&&e.recCanLoadMore){this.setData({recIsRequest:!0});var r=o.Request.requestDataWithUrl("GET",a);o.Request.runSecondaryRequestForPage(r,this).then(function(o){var a=t.formatRecData(o.list),r=!0;a.length<e.recCount&&(r=!1),t.setData({loadingVisible:!1,recCanLoadMore:r,recIsRequest:!1,recOffset:e.recOffset+e.recCount,recDataList:e.recDataList.concat(a)})},function(e){t.setData({recIsRequest:!1})})}},formatRecData:function(t){var e=[];return t instanceof Array?(t.forEach(function(t){e.push({goodsId:t.goods_id,imgUrl:o.ImageUtil.cdnCompress(t.hd_thumb_url||t.thumb_url),goodsName:t.goods_name,price:o.StdFormat.price(t.price,100),soldQuantity:o.StdFormat.sales(t.sales),customerNum:parseInt(t.customer_num,10)})}),e):e},remove:function(t){this.setData({removeButtonHidden:!0}),(0,o.TrackingRecord)({op:"click",event:"pop_btn_click",page_name:"footprint",page_section:"pop_list",page_element:"del_btn"});var e=t.detail.formId;this.uploadFormId(e,"unknown",!0)},uploadFormId:function(t,e,o){t&&e&&d.default.uploadFormIdToSH(t,o)},bottomBtnTracking:function(t){var e={op:"click",event:"select_btn_click",page_name:"footprint",page_section:"edit",page_element:t};"del_btn"==t&&(e.goods_ids=JSON.stringify(this.removeGoodsIds)),(0,o.TrackingRecord)(e)},cancelRemove:function(t){this.removeGoodsIds=[],this.unselectedInFootPrintDatas(),this.setData({removeButtonHidden:!1,footPrintDatas:this.data.footPrintDatas,confirmButtonSelected:!1}),this.bottomBtnTracking("cancel");var e=t.detail.formId;this.uploadFormId(e,"unknown",!0)},confirmRemove:function(t){this.removeRequest(),this.bottomBtnTracking("del_btn");var e=t.detail.formId;this.uploadFormId(e,"unknown",!0)},goodTap:function(t){t.currentTarget.dataset.goodsId;var e=t.currentTarget.dataset.index,a=t.currentTarget.dataset.foot,r=t.currentTarget.dataset.isFoot;if(this.data.removeButtonHidden&&!this.data.noShowFootPrint&&r){var n=t.currentTarget.dataset.goodsId,s=this.removeGoodsIds.indexOf(n);-1!==s?(this.removeGoodsIds.splice(s,1),this.data.confirmButtonSelected&&0==this.removeGoodsIds.length&&this.setData({confirmButtonSelected:!1})):(this.removeGoodsIds.push(n),this.data.confirmButtonSelected||this.setData({confirmButtonSelected:!0})),this.selectedInFootPrintDatas(n),(0,o.TrackingRecord)({op:"click",event:"sel_btn_clk",page_name:"footprint",page_section:"goods_list",page_element:"sel_btn",goods_id:n,sold_out:a.showNull?1:0,idx:e,is_select:-1!==s?0:1})}else{var i=t.currentTarget.dataset.goodsId;o.Navigation.forward("/pages/goods/goods?goods_id="+i),(0,o.TrackingRecord)({op:"click",event:"goods_clk",page_name:"footprint",page_section:"goods_list",page_element:"goods",goods_id:i,sold_out:a.showNull?1:0,idx:e})}},isNoFootprintData:function(){for(var t=0;t<this.data.footPrintDatas.length;t++){this.data.footPrintDatas[t];for(var e=0;e<this.data.footPrintDatas[t].length;e++)return!1}return!0},removeRequest:function(){if(this.removeGoodsIds&&this.removeGoodsIds.length>0){var t={goods_id_list:this.removeGoodsIds},e=this;o.Request.apiRequest("POST","footprint/goods/delete",t).then(function(t){for(var o=0;o<e.removeGoodsIds.length;o++){var a=e.removeGoodsIds[o];e.removeInFootPrintDatas(a)}e.setData({footPrintDatas:e.data.footPrintDatas,confirmButtonSelected:!1,noShowFootPrint:e.isNoFootprintData(),hasShowFootPrint:!e.isNoFootprintData()}),e.isNoFootprintData&&e.goTop(),e.removeGoodsIds=[]},function(t){console.error("删除失败"),e.$showToast("删除失败")})}},removeInFootPrintDatas:function(t){for(var e=0;e<this.data.footPrintDatas.length;e++){for(var o=this.data.footPrintDatas[e],a=0;a<this.data.footPrintDatas[e].length;a++)if(o[a]&&o[a].goodsId&&o[a].goodsId==t){o.splice(a,1);break}this.data.footPrintDatas[e]=o}},selectedInFootPrintDatas:function(t){for(var o=0;o<this.data.footPrintDatas.length;o++)for(var a=this.data.footPrintDatas[o],r=0;r<this.data.footPrintDatas[o].length;r++)if(a[r]&&a[r].goodsId&&a[r].goodsId==t){this.setData(e({},"footPrintDatas["+o+"]["+r+"].selected",!a[r].selected));break}},unselectedInFootPrintDatas:function(){if(this.data.footPrintDatas)for(var t=0;t<this.data.footPrintDatas.length;t++){this.data.footPrintDatas[t];for(var e=0;e<this.data.footPrintDatas[t].length;e++)this.data.footPrintDatas[t][e].selected=!1}}};(0,o.PddPage)(c,{pageName:"footprint"}); 
 			}); 	require("package_a/footprint/footprint.js");
 		__wxRoute = 'package_a/goods_comments/goods_comments';__wxRouteBegin = true; 	define("package_a/goods_comments/goods_comments.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}var t=require("../../common/index"),a=e(require("../../components/goods_bottom_bar/goods_bottom_bar.js")),i=(e(require("../../components/toast/toast.js")),e(require("../../pages/goods/cache_goods_data"))),s=e(require("../../pages/goods/goods_util")),o=(e(require("../../configs/api")),e(require("../../common/buy_util"))),r=(e(require("../../storage/ram_manager")),e(require("../../constants/tracking/goods"))),n=e(require("../../components/sku_selector/sku_selector_v2")),l=e(require("../../components/share_action_sheet/share_action_sheet")),d={id:-1,level:0,name:"全部",num:0,positive:1},c={id:-2,level:0,name:"有内容",num:0,positive:1},u={id:-3,level:0,name:"追加",num:0,positive:1},g={id:-4,level:0,name:"有图",num:0,positive:1},m={commentListsWithPic:{},data:{tagInfo:{},goodsId:"",tapMoreShow:!0,desc:!1,params:{page:1,size:20},flag:!0,galleryCurrent:1,commentLists:[],needLoadBg:!0,loadingVisible:!0,loadingText:"正在加载...",selectedNum:0,listLoading:!1,topShow:!1},scrollBottom:function(){if(this.data.flag){var e={},t=this.data.api;e.size=this.data.params.size,e.page=this.data.params.page+1,this.setData({params:e}),this.getListData(t)}},goTop:function(){this.setData({scrollTop:0})},scroll:function(e){var t=e.detail;if(t){var a=parseInt(t.scrollTop);a>=this.data.scrollContainerHeight&&!this.data.topShow&&this.setData({topShow:!0}),a<this.data.scrollContainerHeight&&this.data.topShow&&this.setData({topShow:!1})}},preLoadGoodsPage:function(e){var t=getCurrentPages(),a=void 0;if(t.length>1&&(a=t[t.length-2]),a&&a.transGoodsData){var i=a.transGoodsData;i&&i.mallId==e&&wx.setNavigationBarTitle({title:i.mallName})}},loadPage:function(){this.setBottomBar(),this.getTagData(),this.data.windowRatio||this.setData({windowRatio:t.SystemInfo.getWindowWidthSync()/t.SystemInfo.getWindowHeightSync()})},clickDesc:function(){var e=!this.data.desc;this.setData({desc:e})},selectTag:function(e){var t=this;this.commentListsWithPic={},this.noMoreGalleryComment=!1,this.galleryPage=0,this.setData({"params.page":1,"params.size":20,flag:!0});var a=e.currentTarget.dataset.index,i=(e.currentTarget.dataset.item,this.data.tagInfo.tags.map(function(e,i){return e.active=!1,i===a&&(e.active=!0,t.getListData(e.api),t.setData({api:e.api,galleryApi:e.galleryApi,selectedNum:e.num})),e}));this.setData({"tagInfo.tags":i,commentLists:[],commentGallery:[]})},getListData:function(e){var a=this,i=this.data.params,s=this;this.data.flag&&(1===s.data.params.page?s.setData({listLoading:!1,flag:!1}):s.setData({listLoading:!0,flag:!1}),t.Request.apiRequest("GET",e,i,!0).then(function(e){var i=[],o=a.data.commentGallery||[];(i=e.data.map(function(e,i){var s=e.time;if(e.time=t.TimeUtil.formatTime(e.time,"yyyy.MM.dd"),e.specs=t.DataUtil.formatSpecs(e.specs),e.append&&(e.append.time="用户"+t.TimeUtil.timeSpan(s,e.append.time)+"后追评"),e.pictures.length>0){a.commentListsWithPic[e.review_id]=e;for(var r=0;r<e.pictures.length;r++)o.push(t.ObjectUtil.assign(e.pictures[r],{reviewId:e.review_id}))}else if(e.append&&e.append.pictures.length>0){a.commentListsWithPic[e.review_id]=e;for(var n=0;n<e.append.pictures.length;n++)o.push(t.ObjectUtil.assign(e.append.pictures[n],{reviewId:e.review_id}))}return e})).length<a.data.params.size?a.setData({flag:!1,loadingVisible:!1,loadingText:"没有更多评价了",commentLists:s.data.commentLists.concat(i),listLoading:!0,commentGallery:o}):a.setData({flag:!0,commentLists:s.data.commentLists.concat(i),loadingVisible:!1,loadingText:"正在加载...",listLoading:!0,commentGallery:o})},function(e){a.data.flag=!0}))},imageTap:function(e){if(e&&e.currentTarget&&e.currentTarget.dataset&&e.currentTarget.dataset.reviewId){for(var t=this.commentListsWithPic[e.currentTarget.dataset.reviewId],a=0,i=0;i<this.data.commentGallery.length;i++)if(this.data.commentGallery[i].reviewId==e.currentTarget.dataset.reviewId){a=i;break}a+=e.currentTarget.dataset.index,this.setData({showGallery:!0,swiperCurrent:a,galleryCurrent:a+1,galleryComment:t}),this.loadMoreGalleryComment(a+1)}},commentSpreadTap:function(){this.setData({hideGalleryComment:!this.data.hideGalleryComment})},closeGallery:function(){this.longPressLock||this.setData({showGallery:!1,hideGalleryComment:!1})},galleryChange:function(e){if(e.detail){var t=this.data.commentGallery[e.detail.current],a=this.commentListsWithPic[t.reviewId];this.setData({galleryCurrent:e.detail.current+1,galleryComment:a}),this.loadMoreGalleryComment(e.detail.current+1)}},longTapImage:function(e){var t=e.target.dataset,a=void 0;t&&(a=t.downloadUrl,this.actionSheet.show(a),this.longPressLock=!0)},getTagData:function(){var e=this,a=this.data.goodsId,i="reviews/"+a+"/info",s=this;t.Request.apiRequest("GET",i,null,!0).then(function(t){if(t){var i="reviews/"+a+"/list?page=1&size=20",o="api/engels/reviews/picture?page=1&size=10&goods_id="+a,r={tags:t.labels||[],averageScore:parseFloat(t.average||0,10).toFixed(1),number:parseInt(t.number||0,10),scoreNumber:parseInt(t.score_num,10),append:parseInt(t.append||0,10),picture:parseInt(t.picture||0,10),noCommentNum:parseInt(t.default_num||0,10)};d.num=r.number,c.num=r.number,g.num=r.picture,u.num=r.append;var n=[],l=r.number;d.num>0&&n.push(d),u.num>0&&n.push(u),g.num>0&&n.push(g),r.tags&&r.tags.length>0&&(n=n.concat(r.tags||[])),1===n.length&&(n=[]),r.tags=n.map(function(e,t){var o="",r="";switch(e.id){case d.id:case c.id:o="reviews/"+a+"/list?page=1&size=20",r="api/engels/reviews/picture?page=1&size=10&goods_id="+a;break;case g.id:o="reviews/"+a+"/list?picture=1&page=1&size=20",r="api/engels/reviews/picture?picture=1&page=1&size=10&goods_id="+a;break;case u.id:o="reviews/"+a+"/list?append=1&page=1&size=20",r="api/engels/reviews/picture?append=1&page=1&size=10&goods_id="+a;break;default:e.id?(o="reviews/"+a+"/list?label_id="+e.id+"&page=1&size=20",r="api/engels/reviews/picture?label_id="+e.id+"&page=1&size=10&goods_id="+a):(o="reviews/"+a+"?page=1&size=20",r="api/engels/reviews/picture?page=1&size=10&goods_id="+a)}return e.api=o,e.galleryApi=r,e.id==s.data.tapId?(e.active=!0,i=o,l=e.num):e.active=!1,e}),e.setData({tagInfo:r,api:i,galleryApi:o,selectedNum:l}),e.getListData(i)}},function(e){})},loadMoreGalleryComment:function(e){var a=this;if(!(e<this.data.commentGallery.length-3||this.noMoreGalleryComment||this.loadingGallery)){this.loadingGallery=!0;var i=0;if(this.galleryPage)this.galleryPage++;else{for(var s in this.commentListsWithPic)i++;this.galleryPage=Math.floor(i/10)+1}var o={page:this.galleryPage,size:10};t.Request.apiRequest("GET",this.data.galleryApi,o,!0).then(function(e){a.loadingGallery=!1;var i=a.data.commentGallery||[];e.data&&(e.data.forEach(function(e,s){var o=e.time;if(e.time=t.TimeUtil.formatTime(e.time,"yyyy.MM.dd"),e.specs=t.DataUtil.formatSpecs(e.specs),e.append&&(e.append.time="用户"+t.TimeUtil.timeSpan(o,e.append.time)+"后追评"),e.pictures.length>0){if(!a.commentListsWithPic[e.review_id]){a.commentListsWithPic[e.review_id]=e;for(var r=0;r<e.pictures.length;r++)i.push(t.ObjectUtil.assign(e.pictures[r],{reviewId:e.review_id}))}}else if(e.append&&e.append.pictures.length>0&&!a.commentListsWithPic[e.review_id]){a.commentListsWithPic[e.review_id]=e;for(var n=0;n<e.append.pictures.length;n++)i.push(t.ObjectUtil.assign(e.append.pictures[n],{reviewId:e.review_id}))}}),a.setData({commentGallery:i}),e.data.length<o.size&&(a.noMoreGalleryComment=!0))},function(e){a.loadingGallery=!1})}},setBottomBar:function(){var e=this,t=this.$urlQueryObj.cache_bottom_id,o=i.default.getDataFromCache(t);if(o&&o.bottomBarData){var r=o.bottomBarData;this.setData({bottomBarData:r}),this.goodsBottomBar||(this.goodsBottomBar=new a.default({showToast:this.$showToast,goodsId:this.$urlQueryObj.goods_id,setDataFunc:function(t){var a=e.data.bottomBarData||{};for(var i in t)t.hasOwnProperty(i)&&(a[i]=t[i]);e.setData({bottomBarData:a})},addRootFunc:function(t,a){t&&"function"==typeof a&&(e[t]=a)}})),this.goodsBottomBar&&(this.goodsBottomBar.load(null),this.setData({bottomBarVisible:!0}));var n=o.barDataNeededFromPage;n&&s.default.setBarDataInPage(n)}},goLotteryList:function(e){s.default.goLotteryList()},getPriceRange:o.default.getPriceRange,showSkuSelector:o.default.showSkuSelector,groupBuy:o.default.groupBuy,singleBuy:o.default.singleBuy,groupBuyOrPromptShare:o.default.groupBuyOrPromptShare,selectSpec:n.default.selectSpec,preloadSkuImgLoaded:n.default.preloadSkuImgLoaded,updateGoodsNumber:n.default.updateGoodsNumber,goodsNumberFocus:n.default.goodsNumberFocus,goodsNumberBlur:n.default.goodsNumberBlur,goodsNumberChange:n.default.goodsNumberChange,hideSkuSelector:n.default.hideSkuSelector,skuContainerDefaultClick:n.default.skuContainerDefaultClick,viewSkuImage:n.default.viewSkuImage,confirmSku:n.default.confirmSku,onLoad:function(e){var a="",i="";this.mallId=e.mall_id,a=t.UrlUtil.parseQuery(e).goods_id,i=t.UrlUtil.parseQuery(e).tap_id;var s=t.ObjectUtil.assign({},n.default.initSkuStatus,{goodsId:a,tapId:i});this.setData(s),this.loadPage();var o=this;this.actionSheet=new l.default({page:o,ns:"actionSheet",justSave:!0,complete:function(){o.longPressLock=!1}})},onReady:function(){this.setData({scrollContainerHeight:t.SystemInfo.getWindowHeightSync()})},toIndexPage:function(){var e=this.data.goodsInfo;(0,t.TrackingRecord)(t.ObjectUtil.assign({},r.default.IconClick,{page_element:"return_index",goods_id:e.goodsId,has_local_group:e.hasLocalGroup?"1":"0"})),this.$switchTab("index")},onCustomServiceClicked:function(e){if(this.mallId){var a=this.mallId,i={goodsId:this.data.goodsInfo.goodsId,goodsName:this.data.goodsInfo.goodsName,customerNum:this.data.goodsInfo.groupTypes[1].requireNum,src:this.data.goodsInfo.thumbUrl,groupPrice:this.data.goodsInfo.minOnsaleGroupPrice},s="/pages/custom_service/custom_service?mall_id="+a;s=s+"&"+t.UrlUtil.buildQuery(i),t.Navigation.forward(s),(0,t.TrackingRecord)({op:"click",page_name:"complaint_detail",page_element:"contact_seller_btn"})}this.$uploadFormId(e,!1)},onShow:function(){},onUnload:function(){},onHide:function(){}};(0,t.PddPage)(m,{pageName:"goods_comments"}); 
 			}); 	require("package_a/goods_comments/goods_comments.js");
 		__wxRoute = 'package_a/likes/likes';__wxRouteBegin = true; 	define("package_a/likes/likes.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}e(require("../../components/toast/toast.js"));var t=require("../../common/index"),a=e(require("../../configs/api")),s=e(require("../../models/format/grid_item_goods")),r=e(require("../../components/segment/segment.js")),o=e(require("../../storage/ram_manager")),i=e(require("../../common/gotop_util")),l=e(require("../../storage/user_storage")),n=e(require("../../libs/co/we-index")),d=e(require("../../libs/regenerator-runtime/runtime")),u=["商品","店铺"],c={segmentControl:null,winHeight:0,isFirstEnterPage:!0,recOffset:0,scrollTopValues:[],data:{goTopClass:!1,visible:!0,firstEnter:!0,loadLikesMoreVisible:!1,isLoadAllLikeGoods:!1,isLoadAllRecGoods:!1,hasLoadLikeMalls:!1,isLoadAllMalls:!1,colletionTabs:u,likeDatas:[],likeRecGoods:[],tabStatus:function(){var e=[];return u.forEach(function(){e.push({isLoadALL:!1,loadingVisible:!0,loadLikesMoreVisible:!1})}),e}(),showMoreItemIndex:-1,moreVisible:!1,scrollTop:0,pageScrollHeight:0,$tabsData:[{title:"商品"},{title:"店铺"}],curTabIndex:0,mallsNewGoods:{}},showMore:function(e){var t=parseInt(e.currentTarget.dataset.index,10);isNaN(t)||this.setData({showMoreItemIndex:t,moreVisible:!0})},hideMore:function(){this.data.moreVisible&&this.setData({showMoreItemIndex:-1,moreVisible:!1})},goTop:function(){this.setData({scrollTop:1}),this.setData({scrollTop:0})},scroll:function(e){this.hideMore();var t=parseInt(e.detail.scrollTop,10);isNaN(t)||(this.scrollTopValues[this.data.curTabIndex]=t,i.default.showGoTopBtn(t,this))},setScrollTop:function(e){i.default.showGoTopBtn(this.scrollTopValues[this.data.curTabIndex],this)},swiperChange:function(e){var t=parseInt(e.detail.current,10);isNaN(t)||(this.segmentControl.updateSelectIndex(t),this.setData(this.segmentControl.$data()),this.setScrollTop(t))},didClickSegmentTab:function(e){var a=e.currentTarget.dataset,s=parseInt(a.index,10);this.setData(this.segmentControl.$data()),this.setScrollTop(s);var r={op:"click",event:0==s?"goods_segment_clk":"mall_segment_clk",page_name:"likes",page_section:"segment_list",page_element:0==s?"goods_segment":"mall_segment",favourite_type:s};(0,t.TrackingRecord)(r)},onReady:function(){this.winHeight=t.SystemInfo.getWindowHeightSync(),i.default.showGoTopBtn(this.scrollTopValues[this.data.curTabIndex],this),this.setData({pageScrollHeight:this.winHeight-t.Util.rpxToPx(80)})},scrollToLower:function(){var e=this;switch(this.data.curTabIndex){case 0:this.data.isLoadAllLikeGoods?(0,n.default)(d.default.mark(function t(){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.loadLikeRecommendGoodsDetail(e);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])})):(0,n.default)(d.default.mark(function t(){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.loadLikeGoodsDetail(e);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}));break;case 1:var t=this.data.hasLoadLikeMalls,a=this.data.likeDatas[1]||[];t&&0===a.length?(0,n.default)(d.default.mark(function t(){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.loadLikeRecommendGoodsDetail(e);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])})):(0,n.default)(d.default.mark(function t(){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.loadLikeMallsDetail(e);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}))}},formatMallList:function(e){return e.map(function(e){return o.default.likeMallsIds[e.mall_id]=!0,{tpl:"like-mall-item",isOpen:1==e.is_open,logo:e.logo,hasCoupon:e.mall_coupon_available,mallId:e.mall_id,strategyType:e.mall_coupon_available,mallName:e.mall_name,sales:t.StdFormat.sales(e.mall_sales)}})},loadLikeMallsDetail:n.default.wrap(d.default.mark(function e(s){var r,i,l,n,u,c,p,f;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!s.likeMallsRequest&&!s.isLoadAllMalls){e.next=3;break}return e.abrupt("return");case 3:return s.likeMallsRequest=!0,r=20,this.likeMallsPage=this.likeMallsPage||1,i=t.DataUtil.formatByPos(a.default.likeMalls,this.likeMallsPage,r),l=t.Request.requestDataWithUrl("GET",i),e.next=10,t.Request.runMainRequestForPage(l,s);case 10:return(n=e.sent)&&(s.likeMallsPage++,s.likeMallsRequest=!1),u=n.mall_list||[],u=t.DataUtil.objectArrayDuplicateRemove(u,"mall_id"),u=s.formatMallList(u),c=u.length<r,p=s.data.likeDatas[1]||[],f=u,u=p.concat(u),this.setData({hasLoadLikeMalls:!0,"tabStatus[1].loadLikesMoreVisible":!c||0===u.length,"tabStatus[1].loadingVisible":!1,"tabStatus[1].isLoadALL":!!c,isLoadAllMalls:c,"likeDatas[1]":u}),o.default.likeMallsList=u,this.loadMallsNewGoods(s,f),e.abrupt("return",u);case 25:e.prev=25,e.t0=e.catch(0),console.error(e.t0),s.likeMallsRequest=!1,s.$showToast("加载出错");case 30:case"end":return e.stop()}},e,this,[[0,25]])})),loadMallsNewGoods:n.default.wrap(d.default.mark(function e(s,r){var o,i,n,u,c,p,f,g,k;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r&&0!=r.length){e.next=3;break}return e.abrupt("return");case 3:o=[];for(i in r)o.push(r[i].mallId);return n={mall_ids:o},u=l.default.getUserId(),c=t.DataUtil.formatByPos(a.default.likeMallsGoods,u),p=t.Request.requestDataWithUrl("POST",c,n),e.next=11,t.Request.runMainRequestForPage(p,s);case 11:if((f=e.sent).result){for(g in f.result)f.result[g]&&f.result[g].forEach(function(e){e.price=t.StdFormat.price(e.price,100)});k=t.ObjectUtil.assign(f.result,this.data.mallsNewGoods),this.setData({mallsNewGoods:k})}e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[0,15]])})),priorityStrategy:function(e,t){var a=this;if(!e.isOnSale)return{text:"",type:""};var s=function(e){var s={priceDecline:function(e){var t=e.reducedPrice;return!(parseInt(t,10)<=0)&&{text:["比收藏时降",t,"元"].join(""),type:"reduce_price"}},getCoupon:function(e){return!!e.mallCouponAvailable&&{text:"领券有优惠",type:"mall_coupon_available"}},storeNotEnough:function(e){var t=e.quantity;return parseInt(t,10)>0&&parseInt(t,10)<200&&{text:["库存仅剩",t,"件"].join(""),type:"quantity"}}},r=[],o=a;t.forEach(function(e){if(!s[e])return!1;r.push(s[e])});for(var i=0;i<r.length;i++){var l=r[i].call(o,e);if(l)return l}r=null}(e);return s=s||{text:"",type:""}},formatLikeGoods:function(e){var a=this,s=["priceDecline","getCoupon","storeNotEnough"];return e.map(function(e){o.default.likeGoodsIds[e.goods_id]=!0;var r={tpl:"like-goods-item",goodsId:e.goods_id,goodsName:e.goods_name,price:t.StdFormat.price(e.price,100),imgUrl:t.ImageUtil.cdnCompress(e.hd_thumb_url||e.thumb_url),groupDesc:e.customer_num+"人团",customerNum:e.customer_num,soldQuantity:e.sold_quantity,soldQuantityFormatted:t.StdFormat.sales(e.sold_quantity),isPreSale:1===parseInt(e.is_pre_sale,10),skuIds:(e.sku_ids||[]).map(function(e){return parseInt(e,10)}),isOnSale:e.is_onsale>0,isApp:!!e.is_app,mallId:e.mall_id,reducedPrice:t.StdFormat.price(e.reduced_price,100),quantity:parseInt(e.quantity,10),mallCouponAvailable:1===e.mall_coupon_available,goToGoods:e.sku_ids.length>1},i=a.priorityStrategy(r,s);return r.likeGoodsHint=i.text,r.strategyType=i.type,r})},loadLikeGoodsDetail:n.default.wrap(d.default.mark(function e(s){var r,i,l,n,u,c,p,f;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!s.isLoadAllLikeGoods&&!s.likeGoodsRequest){e.next=3;break}return e.abrupt("return");case 3:return s.likeGoodsRequest=!0,s.likeGoodsPage=s.likeGoodsPage||1,r=o.default.favoriteUpdateTime||0,i=20,l=t.DataUtil.formatByPos(a.default.likeGoods,r,s.likeGoodsPage,i),n=t.Request.requestDataWithUrl("GET",l),e.next=11,t.Request.runMainRequestForPage(n,s);case 11:return(u=e.sent)&&(s.likeGoodsPage++,s.likeGoodsRequest=!1),c=u.goods_list||[],c=t.DataUtil.objectArrayDuplicateRemove(c,"goods_id"),c=s.formatLikeGoods(c),p=c.length<i,f=s.data.likeDatas[0]||[],c=f.concat(c),s.setData({"likeDatas[0]":c,isLoadAllLikeGoods:p,"tabStatus[0].loadingVisible":!1,"tabStatus[0].loadLikesMoreVisible":!0,"tabStatus[0].isLoadALL":!!p,firstEnter:!1}),o.default.likeGoodsList=c,e.abrupt("return",c);case 24:e.prev=24,e.t0=e.catch(0),console.error(e.t0),s.likeGoodsRequest=!1,s.$showToast("加载出错");case 29:case"end":return e.stop()}},e,this,[[0,24]])})),loadLikeRecommendGoodsDetail:n.default.wrap(d.default.mark(function e(r){var o,i,l,n,u,c;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!r.data.isLoadAllRecGoods&&!r.recommendGoodsRequest){e.next=3;break}return e.abrupt("return");case 3:return r.recommendGoodsRequest=!0,o=t.DataUtil.formatByPos(a.default.likeRecommend,r.recOffset,20),i=t.Request.requestDataWithUrl("GET",o),e.next=8,t.Request.runSecondaryRequestForPage(i,r);case 8:(l=e.sent)&&(r.recOffset+=20,r.recommendGoodsRequest=!1),n=l.list||[],n=n.map(function(e){return s.default.formatData(e)}),u=r.data.likeRecGoods||[],u=u.concat(n),u=t.DataUtil.objectArrayDuplicateRemove(u,"goodsId",function(e){return 1==e.isApp}),c=n.length<20,this.setData({likeRecGoods:u,isLoadAllRecGoods:c}),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0),r.recommendGoodsRequest=!1,r.$showToast("加载出错");case 24:case"end":return e.stop()}},e,this,[[0,19]])})),gotoGoodsDetail:function(e){var a=e.currentTarget.dataset;if(a){var s=a.goodsId;if(s){var r=e.currentTarget.dataset.goodsItem;this.transGoodsData=r;var o="/pages/goods/goods?goods_id="+s;if(1==e.currentTarget.dataset.showSkuSelector&&(o+="&show_sku_selector=1"),t.Navigation.forward(o),"mallItem"===a.refer)(0,t.TrackingRecord)({op:"click",page_section:"mall_list",page_element:"goods",goods_id:s,goods_idx:a.goodsIndex,is_new:a.isNew,idx:a.index,mall_id:a.mallId,buy_prompt:a.strategy,favorite_type:"1",is_open:!a.invalidMall});else{var i={goods_id:s,idx:a.index,favorite_type:"0",buy_prompt:a.strategy};if(1==a.showSkuSelector){var l=this.getTrackingParams("likes_list","open_btn",i);(0,t.TrackingRecord)(l)}else(0,t.TrackingRecord)({op:"click",event:"item_clk",page_name:"likes",page_section:"likes_list",page_element:"goods",favorite_type:0,goods_id:s,idx:a.index,buy_prompt:a.strategy})}}}},gotoOrderCheckout:function(e){var a=e.currentTarget.dataset;if(a){var s=a.goodsId,r=a.skuId;if(s&&r){var o={sku_id:r,goods_id:s,goods_number:1},i="/pages/order_checkout/order_checkout?"+t.UrlUtil.buildQuery(o);t.Navigation.forward(i),(0,t.TrackingRecord)({op:"click",event:"open_btn_clk",page_name:"likes",page_section:"likes_list",page_element:"open_btn",favorite_type:0,goods_id:s,idx:a.index,buy_prompt:a.strategy})}}},forwardMall:function(e,a,s){var r=e.currentTarget.dataset.mallId,o=e.currentTarget.dataset.invalidMall,i=e.currentTarget.dataset.index,l=e.currentTarget.dataset.goodsId;if(this.hideMore(),!o&&r){t.Navigation.forward("/pages/mall_page/mall_page?mall_id="+r+(s?"":"&from_like=1"));var n={idx:i,favorite_type:"0"},d=void 0;s?(n.goods_id=l,d=this.getTrackingParams("likes_list","enter_mall_btn",n)):(n.mall_id=r,n.is_open=!e.currentTarget.dataset.invalidMall,n.favorite_type="1",d=a?this.getTrackingParams("mall_list","enter_btn",n):this.getTrackingParams("mall_list","mall",n)),d.buy_prompt=e.currentTarget.dataset.strategy,(0,t.TrackingRecord)(d)}else this.$showToast("该店铺已失效，到其它店铺逛逛吧")},enterMall:function(e){this.forwardMall(e,!0)},gotoMallPage:function(e){this.forwardMall(e,!1)},gotoMallPageFromGoodsItem:function(e){this.forwardMall(e,!1,!0)},doLikeOrCancelLikeGoods:n.default.wrap(d.default.mark(function e(s,r,i){var l,n,u;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r&&!i.likeGoodsRequestLock){e.next=3;break}return e.abrupt("return");case 3:return i.likeGoodsRequestLock=!0,l=s?a.default.doLikeGoods:a.default.unLikeGoods,n=t.Request.requestDataWithUrl("POST",l+r),e.next=8,t.Request.runMainRequestForPage(n,i);case 8:(u=e.sent)&&(o.default.likeGoodsIds[r]=s),o.default.likeGoodsList=t.DataUtil.removeItemByKey(o.default.likeGoodsList,"goodsId",r),i.hideMore(),i.$showToast("取消收藏成功"),i.setData({hasLiked:!!o.default.likeGoodsIds[r],"likeDatas[0]":o.default.likeGoodsList||[]}),i.likeGoodsRequestLock=!1,e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0),i.$showToast("网络出错");case 21:case"end":return e.stop()}},e,this,[[0,17]])})),doLikeOrCancelLikeMall:n.default.wrap(d.default.mark(function e(s,r,i){var l,n,u;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r&&!i.likeMallsRequestLock){e.next=3;break}return e.abrupt("return");case 3:return i.likeMallsRequestLock=!0,l=s?a.default.doLikeMall:a.default.unLikeMall,n=t.Request.requestDataWithUrl("POST",l+r),e.next=8,t.Request.runMainRequestForPage(n,i);case 8:(u=e.sent)&&(o.default.likeMallsIds[r]=s),o.default.likeMallsList=t.DataUtil.removeItemByKey(o.default.likeMallsList,"mallId",r),this.hideMore(),this.$showToast("取消收藏成功"),this.setData({hasLiked:!!o.default.likeMallsIds[r],"likeDatas[1]":o.default.likeMallsList||[]}),i.likeMallsRequestLock=!1,e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0),i.$showToast("网络出错");case 21:case"end":return e.stop()}},e,this,[[0,17]])})),cancelLikeGoods:function(e){var a=e.currentTarget.dataset,s=a.goodsId,r=a.index;if(s){var o=this;(0,n.default)(d.default.mark(function e(){var i,l;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.doLikeOrCancelLikeGoods(!1,s,o);case 3:i={goods_id:s,buy_prompt:a.strategy,idx:r,favorite_type:"0"},l=o.getTrackingParams("likes_list","cancel_btn",i),(0,t.TrackingRecord)(l),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}))}},cancelLikeMall:function(e){var a=e.currentTarget.dataset.mallId;if(a){var s=this;(0,n.default)(d.default.mark(function r(){var o,i,l;return d.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,s.doLikeOrCancelLikeMall(!1,a,s);case 3:o=e.currentTarget.dataset.index,i={mall_id:a,idx:o,favorite_type:"1",is_open:!e.currentTarget.dataset.invalidMall,buy_prompt:e.currentTarget.dataset.strategy},l=s.getTrackingParams("mall_list","cancel_btn",i),(0,t.TrackingRecord)(l),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),console.error(r.t0);case 12:case"end":return r.stop()}},r,this,[[0,9]])}))}},onUnload:function(){o.default.likeGoodsList=null,o.default.likeMallsList=null},onShow:function(){this.isFirstEnterPage?this.isFirstEnterPage=!1:this.setData({"likeDatas[0]":o.default?o.default.likeGoodsList||[]:[],"likeDatas[1]":o.default?o.default.likeMallsList||[]:[]})},onLoad:function(e){var t=this,a={tabsData:this.data.$tabsData};this.segmentControl=new r.default(a,this),this.setData(this.segmentControl.$data()),(0,n.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,[t.loadLikeGoodsDetail(t),t.loadLikeRecommendGoodsDetail(t),t.loadLikeMallsDetail(t)];case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}))},getTrackingParams:function(e,a,s){var r={op:"click",page_name:"likes",page_section:e,page_element:a};return s&&(r=t.ObjectUtil.assign(r,s)),r}};(0,t.PddPage)(c,{pageName:"likes"}); 
 			}); 	require("package_a/likes/likes.js");
 		__wxRoute = 'package_a/promotion_main/promotion_main';__wxRouteBegin = true; 	define("package_a/promotion_main/promotion_main.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return t&&t.__esModule?t:{default:t}}var e=require("../../common/index"),o=(t(require("../../configs/api")),t(require("../../controller/formid_controller"))),a=(t(require("../../libs/es6-promise.min.js")),t(require("../../libs/co/we-index"))),n=t(require("../../libs/regenerator-runtime/runtime")),r=t(require("./component/promotion_timeline")),i=t(require("../../components/promotion_spike/promotion_spike")),s=t(require("./component/carnival_promotion")),p=t(require("./component/main_carnival_promotion")),l=t(require("./component/relay_promotion")),c=t(require("./component/tesla")),d=t(require("./component/promotion_bottombar")),m=t(require("./component/promotion_alert")),u=t(require("../../storage/ram_manager")),h=t(require("../../common/gotop_util")),g={scrollTop:0,components:[],data:{},onShareAppMessage:function(t){},pvTracking:function(){if(!u.default.isFromAppOnShow||!this.$firstTimeTrackRecord.pv){var t={op:"pv",page_sn:10115,page_url:"pages/promotion_main/promotion_main",refer_xcx_campaign_d12:1};(0,e.TrackingRecord)(t),this.$firstTimeTrackRecord.pv=!0}},onReady:function(){},onShow:function(){var t=this;this.updateUIInterval||(this.updateComponents(),this.updateUIInterval=setInterval(function(){t.updateComponents()},1e3)),u.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking(),u.default.isReadBigSales=!0},updateComponents:function(){this.dataObj={},this.components.forEach(function(t){t&&t.updateData&&t.updateData()}),this.setData(this.dataObj)},onHide:function(){this.updateUIInterval&&(clearInterval(this.updateUIInterval),this.updateUIInterval=null)},onUnload:function(){this.updateUIInterval&&(clearInterval(this.updateUIInterval),this.updateUIInterval=null)},onLoad:function(t){this.pvTracking(),this.initComponent(),this.loadData()},onPageScroll:function(t){var e=parseInt(t.scrollTop);this.scrollTop=e,h.default.showGoTopBtn(e,this)},initComponent:function(){this.promotionTimeline=new r.default({page:this,ns:"promotionTimeline",pageSn:10115}),this.components.push(this.promotionTimeline),this.promotionSpike=new i.default({page:this,ns:"promotionSpike"}),this.components.push(this.promotionSpike),this.carnivalPromotion=new s.default({page:this,ns:"carnivalPromotion"}),this.components.push(this.carnivalPromotion),this.mainCarnivalPromotion=new p.default({page:this,ns:"mainCarnivalPromotion"}),this.components.push(this.mainCarnivalPromotion),this.brandRelayPromotion=new l.default({page:this,ns:"brandRelayPromotion",type:"brand_day"}),this.components.push(this.brandRelayPromotion),this.tesla=new c.default({page:this,ns:"tesla"}),this.components.push(this.tesla),this.promotionBottombar=new d.default({page:this,ns:"promotionBottombar"}),this.components.push(this.promotionBottombar),this.promotionAlert=new m.default({page:this,ns:"promotionAlert"}),this.components.push(this.promotionAlert)},loadData:function(){var t=this;(0,a.default)(n.default.mark(function e(){return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.setData({loadingVisible:!0}),e.next=4,[t.promotionTimeline.loadData(),t.promotionSpike.loadData(),t.carnivalPromotion.loadData()];case 4:t.setData({loadingVisible:!1}),t.mainCarnivalPromotion.loadData(),t.brandRelayPromotion.loadData(),t.tesla.loadData(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),t.setData({loadingVisible:!1});case 14:case"end":return e.stop()}},e,this,[[0,10]])}))},reLoad:function(){this.setData({showError:!1}),this.loadData()},gotoGoodsDetail:function(t){if(t&&t.currentTarget&&t.currentTarget.dataset&&t.currentTarget.dataset.goodsId){var o=t.currentTarget.dataset.goodsId;e.Navigation.route("/pages/goods/goods?goods_id="+o+"&xcx_campaign_id_01=big_sale");var a=t.currentTarget.dataset.index,n=t.currentTarget.dataset.refer,r={op:"click",goods_id:o,idx:a,page_sn:10115,refer_xcx_campaign_d12:1};if("preheat_list"===n)r.page_el_sn=99179;else if("spike_list"===n)r.page_el_sn=99860;else if("carnival"===n){var i=t.currentTarget.dataset.promotionId;r.page_el_sn=99340,r.subject_id=i}else if("main_carnival"===n){var s=t.currentTarget.dataset.promotionId;r.page_el_sn=99338,r.subject_id=s}else r.page_el_sn=99334;var p=t.currentTarget.dataset.goodsItem;p&&(p.ad&&(r.ad=JSON.stringify(p.ad)),p.p_rec&&(r.p_rec=JSON.stringify(p.p_rec)),p.p_search&&(r.p_search=JSON.stringify(p.p_search))),(0,e.TrackingRecord)(r)}},gotoVenue:function(t){if(t&&t.currentTarget&&t.currentTarget.dataset&&t.currentTarget.dataset.promotionId){var o=t.currentTarget.dataset.promotionId;e.Navigation.forward("/package_a/promo_dec_venue/promo_dec_venue?promotionId="+o);var a=t.currentTarget.dataset.refer,n=t.currentTarget.dataset.subRefer,r=null;r="main_carnival"===a?99339:"carnival"===a?"top"===n?99347:99346:"relay"===a?99337:99301,(0,e.TrackingRecord)({op:"click",page_el_sn:r,subject_id:o,page_sn:10115,refer_xcx_campaign_d12:1})}},uploadFormId:function(t){t&&t.detail&&t.detail.formId&&o.default.uploadFormIdToSH(t.detail.formId,!0)}};(0,e.PddPage)(g,{pageName:"promotion_main",pageSn:10115,notUseCommonPV:!0}); 
 			}); 	require("package_a/promotion_main/promotion_main.js");
 		__wxRoute = 'package_a/promo_dec_venue/promo_dec_venue';__wxRouteBegin = true; 	define("package_a/promo_dec_venue/promo_dec_venue.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var a=require("../../common/index"),o=require("./venue_constants"),r=e(require("../../configs/api")),n=e(require("../../components/segment/segment.js")),s=e(require("../../common/object_util")),i=e(require("../../controller/formid_controller")),u=e(require("../../common/gotop_util")),c=(e(require("../../libs/es6-promise.min.js")),e(require("../../libs/co/we-index"))),d=e(require("../../libs/regenerator-runtime/runtime")),l=e(require("../../storage/ram_manager")),p=e(require("../promotion_main/component/promotion_alert")),g={page:1,inRequest:{},scrollTop:0,promotionId:0,data:{loadingVisible:!0,$tabsData:[],canLoadMore:null,list:[],showError:!1},pvTracking:function(){if(!l.default.isFromAppOnShow||!this.$firstTimeTrackRecord.pv){var e={op:"pv",page_sn:10116,page_url:"pages/promo_dec_venue/promo_dec_venue?promotionId="+this.promotionId,subject_id:this.promotionId,refer_xcx_campaign_d12:1};(0,a.TrackingRecord)(e),this.$firstTimeTrackRecord.pv=!0}},onLoad:function(e){var t=this,a={tabsData:t.data.$tabsData,alignType:"align-gap"};t.segmentControl=new n.default(a,this),t.promotionAlert=new p.default({page:this,ns:"promotionAlert"});var r=0;wx.setNavigationBarTitle({title:"拼多多12.12购物节"}),e&&e.promotionId&&(r=e.promotionId,t.promotionId=r,o.VenueSubject[r]?(0!==o.VenueSubject[r].bottomBar[0].id&&o.VenueSubject[r].bottomBar.unshift({class:"main-venue",id:0}),t.setData({bottomBar:o.VenueSubject[r].bottomBar,mainColor:o.VenueSubject[r].mainColor,loadingColor:o.VenueSubject[r].loadingColor,loadingBg:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/"+o.VenueSubject[r].loadingBg+".png",bannerLoadingBg:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/banner-"+o.VenueSubject[r].loadingBg+".png"})):(0!==o.FixedVenue.bottomBar[0].id&&o.FixedVenue.bottomBar.unshift({class:"main-venue",id:0}),t.setData({bottomBar:o.FixedVenue.bottomBar,mainColor:o.FixedVenue.mainColor,loadingColor:o.FixedVenue.loadingColor,loadingBg:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/"+o.FixedVenue.loadingBg+".png",bannerLoadingBg:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/banner-"+o.FixedVenue.loadingBg+".png"})),this.pvTracking(),(0,c.default)(d.default.mark(function e(){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,[t.getVenueTabInfo(r,t),t.getVenueBanner(r,t)];case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])})))},onShow:function(e){var t=this;this.updateUIInterval||(this.updateUIInterval=setInterval(function(){t.promotionAlert&&t.promotionAlert.updateData&&t.promotionAlert.updateData()},1e3)),l.default.isFromAppOnShow||this.$firstTimeTrackRecord.pv||this.pvTracking(),l.default.isReadBigSales=!0},onHide:function(){this.updateUIInterval&&(clearInterval(this.updateUIInterval),this.updateUIInterval=null)},onUnload:function(){this.updateUIInterval&&(clearInterval(this.updateUIInterval),this.updateUIInterval=null)},onShareAppMessage:function(e){var t="";return"menu"==e.from?t="top_forward":"subject-share-btn"==e.target.dataset.subRefer&&(t="big_sale_share"),this.$generateShareContent({title:"12.12狂欢节1折品牌清仓，年终疯抢！红包整点发放，入场领取>>",imageUrl:"http://minipinduoduo.oss-cn-shanghai.aliyuncs.com/promotion/promo_dec_venue/custom-share2.png",queries:{promotionId:this.promotionId},referStr:t,subjectId:this.promotionId,pageSn:10116,refer_xcx_campaign_d12:1})},share:function(e){(0,a.TrackingRecord)({op:"click",page_sn:10116,page_element:"share_btn"})},goTop:function(){if(wx.pageScrollTo){if(wx.pageScrollTo({scrollTop:0}),0===this.data.curTabIndex||this.data.$tabsData.length<=0)return;this.setDataObject={},this.segmentControl.updateSelectIndex(0),this.setDataObject.curTabIndex=0,this.setDataObject=Object.assign(this.setDataObject,this.segmentControl.$data()),this.setData(this.setDataObject)}},onPageScroll:function(e){var t=parseInt(e.scrollTop);if(this.scrollTop=t,u.default.showGoTopBtn(t,this),wx.createSelectorQuery){var a=this,o=wx.createSelectorQuery();o.select(".segemnt-main").boundingClientRect(),o.select(".promo-venue-container").boundingClientRect();for(var r in a.data.$tabsData){var n="#id-"+r;o.select(n).boundingClientRect()}o.exec(function(e){if(e&&e[0]&&e[1]&&e[0].top<0&&e[1].bottom>0?a.data.segmentFloat||a.setData({segmentFloat:!0}):a.data.segmentFloat&&a.setData({segmentFloat:!1}),e&&e[0]&&e[1]&&e[1].top<=0&&e[1].bottom>=0)for(var t in e)if(t>1&&e[t].top-e[0].height<=0&&e[t].bottom-e[0].height>0){a.data.curTabIndex!=t-2&&(a.setDataObject={},a.segmentControl.updateSelectIndex(t-2),a.setDataObject.curTabIndex=t-2,a.setDataObject=Object.assign(a.setDataObject,a.segmentControl.$data()),a.setData(a.setDataObject));break}})}},didClickSegmentTab:function(e){if(e&&e.target&&e.target.dataset){var t=e.target.dataset;if(wx.pageScrollTo&&wx.createSelectorQuery){var o=this,r=wx.createSelectorQuery(),n="#id-"+t.index;r.select(n).boundingClientRect(),r.select(".segemnt-main").boundingClientRect(),r.exec(function(e){e&&e[0]&&e[1]&&wx.pageScrollTo({scrollTop:o.scrollTop+e[0].top-e[1].height})})}if(t.index===this.data.curTabIndex)return;wx.pageScrollTo&&wx.createSelectorQuery?(this.setDataObject={},this.segmentControl.updateSelectIndex(t.index),this.setDataObject.curTabIndex=t.index,this.setDataObject=Object.assign(this.setDataObject,this.segmentControl.$data()),this.setData(this.setDataObject)):this.$showToast("微信版本较低无法跳转，您可以滑动查看对应商品");var s=this.data.$tabsData[this.data.curTabIndex],i=this.data.$tabsData[t.index];(0,a.TrackingRecord)({op:"click",page_sn:10116,page_el_sn:99322,tab_subject_id:i.id,subject_id:this.promotionId,sub_subject_id:s.id,refer_xcx_campaign_d12:1})}},getVenueBanner:c.default.wrap(d.default.mark(function e(t,o){var n,s,i;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=a.DataUtil.formatByPos(r.default.subjectRollMessage,t),s=a.Request.requestDataWithUrl("GET",n),e.next=5,a.Request.runSecondaryRequestForPage(s,o);case 5:if(!(i=e.sent).errorCode){e.next=9;break}return o.$showToast(i.errorMsg),e.abrupt("return");case 9:i&&i.subject&&wx.setNavigationBarTitle({title:i.subject}),i.banner_2=a.ImageUtil.cdnCompress(i.banner_2),o.setData({bannerInfo:i}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])})),getVenueTabInfo:c.default.wrap(d.default.mark(function e(t,n){var s,i,u,c,l,p;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=a.DataUtil.formatByPos(r.default.promoTabInfo,t),i=a.Request.requestDataWithUrl("GET",s),e.next=5,a.Request.runMainRequestForPage(i,n);case 5:if(!(u=e.sent).errorCode){e.next=10;break}return n.$showToast(u.errorMsg),n.setData({loadingVisible:!1,showError:!0}),e.abrupt("return");case 10:if(!(u.sub_promotions.length>0)){e.next=19;break}return c={id:t,subject:"精选爆款"},u.sub_promotions.unshift(c),l=n.formatTabInfo(u),e.next=16,n.getCarnivalVenueGoods(t,n,0);case 16:for(p=1;p<u.sub_promotions.length;p++)p==u.sub_promotions.length-1&&"猜你喜欢"==u.sub_promotions[p].subject?n.getRecommendGoods(u.sub_promotions[p].id,n,p):n.getCarnivalVenueGoods(u.sub_promotions[p].id,n,p);e.next=20;break;case 19:o.VenueSubject[t]?n.getCarnivalVenueGoods(t,n,0):n.getSubjectVenueGoods(t,n);case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(0),n.setData({loadingVisible:!1,showError:!0}),console.error(e.t0);case 26:case"end":return e.stop()}},e,this,[[0,22]])})),formatTabInfo:function(e){e&&e.sub_promotions&&e.sub_promotions.forEach(function(e){e.title=e.subject}),this.segmentControl.refreshTabsData(e.sub_promotions),this.setDataObject=s.default.assign(this.data,this.segmentControl.$data()),this.setData(this.setDataObject)},getCarnivalVenueGoods:c.default.wrap(d.default.mark(function e(o,n,s){var i,u,c,l,p,g;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=a.DataUtil.formatByPos(r.default.promoVenueGoods,o),u=a.Request.requestDataWithUrl("GET",i),e.next=5,a.Request.runMainRequestForPage(u,n);case 5:if(!(c=e.sent).errorCode){e.next=9;break}return 0===s&&(n.$showToast(c.errorMsg),n.setData({loadingVisible:!1,showError:!0})),e.abrupt("return");case 9:if(n.setData({loadingVisible:!1}),c&&c.list&&c.list.goods_list){for(l=n.filterGoods(c.list.goods_list);l.length>20;)p=n.formatVenueGoods(l.splice(0,20)),n.setData(t({},"list["+s+"]",n.data.list[s]?n.data.list[s].concat(p):p));g=n.formatVenueGoods(l),n.setData(t({},"list["+s+"]",n.data.list[s]?n.data.list[s].concat(g):g))}e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),0===s&&n.setData({loadingVisible:!1,showError:!0}),console.error(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,13]])})),getRecommendGoods:c.default.wrap(d.default.mark(function e(o,r,n){var s,i,u,c,l;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s="api/roewe/query?offset=0&count=40&app_name=industry_promotion&subject_id="+o,i=a.Request.requestDataWithUrl("GET",s),e.next=5,a.Request.runMainRequestForPage(i,r);case 5:if(!(u=e.sent).errorCode){e.next=8;break}return e.abrupt("return");case 8:u&&u.data&&(c=r.filterGoods(u.data),l=r.formatVenueGoods(c),r.setData(t({},"list["+n+"]",l))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}},e,this,[[0,11]])})),formatVenueGoods:function(e){if(Array.isArray(e)&&e.length>0){var t=[];return e.forEach(function(e){if(e.goodsId=e.goods_id,e.imgUrl=a.ImageUtil.cdnCompress(e.hd_thumb_url?e.hd_thumb_url:e.thumb_url),e.goodsName=e.goods_name,e.price=e.group?a.StdFormat.price(e.group.price,100):a.StdFormat.price(e.price,100),e.soldQuantity=a.StdFormat.sales(e.sales||e.cnt)||null,e.display_name&&(e.showPromFlag=!0,e.promFlagText=e.display_name,e.promFlagType="multiple-discount"),e.pick_num&&(e.showPromFlag=!0,e.promFlagText="限时免单"+e.pick_num+"件",e.promFlagType="limited-time-free"),e.init_quantity){e.showPromFlag=!0,e.promFlagType="limited-quantity-discount",e.promFlagText=e.init_quantity+"件限量疯抢";var o=Date.parse(new Date)/1e3;if(e.start_time>o){var r=new Date(1e3*e.start_time).getHours();e.promFlagText=r+"点限量"+e.init_quantity+"件"}}e.transData={ad:e.ad,p_rec:e.p_rec,p_search:e.p_search},t.push(e)}),t}},filterGoods:function(e){for(var t=[],a={},o=0;o<e.length;o++)1==e[o].is_app||a[e[o].goods_id]||(t.push(e[o]),a[e[o].goods_id]=1);return t},getSubjectVenueGoods:c.default.wrap(d.default.mark(function e(t,o){var n,s,i,u,c,l,p;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=o.page||1,s=20,i=[n,s].join("$"),!o.inRequest[i]){e.next=6;break}return e.abrupt("return");case 6:return o.inRequest[i]=!0,u=a.DataUtil.formatByPos(r.default.subjectGoodsApi,t,n,s),c=a.Request.requestDataWithUrl("GET",u),e.next=11,a.Request.runMainRequestForPage(c,o);case 11:if(l=e.sent,o.inRequest[i]=!1,o.setData({loadingVisible:!1}),!l.errorCode){e.next=18;break}return o.$showToast(l.errorMsg),1===n&&o.setData({showError:!0}),e.abrupt("return");case 18:l.goods_list=o.filterGoods(l.goods_list),(p=o.formatVenueGoods(l.goods_list))&&o.processSubjectVenueGoods({goodsList:p,loadAll:p.length<20}),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(0),1===page&&o.setData({loadingVisible:!1,showError:!0}),console.error(e.t0);case 27:case"end":return e.stop()}},e,this,[[0,23]])})),processSubjectVenueGoods:function(e){var a=this;a.nowPage=e.reqFlag;var o=a.data.list;if(o[0]=void 0==o[0]?[]:o[0],e.goodsList.length>0){var r;a.page=e.loadAll?a.page:a.page+1,a.setData((r={},t(r,"list[0]",o[0].concat(e.goodsList)),t(r,"canLoadMore",!e.loadAll),r))}else a.setData({canLoadMore:!1})},reLoad:function(){var e=this;this.setData({showError:!1,loadingVisible:!0}),(0,c.default)(d.default.mark(function t(){return d.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,[e.getVenueTabInfo(e.promotionId,e),e.getVenueBanner(e.promotionId,e)];case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}))},onReachBottom:function(){var e=this;e.data.canLoadMore&&e.getSubjectVenueGoods(e.promotionId,e)},submitFormId:function(e){var t=e.detail&&e.detail.formId;i.default.uploadFormIdToSH(t,!0)},gotoGoodsDetail:function(e){if(e&&e.currentTarget&&e.currentTarget.dataset&&e.currentTarget.dataset.goodsId){var t=e.currentTarget.dataset.goodsId;a.Navigation.route("/pages/goods/goods?goods_id="+t+"&xcx_campaign_id_01=big_sale");var o={op:"click",page_el_sn:99324,goods_id:t,idx:e.currentTarget.dataset.index,page_sn:10116,subject_id:this.promotionId,refer_xcx_campaign_d12:1},r=e.currentTarget.dataset.goodsItem;r&&(r.ad&&(o.ad=JSON.stringify(r.ad)),r.p_rec&&(o.p_rec=JSON.stringify(r.p_rec)),r.p_search&&(o.p_search=JSON.stringify(r.p_search)));var n=this.data.$tabsData[this.data.curTabIndex];n&&n.id&&(o.sub_subject_id=n.id),(0,a.TrackingRecord)(o)}},toNextVenue:function(e){var t=e.currentTarget.dataset.promotionId,o=e.detail&&e.detail.formId;i.default.uploadFormIdToSH(o,!0);var r={op:"click",page_sn:10116,subject_id:this.promotionId,refer_xcx_campaign_d12:1};0===t?(a.Navigation.forward("/package_a/promotion_main/promotion_main"),r.page_el_sn=99326):(r.page_el_sn=99325,r.tab_subject_id=t,a.Navigation.redirectForward("/package_a/promo_dec_venue/promo_dec_venue?promotionId="+t)),(0,a.TrackingRecord)(r)}};(0,a.PddPage)(g,{pageName:"promo_dec_venue",pageSn:10116,notUseCommonPV:!0}); 
 			}); 	require("package_a/promo_dec_venue/promo_dec_venue.js");
 	