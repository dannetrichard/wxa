	var __wxAppData = {}; 	var __wxRoute; 	var __wxRouteBegin; 	var __wxAppCode__ = {};	var global = {};	var __wxAppCurrentFile__; 	var Component = Component || function(){};	var Behavior = Behavior || function(){};
		define("pages/common/alertView/alertView.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){var t={};t.viewShow=!1,e.setData({alertViewData:t})}var t=getApp();module.exports={show:function(a,o,l){o.sScreen=t.globalData.sScreen,o.viewShow=!0,o.cancelText=o.cancelText||"知道了",a.setData({alertViewData:o}),l&&l.alertConfirm&&(a.alertConfirm=l.alertConfirm),l&&l.alertClose?a.alertClose=function(){l.alertClose(),e(a)}:a.alertClose=function(){e(a)},a.catchtouchmove=function(e){}},hide:e}; 
 			}); 
		define("pages/common/bankSupport/bankSupport.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function a(a){var n=a.data.bankInfoData||{};n.viewShow=!1,a.setData({bankInfoData:n})}var n=getApp();module.exports={show:function(t,e){for(var o={},r=[],h=parseInt(e.length/2)+e.length%2,i=0;i<h;i++){var s={};s.left=e[2*i].bankname,i<h-1?s.right=e[2*i+1].bankname:e[2*i+1]&&e[2*i+1].bankname?s.right=e[2*i+1].bankname:s.right="",r.push(s)}o.bankList=r,o.sScreen=n.globalData.sScreen,o.viewShow=!0,t.setData({bankInfoData:o}),t.bankSupportClose=function(){a(t)},t.catchtouchmove=function(a){}},hide:a}; 
 			}); 
		define("pages/common/htmlToWxml/html2json.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){return'"'+t+'"'}function e(t){return t.replace(/<\?xml.*\?>\n/,"").replace(/<!doctype.*\>\n/,"").replace(/<!DOCTYPE.*\>\n/,"")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.json2html=exports.html2json=void 0;var r=require("./htmlparser"),a=function(){};exports.html2json=function(t){t=e(t=(t||"").replace(/\s+/g," "));var n=[],i={node:"root",child:[]};return(0,r.HTMLParser)(t,{start:function(t,e,r){a(t,e,r);var o={node:"element",tag:t};if(0!==e.length&&(o.attr=e.reduce(function(t,e){var r=e.name,a=e.value;return a=((a=a.replace(/\s/g,"")).split(";")||[]).map(function(t){if(-1!=t.indexOf("px")){var e=t.split(":")[1],r=t.split(":")[0];if(e.split(/\s/g).length>1)return e.map(function(e){var a=Number.parseInt(e);return isNaN(a)?t:(a*=2,r+": "+a+"rpx;")});var a=Number.parseInt(e);return isNaN(a)?t:(a*=2,r+": "+a+"rpx;")}return t}).join(" "),t[r]?Array.isArray(t[r])?t[r].push(a):t[r]=[t[r],a]:t[r]=a,t},{})),["h1","h2","h3","h4","h5","h6","a","abbr","address","applet","acronym","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","head","header","hgroup","hr","html","i","iframe","img","input","ins","keygen","kbd","label","legend","li","link","map","mark","menu","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","ruby","s","samp","script","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","rt","section"].indexOf(t)>=0&&(o.attr&&o.attr.class?o.attr.class=o.attr.class+" "+t:(o.attr=o.attr||{},o.attr.class=t)),r){var s=n[0]||i;void 0===s.child&&(s.child=[]),s.child.push(o)}else n.unshift(o)},end:function(t){a(t);var e=n.shift();if(e.tag!==t&&console.error("invalid state: mismatch end tag"),0===n.length)i.child.push(e);else{var r=n[0];void 0===r.child&&(r.child=[]),r.child.push(e)}},chars:function(t){if(a(t)," "!=t){var e={node:"text",text:t};if(0===n.length)i.child.push(e);else{var r=n[0];void 0===r.child&&(r.child=[]),r.child.push(e)}}},comment:function(t){a(t);var e={node:"comment",text:t},r=n[0];void 0===r.child&&(r.child=[]),r.child.push(e)}}),i},exports.json2html=function e(r){var a=["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed"],n="";r.child&&(n=r.child.map(function(t){return e(t)}).join(""));var i="";if(r.attr&&""!==(i=Object.keys(r.attr).map(function(e){var a=r.attr[e];return Array.isArray(a)&&(a=a.join(" ")),e+"="+t(a)}).join(" "))&&(i=" "+i),"element"===r.node){var o=r.tag;return a.indexOf(o)>-1?"<"+r.tag+i+"/>":"<"+r.tag+i+">"+n+("</"+r.tag+">")}return"text"===r.node?r.text:"comment"===r.node?"\x3c!--"+r.text+"--\x3e":"root"===r.node?n:void 0}; 
 			}); 
		define("pages/common/htmlToWxml/htmlparser.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){for(var t={},n=e.split(","),a=0;a<n.length;a++)t[n[a]]=!0;return t}Object.defineProperty(exports,"__esModule",{value:!0});var t=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,n=/^<\/([-A-Za-z0-9_]+)[^>]*>/,a=/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,r=e("area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr"),o=e("a,address,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video"),i=e("abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),s=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),c=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),l=e("script,style"),d=exports.HTMLParser=function(e,d){function u(e,t){if(t)for(n=h.length-1;n>=0&&h[n]!=t;n--);else var n=0;if(n>=0){for(var a=h.length-1;a>=n;a--)d.end&&d.end(h[a]);h.length=n}}var m,p,f,h=[],b=e;for(h.last=function(){return this[this.length-1]};e;){if(p=!0,h.last()&&l[h.last()])e=e.replace(new RegExp("([\\s\\S]*?)</"+h.last()+"[^>]*>"),function(e,t){return t=t.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2"),d.chars&&d.chars(t),""}),u(0,h.last());else if(0==e.indexOf("\x3c!--")?(m=e.indexOf("--\x3e"))>=0&&(d.comment&&d.comment(e.substring(4,m)),e=e.substring(m+3),p=!1):0==e.indexOf("</")?(f=e.match(n))&&(e=e.substring(f[0].length),f[0].replace(n,u),p=!1):0==e.indexOf("<")&&(f=e.match(t))&&(e=e.substring(f[0].length),f[0].replace(t,function(e,t,n,l){if(t=t.toLowerCase(),o[t])for(;h.last()&&i[h.last()];)u(0,h.last());if(s[t]&&h.last()==t&&u(0,t),(l=r[t]||!!l)||h.push(t),d.start){var m=[];n.replace(a,function(e,t){var n=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:c[t]?t:"";m.push({name:t,value:n,escaped:n.replace(/(^|[^\\])"/g,'$1\\"')})}),d.start&&d.start(t,m,l)}}),p=!1),p){var g=(m=e.indexOf("<"))<0?e:e.substring(0,m);e=m<0?"":e.substring(m),d.chars&&d.chars(g)}if(e==b)throw"Parse Error: "+e;b=e}u()};exports.HTMLtoXML=function(e){var t="";return d(e,{start:function(e,n,a){t+="<"+e;for(var r=0;r<n.length;r++)t+=" "+n[r].name+'="'+n[r].escaped+'"';t+=">"},end:function(e){t+="</"+e+">"},chars:function(e){t+=e},comment:function(e){t+="\x3c!--"+e+"--\x3e"}}),t},exports.HTMLtoDOM=function(t,n){var a=e("html,head,body,title"),r={link:"head",base:"head"};n?n=n.ownerDocument||n.getOwnerDocument&&n.getOwnerDocument()||n:"undefined"!=typeof DOMDocument?n=new DOMDocument:"undefined"!=typeof document&&document.implementation&&document.implementation.createDocument?n=document.implementation.createDocument("","",null):"undefined"!=typeof ActiveX&&(n=new ActiveXObject("Msxml.DOMDocument"));var o=[];if(!(n.documentElement||n.getDocumentElement&&n.getDocumentElement())&&n.createElement&&function(){var e=n.createElement("html"),t=n.createElement("head");t.appendChild(n.createElement("title")),e.appendChild(t),e.appendChild(n.createElement("body")),n.appendChild(e)}(),n.getElementsByTagName)for(var i in a)a[i]=n.getElementsByTagName(i)[0];var s=a.body;return d(t,{start:function(e,t,i){if(a[e])return s=a[e],void(i||o.push(s));var c=n.createElement(e);for(var l in t)c.setAttribute(t[l].name,t[l].value);r[e]&&"boolean"!=typeof a[r[e]]?a[r[e]].appendChild(c):s&&s.appendChild&&s.appendChild(c),i||(o.push(c),s=c)},end:function(e){o.length-=1,s=o[o.length-1]},chars:function(e){s.appendChild(n.createTextNode(e))},comment:function(e){}}),n}; 
 			}); 
		define("pages/common/loanNotice/loanNotice.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){var a={};a.viewShow=!1,t.setData({loanNoticeData:a})}var a=getApp();module.exports={show:function(e){var o={sScreen:a.globalData.sScreen,dailyInterestRate:e.data.dailyInterestRate,viewShow:!0,prod:a.globalData.prod};e.setData({loanNoticeData:o}),e.loanNoticeClose=function(){t(e)},e.catchtouchmove=function(t){}},hide:t}; 
 			}); 
		define("pages/common/marketInfo/marketInfo.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){var a=t.data.marketInfo||{};a.viewShow=!1,t.setData({marketInfo:a})}var a=getApp();module.exports={show:function(e){var o=e.data.marketInfo||{};o.sScreen=a.globalData.sScreen,o.viewShow=!0,e.setData({marketInfo:o}),e.marketInfoClose=function(){t(e)},e.catchtouchmove=function(t){}},hide:t}; 
 			}); 
		define("pages/loan/bankCardView/bankCardView.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("../../../utils/util.js"),t=require("../../../utils/report.js"),e=require("../cardlist/cardlist.js"),r=require("../../common/alertView/alertView.js"),o=getApp();module.exports={bindPage:function(n){n.chooseBankCard=function(i){2!=n.data.loanState&&("1"==o.globalData.prod?t.report("","PayBankCardPickBut",1):t.report("","BankCardPickBut",1),2!=n.data.loan_status?r.show(n,{type:0,content:"你当前有未还清借款，暂不支持更换收款卡，如需帮助，请致电微众银行客服",cancelText:"取消",confirmText:"联系客服"},{alertConfirm:function(){"1"==o.globalData.prod?t.report("","PayUnpayWindowConnect",1):t.report("","UnpayWindowConnect",1),a.phoneCall("075589468888"),r.hide(n)},alertClose:function(){"1"==o.globalData.prod?t.report("","PayUnpayWindowCancel",1):t.report("","UnpayWindowCancel",1)}}):e.show(n))}}}; 
 			}); 
		define("pages/loan/cardlist/cardlist.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function a(a){var r={};r.viewShow=!1,a.setData({cardListData:r})}function r(a,r){for(var t,e=!1,i=0;i<r.length;i++){t=r[i];for(var o=0;o<a.length;o++)if(t.bind_serial==a[o].bind_serial){e=!0;break}{if(!e)return t;e=!1}}}var t=require("../../../utils/jsApiHelper.js"),e=require("../../../utils/dataManager.js"),i=require("../../../utils/loading.js"),o=require("../../../utils/report.js"),s=getApp();module.exports={show:function(n){var d=e.shareData.get("cardList");d&&d.length>0&&(d=e.sortCardlist(d));var c={};c.sScreen=s.globalData.sScreen,c.viewShow=!0,c.cardList=d||[],n.setData({cardListData:c}),n.cardListClose=function(){a(n)},n.chooseCard=function(r){var t=n.data.formData;t.card=r.currentTarget.dataset.card,n.setData({formData:t}),a(n)},n.bindCard=function(){"1"==s.globalData.prod?o.report("","PayNewBankCardBut",1):o.report("","BewBankCardBut",1);var d={};d="change-card"==s.globalData.account.type?{req_type:8}:{loan_token:n.data.loanOrderToken,req_type:6},t.bindCard(d,function(t){if(t)console.log("cardlist bindCard: ",t);else{i.show();var o=e.shareData.get("cardList");e.queryCard({},function(t,s){if(console.log("cardlist queryCard:",t,s),i.hide(),!t){if(0==s.array.length)return;var d=s.array,c=r(o,d),l=e.sortCardlist(s.array);if(c&&!c.forbid_word){for(var u,f=0;f<l.length;f++)if(l[f].bind_serial==c.bind_serial){u=f;break}l.splice(u,1),l.unshift(c);var h=n.data.formData;h.card=c,n.setData({formData:h})}e.shareData.set("cardList",l),a(n)}})}},n)},n.catchtouchmove=function(a){}},hide:a}; 
 			}); 
		define("pages/loan/couponsDialog/couponsDialog.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){var t={};t.viewShow=!1,e.setData({couponsData:t})}var t=require("../../../utils/util.js"),a=require("../../../utils/dataManager.js"),o=require("../../../utils/loading.js"),r=require("../../common/alertView/alertView.js"),i=getApp();module.exports={show:function(n){var u={is_first_loan:n.data.isFirstLoan?"Y":"N"};o.show(),a.queryrecommendticket(u,function(e,a){if(console.log("queryrecommendticket:",e,a),o.hide(),!e&&a.equity_list.length>0){for(var u=a.equity_list,s=0;s<u.length;s++)u[s]=t.equityDataPreHandle(u[s]);var c={};for(c.selectedItem=n.data.formData.equity,c.sScreen=i.globalData.sScreen,c.ratio=i.globalData.ratio,c.coupons=[],c.viewShow=!0,s=0;s<u.length;s++){var l=u[s];l.equity_expire_date=t.formatDate(l.equity_expire_date,"YYYY.MM.DD"),l=t.equityDataPreHandle(u[s]),c.coupons.push(l)}n.setData({couponsData:c})}else{r.show(n,{type:1,content:"没有可使用的优惠券",cancelText:"知道了"});var d=n.data.formData;d.equity=void 0,d.showRate=void 0,d.showOriginRate=void 0,n.setData({formData:d}),n.caculatePayDetailInfo(),n.randerRateTip()}}),n.couponClose=function(){e(n)},n.chooseCoupon=function(t){var a=n.data.formData;a.equity=t.currentTarget.dataset.coupon;var o=!t.currentTarget.dataset.coupon;n.setData({formData:a,noUseEquity:o}),n.randerRateTip(),n.caculatePayDetailInfo(),e(n)},n.catchtouchmove=function(e){}},hide:e}; 
 			}); 
		define("pages/loan/inputView/inputView.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("../../../utils/util.js"),t=require("../../../utils/report.js"),e=require("../../../utils/caculator.js"),n=getApp();module.exports={bindPage:function(o){o.inputLoanAmountFocus=function(){"1"==n.globalData.prod?t.report("","PayAmountInputBut",1):t.report("","AmountInputBut",1)},o.inputloanAmount=function(t){var e=t.detail.value,n=e;e=e.replace(/(^0+|\u200B)/g,"");var r=a.convertMoneyToHandle(e);if(/(^|\u200B)[0-9]*$/.test(r)){if(o.data.oldMoney>=1e4&&t.detail.value>=1e4)(i=o.getMoneyError(10*o.data.oldMoney))&&o.showAnimation(i.text);else if(e>=1e3){var i=o.getMoneyError(e);o.setData({allowLoan:!i}),!i||"tooMuch"!=i.type&&"overflow"!=i.type&&"noHundredMulriple-pre"!=i.type||o.showAnimation(i.text)}}else e="";if(o.data.formData.money=r,o.data.oldMoney=e,o.judgeShowRepayInfo(r)?(o.caculatePayDetailInfo(),o.setData({isValidAmount:!0,allowLoan:!0})):o.setData({isValidAmount:!1,allowLoan:!1}),n!=r)return{value:r,cursor:r.length}},o.judgeShowRepayInfo=function(a){return a>=500&&a%100==0&&a<=4e4},o.showAnimation=function(a){if(o.data.alertText!=a&&o.setData({alertText:a}),o.data.finish){o.animation.translate(0,40).step(),o.setData({animation:o.animation.export(),finish:!1});var t=o;setTimeout(function(){t.animation.translate(0,-40).step(),t.setData({animation:t.animation.export(),finish:!0})},3e3)}},o.caculatePayDetailInfo=function(){var t={interestRate:o.data.formData.rate.interest_rate,loanTerm:o.data.formData.rate.loan_term,firstRepayDay:o.data.new_loan_first_pmt_due_date,money:o.data.formData.money,startDate:o.data.formData.current_date,equity:o.data.formData.equity},n=o.data.repayPlanData||{};n.detailInfo=e.getRepayPlanData(t);var r=n.detailInfo.perMonth[o.data.formData.rate.loan_term-1];o.setData({repayPlanData:n,discount_amount:a.centToYuan(n.detailInfo.sunDiscount),endDate:r.year+"/"+r.month+"/"+r.day})}}}; 
 			}); 
		define("pages/loan/instalmentSteps.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t=require("../../utils/report.js"),a=(require("../../utils/view.js"),require("../../utils/util.js")),e=require("../../utils/loading.js"),o=require("../../utils/dataManager.js"),n=require("../../utils/pageManager.js"),r=require("../../utils/jsApiHelper.js"),i=getApp();module.exports={bindPage:function(l){l.changeLoanState=function(){0==l.data.loanState?l.data.accountViewShow?l.secondStep():l.firstStep():1==l.data.loanState?l.thirdStep():2==l.data.loanState&&l.lastStep()},l.firstStep=function(){var a=l.getMoneyError(l.data.formData.money);if(a)l.showAnimation(a.text);else if(l.data.allowLoan){if(l.setData({isloading:!0}),!i.btnAllowClick(l.data.eventControl))return;t.report("","PayAmountNextBut",1);var e=i.globalData.account;e.is_first_loan&&"Y"==e.is_first_loan&&t.report("","PayAmountNextBut-firsttime",1),l.loanOrder(function(a,e){l.setData({isloading:!1}),a?(l.showDialog(a.msg,"知道了"),i.btnRecover(l.data.eventControl)):(t.report("PayCompletebrand"),e.is_first_loan&&"Y"==e.is_first_loan&&t.report("","PayCompletebrand-firsttime",1),l.setData({loanState:0}),l.setData({accountViewShow:!0,inputDisabled:!0,allowLoan:!1}),l.scrollTo(1e3*i.globalData.ratio,"accountView",function(){var t=l;setTimeout(function(){i.btnRecover(t.data.eventControl),l.setData({account_focus:!0})},300)}))})}},l.secondStep=function(){t.report("","PayCombrandNextBut",1);var a=i.globalData.account;if(a.is_first_loan&&"Y"==a.is_first_loan&&t.report("","PayCombrandNextBut-firsttime",1),l.data.accountNum.length<4)return l.showAnimation("请先补全商家收款账号"),void l.setData({account_focus:!0});l.data.marketInfo.mct_acct_no_suffix==l.data.accountNum?(l.setData({bankViewShow:!0,loanState:1}),t.report("PayBankCardPick"),a.is_first_loan&&"Y"==a.is_first_loan&&t.report("","PayBankCardPick-fristtime",1),l.scrollTo(840*i.globalData.ratio,"bankView",function(){var t=l;setTimeout(function(){i.btnRecover(t.data.eventControl)},300)})):l.showDialog("输入的账号信息有误，请核实后再次输入","知道了")},l.thirdStep=function(){if(i.btnAllowClick(l.data.eventControl)){t.report("","PayBankCardNextBut",1);var a=i.globalData.account;if(a.is_first_loan&&"Y"==a.is_first_loan&&t.report("","BankCardNextBut-firsttime",1),!l.data.formData.card)return l.showDialog("请添加一张银行卡","知道了"),void i.btnRecover(l.data.eventControl);if(2!=l.data.loan_status){if(l.data.formData.card.forbid_word)return l.showDialog(l.data.formData.card.bank_name+l.data.formData.card.forbid_word,"知道了"),void i.btnRecover(l.data.eventControl)}else{if(l.data.formData.card.forbid_word&&l.data.hadOtherCard)return l.showDialog("请选择一张银行卡","知道了"),void i.btnRecover(l.data.eventControl);if(l.data.formData.card.forbid_word&&!l.data.hadOtherCard)return l.showDialog("请添加一张银行卡","知道了"),void i.btnRecover(l.data.eventControl)}t.report("PayReceiptConfirm"),a.is_first_loan&&"Y"==a.is_first_loan&&t.report("","PayReceiptConfirm-firsttime",1),l.setData({loanState:2}),l.setData({bankViewShow:!0,confirmViewShow:!0,buttonTitle:"确认借钱"}),l.data.needFillInfo&&(l.setData({inputInfoShow:!0,allowLoan:!1}),setTimeout(function(){l.setData({name_focus:!0})},1e3)),l.scrollTo(1300*i.globalData.ratio,"confirmView",function(){var t=l;setTimeout(function(){i.btnRecover(t.data.eventControl)},300)})}},l.lastStep=function(){if(i.btnAllowClick(l.data.eventControl)){t.report("","PayReceiptNextBut",1);var a=i.globalData.account;a.is_first_loan&&"Y"==a.is_first_loan&&t.report("","PayReceiptNextBut-firsttime",1),l.data.allowLoan?l.data.needFillInfo?l.checkUserInfo():l.next():l.data.needFillInfo&&((l.data.serverUserInfo.inputName.length<=0||l.data.serverUserInfo.id.length<4)&&(l.showAnimation("请先补全身份信息"),l.data.serverUserInfo.inputName.length<=0?l.setData({name_focus:!0}):l.data.serverUserInfo.id.length<4&&l.setData({idcard_focus:!0})),i.btnRecover(l.data.eventControl))}},l.checkUserInfo=function(){var t=l.data.serverUserInfo;/^[0-9]{3,3}$/.test(t.id.substr(0,3))&&/^[0-9xX]{1,1}$/.test(t.id.substr(3,3))?(e.show(),o.activeAccount({name:t.inputName,id:t.id},function(t,a){console.log("instalmentSteps activeAccount:",t,a),t?(l.showDialog(t.msg||"用户名身份证校验失败","知道了"),i.btnRecover(l.data.eventControl),e.hide()):"Y"==a.activate_flag?l.next():(l.showDialog("用户名身份证校验失败","知道了"),i.btnRecover(l.data.eventControl),e.hide())},l)):(l.showAnimation("请输入合法的身份证后四位"),i.btnRecover(l.data.eventControl))},l.next=function(){"1"==l.data.cust_type?n.push("staffToken"):l.submit()},l.submit=function(t){if(l.data.needFillInfo){var a=l.data.serverUserInfo;l.loanConfirm(l.data.loanOrderToken,a,t)}else l.loanConfirm(l.data.loanOrderToken,!1,t)},l.loanOrder=function(t){var a={token_scene:2,tran_amt:100*parseInt(l.data.formData.money),term:l.data.formData.rate.loan_term,card_no:i.globalData.account.card_no};l.data.formData.equity&&(a.list_no=l.data.formData.equity.list_no,a.equity_type=l.data.formData.equity.equity_type,a.equity_value=l.data.formData.equity.equity_value),"1"==i.globalData.prod&&(a.market_brand_no=i.globalData.marketNo,a.mct_name=l.data.marketInfo.mct_name,a.mct_acct_no=l.data.marketInfo.mct_acct_no,a.prod=i.globalData.prod),o.loanOrder(a,function(a,e){if(console.log("instalmentSteps loanOrder: ",a,e),a)a.result?"1"===a.result.errortype?n.goto("warning",{reason:a.msg,result:"无法借钱",tips:!0}):"2"===a.result.errortype?n.goto("infoWarning"):t(a):t(a);else{var o=e.loan_token||"",r=e.anti_fraud_no||"",i=l.data.serverUserInfo;i.id_no=e.id_no,i.surname=e.surname,i.name=e.name,i.mobile_no=e.mobile_no,i.id_type=e.id_type;var s=l.data.formData;s.bank_group_id=e.bank_group_id,s.banks=e.banks;for(var d="",c=0;c<e.banks.length;c++)0==c?d=e.banks[c].bank_name:d+="、"+e.banks[c].bank_name;l.setData({loanOrderToken:o,anti_fraud_no:r,serverUserInfo:i,formData:s,banks:d}),t(null,e)}},l)},l.loanConfirm=function(t,s,d){e.show(),r.getCftToken({req_type:2,loan_token:t,bind_serial:l.data.formData.card.bind_serial,bank_type:l.data.formData.card.bank_type},function(r,c){if(console.log("instalmentSteps getCftToken: ",r,c),r)i.btnRecover(l.data.eventControl),e.hide();else{var f={token_scene:2,loan_token:t,cft_token:c,bind_serial:l.data.formData.card.bind_serial,bank_type:l.data.formData.card.bank_type,card_no:i.globalData.account.card_no,anti_fraud_no:l.data.anti_fraud_no,interest_rate:l.data.formData.rate.interest_rate,penalty_rate:l.data.formData.rate.penalty_rate,bank_group_id:l.data.formData.bank_group_id,contract_ver:l.data.contract_ver,req_time:a.getDateForServer(),prod:i.globalData.prod};s&&(f.true_name=s.name,f.credid_tail=s.id),l.data.formData.showRate&&(f.interest_rate=(l.data.formData.showRate/100).toFixed(6),f.orig_interest_rate=(l.data.formData.showOriginRate/100).toFixed(6),f.penalty_rate&&(f.penalty_rate=(1e6*f.interest_rate*1.5/1e6).toFixed(6),f.orig_penalty_rate=(1e6*f.orig_interest_rate*1.5/1e6).toFixed(6))),d&&(f.staff_token=d.staff_token),e.show(),o.loanConfirm(f,function(t,a){console.log("instalmentSteps loanConfirm: ",t,a),i.btnRecover(l.data.eventControl),e.hide(),t?t.result.block_type&&"voipcall"==t.result.block_type?n.goto("needvoipcall",{caseType:4,fromPage:"instalmentCredit"}):(t.result.loan_init_prin=100*l.data.formData.money,"30937013"==t.code||"30937063"==t.code?n.goto("phonecheck",t.result):"30938725"==t.code||"30938726"==t.code||"30938727"==t.code?n.goto("maintaining",t.result):n.goto("loanResultCertificate",t.result)):(a.loan_init_prin=100*l.data.formData.money,n.goto("loanResultCertificate",a))},l)}},l)}}}; 
 			}); 
		define("pages/loan/loanDetail/loanDetail.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";require("../../../utils/util.js");var a=require("../../../utils/dataManager.js"),t=require("../../../utils/loading.js"),o=require("../couponsDialog/couponsDialog.js"),e=require("../repayPlan/repayPlan.js"),n=require("../../common/bankSupport/bankSupport.js"),r=require("../../../utils/report.js"),u=getApp(),i=[5,10,20];module.exports={bindPage:function(p){p.changeCoupon=function(){o.show(p)},p.chooseRepayCount=function(){0!=p.data.loanState||p.data.accountViewShow||wx.showActionSheet({itemList:["5个月","10个月","20个月"],success:function(a){if(!a.cancel){var t=p.data.formData;t.rate.loan_term=i[a.tapIndex],p.setData({formData:t}),p.caculatePayDetailInfo()}}})},p.checkRepaylist=function(){"1"==u.globalData.prod?r.report("","PayCheckDetailBut",1):r.report("","CheckDetailBut",1),e.show(p)},p.checkBankList=function(){"1"==u.globalData.prod?r.report("","PayBankSupportBut",1):r.report("","BankSupportBut",1),t.show(),a.querySupportbank({},function(a,o){console.log("loanDetail querySupportbank: ",a,o),t.hide(),!a&&o.bankInfo.length>0&&n.show(p,o.bankInfo)},p)}}}; 
 			}); 
		define("pages/loan/loanStepInfo/loanStepInfo.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){t.setData({allowLoan:t.data.serverUserInfo.inputName.length>0&&4===t.data.serverUserInfo.id.length})}var a=require("../../../utils/report.js"),e=require("../../../utils/pageManager.js");getApp();module.exports={bindPage:function(r){r.inputName=function(a){var e=r.data.serverUserInfo;e.inputName=a.detail.value,r.setData({serverUserInfo:e}),t(r)},r.inputNameblur=function(t){t.detail.value&&r.setData({idcard_focus:!0})},r.inputIDCard=function(a){var e=r.data.serverUserInfo;e.id=a.detail.value,r.setData({serverUserInfo:e}),t(r)},r.showReceiptDetail=function(){r.setData({isShowDetail:!r.data.isShowDetail})},r.checkAgreement=function(){var t=getApp();if(t.btnAllowClick(r.data.eventControl)){"1"==t.globalData.prod?a.report("","PayRelContractBut",1):a.report("","RelContractBut",1);var n=r.data.contract_ver;"1"!=t.globalData.prod&&"Y"==r.data.formData.card.pro_acct_flag&&(n=n+";"+t.globalData.newContract),e.showContractList(1,n,function(){t.btnRecover(r.data.eventControl)})}}}}; 
 			}); 
		define("pages/loan/loanSteps.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("../../utils/report.js"),t=require("../../utils/view.js"),e=require("../../utils/util.js"),o=require("../../utils/loading.js"),r=require("../../utils/dataManager.js"),n=require("../../utils/pageManager.js"),i=require("../../utils/jsApiHelper.js"),l=(t.general,getApp());module.exports={bindPage:function(t){t.changeLoanState=function(){0==t.data.loanState?t.firstStep():1==t.data.loanState?t.secondStep():2==t.data.loanState&&t.lastStep()},t.firstStep=function(){var e=t.getMoneyError(t.data.formData.money);if(e)t.showAnimation(e.text);else if(t.data.allowLoan){if(t.setData({isloading:!0}),!l.btnAllowClick(t.data.eventControl))return;a.report("","AmountNextBut",1);var o=l.globalData.account;o.is_first_loan&&"Y"==o.is_first_loan&&a.report("","AmountNextBut-firsttime",1),t.loanOrder(function(e,o){console.log("loanSteps loanOrder: ",e,o),t.setData({isloading:!1}),e?(t.showDialog(e.msg,"知道了"),l.btnRecover(t.data.eventControl)):(a.report("BankCardPick"),o.is_first_loan&&"Y"==o.is_first_loan&&a.report("","BankCardPick-fristtime",1),t.setData({loanState:1}),t.setData({bankViewShow:!0,confirmViewShow:!1,inputDisabled:!0}),t.scrollTo(840*l.globalData.ratio,"bankView",function(){var a=t;setTimeout(function(){l.btnRecover(a.data.eventControl)},300)}))})}},t.secondStep=function(){if(l.btnAllowClick(t.data.eventControl)){a.report("","BankCardNextBut",1);var e=l.globalData.account;if(e.is_first_loan&&"Y"==e.is_first_loan&&a.report("","BankCardNextBut-firsttime",1),!t.data.formData.card)return t.showDialog("请添加一张银行卡","知道了"),void l.btnRecover(t.data.eventControl);if(2!=t.data.loan_status){if(t.data.formData.card.forbid_word)return t.showDialog(t.data.formData.card.bank_name+t.data.formData.card.forbid_word,"知道了"),void l.btnRecover(t.data.eventControl)}else{if(t.data.formData.card.forbid_word&&t.data.hadOtherCard)return t.showDialog("请选择一张银行卡","知道了"),void l.btnRecover(t.data.eventControl);if(t.data.formData.card.forbid_word&&!t.data.hadOtherCard)return t.showDialog("请添加一张银行卡","知道了"),void l.btnRecover(t.data.eventControl)}a.report("ReceiptConfirm"),e.is_first_loan&&"Y"==e.is_first_loan&&a.report("","ReceiptConfirm-firsttime",1),t.setData({loanState:2}),t.setData({bankViewShow:!0,confirmViewShow:!0,buttonTitle:"确认借钱"}),t.data.needFillInfo&&(t.setData({inputInfoShow:!0,allowLoan:!1}),setTimeout(function(){t.setData({name_focus:!0})},1e3)),t.scrollTo(1300*l.globalData.ratio,"confirmView",function(){var a=t;setTimeout(function(){l.btnRecover(a.data.eventControl)},300)})}},t.lastStep=function(){if(l.btnAllowClick(t.data.eventControl)){a.report("","ReceiptNextBut",1);var e=l.globalData.account;e.is_first_loan&&"Y"==e.is_first_loan&&a.report("","ReceiptNextBut-firsttime",1),t.data.allowLoan?t.data.needFillInfo?t.checkUserInfo():t.next():t.data.needFillInfo&&((t.data.serverUserInfo.inputName.length<=0||t.data.serverUserInfo.id.length<4)&&(t.showAnimation("请先补全身份信息"),t.data.serverUserInfo.inputName.length<=0?t.setData({name_focus:!0}):t.data.serverUserInfo.id.length<4&&t.setData({idcard_focus:!0})),l.btnRecover(t.data.eventControl))}},t.checkUserInfo=function(){var a=t.data.serverUserInfo;/^[0-9]{3,3}$/.test(a.id.substr(0,3))&&/^[0-9xX]{1,1}$/.test(a.id.substr(3,3))?(o.show(),r.activeAccount({name:a.inputName,id:a.id},function(a,e){console.log("loanSteps activeAccount: ",a,e),a?(t.showDialog(a.msg||"用户名身份证校验失败","知道了"),l.btnRecover(t.data.eventControl),o.hide()):"Y"==e.activate_flag?t.next():(t.showDialog("用户名身份证校验失败","知道了"),l.btnRecover(t.data.eventControl),o.hide())},t)):(t.showAnimation("请输入合法的身份证后四位"),l.btnRecover(t.data.eventControl))},t.next=function(){"1"==t.data.cust_type?n.push("staffToken"):t.submit()},t.submit=function(a){if(t.data.needFillInfo){var e=t.data.serverUserInfo;t.loanConfirm(t.data.loanOrderToken,e,a)}else t.loanConfirm(t.data.loanOrderToken,!1,a)},t.loanOrder=function(a){var e={token_scene:2,tran_amt:100*parseInt(t.data.formData.money),term:t.data.formData.rate.loan_term,card_no:l.globalData.account.card_no};t.data.formData.equity&&(e.list_no=t.data.formData.equity.list_no,e.equity_type=t.data.formData.equity.equity_type,e.equity_value=t.data.formData.equity.equity_value),r.loanOrder(e,function(e,o){if(console.log("loanSteps loanOrder: ",e,o),e)e.result?"1"===e.result.errortype?n.goto("warning",{reason:e.msg,result:"无法借钱",tips:!0}):"2"===e.result.errortype?n.goto("infoWarning"):a(e):a(e);else{var r=o.loan_token||"",i=o.anti_fraud_no||"",l=t.data.serverUserInfo;l.id_no=o.id_no,l.surname=o.surname,l.name=o.name,l.mobile_no=o.mobile_no,l.id_type=o.id_type;var s=t.data.formData;s.bank_group_id=o.bank_group_id,s.banks=o.banks;for(var d="",f=0;f<o.banks.length;f++)0==f?d=o.banks[f].bank_name:d+="、"+o.banks[f].bank_name;t.setData({loanOrderToken:r,anti_fraud_no:i,serverUserInfo:l,formData:s,banks:d}),a(null,o)}},t)},t.loanConfirm=function(a,s,d){var f=t.data.contract_ver;"1"!=l.globalData.prod&&"Y"==t.data.formData.card.pro_acct_flag&&(f=f+";"+l.globalData.newContract),o.show(),i.getCftToken({req_type:2,loan_token:a,bind_serial:t.data.formData.card.bind_serial,bank_type:t.data.formData.card.bank_type},function(i,c){if(console.log("loanSteps getCftToken: ",i,c),i)l.btnRecover(t.data.eventControl),o.hide();else{var _={token_scene:2,loan_token:a,cft_token:c,bind_serial:t.data.formData.card.bind_serial,bank_type:t.data.formData.card.bank_type,card_no:l.globalData.account.card_no,anti_fraud_no:t.data.anti_fraud_no,interest_rate:t.data.formData.rate.interest_rate,penalty_rate:t.data.formData.rate.penalty_rate,bank_group_id:t.data.formData.bank_group_id,contract_ver:f,req_time:e.getDateForServer()};s&&(_.true_name=s.name,_.credid_tail=s.id),"1"!=l.globalData.prod&&t.data.formData.card&&t.data.formData.card.pro_acct_flag&&(_.pro_acct_flag=t.data.formData.card.pro_acct_flag),t.data.formData.showRate&&(_.interest_rate=(t.data.formData.showRate/100).toFixed(6),_.orig_interest_rate=(t.data.formData.showOriginRate/100).toFixed(6),_.penalty_rate&&(_.penalty_rate=(1e6*_.interest_rate*1.5/1e6).toFixed(6),_.orig_penalty_rate=(1e6*_.orig_interest_rate*1.5/1e6).toFixed(6))),d&&(_.staff_token=d.staff_token),o.show(),r.loanConfirm(_,function(a,e){console.log("loanSteps loanConfirm: ",a,e),l.btnRecover(t.data.eventControl),o.hide(),a?a.result.block_type&&"voipcall"==a.result.block_type?n.goto("needvoipcall",{caseType:1,fromPage:"loan"}):n.goto("loanResult",a.result):n.goto("loanResult",e)},t)}},t)}}}; 
 			}); 
		define("pages/loan/repayPlan/repayPlan.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function a(a){var t=a.data.repayPlanData||{};t.viewShow=!1,a.setData({repayPlanData:t})}var t=getApp();module.exports={show:function(e){var n=e.data.repayPlanData||{};n.sScreen=t.globalData.sScreen,n.viewShow=!0,n.scrollTop=0,e.setData({repayPlanData:n}),e.repayPlanClose=function(){a(e)},e.catchtouchmove=function(a){}},hide:a}; 
 			}); 
		define("pages/records/loanCertificate/loanCertificate.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){var a=t.data.certificateInfoData||{};a.viewShow=!1,t.setData({certificateInfoData:a})}var a=getApp();module.exports={show:function(e){var c=e.data.certificateInfoData||{};c.sScreen=a.globalData.sScreen,c.viewShow=!0,e.setData({certificateInfoData:c}),e.certificateInfoClose=function(){t(e)},e.catchtouchmove=function(t){}},hide:t}; 
 			}); 
		define("pages/verifyFourElements/phoneTips/phoneTips.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){var a={};a.viewShow=!1,t.setData({tipsData:a})}var a=getApp();module.exports={show:function(e){var o={sScreen:a.globalData.sScreen,viewShow:!0};e.setData({tipsData:o}),e.tipClose=function(){t(e)},e.catchtouchmove=function(t){}},hide:t}; 
 			}); 
		define("pages/verifyFourElements/smsVerify/smsCodeTips/smsCodeTips.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){var a={};a.viewShow=!1,t.setData({tipsData:a})}var a=getApp();module.exports={show:function(e){var o={sScreen:a.globalData.sScreen,viewShow:!0};e.setData({tipsData:o}),e.tipClose=function(){t(e)},e.catchtouchmove=function(t){}},hide:t}; 
 			}); 
		define("utils/caculator.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function t(t){for(var n,u,o=t.interestRate,i=t.loanTerm,y=t.money,l=t.firstRepayDayObj,c=0,d=0,p=100*y/i,h=a(l,i),f=r(p,i),m=0;m<h.length;m++)(n=h[m]).principal=u=f[m],d=Math.round(n.dayCount*u*o),n.interest=d,n.originalPay=n.shouldPay=p+d,c+=d,n.isPercentEquity=t.equity&&"percent"==t.equity.js_equity_type;var P={repayDay:l.day,repayMonth:l.month,perMonth:h,sumInterest:c,shouldPaySumInterest:c,onePart:p};e(P,t.equity,o),P.sumInterest=s.centToYuan(P.sumInterest),P.shouldPaySumInterest=s.centToYuan(P.shouldPaySumInterest),P.onePart=s.centToYuan(P.onePart);for(m=0;m<h.length;m++)(n=h[m]).originalPay=s.centToYuan(n.originalPay),n.shouldPay=s.centToYuan(n.shouldPay);return P}function e(t,e,r){n(t,e,r);for(var a,u=t.perMonth,o=0,i=0;i<u.length;i++)(a=u[i]).shouldPay=a.originalPay-a.discount,o+=a.discount;t.shouldPaySumInterest=t.sumInterest-o,t.sunDiscount=o}function n(t,e,n){var r,a=t.perMonth;if(e&&"day"==e.js_equity_type)for(var u=e.equity_value,o=0;o<a.length;o++)r=a[o],u>0?u<=r.dayCount?(r.discount=u*r.principal*n,u-=u):(r.discount=r.dayCount*r.principal*n,u-=r.dayCount):r.discount=0;else if(e&&"percent"==e.js_equity_type)for(o=0;o<a.length;o++)(r=a[o]).discount=r.interest-r.dayCount*r.principal*e.js_new_rate/100;else for(o=0;o<a.length;o++)a[o].discount=0}function r(t,e){for(var n=[],r=0;r<e;r++)n.push(t*(e-r));return n}function a(t,e){var n,r,a,y=t.month,l=t.year,c=0,d=[],p=e;if(2==o(y,i.month)){var h=o(y,2);c=u(i.year,h)-(i.day-t.day)}else c=t.day-i.day;for(var f=0;f<p;f++)(a=o(r=(y+f)%12||12,1))-1,n=u(l,a),1==r&&0!=f&&l++,0==f&&(n+=c),d.push({day:s.zeroFill(t.day),month:s.zeroFill(r),dayCount:n,year:l});return d}function u(t,e){return[31,t%400&&(!(t%100)||t%4)?28:29,31,30,31,30,31,31,30,31,30,31][e-1]}function o(t,e){var n=t-e;return n>0?n:12+n}var i,s=require("util.js");module.exports={getRepayPlanData:function(e){var n=e.startDate,r=e.firstRepayDay,a=parseInt(n.slice(0,4)),u=parseInt(n.slice(4,6)),o=parseInt(n.slice(6,8));i={year:a,month:u,day:o},e.firstRepayDayObj={year:parseInt(r.slice(0,4)),month:parseInt(r.slice(4,6)),day:parseInt(r.slice(6,8))};var s=t(e);return s.currentEquity=e.equity,s}}; 
 			}); 
		define("utils/dataManager.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e,t){t?a(e):wx.checkSession({success:function(t){l?n(e):a(e)},fail:function(n){a(e)}})}function n(e){var n=getApp().runEnvironment.apiDomain;c.request({url:n+k.getpassticket,data:{access_token:l,x_key:i},method:"POST",success:function(n){if("0"==n.data.retcode)s=n.data.pass_ticket,e(!0);else{n.data.retmsg||n.errMsg;e(!1)}},fail:function(){e(!1)}})}function a(e){getApp();wx.login({success:function(n){var a=getApp().runEnvironment.apiDomain;c.request({url:a+k.login,data:{code:n.code,appid:getApp().runEnvironment.appid},method:"POST",success:function(n){if("0"==n.data.retcode)l=n.data.access_token,i=n.data.x_key,r.initParams(i),s=n.data.pass_ticket,e(!0);else{n.data.retmsg||n.errMsg;e(!1)}},fail:function(){e(!1)}})}})}function t(n,a,b,p,f,d){var y=getApp().runEnvironment.apiDomain,f=f||0;a.access_token=l,a.x_key=i,a.pass_ticket=s,a.channelid=getApp().globalData.channelId;var w=d;c.request({url:y+k[n],data:a,method:b,success:function(c){var i=c.data;if("0"==i.retcode)null!=p&&p(null,i,w);else if("403"==i.retcode)0==f?e(function(e){if(e)t(n,a,b,p,1,w);else{p&&o.showLoginException()}}):(r.log(n,i),p&&((l=u.getPassError(i))?p(l,null,w):p(null,i,w)));else if(r.log(n,i),p){var l=u.getPassError(i);l?p(l,null,w):p(null,i,w)}},fail:function(e){r.log(n,e);var a={msg:"系统繁忙，请重新尝试",code:"error",type:"server-pass-error",result:{}};p&&p(a,null,w)},complete:function(){}})}var c=require("requestHelper.js"),r=(require("pageManager.js"),require("report.js")),o=require("view.js"),u=require("error.js"),i=(getApp(),null),l=null,s=null,k={login:"/webank/webankchecklogin",getpassticket:"/webank/webankgetpassticket",checkwhite:"/webank/webankcheckwhite",prenotify:"/webank/webankprenotify",getSign:"/webank/webankgenjsapisign",openaccount:"/webank/webankopenaccount",querycard:"/webank/webankquerycard",rate:"/webank/webankqueryrate",loanOrder:"/webank/webankloanapi",loanConfirm:"/webank/webankloanconfirm",activeAccount:"/webank/webankactiveaccount",queryCredit:"/webank/webankquerycredit",loanDetail:"/webank/webankqueryloandetail",repayOrder:"/webank/webankrepayapi",repayConfirm:"/webank/webankrepayconfirm",queryForwardRepay:"/webank/webankqueryforwardrepay",queryloanbydate:"/webank/webankqueryloanbydate",queryLoanRecord:"/webank/webankqueryloanrecord",queryRepayRecord:"/webank/webankqueryrepayrecord",queryAccount:"/webank/webankqueryaccount",querysupportbank:"/webank/webankquerysupportbank",subscribe:"/webank/webanksubscribe",changecard:"/webank/webankchangecard",changecardconfirm:"/webank/webankchangecardconfirm",checkstafftoken:"/webank/webankcheckstafftoken",queryrecommendticket:"/webank/webankqueryrecommendticket",queryequity:"/webank/webankqueryequity",noopenqueryequity:"/webank/webanknoopenqueryequity",facequery:"/webank/webankfacequery",closeaccount:"/webank/webankcloseaccount",closequery:"/webank/webankclosequery",restartAccount:"/webank/webankrestartaccount",checkcustinfo:"/webank/webankcheckcustinfo",checkcustquery:"/webank/webankcheckcustquery",smssend:"/webank/webanksmssend",smscheck:"/webank/webanksmscheck",namecheckedopenaccount:"/webank/webanknamecheckedopenaccount",bankcustquery:"/webank/webankbankcustquery",checkpayresult:"/webank/webankcheckpayresult",queryloanstatus:"/webank/webankqueryloanstatus",weehoursphonecall:"/webank/webankweehoursphonecall"},b={};module.exports={shareData:{get:function(e){return b[e]},set:function(e,n){return b[e]=n,b}},apiMap:k,getXKey:function(){return i},login:e,queryAccount:function(e,n,a){e.channelid=getApp().globalData.channelId;var c=getApp().globalData.marketNo;null!=c&&(e.market_brand_no=c,e.market_act_no=getApp().globalData.marketActNo,e.prod=getApp().globalData.prod),t("queryAccount",e,"POST",function(e,a,t){if(e)n(e,a,t);else{var c=getApp();c.globalData.account=a,"Y"!=a.active?c.globalData.customerId=3:"Y"==a.is_first_loan?c.globalData.customerId=4:"Y"!=a.is_first_loan&&(c.globalData.customerId=5),n(null,a,t)}},0,a)},getSign:function(e,n,a){e.appid=getApp().runEnvironment.appid,t("getSign",e,"POST",n,0,a)},prenotify:function(e,n,a){t("prenotify",e,"POST",n,0,a)},openaccount:function(e,n,a){var c=getApp().globalData.marketNo;null!=c&&(e.market_brand_no=c,e.prod=getApp().globalData.prod),t("openaccount",e,"POST",n,0,a)},queryCredit:function(e,n,a){t("queryCredit",e,"POST",n,0,a)},loanOrder:function(e,n,a){t("loanOrder",e,"POST",n,0,a)},checkStaffToken:function(e,n,a){t("checkstafftoken",e,"POST",n,0,a)},queryCard:function(e,n,a){t("querycard",e,"POST",n,0,a)},querySupportbank:function(e,n,a){t("querysupportbank",e,"POST",n,0,a)},subscribe:function(e,n,a){t("subscribe",e,"POST",n,0,a)},loanConfirm:function(e,n,a){t("loanConfirm",e,"POST",n,0,a)},activeAccount:function(e,n,a){t("activeAccount",e,"POST",n,0,a)},queryLoanRecord:function(e,n,a){t("queryLoanRecord",e,"POST",n,0,a)},queryRepayRecord:function(e,n,a){t("queryRepayRecord",e,"POST",n,0,a)},loanDetail:function(e,n,a){t("loanDetail",e,"POST",n,0,a)},queryForwardRepay:function(e,n,a){t("queryForwardRepay",e,"POST",n,0,a)},queryloanbydate:function(e,n,a){t("queryloanbydate",e,"POST",n,0,a)},repayOrder:function(e,n,a){t("repayOrder",e,"POST",n,0,a)},repayConfirm:function(e,n,a){t("repayConfirm",e,"POST",n,0,a)},queryrecommendticket:function(e,n,a){t("queryrecommendticket",e,"POST",n,0,a)},queryequity:function(e,n,a){t("queryequity",e,"POST",n,0,a)},noopenqueryequity:function(e,n,a){t("noopenqueryequity",e,"POST",n,0,a)},getDefaultCard:function(e,n){var a,t;if(n)for(var c=0;c<e.length;c++)if((t=e[c]).bind_serial==n){a=t;break}return a},sortCardlist:function(e){if(0!=e.length){var n=e.sort(function(e,n){return e.bankacc_type==n.bankacc_type?Number(e.forbid_word?"2":"1")-Number(n.forbid_word?"2":"1"):Number(e.bankacc_type)-Number(n.bankacc_type)}),a=this.shareData.get("defauldCard");if(a&&!a.forbid_word){for(var t,c=0;c<n.length;c++)if(n[c].bind_serial==a.bind_serial){t=c;break}n.splice(t,1),n.unshift(a)}return n}},checkwhite:function(e,n,a){t("checkwhite",e,"POST",n,0,a)},getAgreement:function(e,n,a){var t=getApp().runEnvironment.cdnDomain,r=a;c.request({url:t+"/contracts/"+e,data:{},method:"GET",success:function(e){n(null,e.data,r)},fail:function(){n({msg:"请求失败",code:"error",type:"server-pass-error"},null,r)}})},facequery:function(e,n,a){t("facequery",e,"POST",n,0,a)},restartAccount:function(e,n,a){e.channelid=getApp().globalData.channelId,t("restartAccount",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)},checkcustinfo:function(e,n,a){e.channelid=getApp().globalData.channelId,t("checkcustinfo",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)},checkcustquery:function(e,n,a){e.channelid=getApp().globalData.channelId,t("checkcustquery",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)},smssend:function(e,n,a){e.channelid=getApp().globalData.channelId,t("smssend",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)},smscheck:function(e,n,a){e.channelid=getApp().globalData.channelId,t("smscheck",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)},namecheckedopenaccount:function(e,n,a){e.channelid=getApp().globalData.channelId,t("namecheckedopenaccount",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)},bankcustquery:function(e,n,a){e.channelid=getApp().globalData.channelId,t("bankcustquery",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)},checkpayresult:function(e,n,a){e.channelid=getApp().globalData.channelId,t("checkpayresult",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)},queryloanstatus:function(e,n,a){e.channelid=getApp().globalData.channelId,t("queryloanstatus",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)},weehoursphonecall:function(e,n,a){e.channelid=getApp().globalData.channelId,t("weehoursphonecall",e,"POST",function(e,a,t){e?n(e,a,t):n(null,a,t)},0,a)}}; 
 			}); 
		define("utils/dataReportHelper.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){c<n?(c++,e.data._r_key=(new Date).getTime(),wx.request({url:e.url,data:e.data,method:e.method,header:{"content-type":"application/x-www-form-urlencoded"},success:function(a){t();var c=e.success;c&&c(a)},fail:function(a){t();var c=e.fail;c&&c()},complete:function(){var t=e.complete;t&&t()}})):a.push(e)}function t(){c--,a.length>0&&e(a.splice(0,1)[0])}var a=[],c=0,n=3;module.exports={request:e}; 
 			}); 
		define("utils/error.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function r(r){var e=r.errMsg.match(/([a-zA-Z]+):([a-zA-Z]+)/),t=e[1],n=e[2],o=s[t]||s[t+":"+n];return o.result=r,o.type="api-error",o}var e={requestFail:{type:"request-fail",msg:"请求失败"},unKnow:{type:"unknow",msg:"未知错误"}},t={ok:/:ok$/},s={verifyPaymentPassword:{msg:"验证失败"},requestPaymentToBank:{msg:"付款失败"},bindPaymentCard:{msg:"绑卡失败"}};module.exports={maps:e,getJsApiError:function(e){return t.ok.test(e.errorMsg)?null:r(e)},getPassError:function(r){return"0"!=r.retcode?{msg:r.retmsg,code:r.retcode,type:"server-pass-error",result:r}:null}}; 
 			}); 
		define("utils/jsApiHelper.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function n(n,e,o){s.globalData.inJSAPI=!0;var l=o;console.log("getCftToken params: ",n),wx.verifyPaymentPassword({appId:n.appId,timeStamp:n.timeStamp,nonceStr:n.nonceStr,package:n.Package,signType:n.signType,paySign:n.paySign,success:function(n){if(console.log("success getCftToken ",n),n.token)e(null,n.token,l);else{var o={type:"api-error",msg:"验证失败"};r.log("verifyPaymentPassword",o),e(o,null,l)}},fail:function(n){r.log("verifyPaymentPassword",n),console.log("fail getCftToken ",n);var o=i.getJsApiError(n);e(o,null,l)},complete:function(n){s.globalData.inJSAPI=!1,console.log("complete getCftToken ",n)}})}function e(n,e,o){var l=o;wx.requestPaymentToBank({appId:n.appId,timeStamp:n.timeStamp,nonceStr:n.nonceStr,package:n.Package,signType:n.signType,paySign:n.paySign,success:function(n){if(console.log("success getWebPayCheckoutCounterRequst ",n),n.token&&(n.bind_serial||n.bindSerial))e(null,n,l);else{var o={type:"api-error",msg:"付款失败"};r.log("requestPaymentToBank",o),e(o,null,l)}},fail:function(n){r.log("requestPaymentToBank",n),console.log("fail getWebPayCheckoutCounterRequst ",n);var o=i.getJsApiError(n);e(o,null,l)}})}function o(n,e,o){var l=o;wx.bindPaymentCard({appId:n.appId,timeStamp:n.timeStamp,nonceStr:n.nonceStr,package:n.Package,signType:n.signType,paySign:n.paySign,success:function(n){console.log("success bindCard ",n),e(null,n,l)},fail:function(n){r.log("bindPaymentCard",n),console.log("fail bindCard ",n);var o=i.getJsApiError(n);e(o,null,l)}})}function l(n,e,o){if("DEV"==s.runEnvironment.runModel){l=o;wx.showModal({title:"这里是视频审核",content:"这里是视频审核",success:function(n){n.confirm?e(null,"makeVoIPCall:ok  ",l):e({type:"api-error",msg:"makeVoIPCall:fail cancel"},null,l)}})}else{s.globalData.inJSAPI=!0;var l=o,t=JSON.stringify(n||{});wx.makeVoIPCall({allowBackCamera:!1,showOther:!1,avatarUrl:"",context:t,success:function(n){console.log("success videoCall ",n),e(null,n,l)},fail:function(n){if(r.log("makeVoIPCall",n),console.log("fail videoCall ",n),"makeVoIPCall:fail network error"==n.errMsg)e(null,n,l);else{var o={type:"api-error",msg:n.errMsg};e(o,null,l)}},complete:function(n){s.globalData.inJSAPI=!1,console.log("complete videoCall ",n)}})}}var t=require("dataManager.js"),i=require("error.js"),a=require("loading.js"),r=(require("util"),require("report.js")),s=getApp();module.exports={getCftToken:function(e,o,l){"DEV"==s.runEnvironment.runModel?(a.hide(),wx.showModal({title:"这里是验证交易密码",content:"这里是获取CTF Token",success:function(n){a.show(),n.confirm?o(null,"123123",l):o({type:"api-error",msg:"付款失败"},null,l)}})):(a.show(),t.getSign(e,function(e,l,t){if(a.hide(),e)return o(e,null,t);n(l,function(n,e,l){if(n)return o(n,null,l);o(null,e,l)},t)},l))},bindCard:function(n,e,l){"DEV"==s.runEnvironment.runModel?(a.hide(),wx.showModal({title:"进入绑卡流程",content:"进入绑卡流程",success:function(n){a.show(),n.confirm?e(null,"123123",l):e({type:"api-error",msg:"付款失败"},null,l)}})):(a.show(),t.getSign(n,function(n,l,t){if(a.hide(),n)return e(n,null,t);o(l,function(n,o,l){if(n)return e(n,null,l);e(null,o,l)},t)},l))},getWebPayCheckoutCounterRequst:function(n,o,l){"DEV"==s.runEnvironment.runModel?(a.hide(),wx.showModal({title:"这里是还款收银台",content:"这里是还款收银台",success:function(n){a.show(),n.confirm?o(null,{token:"123123",bind_serial:"11111"},l):o({type:"api-error",msg:"付款失败"},null,l)}})):(a.show(),t.getSign(n,function(n,l,t){if(a.hide(),n)return o(n,null,t);e(l,function(n,e,l){if(n)return o(n,null,l);o(null,e,l)},t)},l))},startVoipCall:function(n,e,o){wx.makeVoIPCall?wx.getNetworkType({success:function(i){var r=i.networkType;"3g"==r||"4g"==r||"wifi"==r?(a.show(),t.facequery({},function(o,t,i){a.hide(),o?e(t.msg,i):"Y"==t.is_allow_face?l(n,function(n,o,l){n?e(n.msg,l,!0):e(null,l)},i):e(t.biz_msg,i)},o)):e("当前网络较差，无法进行视频审核。建议在 3G/4G/WiFi 环境下操作",o)},fail:function(n){e("当前网络较差，无法进行视频审核。建议在3G/4G/WiFi环境下操作",o)}}):e("该功能仅支持6.5.8及以上微信客户端",o)}}; 
 			}); 
		define("utils/loading.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var o=!1;module.exports={show:function(){wx.showLoading?o||(wx.showLoading({title:"正在加载",mask:!0}),o=!0):wx.showToast({title:"正在加载",icon:"loading",duration:1e4,mask:!0})},hide:function(){wx.hideLoading?o&&(wx.hideLoading(),o=!1):wx.hideToast()}}; 
 			}); 
		define("utils/pageManager.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e,n,a,o){var s=i[e];null!=n&&(r[e]=n,s=s+"?pageName="+e),wx.redirectTo({url:s,success:function(e){},fail:function(){},complete:function(){a&&a(),t(o)}})}function n(e,n,a,o){var s=i[e];null!=n&&(r[e]=n,s=s+"?pageName="+e),wx.navigateTo({url:s,success:function(e){},fail:function(){},complete:function(){a&&a(),t(o)}})}function a(e,a,t){var o=require("report.js"),i=["LoanCountBut","RecConLoanCountBut","RecLoanCountBut"],r=["PersInfoAuthBut","RecConPersInfoAuthBut","RecPersInfoAuthBut"],s=["TencentCreditBut","RecConTencentCreditBut","RecTencentCreditBut"],l=["AgreeDetainBut","RecConAgreeDetainBut","RecAgreeDetainBut"],c=["","RecConPersAuthBut","RecPersAuthBut"],u=t[a],p="";u.indexOf("借款额度合同")>=0&&(p=i[e]),u.indexOf("个人征信授权书")>=0&&(p=c[e]),u.indexOf("个人信息使用授权书")>=0&&(p=r[e]),u.indexOf("腾讯征信等授权书")>=0&&(p=s[e]),u.indexOf("委托扣款协议书")>=0&&(p=l[e]),u.indexOf("微众银行个人贷款专户服务协议")>=0&&(p="RecLoanAcountBut");var g={contractName:u};o.report("",p,1),n("agreement",g,null,!0)}function t(e){e||o.hide()}var o=require("loading.js"),i={index:"/pages/index/index",welcome:"/pages/welcome/welcome",warning:"/pages/warning/warning",exception:"/pages/warning/exception/exception",contractList:"/pages/contractList/contractList",personalCenter:"/pages/personalCenter/personalCenter",coupons:"/pages/coupons/coupons",records:"/pages/records/records",loanDetailRepayed:"/pages/records/loanDetailRepayed/loanDetailRepayed",loanDetailRepaying:"/pages/records/loanDetailRepaying/loanDetailRepaying",receipt:"/pages/records/receipt/receipt",faq:"/pages/faq/faq",faqDetail:"/pages/faq/faqDetail/faqDetail",faqClassify:"/pages/faq/faqClassify/faqClassify",loanAmount:"/pages/loanAmount/loanAmount",loan:"/pages/loan/loan",instalmentCredit:"/pages/loan/instalmentCredit",staffToken:"/pages/loan/staffToken/staffToken",loanResult:"/pages/loan/loanResult/loanResult",needvoipcall:"/pages/voipcall/needvoipcall/needvoipcall",repay:"/pages/repay/repay",repayCurPeriod:"/pages/repay/repayCurPeriod/repayCurPeriod",repayResult:"/pages/repay/repayResult/repayResult",agreement:"/pages/agreement/agreement",voipResult:"/pages/voipcall/voipResult/voipResult",smsVerify:"/pages/verifyFourElements/smsVerify/smsVerify",verifyFourElements:"/pages/verifyFourElements/verifyFourElements",infoWarning:"/pages/loan/infoWarning/infoWarning",loanResultCertificate:"/pages/loan/loanResultCertificate/loanResultCertificate",phonecheck:"/pages/loan/phonecheck/phonecheck",maintaining:"/pages/maintaining/maintaining"},r={};module.exports={goto:e,push:n,pop:function(e,n,a){wx.navigateBack({delta:e,success:function(e){},fail:function(){},complete:function(){t(a)}})},getParams:function(e){var n=null;if(e.pageName){var a=e.pageName;n=r[a],r[a]=null}return n},showContractList:function(e,n,t){for(var o=n.split(";"),i=[],r=0;r<o.length;r++){var s=o[r].split("V")[0];i.push(s)}wx.showActionSheet({itemList:i,success:function(n){n.cancel?t&&t():a(e,n.tapIndex,o)},fail:function(e){t&&t()}})},showAgreementDetail:a,handleBlockCode:function(n){"interview"!=n.block_sub_type?e("warning",{reason:n.block_msg,result:n.block_title||"",block_sub_type:n.block_sub_type||"",block_code:n.block_code,restart:n.restart||"",retcode:n.retcode}):e("needvoipcall",{caseType:2,fromPage:"index"})},gotoBusyException:function(){e("warning",{result:"系统繁忙，请稍后再试",reason:"",errorType:!0})},gotoIndex:function(e){var n=getApp(),a=i.index;if(null!=n.globalData.indexOptions){var t=n.globalData.indexOptions,o=!0;for(var r in t)r&&o?(a=a+"?"+r+"="+decodeURIComponent(t[r]),o=!1):r&&!o&&(a=a+"&"+r+"="+decodeURIComponent(t[r]))}e?wx.reLaunch({url:a}):wx.redirectTo({url:a,success:function(e){},fail:function(){},complete:function(){}})},getRootPage:function(){return getCurrentPages()[0]},getParentPage:function(){var e=getCurrentPages();return e.length>=2?e[e.length-2]:e[0]}}; 
 			}); 
		define("utils/report.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("wa.xcx.js");getApp();module.exports={report:function(t,e,o){var r=getApp();""==t&&(t=null),a.params.pageId=t,1==o?a.clickStat(e,1,{mktChannel:r.globalData.mktChannel,mct_no:r.globalData.marketNo}):(a.setDefinedInfo({mktChannel:r.globalData.mktChannel,mct_no:r.globalData.marketNo}),a.report())},initParams:function(t){a.params={appId:"1124",account:"faq_xcx",openId:t}},reportFaqIndex:function(){var t=getApp();a.params.pageId="FAQhomePage",a.setDefinedInfo({customerId:getApp().globalData.customerId,mktChannel:t.globalData.mktChannel,mct_no:t.globalData.marketNo}),a.report()},reportFaqDetail:function(t,e){var o=getApp();a.params.pageId="FAQitem",a.setParam("dr",e),a.setDefinedInfo({customerId:getApp().globalData.customerId,mktChannel:o.globalData.mktChannel,mct_no:o.globalData.marketNo}),a.setParam("id",t),a.report()},reportFaqType:function(t,e){var o=getApp();a.params.pageId="FAQcategory",a.setParam("dr",e),a.setDefinedInfo({customerId:getApp().globalData.customerId,mktChannel:o.globalData.mktChannel,mct_no:o.globalData.marketNo}),a.setParam("id",t),a.report()},reportFaqSearchFocus:function(){var t=getApp();a.params.pageId="FAQhomePage",a.clickStat("searchWord","",{customerId:getApp().globalData.customerId,mktChannel:t.globalData.mktChannel,mct_no:t.globalData.marketNo})},reportFaqSearch:function(t,e){var o=getApp();a.params.pageId="FAQhomePage",a.clickStat("searchWord",t,{customerId:getApp().globalData.customerId,hasResult:e,mktChannel:o.globalData.mktChannel,mct_no:o.globalData.marketNo})},reportFaqSearchCancel:function(t){var e=getApp();a.params.pageId="FAQhomePage",a.clickStat("searchWord",t,{customerId:getApp().globalData.customerId,mktChannel:e.globalData.mktChannel,mct_no:e.globalData.marketNo})},reportFromSearch:function(t,e){var o=getApp();a.params.pageId="FAQitem",a.setParam("dr","search"),a.setParam("id",e),a.setDefinedInfo({searchWord:t,customerId:getApp().globalData.customerId,mktChannel:o.globalData.mktChannel,mct_no:o.globalData.marketNo}),a.report()},reportSatisfaction:function(t,e){var o=getApp();a.params.pageId="FAQitem",a.clickStat("satisfaction",e,{faqId:t,customerId:getApp().globalData.customerId,mktChannel:o.globalData.mktChannel,mct_no:o.globalData.marketNo})},log:function(t,e){a.log(t+"  ---  "+JSON.stringify(e))}}; 
 			}); 
		define("utils/requestHelper.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e){"DEV"==getApp().runEnvironment.runModel&&(e.method="GET"),a<o?(a++,e.data._r_key=(new Date).getTime(),wx.request({url:e.url,data:e.data,method:e.method,header:{"content-type":"application/x-www-form-urlencoded"},success:function(n){if(t(),"200"==n.statusCode){var a=e.success;a&&a(n)}else{var o=e.fail;o&&o(n)}},fail:function(n){t();var a=e.fail;a&&a()},complete:function(){var t=e.complete;t&&t()}})):n.push(e)}function t(){a--,n.length>0&&e(n.splice(0,1)[0])}var n=[],a=0,o=5;module.exports={request:e}; 
 			}); 
		define("utils/util.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function e(e,t){return(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toFixed(t)}function t(e){return e>=10?e.toString():"0"+e.toString()}console.log=function(){},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},module.exports={formatTime:function(e){return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())},createTimeStamp:function(){return parseInt((new Date).getTime()/1e3)+""},createNonceStr:function(){return Math.random().toString(36).substr(2,15)},centToYuan:function(t,n){return void 0===t?0:e(t/100,void 0===n?2:n)},formatDate:function(e,t){var n={};n.Y=e.slice(0,4),n.M=e.slice(4,6),n.D=e.slice(6,8);var r,u={Y:"Y+",M:"M+",D:"D+"},i=t;for(var o in u)r=new RegExp(u[o]),i=i.replace(r,function(e){return n[o].slice(-e.length)});return i},strTrim:function(e,t){var n;return n=e.replace(/(^\s+)|(\s+$)/g,""),"g"==t.toLowerCase()&&(n=n.replace(/\s/g,"")),n},zeroFill:t,equityDataPreHandle:function(e,t){if(e){var n=getApp().globalData.account.rate,r=t||n[0].interest_rate,u=Math.round(1e6*r)/1e4,i={INT_D_NEW:"day",INT_D:"day",INT_A:"money",INT_P:"percent",INT_P_NEW:"percent"};if(e.js_equity_type=i[e.equity_type],e.js_equity_name="","INT_D_NEW"!=e.equity_type&&"INT_D"!=e.equity_type||(e.js_equity_name="免息券",e.js_equity_fullname="前"+e.equity_value+"天免利息","INT_D_NEW"==e.equity_type?e.js_equity_desc="前"+e.equity_value+"天免利息，仅首次借款使用":e.js_equity_desc="前"+e.equity_value+"天免利息"),"INT_P_NEW"==e.equity_type||"INT_P"==e.equity_type){var o=u*e.equity_value/100<.02;e.js_equity_name="折扣券",e.js_equity_fullname="日利率"+e.equity_value/10+"折"+(o?",最低0.02%":""),e.js_equity_desc="日利率"+e.equity_value/10+"折"+(o?"(折后日利率不能低于0.02%)":""),e.js_equity_discount=e.equity_value/10,e.isTooLow=o,e.js_new_rate=o?.02:u*e.equity_value/100}return e}},sortList:function(e,t){return t.sort(function(t,n){return t[e]-n[e]})},getDateForServer:function(){var e=new Date,n=e.getFullYear();t(e.getMonth()+1),t(e.getDay());return[n,t(e.getMonth()+1),t(e.getDate()),t(e.getHours()),t(e.getMinutes()),t(e.getSeconds())].join("")},phoneCall:function(e){wx.makePhoneCall({phoneNumber:e})},convertMoneyToHandle:function(e){return e.replace(/,/g,"")},contractTranslate:function(e){var t=e.split("V"),n=t[0],r=t[1],u={"借款额度合同":"borrowing-contract","个人征信授权书":"personal-credit","个人信息使用授权书":"personal-info","腾讯征信等授权书":"tencent-inquiry-letter","委托扣款协议书":"principal-debit-protocol","微众银行个人贷款专户服务协议":"personal-account-service-protocol"};return u[n]?u[n]+"V"+r:e},versionCompare:function(e,t){for(var n=e.split("."),r=t.split("."),u=0;u<n.length;u++){if(n[u]>r[u])return 1;if(n[u]<r[u])return-1}return 0},isCnNewID:function(e){var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=[1,0,"X",9,8,7,6,5,4,3,2];if(/^\d{17}(\d|x)$/i.test(e)){for(var r,u=0,i=0;i<e.length-1;i++)u+=parseInt(e.substr(i,1),10)*t[i];return r=u%11,n[r]==e.substr(17,1).toUpperCase()}return!1}}; 
 			}); 
		define("utils/view.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";function o(o){o?wx.showToast({title:"正在加载",icon:"loading",duration:1e4,mask:!0}):wx.hideToast()}var o=require("loading.js"),e=require("pageManager.js");module.exports={general:{hide:"hide",show:"show"},remindShow:function(o){var e=require("dataManager.js"),n=getApp(),a=e.getXKey(),t=n.globalData.account&&n.globalData.account.control&&n.globalData.account.control.account_maintain_info;if(t)for(var i=0;i<t.length;i++){var r=t[i];if(r.page==o&&!wx.getStorageSync("remind"+r.id+"_"+a))return r}return null},remindClose:function(o){var e=require("dataManager.js").getXKey();wx.setStorageSync("remind"+o+"_"+e,"show")},showLoginException:function(){o.hide(),wx.showModal({title:"系统繁忙，请退出再试",showCancel:!1,confirmText:"确认",confirmColor:"#DAAA1A",success:function(o){e.gotoIndex(!0)}})},showException:function(){o.hide(),wx.showModal({title:"系统繁忙，请重新尝试",showCancel:!1,confirmText:"确认",confirmColor:"#DAAA1A",success:function(o){}})},loading:o}; 
 			}); 
		define("utils/wa.xcx.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e=require("dataReportHelper.js"),t=function(e){return"object"===(void 0===e?"undefined":a(e))&&!!e},n=function(a){return a.split("_")[0]+"_02"},o=function(a,e){try{if(a.stack){var t=a.stack.match("https?://[^\n]+"),n=(t=t?t[0]:"").match(":(\\d+):(\\d+)");return n||(n=[0,0,0]),{_msg:_processStackMsg(a),_line:n[1],_col:n[2],_url:t.replace(n[0],"")}}return a.name&&a.message&&a.description?{_msg:JSON.stringify(a)}:a.header?{_msg:a.errMsg?"[backend]"+a.errMsg:"未获取到错误信息",_line:a.header?a.header:"无头信息",_col:a.method?a.method:"无调用方法",_url:a.url?a.url:"无URL"}:{_msg:e||"未获取到错误信息",_url:JSON.stringify(a)}}catch(a){return a}},r=function(a,t){if(a.account&&a.appId){a.appId&&-1==a.appId.indexOf("_01")&&-1==a.appId.indexOf("_02")&&(a.appId=a.appId+"_01"),a._nopv=t;var n=getApp().runEnvironment.traceDomain;e.request({url:n,data:a,method:"GET",success:function(a){console.log("wa report success")},fail:function(){console.log("wa report fail")}})}else console.info("未设置AppID或Account")},p={params:{},setParam:function(a,e){this.params[a]=e},setDefinedInfo:function(a){t(a)?this.params.defined_info=a:console.log("设置的格式有误")},report:function(){r(this.params,0)},clickStat:function(e,t,o){try{var p={account:this.params.account,appId:n(this.params.appId),openId:this.params.openId,pageId:this.params.pageId,defined_name:e,defined_value:void 0===t||null===t?"null":t};"object"==(void 0===o?"undefined":a(o))&&o&&(p.defined_info=o),r(p,1)}catch(a){console.error(a)}},log:function(a){try{var e={account:this.params.account,appId:n(this.params.appId),openId:this.params.openId,_log:a};r(e,1)}catch(a){console.error(a)}},errorReport:function(a,e){try{var p=t(a)?o(a,e):{_msg:a};p.account=this.params.account,p.appId=n(this.params.appId),null!==this.params.openId&&void 0!==this.params.openId&&(p.openId=this.params.openId),r(p,1)}catch(p){console.error(p)}},pageStayTime:function(a,e){try{if(null===a||void 0===a||NaN==Number(a))return;var t={account:this.params.account,appId:n(this.params.appId),pageId:this.params.pageId,defined_name:"wa_page_stay_time",defined_value:a};null!==this.params.openId&&void 0!==this.params.openId&&(t.openId=this.params.openId),null!==e&&void 0!==e&&(t.pageId=e),r(t,1)}catch(a){console.error(a)}}};module.exports=p; 
 			}); 
		define("app.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("utils/pageManager.js"),e=require("utils/dataManager.js"),t=!1;App({onLaunch:function(){this.refreshSession()},onShow:function(){if(this.getSystemInfo(),t){t=!1;var e=getCurrentPages();e.length>0&&((e[0].data.pageName&&"personalCenter"==e[0].data.pageName||e[0].data.pageName&&"loanAmount"==e[0].data.pageName||e[0].data.pageName&&"repayCurPeriod"==e[0].data.pageName)&&(this.globalData.pageParam={comefrom:"appShow",refreshDataFlag:0}),(e[0].data.pageName&&"welcome"==e[0].data.pageName||e[0].data.pageName&&"warning"==e[0].data.pageName||e[0].data.pageName&&"voipResult"==e[0].data.pageName||e[0].data.pageName&&"needvoipcall"==e[0].data.pageName)&&a.gotoIndex())}},onHide:function(){var a=getCurrentPages();a.length>0&&(a[0].data.pageName&&"personalCenter"==a[0].data.pageName||a[0].data.pageName&&"loanAmount"==a[0].data.pageName||a[0].data.pageName&&"repayCurPeriod"==a[0].data.pageName||a[0].data.pageName&&"welcome"==a[0].data.pageName&&1==a.length||a[0].data.pageName&&"warning"==a[0].data.pageName||a[0].data.pageName&&"voipResult"==a[0].data.pageName||a[0].data.pageName&&"needvoipcall"==a[0].data.pageName)&&!this.globalData.inJSAPI&&(t=!0,a[0].showPage(!1))},onUnlaunch:function(){},getSystemInfo:function(){var a=this.globalData.systemInfo;if(!(a&&a.windowWidth&&a.windowWidth>0))try{var e=wx.getSystemInfoSync();this.globalData.ratio=Number(e.windowWidth/750).toFixed(2),this.globalData.sScreen=!(e.windowWidth>320),this.globalData.systemInfo=e,this.globalData.isIOS8=-1!=e.system.replace(/\s/g,"").indexOf("iOS8"),this.globalData.iphoneX=e.windowHeight>667&&e.windowWidth<414}catch(a){}},refreshSession:function(){setInterval(function(){e.login(function(a){console.log(new Date,"login result"+a)})},36e5)},btnAllowClick:function(a){return!!a.btnAllowFlag&&(a.btnAllowFlag=!1,!0)},btnRecover:function(a){a.btnAllowFlag=!0},btnRecoverByUnload:function(){var a=getCurrentPages();a.length>=2&&this.btnRecover(a[a.length-2].data.eventControl)},exceptionHandler:function(){var e=this.globalData.account;return"0"!=(null==e?"exception":e.retcode)?(a.gotoBusyException(),!0):e.maintain_info&&"Y"==e.maintain_info.is_maintain?(a.goto("warning",{reason:e.maintain_info.maintain_wording,result:"暂停服务中"}),!0):"page"==e.block_type&&"XXXXXX"==e.block_code?(a.gotoBusyException(),!0):"page"==e.block_type&&"00000"!=e.block_code&&(a.handleBlockCode(e),!0)},globalData:{customerId:1,sScreen:!1,isIOS8:!1,ratio:1,iphoneX:!1,systemInfo:null,account:null,mktChannel:null,channelId:null,marketBrandNo:null,marketNo:null,marketActNo:null,prod:"0",abFlag:"0000000000",openAccount:!1,reLoginFlag:!1,pageParam:{},inJSAPI:!1,indexOptions:{},newContract:"微众银行个人贷款专户服务协议V1.0"},runEnvironment:{runModel:"PRD",appid:"wx31e5b0edab03aafc",apiDomain:"https://pay.weixin.qq.com",cdnDomain:"https://www.webankcdn.net/s/wxma",faqJsonDomain:"https://www.webankcdn.net/a/rcs-faq/faqdata/wxJson/",traceDomain:"https://trace.webank.com/rcrm-codcs/wb-rcrm-codcs",defaultFaqId:"201701201745253641",couponsTypeId:"40"}}); 
 			}); 	require("app.js");
 		__wxRoute = 'pages/index/index';__wxRouteBegin = true; 	define("pages/index/index.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var o=require("../../utils/dataManager.js"),a=require("../../utils/pageManager.js"),t=require("../../utils/loading.js"),e=(require("../../utils/view.js"),getApp());Page({data:{pageName:"index",eventControl:{btnAllowFlag:!0}},onLoad:function(o){console.log("index options: ",o),wx.setNavigationBarTitle({title:"微粒贷"}),e.globalData.channelId=o.channelId||1e3,e.globalData.mktChannel=e.globalData.channelId,e.globalData.abFlag=o.abFlag||"0000000000",e.globalData.marketBrandNo=o.market_brand_no,e.globalData.marketActNo=o.market_act_no,e.globalData.indexOptions=o,e.getSystemInfo()},onReady:function(){this.doLogin()},onShow:function(){},onHide:function(){},onUnload:function(){},doLogin:function(){t.show();var e=this;o.login(function(o){o?e.initData():a.gotoBusyException()},!0)},initData:function(){t.show();var n={};e.globalData.marketBrandNo&&(n={market_brand_no:e.globalData.marketBrandNo,market_act_no:e.globalData.marketActNo}),o.checkwhite(n,function(i,r,l){if(console.log("index checkwhite:",i,r),i&&"30938705"!=i.code&&"30938706"!=i.code&&"30938707"!=i.code&&"30938708"!=i.code&&"30938709"!=i.code)a.gotoBusyException();else{if(r=r||i.result,e.globalData.prod=r.prod||"0",e.globalData.marketNo=r.mct_no,"N"==r.is_white)return e.globalData.customerId=2,void a.goto("welcome",{noWhite:!0});if("Y"==r.is_white){if(e.globalData.indexOptions.faqId&&e.globalData.indexOptions.faqId.length>0)return void a.goto("faqDetail",{faqId:e.globalData.indexOptions.faqId});e.globalData.indexOptions.marketBrandNo&&(n={market_brand_no:e.globalData.indexOptions.marketBrandNo,market_act_no:e.globalData.indexOptions.marketActNo});var c=["借款额度合同V2.6","个人信息使用授权书V2.2","腾讯征信等授权书V2.1","委托扣款协议书V1.5"];o.shareData.set("credit_contract_ver","个人征信授权书V2.4"),o.shareData.set("without_credit_contract_ver",c.join(";"));var d=[];if(d.push.apply(d,c),d.splice(1,0,"个人征信授权书V2.4"),o.shareData.set("contract_ver",d.join(";")),r.check_brand_status&&"N"==r.check_brand_status)return void a.goto("maintaining",r);t.show(),n.outputtype="json",o.queryAccount(n,function(n,i,r){if(console.log("index queryAccount:",n,i),!e.exceptionHandler()){var l=e.globalData.account;if("1"!=e.globalData.prod||"L0004"!=l.block_code&&"H0003"!=l.block_code){var c=l.control;c&&c.account_maintain_info;return"Y"==l.active?"Y"==l.is_overdue?void a.goto("repayCurPeriod"):void("1"==e.globalData.prod?a.goto("loanAmount"):a.goto("personalCenter")):(t.show(),void o.noopenqueryequity({},function(o,t,e){if(console.log("index noopenqueryequity: ",o,t),!o){var n=getApp().globalData.account;n.operate_config?t.operate_config&&t.operate_config.noopen&&(n.operate_config.noopen=t.operate_config.noopen):n.operate_config=t.operate_config}a.goto("welcome")},r))}var d={caseType:"H0003"==l.block_code?3:5,fromPage:"index"};a.goto("needvoipcall",d)}},l)}}},this)}}); 
 			}); 	require("pages/index/index.js");
 		__wxRoute = 'pages/welcome/welcome';__wxRouteBegin = true; 	define("pages/welcome/welcome.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t=require("../common/alertView/alertView.js"),e=require("../../utils/view.js"),o=require("../../utils/jsApiHelper.js"),a=require("../../utils/dataManager.js"),r=require("../../utils/pageManager.js"),n=require("../../utils/report.js"),i=require("../../utils/loading.js"),c=getApp();Page({data:{pageName:"welcome",eventControl:{btnAllowFlag:!0},sScreen:c.globalData.sScreen,pageShow:!1,checked:!1,giconSize:16,noWhite:!1,iconType:[{icon:"../../images/icn-feature-1@2x.png",content:"5 秒出额度"},{icon:"../../images/icn-feature-2@2x.png",content:"1 分钟借钱"},{icon:"../../images/icn-feature-3@2x.png",content:"3 分钟到账"}],abIconType:[{icon:"../../images/flash.png",content:"5 秒出额度，3分钟到账"},{icon:"../../images/calender.png",content:"借几天算几天利息"},{icon:"../../images/wallet.png",content:"提前还不收违约金"}],maintainInfoShow:!1,maintainInfo:{faq:""},welcomeABFlagShow:!1,operate_tip_title:"",showBubble:!1},onLoad:function(t){wx.setNavigationBarTitle({title:"微粒贷"}),console.log("welcome options: ",t);var o=r.getParams(t),a=c.globalData.abFlag.split("");if(this.setData({giconSize:24*c.globalData.ratio,noWhite:o&&o.noWhite||!1,sScreen:c.globalData.sScreen,welcomeABFlagShow:"1"==a[1]}),!this.data.noWhite){var n=e.remindShow("noopen");n&&this.setData({maintainInfoShow:!0,maintainInfo:n});var i=c.globalData.account;i&&i.operate_config&&i.operate_config.noopen&&i.operate_config.noopen.operate_tip&&this.setData({operate_tip_title:i.operate_config.noopen.operate_tip.title})}},onReady:function(){},onShow:function(){if(this.showPage(!0),this.data.eventControl.smsVerifyData&&(this.queryCreditLimit(this,this.data.eventControl.smsVerifyData),this.data.eventControl.smsVerifyData=null),this.data.eventControl.tokenData&&(this.submit(),this.data.eventControl.tokenData=null),"1"==c.globalData.prod)n.report("PaywelcomePage"),this.data.noWhite?n.report("","PaywelcomePage-noWhite list",1):(n.report("","PaywelcomePage-White list",1),(t=c.globalData.account)&&t.restart&&"Y"==t.restart&&n.report("PayShutDownWelcome"));else if(n.report("welcomePage"),this.data.noWhite)n.report("","welcomePage-noWhite list",1);else{n.report("","welcomePage-White list",1);var t=c.globalData.account;t&&t.restart&&"Y"==t.restart&&n.report("ShutDownWelcome")}},onHide:function(){},onUnload:function(){c.btnRecoverByUnload()},showPage:function(e){!e&&this.data.alertViewData&&this.data.alertViewData.viewShow&&t.hide(this),this.setData({pageShow:e})},checkboxChange:function(t){this.setData({checked:!this.data.checked}),this.data.checked&&this.data.showBubble&&this.setData({showBubble:!1})},checkPersonalCredit:function(){"1"==c.globalData.prod?n.report("","PayCreditAuthBut",1):n.report("","CreditAuthBut",1),r.push("agreement",{contractName:"个人征信授权书V2.4"},null,!0)},checkAgreement:function(t){"1"==c.globalData.prod?n.report("","PayContractUrlBut",1):n.report("","ContractUrlBut",1),r.push("contractList",{contract_ver:a.shareData.get("without_credit_contract_ver")})},openAccount:function(e){var s=c.globalData.account;if(s&&"block_code_unreg"==s.block_code)return"1"==c.globalData.prod?s&&"Y"==s.restart?n.report("","PayGetLimitAgainbutnotre",1):n.report("","PayGetLimitbutnotre",1):s&&"Y"==s.restart?n.report("","GetLimitAgainbutnotre",1):n.report("","GetLimitbutnotre",1),void t.show(this,{type:0,content:"请添加一张本人银行卡进行微信支付实名认证。",cancelText:"取消",confirmText:"添加银行卡"},{alertConfirm:this.gotoBindCard,alertClose:function(){"1"==c.globalData.prod?s&&"Y"==s.restart?n.report("","PayaddcardAgainCancel",1):n.report("","Payaddcardcancel",1):s&&"Y"==s.restart?n.report("","addcardAgainCancel",1):n.report("","addcardcancel",1)}});if("1"==c.globalData.prod?s&&"Y"==s.restart?n.report("","PayGetLimitAgain",1):n.report("","PayGetLimitBut",1):s&&"Y"==s.restart?n.report("","GetLimitAgain",1):n.report("","GetLimitBut",1),this.data.checked){if(!c.btnAllowClick(this.data.eventControl))return;if(s&&s.control&&s.control.disable&&s.control.disable.open_account)return c.btnRecover(this.data.eventControl),void this.showDialog(s.control.disable.open_account,"知道了");i.show(),a.prenotify({nopwdnosms_flag:0,type:0},null),"1"==c.globalData.prod?s&&"Y"==s.restart?n.report("PayOpenPassword"):n.report("PayGetLimitPassword"):s&&"Y"==s.restart?n.report("OpenPassword"):n.report("GetLimitPassword"),o.getCftToken({req_type:1},function(t,e,o){if(console.log("welcome getCftToken: ",t,e),t)return c.btnRecover(o.data.eventControl),i.hide(),void("server-pass-error"==t.type&&o.showDialog(t.msg,"知道了"));s&&"Y"==s.restart?(o.submit=function(){o.restartAccountRequest(o,e)},s&&"1"==s.cust_type?r.push("staffToken"):o.submit()):o.openAccountRequest(o,e)},this)}else this.setData({showBubble:!0})},restartAccountRequest:function(t,e){i.show();c.globalData.account;a.restartAccount({cft_token:e,token_scene:1,contract_ver:a.shareData.get("contract_ver")},function(t,e,o){console.log("welcome restartAccount: ",t,e),t&&"30937402"!=t.result.retcode?o.handlerOpenError(t):("1"==c.globalData.prod?n.report("PayOpenSucees"):n.report("OpenSucees"),o.queryAccountInfo(o))},t)},openAccountRequest:function(t,e){i.show(),a.openaccount({cft_token:e,token_scene:1,contract_ver:a.shareData.get("contract_ver")},function(t,e,o){console.log("welcome openaccount: ",t,e),t?o.handlerOpenError(t):o.queryCreditLimit(o,e)},t)},queryCreditLimit:function(t,e){i.show(),setTimeout(function(){a.queryCredit({app_no:e.app_no},function(t,e,o){console.log("welcome queryCredit: ",t,e),o.checkError(t)||("1"==c.globalData.prod?n.report("","PaymktOpenAcct",1):n.report("","mktOpenAcct",1),o.queryAccountInfo(o))},t)},5e3)},queryAccountInfo:function(t){i.show(),a.queryAccount({outputtype:"json",from:"noopen"},function(t,e,o){console.log("welcome queryAccountInfo queryAccount: ",t,e),o.checkError(t)||(i.show(),c.globalData.openAccount=!0,c.exceptionHandler()||("1"==c.globalData.prod?r.goto("loanAmount"):r.goto("personalCenter")))},t)},checkError:function(t){return!!t&&(c.btnRecover(this.data.eventControl),i.hide(),this.showDialog("系统繁忙，请重新尝试","知道了"),!0)},handlerOpenError:function(t){c.btnRecover(this.data.eventControl),i.hide();var e=c.globalData.account;"30937999"==t.result.retcode?this.showDialog("暂不支持15位身份证用户开通，进入微信钱包-右上角三个点-帮助中心-账户问题-注册与安全-15位身份证如何升级为18位中进行升级","知道了"):"1"==t.result.errortype?r.goto("warning",{result:"无法查看额度",reason:t.msg,tips:!0}):"30938601"==t.result.retcode?r.push("verifyFourElements"):"30938602"==t.result.retcode||"30938603"==t.result.retcode||"30938604"==t.result.retcode||e&&"Y"==e.restart?r.handleBlockCode(t.result):this.showDialog(t.msg,"知道了")},gotoBindCard:function(){var r=c.globalData.account;"1"==c.globalData.prod?r&&"Y"==r.restart?n.report("","PayaddcardAgainConfirm",1):n.report("","Payaddcard",1):r&&"Y"==r.restart?n.report("","addcardAgainConfirm",1):n.report("","addcard",1),i.show(),o.bindCard({req_type:4},function(o,r,n){if(console.log("welcome bindCard: ",o,r),i.hide(),o)return"server-pass-error"==o.type&&n.showDialog(o.msg,"知道了"),void c.btnRecover(n.data.eventControl);i.show(),a.queryAccount({outputtype:"json"},function(o,a,r){console.log("welcome bindCard queryAccount: ",o,a),o&&e.showLoginException(),i.hide(),t.hide(r)},n)},this)},clickAttention:function(){},closeMaintainInfo:function(t){this.setData({maintainInfoShow:!1}),e.remindClose(this.data.maintainInfo.id)},showDialog:function(e,o){t.show(this,{type:1,content:e,cancelText:o})},gotofaq:function(){var t=this.data.maintainInfo.faq;t.length>0&&r.push("faqDetail",{faqId:t})}}); 
 			}); 	require("pages/welcome/welcome.js");
 		__wxRoute = 'pages/warning/warning';__wxRouteBegin = true; 	define("pages/warning/warning.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../utils/util.js"),t=require("../../utils/pageManager.js"),o=require("../../utils/report.js"),a=getApp();Page({data:{pageName:"warning",eventControl:{btnAllowFlag:!0},pageShow:!1,result:"",reason:"",retcode:"",restart:"Y",block_sub_type:"",block_code:"",iconSize:200*a.globalData.ratio,tips:!1,sScreen:a.globalData.sScreen,tel_number:"0755-89468888",indexOf_tel:!1,errorType:!1},onLoad:function(e){console.log("warning options: ",e);var o=t.getParams(e);if(o){var r=o.reason.indexOf(this.data.tel_number);this.setData({result:o.result||"",reason:r>0?o.reason.substring(0,r):o.reason,tips:o.tips,retcode:o.retcode,block_sub_type:o.block_sub_type,restart:o.restart||"N",block_code:o.block_code,errorType:o.errorType||!1,indexOf_tel:r>0,iconSize:200*a.globalData.ratio,sScreen:a.globalData.sScreen})}},onReady:function(){},onShow:function(){this.showPage(!0),"Y"==this.data.restart&&("1"==a.globalData.prod?"0"==this.data.retcode?o.report("PayShutDown"):"30937491"==this.data.retcode?o.report("PayOpenPhoneCheck"):o.report("PayOpenFail"):"0"==this.data.retcode?o.report("ShutDown"):"30937491"==this.data.retcode?o.report("OpenPhoneCheck"):o.report("OpenFail"))},onHide:function(){},onUnload:function(){a.btnRecoverByUnload()},callCustomerService:function(){e.phoneCall("075589468888")},showPage:function(e){this.setData({pageShow:e})},restartTap:function(){a.btnAllowClick(this.data.eventControl)&&("1"==a.globalData.prod?o.report("","PayOpenagain",1):o.report("","Openagain",1),t.goto("welcome"))}}); 
 			}); 	require("pages/warning/warning.js");
 		__wxRoute = 'pages/contractList/contractList';__wxRouteBegin = true; 	define("pages/contractList/contractList.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t=require("../../utils/pageManager.js"),a=getApp();Page({data:{contract_ver:[],contract_names:[],sScreen:a.globalData.sScreen,eventControl:{btnAllowFlag:!0}},onLoad:function(n){wx.setNavigationBarTitle({title:"借款合同"}),console.log("contractList options: ",n);var e=t.getParams(n);if(e&&e.contract_ver){for(var r=e.contract_ver.split(";"),o=[],c=0;c<r.length;c++){var s=r[c].split("V")[0];o.push(s)}this.setData({contract_ver:r,contract_names:o})}this.setData({sScreen:a.globalData.sScreen})},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){a.btnRecoverByUnload()},checkContract:function(a){var n=a.currentTarget.dataset.index;t.showAgreementDetail(0,n,this.data.contract_ver)},getContractNames:function(t){for(var a=[],n=0;n<t.length;n++){var e=t[n].split("V")[0];a.push(e)}return a}}); 
 			}); 	require("pages/contractList/contractList.js");
 		__wxRoute = 'pages/personalCenter/personalCenter';__wxRouteBegin = true; 	define("pages/personalCenter/personalCenter.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("../../utils/util"),o=require("../common/loanNotice/loanNotice.js"),t=require("../common/alertView/alertView.js"),e=require("../../utils/dataManager.js"),n=require("../../utils/pageManager.js"),i=require("../../utils/loading.js"),r=require("../../utils/view.js"),l=require("../../utils/report.js"),s=require("../../utils/jsApiHelper.js"),c=r.general,u=getApp();Page({data:{pageName:"personalCenter",eventControl:{btnAllowFlag:!0},pageShow:!1,sScreen:u.globalData.sScreen,isIOS8:u.globalData.isIOS8,isFirstLoan:!1,isShowEquityEntrance:!1,loanStatus:2,availableAmount:0,totalAmount:0,dailyInterestRate:.005,currPmtDudDate:"",bankName:"",cardTail:"",unPaidLoans:0,currBal:"",operateShow:!1,operateTip:"",equityShow:!1,isLoading:!1,equityTip:"",remindShow:!1,remindTip:"微粒贷在不同渠道共用额度，其他渠道借钱会影响微信上的可借额度",maintainInfoShow:!1,maintainInfo:{faq:""},L0001InfoShow:!1,judeBlockCode:!1,loanListShow:c.hide,angle:0,hover:!0,warningShow:!1,iconSize:200*u.globalData.ratio,result:"",reason:"",tel_number:"0755-89468888",indexOf_tel:!1,videoCheck:!1,videoCheckTip:"",noticeShowBottom:!0,allowLoan:!0},onLoad:function(a){wx.setNavigationBarTitle({title:"微粒贷"}),u.globalData.marketBrandNo=null,u.globalData.marketNo=null,u.globalData.marketActNo=null,u.globalData.prod="0",this.setData({globalData:u.globalData}),this.dataHandler(),this.showPage(!0)},onReady:function(){},onShow:function(){l.report("personalCenter");var a=u.globalData.pageParam,o=a&&a.comefrom;if("repayResult"==o||"loanResult"==o||"needvoipcall"==o||"appShow"==o||"voipResult"==o){var t=a.refreshDataFlag;if(a.comefrom="",u.globalData.pageParam=a,0==t){i.show();e.queryAccount({outputtype:"json"},function(a,o,t){console.log("personalCenter onshow queryAccount:",a,o),i.hide(),t.needGoToPage()||(a?t.showPage(!0):(t.dataHandler(),t.showPage(!0)))},this)}else 1==t?this.needGoToPage()||(this.dataHandler(),this.showPage(!0)):this.needGoToPage()}},onHide:function(){},onUnload:function(){u.btnRecoverByUnload()},showPage:function(a){!a&&this.data.loanNoticeData&&this.data.loanNoticeData.viewShow&&o.hide(this),!a&&this.data.alertViewData&&this.data.alertViewData.viewShow&&t.hide(this),this.setData({pageShow:a})},dataHandler:function(){var a=u.globalData.account;a&&a.is_first_loan&&"Y"==a.is_first_loan&&l.report("","personalCenter-firsttime",1),null!=a&&(this.needShowWarning()?(this.setData({iconSize:200*u.globalData.ratio,result:a.block_title||"无法借钱",reason:a.block_msg||"人行不良",warningShow:!0}),a.block_msg.indexOf(this.data.tel_number)>=0&&this.setData({indexOf_tel:!0,reason:a.block_msg.substring(0,a.block_msg.indexOf(this.data.tel_number))})):this.setData({warningShow:!1}),this.dataRender())},needShowWarning:function(){var a=u.globalData.account;return"Y0001"==a.block_code||"C0001"==a.block_code||"R0001"==a.block_code||"H0005"==a.block_code||"R0004"==a.block_code},needGoToPage:function(){return u.exceptionHandler()},callCustomerService:function(){a.phoneCall("075589468888")},dataRender:function(){var o=u.globalData.account,t=u.globalData.abFlag.split("");this.setData({videoCheck:"L0004"==o.block_code||"H0003"==o.block_code,judeBlockCode:!0,availableAmount:a.centToYuan(o.available_amount,0),totalAmount:a.centToYuan(o.total_amount,0),dailyInterestRate:Math.round(1e6*o.rate[0].interest_rate)/1e4,currPmtDudDate:a.formatDate(o.curr_pmt_due_date,"MM月DD日"),bankName:o.bank_name,cardTail:o.card_tail,isFirstLoan:!(!o||"Y"!=o.is_first_loan),isShowEquityEntrance:"Y"==o.is_show_equity_entrance,loanStatus:o.loan_status,unPaidLoans:o.unpaid_loans,currBal:a.centToYuan(o.curr_bal),loanListShow:"2"!=o.loan_status?c.show:c.hide,operateShow:!1,equityShow:!1,noticeShowBottom:!0,allowLoan:0!=u.globalData.account.available_amount}),"L0004"!=o.block_code&&"H0003"!=o.block_code||("L0004"==o.block_code?this.setData({videoCheckTip:"你有一笔借款需要进行视频审核"}):this.setData({videoCheckTip:"你的换卡申请需进行视频审核，完成后才可借款"})),o.operate_config&&o.operate_config.personcenter&&o.operate_config.personcenter.operate_tip&&o.operate_config.personcenter.operate_tip.title?this.setData({operateShow:!0,operateTip:o.operate_config.personcenter.operate_tip.title}):this.setData({operateShow:!1});var e=r.remindShow("personcenter");e?this.setData({maintainInfoShow:!0,maintainInfo:e,operateShow:!1}):this.setData({maintainInfoShow:!1}),"L0001"==o.block_code?this.setData({L0001InfoShow:!0,maintainInfoShow:!1,operateShow:!1}):this.setData({L0001InfoShow:!1}),u.globalData.openAccount&&o.total_amount!=o.available_amount||o.control&&o.control.remind?(this.setData({remindShow:!0}),o.control&&o.control.remind&&this.setData({remindTip:o.control.remind})):this.setData({remindShow:!1}),u.globalData.openAccount=!1,this.data.operateShow?this.setData({equityShow:!1}):o.equity&&o.equity.equity_msg?this.setData({equityShow:!0,equityTip:o.equity.equity_msg,noticeShowBottom:!0}):this.setData({equityShow:!1,noticeShowBottom:"0"==t[0]})},checkLend:function(){var a=u.globalData.account,o=a.control,e=o&&o.disable;return e&&e.loan_money?(this.showDialog(e.loan_money,"知道了"),!1):"L0005"==a.block_code?(this.showDialog("你有一笔借款正在审核中，暂时无法继续借钱。","知道了"),!1):"L0006"==a.block_code?(this.showDialog("你上一笔借款还在等待银行电话确认，暂时无法继续借钱。","知道了"),!1):"H0004"==a.block_code?(this.showDialog("你的换卡申请正在审核中，暂时无法借钱。","知道了"),!1):"H0001"==a.block_code?(this.showDialog("你已经更换过银行卡，请还清当前借款后再进行借钱。","知道了"),!1):"H0002"==a.block_code?(this.showDialog("你的换卡申请正在审核中，暂时无法借钱。","知道了"),!1):"block_code_unreg"==a.block_code?(l.report("","BorrowAddCard",1),t.show(this,{type:0,content:"你的微信尚未绑定银行卡，请绑定你本人（"+a.name+"）的银行卡后继续",cancelText:"取消",confirmText:"立即绑定"},{alertConfirm:this.gotoBindCard,alertClose:function(){l.report("","BorrowAddCardCancel",1)}}),!1):"00000"!=a.block_code?(this.showDialog(a.block_msg||"未知错误","知道了"),!1):a.unpaid_loans&&parseInt(a.unpaid_loans)>=20?(this.showDialog("你的未还清借款笔数已达到20笔上限，暂时无法继续借钱","知道了"),!1):!(a.available_amount<5e4&&a.available_amount>0)||(this.showDialog("你的可借额度低于单笔最低借钱金额500元，无法借钱","知道了"),!1)},gotoBindCard:function(){l.report("","BorrowAddCardConfirm",1),i.show(),s.bindCard({req_type:4},function(a,o,n){if(console.log("personalCenter bindCard:",a,o),i.hide(),a)return"server-pass-error"==a.type&&n.showDialog(a.msg,"知道了"),void u.btnRecover(n.data.eventControl);i.show(),e.queryAccount({outputtype:"json"},function(a,o,e){console.log("personalCenter bindCard queryAccount:",a,o),i.hide(),t.hide(e),a||e.dataHandler()},n)},this)},loadingAction:function(){function a(){t++,o.setData({angle:72*t+"deg"}),o.data.isLoading&&t<1e3?setTimeout(function(){a()},100):o.setData({isLoading:!1})}var o=this,t=0;a()},videoCheck:function(a){if(u.btnAllowClick(this.data.eventControl)){var o={caseType:1,appType:"X"},t=u.globalData.account;"H0003"==t.block_code?(o.caseType=2,l.report("","PersonalChangeVideoBut",1)):l.report("","PersonalBorrowVideoBut",1),s.startVoipCall(o,function(a,o,e){if(console.log("personalCenter startVoipCall:",a),a)u.btnRecover(o.data.eventControl),e||o.showDialog(a,"知道了");else{var i={subscribe_info:u.globalData.account.subscribe_info,caseType:"H0003"==t.block_code?3:1,fromPage:"personalCenter"};n.push("voipResult",i)}},this)}},loanMoney:function(a){var o=u.globalData.account;if(this.data.allowLoan&&this.checkLend()&&u.btnAllowClick(this.data.eventControl)){l.report("","BorrowBut",1),o&&o.is_first_loan&&"Y"==o.is_first_loan&&l.report("","BorrowBut-firsttime",1);var t=this;setTimeout(function(){t.setData({isLoading:!0}),t.loadingAction()},500),e.prenotify({nopwdnosms_flag:0,type:1}),e.queryCard({},function(a,o,i){if(setTimeout(function(){t.setData({isLoading:!1})},500),console.log("personalCenter queryCard:",a,o),a)u.btnRecover(i.data.eventControl),i.showDialog(a.msg,"知道了");else{var r=e.getDefaultCard(o.array,o.default_bind_serial);r&&e.shareData.set("defauldCard",r);var l=e.sortCardlist(o.array);e.shareData.set("cardList",l),n.push("loan")}},this)}},showNotice:function(){this.data.noticeShowBottom,l.report("","TipsBut",1),o.show(this)},navigatorToFAQ:function(){u.btnAllowClick(this.data.eventControl)&&(l.report("","FAQBut",1),n.push("faq",null,null,!0))},navigatorToCoupon:function(){u.btnAllowClick(this.data.eventControl)&&(l.report("","MyCoupon",1),n.push("coupons",null,null,!0))},navigatorToRecord:function(){u.btnAllowClick(this.data.eventControl)&&(l.report("","RecordsBut",1),n.push("records",null,null,!0))},loanlistDetail:function(){if(u.btnAllowClick(this.data.eventControl)){i.show(),l.report("","PayInAdvanBut",1);var a={prod:u.globalData.prod},o=this;e.queryForwardRepay(a,function(a,t,e){if(console.log("personalCenter queryForwardRepay:",a,t),a)u.btnRecover(e.data.eventControl),i.hide(),o.showDialog("系统繁忙，请重新尝试","知道了");else{var t={loan:t.loan,current_day_nbr:t.current_day_nbr,is_acru_dd_pay:u.globalData.account.is_acru_dd_pay,is_acru_pay:u.globalData.account.is_acru_pay,black_tips:t.black_tips};n.push("repay",t)}},this)}},loanFirstDetail:function(){if(u.btnAllowClick(this.data.eventControl)){i.show(),l.report("","CurReceiptBut",1);var a={pay_date:u.globalData.account.curr_pmt_due_date,overdue_unpay:u.globalData.account.overdue_unpay,prod:u.globalData.prod};e.queryloanbydate(a,function(a,o,t){console.log("personalCenter queryloanbydate:",a,o),a?(u.btnRecover(t.data.eventControl),i.hide(),t.showDialog("系统繁忙，请重新尝试","知道了")):n.push("repayCurPeriod",o.loan)},this)}},closeRemind:function(){this.setData({remindShow:!1})},tapOperate:function(){},closeMaintainInfo:function(a){this.setData({maintainInfoShow:!1}),r.remindClose(this.data.maintainInfo.id)},showDialog:function(a,o){t.show(this,{type:1,content:a,cancelText:o})},gotofaq:function(){var a=this.data.maintainInfo.faq;a&&a.length>0&&n.push("faqDetail",{faqId:a})}}); 
 			}); 	require("pages/personalCenter/personalCenter.js");
 		__wxRoute = 'pages/coupons/coupons';__wxRouteBegin = true; 	define("pages/coupons/coupons.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../utils/pageManager.js"),o=require("../../utils/dataManager.js"),t=require("../common/alertView/alertView.js"),a=(require("../../utils/error.js"),require("../../utils/loading.js")),i=require("../../utils/report.js"),n=require("../../utils/util.js"),s=getApp();Page({data:{eventControl:{btnAllowFlag:!0},sScreen:s.globalData.sScreen,effective:[],invalid:[],isFirsLoading:!0,urlLine:""},onLoad:function(e){wx.setNavigationBarTitle({title:"优惠券"}),this.setData({urlLine:getApp().runEnvironment.cdnDomain+"/images/line.png"});var t=this,i={is_first_loan:s.globalData.account.is_first_loan};a.show(),o.queryequity(i,function(e,o){if(console.log("queryequity: ",e,o),a.hide(),e)t.showDialog(e.msg||"未知错误","知道了");else{for(var i=o.equity_list,s=[],r=[],l=0;l<i.length;l++){var u=i[l];u.equity_expire_date=n.formatDate(u.equity_expire_date,"YYYY.MM.DD"),"0"==(u=n.equityDataPreHandle(i[l])).status?s.push(u):r.push(u)}t.setData({effective:s,invalid:r,isFirsLoading:!1})}},this)},onReady:function(){},onShow:function(){i.report("CouponManage")},onHide:function(){},onUnload:function(){s.btnRecoverByUnload()},chooseEquity:function(t){this.checkLend()&&(i.report("","UseCoupon",1),a.show(),o.prenotify({nopwdnosms_flag:0,type:1}),o.queryCard({},function(i,n,s){if(console.log("coupons queryCard: ",i,n),a.hide(),i)getApp().btnRecover(s.data.eventControl),s.showDialog(i.msg,"知道了");else{var r=o.getDefaultCard(n.array,n.default_bind_serial);r&&o.shareData.set("defauldCard",r);var l=o.sortCardlist(n.array);o.shareData.set("cardList",l),e.goto("loan",t.currentTarget.dataset.equity)}},this))},gotofaq:function(){i.report("","UseCouponDetail",1),e.goto("faqClassify",{typeId:s.runEnvironment.couponsTypeId})},checkLend:function(){var e=s.globalData.account,o=e.control,t=o&&o.disable;return t&&t.loan_money?(this.showDialog(t.loan_money,"知道了"),!1):"L0005"==e.block_code?(this.showDialog("你有一笔借款正在审核中，暂时无法继续借钱。","知道了"),!1):"L0006"==e.block_code?(this.showDialog("你上一笔借款还在等待银行电话确认，暂时无法继续借钱。","知道了"),!1):"H0004"==e.block_code?(this.showDialog("你的换卡申请正在审核中，暂时无法借钱。","知道了"),!1):"H0001"==e.block_code?(this.showDialog("你已经更换过银行卡，请还清当前借款后再进行借钱。","知道了"),!1):"H0002"==e.block_code?(this.showDialog("你的换卡申请正在审核中，暂时无法借钱。","知道了"),!1):"00000"!=e.block_code?(this.showDialog(e.block_msg||"未知错误","知道了"),!1):e.unpaid_loans&&parseInt(e.unpaid_loans)>=20?(this.showDialog("你的未还清借款笔数已达到20笔上限，暂时无法继续借钱","知道了"),!1):e.available_amount<5e4?(this.showDialog("你的可借额度低于单笔最低借款额度500元，暂时无法继续借钱","知道了"),!1):"Y"!=e.is_overdue||(this.showDialog("你有借款逾期未还清，无法继续借款，请尽快还清欠款。","知道了"),!1)},showDialog:function(e,o){t.show(this,{type:1,content:e,cancelText:o})}}); 
 			}); 	require("pages/coupons/coupons.js");
 		__wxRoute = 'pages/records/records';__wxRouteBegin = true; 	define("pages/records/records.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("../common/alertView/alertView.js"),t=require("../../utils/report.js"),e=require("../../utils/dataManager.js"),n=require("../../utils/pageManager.js"),o=require("../../utils/loading.js"),i=require("../../utils/util.js"),r=getApp();Page({data:{eventControl:{btnAllowFlag:!0},sScreen:r.globalData.sScreen,currentTab:0,loanlist:[],repaylist:[],loanRecordPages:[],repayRecordPages:[],nextLoanLoading:!1,nextRepayLoading:!1,hasNextLoan:!1,hasNextRepay:!1,loadingMore:!1,isFirstLoanLoading:!0,isFirstRepayLoading:!0},onLoad:function(a){wx.setNavigationBarTitle({title:"借还记录"}),this.dataHandler(),this.setData({sScreen:r.globalData.sScreen})},onReady:function(){},onShow:function(){t.report("LoanPayRecords")},onHide:function(){},onUnload:function(){r.btnRecoverByUnload()},dataHandler:function(){o.show();var a=this;this.loadNextPage(0,function(t){o.hide(),t?a.showDialog(t.msg||"未知错误","知道了"):a.setData({isFirstLoanLoading:!1})})},onReachBottom:function(){this.data.isFirstLoanLoading||this.refresh()},queryNextPageLoanRecord:function(a){var t=this.data.loanRecordPages.length>0?this.data.loanRecordPages[this.data.loanRecordPages.length-1]:{},n={pagesize:"10",last_row_type:t.last_row_type||"",last_row_key:t.last_row_key||"0"};e.queryLoanRecord(n,a)},queryNextPageRepayRecord:function(a){var t=this.data.repayRecordPages.length>0?this.data.repayRecordPages[this.data.repayRecordPages.length-1]:{},n={pagesize:"10",last_row_type:t.last_row_type||"",last_row_key:t.last_row_key||"0"};e.queryRepayRecord(n,a)},loadNextPage:function(a,t){function e(a){t&&t(a)}function n(a){t&&t(null)}var o=this;if(0==a){if(this.data.nextLoanLoading)return;this.data.nextLoanLoading=!0,this.queryNextPageLoanRecord(function(a,t){if(o.data.nextLoanLoading=!1,a)return e(a);if(t.loan.length>0){o.data.loanRecordPages.push(t),"Y"==t.nextpage_flg?o.data.hasNextLoan=!0:o.data.hasNextLoan=!1;for(var r=o.data.loanlist,s=t.loan,l=0;l<t.loan.length;l++){var d={};"Y"==s[l].over_due_flag?d.state="已逾期":"Y"==s[l].pay_off_flag?d.state="已还清":d.state="还款中",d.loanNum=i.centToYuan(s[l].loan_init_prin),d.loanDate=i.formatDate(s[l].register_date,"YYYY/MM/DD"),d.loan_receipt_nbr=s[l].loan_receipt_nbr,r.push(d)}o.setData({loanlist:r})}n()})}else{if(this.data.nextRepayLoading)return;this.data.nextRepayLoading=!0,this.queryNextPageRepayRecord(function(a,t){if(o.data.nextRepayLoading=!1,a)return e(a);if(t.txn.length>0){o.data.repayRecordPages.push(t),"Y"==t.nextpage_flg?o.data.hasNextRepay=!0:o.data.hasNextRepay=!1;for(var r=o.data.repaylist,s=t.txn,l=0;l<t.txn.length;l++){var d={};d.repayNum=i.centToYuan(s[l].txn_amt),d.repayDate=i.formatDate(s[l].txn_date,"YYYY/MM/DD"),r.push(d)}o.setData({repaylist:r})}n()})}},refresh:function(){var a=this;(0==this.data.currentTab&&this.data.hasNextLoan||1==this.data.currentTab&&this.data.hasNextRepay)&&(a.setData({loadingMore:!0}),this.loadNextPage(this.data.currentTab,function(t){a.setData({loadingMore:!1})}))},tapLoan:function(){0!=this.data.currentTab&&(t.report("","LoanRecordBut",1),this.setData({currentTab:0}))},tapRepay:function(){if(1!=this.data.currentTab)if(t.report("","PayRecordBut",1),0==this.data.repayRecordPages.length&&this.data.isFirstRepayLoading){var a=this;o.show(),this.loadNextPage(1,function(t){a.setData({isFirstRepayLoading:!1}),o.hide(),t||1!=a.data.currentTab&&a.setData({currentTab:1})})}else this.setData({currentTab:1})},tapDetail:function(a){if(r.btnAllowClick(this.data.eventControl)){var e=a.currentTarget.dataset.index;if(void 0!=e&&e<this.data.loanlist.length){var o={loan_receipt_nbr:this.data.loanlist[e].loan_receipt_nbr};t.report("","loanPayDetailBut",1),"还款中"==this.data.loanlist[e].state||"已逾期"==this.data.loanlist[e].state?n.push("loanDetailRepaying",o,null,!0):"已还清"==this.data.loanlist[e].state&&n.push("loanDetailRepayed",o,null,!0)}}},showDialog:function(t,e){a.show(this,{type:1,content:t,cancelText:e})}}); 
 			}); 	require("pages/records/records.js");
 		__wxRoute = 'pages/records/loanDetailRepayed/loanDetailRepayed';__wxRouteBegin = true; 	define("pages/records/loanDetailRepayed/loanDetailRepayed.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("../../common/alertView/alertView.js"),t=require("../../../utils/report.js"),e=require("../../../utils/util.js"),_=require("../../../utils/dataManager.js"),n=require("../../../utils/pageManager.js"),i=require("../../../utils/loading.js"),r=getApp();Page({data:{eventControl:{btnAllowFlag:!0},sScreen:r.globalData.sScreen,loan_receipt_param:{},loan_receipt_nbr:"",sum:0,loanDate:"",equityDesc:"",loan_init_prin:0,loan_init_term:10,loanlist:[],isFirsLoading:!0,iconSize:60,isPeriod:!1},onLoad:function(a){wx.setNavigationBarTitle({title:"借款详情"}),console.log("loanDetailRepayed options: ",a);var t=n.getParams(a);t&&this.setData({loan_receipt_nbr:t.loan_receipt_nbr}),this.setData({sScreen:r.globalData.sScreen}),this.dataHandler()},onReady:function(){},onShow:function(){t.report("RepaymentDetail")},onHide:function(){},onUnload:function(){r.btnRecoverByUnload()},getEquityDesc:function(a){var t="";if("INT_D_NEW"!=a.equity_type&&"INT_D"!=a.equity_type||(t="该笔借款前"+a.equity_value+"天免利息"),"INT_P_NEW"==a.equity_type||"INT_P"==a.equity_type){var e=r.globalData.account.rate[0].interest_rate,_=Math.round(1e6*e)/1e4*a.equity_value/100<.02;t="该笔借款日利率"+a.equity_value/10+"折"+(_?",最低0.02%":"")}return t},dataHandler:function(){var a=this,t={loan_receipt_nbr:this.data.loan_receipt_nbr};i.show(),_.loanDetail(t,function(t,_){if(console.log("loanDetailRepayed loanDetail:",t,_),i.hide(),t)a.showDialog(t.msg||"未知错误","知道了");else{var n={};n.loan_init_prin=_.loan_init_prin,n.loan_bank=_.loan_bank,n.loan_card_no=_.loan_card_no,n.pay_bank=_.pay_bank,n.pay_card_no=_.pay_card_no,n.register_date=_.register_date,n.expire_date=_.expire_date,n.interest_rate=_.interest_rate,n.orig_interest_rate=_.orig_interest_rate,"Y"==_.has_equity&&(n.list_no=_.list_no,n.equity_type=_.equity_type,n.equity_value=_.equity_value),n.first_pay_date=_.first_pay_date,n.name=_.name,n.id_no=_.id_no,n.stmt_day=_.stmt_day,n.is_paid_out=_.is_paid_out,n.loan_init_term=_.loan_init_term;for(var o="",c=0;c<_.banks.length;c++)0==c?o=_.banks[c].bank_name:o+="、"+_.banks[c].bank_name;n.banks=o,n.contract_ver=_.contract_ver,n.isPeriod="1"==_.prod,n.mct_name=_.mct_name,n.mct_in_bankname=_.mct_in_bankname,n.mct_acct_no=_.mct_acct_no,n.mct_acct_name=_.mct_acct_name,n.mct_out_bankname=_.mct_out_bankname,n.mct_trans_remark=_.mct_trans_remark,n.mct_trans_authcode=_.mct_trans_authcode,a.setData({loanDate:e.formatDate(_.register_date,"YYYY/MM/DD"),equityDesc:a.getEquityDesc(_),loan_init_prin:e.centToYuan(_.loan_init_prin),loan_init_term:_.loan_init_term,loan_receipt_param:n,isPeriod:"1"==_.prod});var s=_.schedule,l=0;if(s){for(var p=a.data.loanlist,c=0;c<s.length;c++){var m=s[c];l+=Number(m.principal||"0")+Number(m.interest||"0")+Number(m.penalty||"0");var d={};d.repayDate=e.formatDate(m.pmt_due_date,"YYYY/MM/DD"),d.pay_off_flag=m.pay_off_flag,d.is_due=m.is_due,d.repayNum=e.centToYuan(Number(m.principal||"0")+Number(m.interest||"0")+Number(m.penalty||"0")),p.push(d)}a.setData({loanlist:p,sum:e.centToYuan(l)})}a.setData({isFirsLoading:!1,iconSize:120*r.globalData.ratio})}})},viewReceipt:function(){if(r.btnAllowClick(this.data.eventControl)){var a={loan_init_prin:this.data.loan_receipt_param.loan_init_prin||"",loan_bank:this.data.loan_receipt_param.loan_bank||"",loan_card_no:this.data.loan_receipt_param.loan_card_no||"",pay_bank:this.data.loan_receipt_param.pay_bank||"",pay_card_no:this.data.loan_receipt_param.pay_card_no||"",interest_rate:this.data.loan_receipt_param.interest_rate||"",orig_interest_rate:this.data.loan_receipt_param.orig_interest_rate||"",register_date:this.data.loan_receipt_param.register_date||"",expire_date:this.data.loan_receipt_param.expire_date||"",first_pay_date:this.data.loan_receipt_param.first_pay_date||"",name:this.data.loan_receipt_param.name||"",id_no:this.data.loan_receipt_param.id_no||"",stmt_day:this.data.loan_receipt_param.stmt_day||"",is_paid_out:this.data.loan_receipt_param.is_paid_out||"",loan_init_term:this.data.loan_receipt_param.loan_init_term||"",banks:this.data.loan_receipt_param.banks||"",list_no:this.data.loan_receipt_param.list_no||"",equity_type:this.data.loan_receipt_param.equity_type||"",equity_value:this.data.loan_receipt_param.equity_value||"",contract_ver:this.data.loan_receipt_param.contract_ver||"",isPeriod:this.data.loan_receipt_param.isPeriod,mct_name:this.data.loan_receipt_param.mct_name,mct_bankname:this.data.loan_receipt_param.mct_in_bankname,mct_acct_no:this.data.loan_receipt_param.mct_acct_no,mct_acct_name:this.data.loan_receipt_param.mct_acct_name,mct_out_bankname:this.data.loan_receipt_param.mct_out_bankname,mct_trans_remark:this.data.loan_receipt_param.mct_trans_remark,mct_trans_authcode:this.data.loan_receipt_param.mct_trans_authcode};t.report("","CheckLoanBut",1),n.push("receipt",a)}},showDialog:function(t,e){a.show(this,{type:1,content:t,cancelText:e})},navigatorToCertificate:function(){if(r.btnAllowClick(this.data.eventControl)){var a={loan_init_prin:this.data.loan_receipt_param.loan_init_prin,mct_in_bankname:this.data.loan_receipt_param.mct_in_bankname,mct_acct_no:this.data.loan_receipt_param.mct_acct_no,mct_acct_name:this.data.loan_receipt_param.mct_acct_name,mct_out_bankname:this.data.loan_receipt_param.mct_out_bankname,mct_trans_remark:this.data.loan_receipt_param.mct_trans_remark};n.push("loanCertificate",a)}}}); 
 			}); 	require("pages/records/loanDetailRepayed/loanDetailRepayed.js");
 		__wxRoute = 'pages/records/loanDetailRepaying/loanDetailRepaying';__wxRouteBegin = true; 	define("pages/records/loanDetailRepaying/loanDetailRepaying.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("../../common/alertView/alertView.js"),t=require("../../../utils/report.js"),e=require("../../../utils/util.js"),n=require("../../../utils/dataManager.js"),i=require("../../../utils/pageManager.js"),r=require("../../../utils/loading.js"),_=getApp();Page({data:{eventControl:{btnAllowFlag:!0},sScreen:_.globalData.sScreen,loan_receipt_param:{},loan_receipt_nbr:"",loanDate:"",equityDesc:"",loan_init_prin:0,currentRepayNum:0,remainNum:0,currentTerm:6,loan_init_term:10,isOverDue:!1,isPaid:!1,textLocation:"0%",iconLocation:"0%",loanlist:[],remainloanlist:[],isFirsLoading:!0,curTermRepayDate:"",curTermInterest:0,curTermPenalty:0,totalRepay:0,totalRemain:0,repaylistExpand:!0,remainlistExpand:!1,isPeriod:!1},onLoad:function(a){wx.setNavigationBarTitle({title:"借款详情"}),console.log("loanDetailRepaying options: ",a);var t=i.getParams(a);t&&this.setData({loan_receipt_nbr:t.loan_receipt_nbr}),this.setData({globalData:_.globalData}),this.dataHandler()},onReady:function(){},onShow:function(){t.report("RepaymentDetail")},onHide:function(){},onUnload:function(){_.btnRecoverByUnload()},getEquityDesc:function(a){var t="";if("INT_D_NEW"!=a.equity_type&&"INT_D"!=a.equity_type||(t="该笔借款前"+a.equity_value+"天免利息"),"INT_P_NEW"==a.equity_type||"INT_P"==a.equity_type){var e=_.globalData.account.rate[0].interest_rate,n=Math.round(1e6*e)/1e4*a.equity_value/100<.02;t="该笔借款日利率"+a.equity_value/10+"折"+(n?",最低0.02%":"")}return t},dataHandler:function(){var a=this,t={loan_receipt_nbr:this.data.loan_receipt_nbr};r.show(),n.loanDetail(t,function(t,n){if(console.log("loanDetailRepaying loanDetail:",t,n),r.hide(),t)a.showDialog(t.msg||"未知错误","知道了");else{var i={};i.loan_init_prin=n.loan_init_prin,i.loan_bank=n.loan_bank,i.loan_card_no=n.loan_card_no,i.pay_bank=n.pay_bank,i.pay_card_no=n.pay_card_no,i.register_date=n.register_date,i.expire_date=n.expire_date,i.interest_rate=n.interest_rate,i.orig_interest_rate=n.orig_interest_rate,"Y"==n.has_equity&&(i.list_no=n.list_no,i.equity_type=n.equity_type,i.equity_value=n.equity_value),i.first_pay_date=n.first_pay_date,i.name=n.name,i.id_no=n.id_no,i.stmt_day=n.stmt_day,i.is_paid_out=n.is_paid_out,i.loan_init_term=n.loan_init_term;for(var o="",s=0;s<n.banks.length;s++)0==s?o=n.banks[s].bank_name:o+="、"+n.banks[s].bank_name;i.banks=o,i.contract_ver=n.contract_ver,i.isPeriod="1"==n.prod,i.mct_name=n.mct_name,i.mct_in_bankname=n.mct_in_bankname,i.mct_acct_no=n.mct_acct_no,i.mct_acct_name=n.mct_acct_name,i.mct_out_bankname=n.mct_out_bankname,i.mct_trans_remark=n.mct_trans_remark,i.mct_trans_authcode=n.mct_trans_authcode,a.setData({loan_receipt_param:i,loanDate:e.formatDate(n.register_date,"YYYY/MM/DD"),equityDesc:a.getEquityDesc(n),loan_init_prin:e.centToYuan(n.loan_init_prin),currentRepayNum:e.centToYuan(n.curr_amount),remainNum:e.centToYuan(n.unpay_amount),currentTerm:Number(n.curr_term),loan_init_term:Number(n.loan_init_term),isOverDue:"Y"==n.is_overdue,isPeriod:"1"==n.prod});var c=n.schedule;if(c){for(var l=a.data.loanlist,m=a.data.remainloanlist,p=0,d=0,s=0;s<c.length;s++){var u=c[s],h={};if(h.repayDate=e.formatDate(u.pmt_due_date,"YYYY/MM/DD"),h.pay_off_flag=u.pay_off_flag,h.is_due=u.is_due,h.is_paid=u.is_paid,h.repayNum=e.centToYuan(Number(u.principal||"0")+Number(u.interest||"0")+Number(u.penalty||"0")),"Y"==h.is_paid?(l.push(h),p+=Number(h.repayNum)):(m.push(h),d+=Number(h.repayNum)),s==a.data.currentTerm-1){var y=_.globalData.account;a.setData({curTermRepayDate:e.formatDate(u.pmt_due_date,"YYYY/MM/DD"),curTermInterest:e.centToYuan(u.interest||"0"),curTermPenalty:e.centToYuan(u.penalty||"0"),isPaid:"1"==y.is_at_stmt_day&&"Y"==u.is_paid&&"N"==u.pay_off_flag})}}a.setData({loanlist:l,totalRepay:p.toFixed(2),remainloanlist:m,totalRemain:d.toFixed(2)}),0==l.length&&a.setData({repaylistExpand:!1})}a.setSliding(),a.setData({isFirsLoading:!1})}})},setSliding:function(){var a;a=this.data.currentTerm>this.data.loan_init_term/2?(this.data.loan_init_term-this.data.currentTerm)/(this.data.loan_init_term-1)*100+"%":(this.data.currentTerm-1)/(this.data.loan_init_term-1)*100+"%",this.setData({textLocation:a});var t=(this.data.currentTerm-1)/(this.data.loan_init_term-1)*100+"%";this.setData({iconLocation:t})},viewReceipt:function(){if(_.btnAllowClick(this.data.eventControl)){var a={loan_init_prin:this.data.loan_receipt_param.loan_init_prin||"",loan_bank:this.data.loan_receipt_param.loan_bank||"",loan_card_no:this.data.loan_receipt_param.loan_card_no||"",pay_bank:this.data.loan_receipt_param.pay_bank||"",pay_card_no:this.data.loan_receipt_param.pay_card_no||"",interest_rate:this.data.loan_receipt_param.interest_rate||"",orig_interest_rate:this.data.loan_receipt_param.orig_interest_rate||"",register_date:this.data.loan_receipt_param.register_date||"",expire_date:this.data.loan_receipt_param.expire_date||"",first_pay_date:this.data.loan_receipt_param.first_pay_date||"",name:this.data.loan_receipt_param.name||"",id_no:this.data.loan_receipt_param.id_no||"",stmt_day:this.data.loan_receipt_param.stmt_day||"",is_paid_out:this.data.loan_receipt_param.is_paid_out||"",loan_init_term:this.data.loan_receipt_param.loan_init_term||"",banks:this.data.loan_receipt_param.banks||"",list_no:this.data.loan_receipt_param.list_no||"",equity_type:this.data.loan_receipt_param.equity_type||"",equity_value:this.data.loan_receipt_param.equity_value||"",contract_ver:this.data.loan_receipt_param.contract_ver||"",isPeriod:this.data.loan_receipt_param.isPeriod,mct_name:this.data.loan_receipt_param.mct_name,mct_bankname:this.data.loan_receipt_param.mct_in_bankname,mct_acct_no:this.data.loan_receipt_param.mct_acct_no,mct_acct_name:this.data.loan_receipt_param.mct_acct_name,mct_out_bankname:this.data.loan_receipt_param.mct_out_bankname,mct_trans_remark:this.data.loan_receipt_param.mct_trans_remark,mct_trans_authcode:this.data.loan_receipt_param.mct_trans_authcode};t.report("","CheckLoanBut",1),i.push("receipt",a)}},tapRepaylist:function(){this.data.loanlist.length>0&&this.setData({repaylistExpand:!this.data.repaylistExpand})},tapRemainlist:function(){this.data.remainloanlist.length>0&&this.setData({remainlistExpand:!this.data.remainlistExpand})},showDialog:function(t,e){a.show(this,{type:1,content:t,cancelText:e})},navigatorToCertificate:function(){if(_.btnAllowClick(this.data.eventControl)){var a={loan_init_prin:this.data.loan_receipt_param.loan_init_prin,mct_in_bankname:this.data.loan_receipt_param.mct_in_bankname,mct_acct_no:this.data.loan_receipt_param.mct_acct_no,mct_acct_name:this.data.loan_receipt_param.mct_acct_name,mct_out_bankname:this.data.loan_receipt_param.mct_out_bankname,mct_trans_remark:this.data.loan_receipt_param.mct_trans_remark};i.push("loanCertificate",a)}}}); 
 			}); 	require("pages/records/loanDetailRepaying/loanDetailRepaying.js");
 		__wxRoute = 'pages/records/receipt/receipt';__wxRouteBegin = true; 	define("pages/records/receipt/receipt.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t=require("../../common/marketInfo/marketInfo.js"),a=require("../../../utils/report.js"),e=require("../../../utils/view.js"),n=(require("../../../utils/caculator.js"),require("../../../utils/util.js")),r=require("../../../utils/pageManager.js"),i=require("../loanCertificate/loanCertificate.js"),o=(e.general,getApp());Page({data:{eventControl:{btnAllowFlag:!0},sScreen:o.globalData.sScreen,pageShow:!1,loan_init_prin:0,loan_bank:"",loan_card_no:"",rate:"",original_rate:"",register_date:"",expire_date:"",equity_fullname:"",first_pay_date:"",name:"",id_no:"",stmt_day:"",is_paid_out:"",loan_init_term:"",use:"个人日常消费",banks:"",equity:{},planParams:{},contract_ver:"",isPeriod:!1,marketInfo:{},certificateInfoData:{}},onLoad:function(t){wx.setNavigationBarTitle({title:"更多详情"}),console.log("receipt options: ",t);var a=r.getParams(t);a&&this.dataHandler(a),this.setData({pageShow:!0,sScreen:o.globalData.sScreen})},onReady:function(){},onShow:function(){a.report("ReceiptInfo")},onHide:function(){},onUnload:function(){o.btnRecoverByUnload()},dataHandler:function(t){if(t.equity_type){var a=n.equityDataPreHandle({list_no:t.list_no,equity_type:t.equity_type,equity_value:t.equity_value},t.orig_interest_rate||t.interest_rate);a&&a.js_equity_fullname&&this.setData({equity:a,equity_fullname:a.js_equity_fullname})}var e=this.data.marketInfo;e.mct_name=t.mct_name,e.mct_bankname=t.mct_bankname,e.mct_acct_no=t.mct_acct_no,e.mct_acct_name=t.mct_acct_name;var r=this.data.certificateInfoData;r.mctAcctName=t.mct_acct_name,r.mctAcctNo=t.mct_acct_no&&t.mct_acct_no.replace(/(.{4})/g,"$1 "),r.mctInBankname=t.mct_bankname,r.mctOutBankname=t.mct_out_bankname,r.mctTransRemark=t.mct_trans_remark,r.mctTransAuthcode=t.mct_trans_authcode,this.setData({loan_init_prin:n.centToYuan(t.loan_init_prin),loan_bank:t.loan_bank,loan_card_no:t.loan_card_no,pay_bank:t.pay_bank,pay_card_no:t.pay_card_no,rate:Math.round(1e6*t.interest_rate)/1e4,original_rate:Math.round(1e6*t.orig_interest_rate)/1e4,register_date:n.formatDate(t.register_date,"YYYY/MM/DD"),expire_date:n.formatDate(t.expire_date,"YYYY/MM/DD"),first_pay_date:n.formatDate(t.first_pay_date,"YYYY/MM/DD"),name:t.name,id_no:t.id_no,stmt_day:t.stmt_day,is_paid_out:t.is_paid_out,loan_init_term:t.loan_init_term,banks:t.banks,contract_ver:t.contract_ver,isPeriod:t.isPeriod,marketInfo:e,certificateInfoData:r});var i={};i.interestRate=t.orig_interest_rate||t.interest_rate,i.loanTerm=t.loan_init_term,i.firstRepayDay=t.first_pay_date,i.money=t.loan_init_prin/100,i.startDate=t.register_date,i.equity=this.data.equity,this.setData({planParams:i})},viewContract:function(){if(o.btnAllowClick(this.data.eventControl)){a.report("","LoanContractBut",1);var t=this;r.showContractList(2,this.data.contract_ver,function(){o.btnRecover(t.data.eventControl)})}},showMarketInfo:function(){a.report("","Branddetails",1),t.show(this)},viewCertificate:function(){a.report("CertificatePage"),i.show(this)}}); 
 			}); 	require("pages/records/receipt/receipt.js");
 		__wxRoute = 'pages/repay/repayCurPeriod/repayCurPeriod';__wxRouteBegin = true; 	define("pages/repay/repayCurPeriod/repayCurPeriod.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../common/alertView/alertView.js"),a=require("../../../utils/report.js"),t=require("../../../utils/pageManager.js"),r=require("../../../utils/dataManager.js"),n=require("../../../utils/jsApiHelper.js"),o=require("../../../utils/loading.js"),i=require("../../../utils/util.js"),s=require("../../../utils/view.js"),u=getApp();Page({data:{pageName:"repayCurPeriod",pageTitle:"本期应还",eventControl:{btnAllowFlag:!0},sScreen:u.globalData.sScreen,pageShow:!1,overdueDays:0,warningContent:"",warningDetail:"",dueDate:"",bankName:"",bankEndNum:"",sum:0,sumAsCent:0,loanStatus:0,isOverDue:!1,overduePenalty:0,isAcruDDPay:!1,isAcruPay:!1,isShowEquityEntrance:!1,loanlist:[],maintainInfoShow:!1,maintainInfo:{faq:""},iconSize:15},onLoad:function(e){var a=u.globalData.account,r="Y"==a.is_overdue?"逾期详情":"本期应还";wx.setNavigationBarTitle({title:r}),console.log("repayCurPeriod options: ",e);var n=t.getParams(e);n&&(a.loan=n),this.setData({sScreen:u.globalData.sScreen,pageTitle:r}),this.dataHandler(a),this.showPage(!0)},onReady:function(){},onShow:function(){this.data.isOverDue?a.report("DelayPayment"):a.report("CurrentPeriod");var e=u.globalData.pageParam,n=e&&e.comefrom;e&&e.requestAccount;if("repayResult"==n||"appShow"==n){if("appShow"==n&&"本期应还"==this.data.pageTitle)return;var i=e.refreshDataFlag;if(e.comefrom="",u.globalData.pageParam=e,0==i){o.show();var s=this;r.queryAccount({outputtype:"json"},function(e,a){if(!s.needGoToPage()){if(e)s.showPage(!0);else if("N"==a.is_overdue)"1"==u.globalData.prod?t.goto("loanAmount"):t.goto("personalCenter");else{var a=u.globalData.account;s.dataHandler(a),s.showPage(!0)}o.hide()}})}else 1==i?this.needGoToPage()||("1"==u.globalData.prod?t.goto("loanAmount"):t.goto("personalCenter")):this.needGoToPage()}},onHide:function(){},onUnload:function(){u.btnRecoverByUnload()},showdate:function(e){var a=i.formatDate(this.data.bizDate,"YYYY/MM/DD");return a=new Date(new Date(a)-0-864e5*this.data.overdueDays+864e5*e),a=new Date(a).format("yyyyMMdd"),a=i.formatDate(a,"YYYY年MM月DD日")},needGoToPage:function(){return u.exceptionHandler()},setWarningContent:function(){var e="",a="";this.data.overdueDays>0&&this.data.overdueDays<=3?(e="已逾期"+this.data.overdueDays+"天，请尽快还款",a=""):this.data.overdueDays>=4&&this.data.overdueDays<=8?(e="已逾期"+this.data.overdueDays+"天，逾期信息将于"+this.showdate(9)+"上报人行征信",a="逾期信息将于"+this.showdate(9)+"上报人行征信，将会影响你在所有银行的信用卡、贷款审批，请于"+this.showdate(8)+"之前还清欠款。"):this.data.overdueDays>=9&&this.data.overdueDays<=30?(e="已逾期"+this.data.overdueDays+"天，请尽快还款，以免人行征信继续恶化",a="逾期信息已上报人行征信，将会影响你在所有银行的信用卡、贷款审批，请尽快还款，以改善人行征信不良影响。"):this.data.overdueDays>=31&&this.data.overdueDays<=60?(e="已逾期"+this.data.overdueDays+"天，人行征信进一步恶化，将给你的工作、生活带来不利影响",a="人行征信进一步恶化，继续拖欠将会影响你在所有银行的信用卡、贷款审批，影响人事招聘审查、录用。"):this.data.overdueDays>=61&&this.data.overdueDays<=90?(e="已逾期"+this.data.overdueDays+"天，微众银行将对欠款严重人员提起诉讼",a="微众银行将派专人上门与你当面沟通还款事宜，对欠款严重人员将向法院提起诉讼，请立即还款。"):this.data.overdueDays>90&&(e="已逾期"+this.data.overdueDays+"天，微众银行将对欠款严重人员提起诉讼",a="微众银行将派专人上门与你当面沟通还款事宜，对欠款严重人员将向法院提起诉讼，请立即还款。"),this.setData({warningContent:e,warningDetail:a})},showPage:function(a){!a&&this.data.alertViewData&&this.data.alertViewData.viewShow&&e.hide(this),this.setData({pageShow:a})},dataHandler:function(e){var a=[],t=0,r=0,n=0;if("Y"==e.is_overdue){this.setData({overdueDays:Number(e.overdue_days||"0"),bizDate:e.biz_date||(new Date).format("yyyyMMdd"),isAcruDDPay:"Y"==e.is_acru_dd_pay,isAcruPay:"Y"==e.is_acru_pay});var o=s.remindShow("refund");o&&this.setData({maintainInfoShow:!0,maintainInfo:o}),this.setWarningContent(),t=e.overdue_array.length;for(l=0;l<t;l++){d=e.overdue_array[l];(h={}).loanNum=i.centToYuan(d.loan_init_prin),h.loanDate=i.formatDate(d.register_date,"YYYY/MM/DD"),h.loan_receipt_nbr=d.loan_receipt_nbr,h.repayNum=i.centToYuan(Number(d.curr_principal||"0")+Number(d.curr_interest||"0")+Number(d.curr_penalty||"0")),h.repayNumAsCent=Number(d.curr_principal||"0")+Number(d.curr_interest||"0")+Number(d.curr_penalty||"0"),a.push(h),r+=parseFloat(h.repayNum),n+=parseInt(h.repayNumAsCent)}r=Number(r).toFixed(2)}else{t=e.loan.length;for(var l=0;l<t;l++){var d=e.loan[l],h={};h.loanNum=i.centToYuan(d.loan_init_prin),h.loanDate=i.formatDate(d.register_date,"YYYY/MM/DD"),h.loan_receipt_nbr=d.loan_receipt_nbr,h.repayNum=i.centToYuan(Number(d.principal||"0")+Number(d.interest||"0")),h.repayNumAsCent=Number(d.principal||"0")+Number(d.interest||"0"),a.push(h)}r=i.centToYuan(e.curr_bal),n=e.curr_bal,r=Number(r).toFixed(2)}this.setData({loanlist:a,sum:r,sumAsCent:n,isOverDue:"Y"==e.is_overdue,loanStatus:e.loan_status,overduePenalty:i.centToYuan(e.overdue_penalty||"0"),dueDate:i.formatDate(e.curr_pmt_due_date,"MM月DD日应还"),bankName:e.bank_name,bankEndNum:e.card_tail,isShowEquityEntrance:"Y"==e.is_show_equity_entrance,iconSize:30*u.globalData.ratio})},tapDetail:function(e){if(u.btnAllowClick(this.data.eventControl)){var r=e.currentTarget.dataset.index;if(void 0!=r&&r<this.data.loanlist.length){var n={loan_receipt_nbr:this.data.loanlist[r].loan_receipt_nbr};a.report("","RepaymentDetailBut",1),t.push("loanDetailRepaying",n,null,!0)}}},handleError:function(e,a){u.btnRecover(this.data.eventControl),o.hide(),a||this.showDialog(e.msg||"未知错误","知道了")},tapRepay:function(){var e=u.globalData.account,t=e.control,n=t&&t.disable;if(n&&n.repay_money)this.showDialog(e.control.disable.repay_money,"知道了");else if(!this.data.isAcruDDPay&&!this.data.isAcruPay&&u.btnAllowClick(this.data.eventControl)){a.report("","DelayPaymentBut",1),o.show();for(var i="",s=0;s<this.data.loanlist.length;s++){var l=this.data.loanlist[s];i=i+(0==s?"":"#")+l.loan_receipt_nbr}var d={receipt_nbr:i,tran_amt:this.data.sumAsCent,type:1,token_scene:3};r.repayOrder(d,function(e,a,t){o.hide(),e?t.handleError(e):t.requestCheckoutCounter(a.repay_token)},this)}},requestCheckoutCounter:function(e){var a={req_type:3,repay_token:e};n.getWebPayCheckoutCounterRequst(a,function(n,i,s){if(console.log("repayCurPeriod getWebPayCheckoutCounterRequst:",n,i),n)s.handleError(n,!0);else{var l=u.globalData.account;o.show(),a={token_scene:3,type:1,repay_token:e,cft_token:i.token,bind_serial:i.bind_serial||i.bindSerial,card_no:l.card_no},r.repayConfirm(a,function(e,a,r){if(e)if(e.result){n=getCurrentPages();e.result.fromPage="repayCurPeriod",1==n.length?t.push("repayResult",e.result):t.goto("repayResult",e.result)}else e.msg="系统繁忙，请重新尝试",r.handleError(e);else{var n=getCurrentPages();a.fromPage="repayCurPeriod",1==n.length?t.push("repayResult",a):t.goto("repayResult",a)}},s)}},this)},navigatorToFAQ:function(){u.btnAllowClick(this.data.eventControl)&&(a.report("","DelayFAQBut",1),t.push("faq",null,null,!0))},navigatorToCoupon:function(){u.btnAllowClick(this.data.eventControl)&&(a.report("","DelayMyDiscountBut",1),t.push("coupons",null,null,!0))},navigatorToRecord:function(){u.btnAllowClick(this.data.eventControl)&&(a.report("","DelayRecordsBut",1),t.push("records",null,null,!0))},tapWarningDetail:function(){this.showDialog(this.data.warningDetail,"知道了")},closeMaintainInfo:function(e){this.setData({maintainInfoShow:!1}),s.remindClose(this.data.maintainInfo.id)},showDialog:function(a,t){e.show(this,{type:1,content:a,cancelText:t})},gotofaq:function(){var e=this.data.maintainInfo.faq;e.length>0&&t.push("faqDetail",{faqId:e})}}); 
 			}); 	require("pages/repay/repayCurPeriod/repayCurPeriod.js");
 		__wxRoute = 'pages/faq/faq';__wxRouteBegin = true; 	define("pages/faq/faq.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t,a,e=getApp(),s=require("../../utils/pageManager.js"),i=require("../../utils/util.js"),n=require("../../utils/requestHelper.js"),o=require("../../utils/report.js"),r=e.runEnvironment.faqJsonDomain,c="";Page({data:{eventControl:{btnAllowFlag:!0},search:"search",clear:"clear",searchBox:"",searchCancel:"",searchView:"hide",searchResult:"hide",searchNoResult:"hide",contShow:!1,inputValue:"",focus:!1,faqList:[],prmList:[],allFaqList:[],searchList:[],sScreen:e.globalData.sScreen},onLoad:function(s){a=e.globalData.customerId,wx.setNavigationBarTitle({title:"常见问题"});var c=this;o.reportFaqIndex(),n.request({url:r+"FAQ_CONTENT_1_1_3_"+a+".JSON",data:{},method:"GET",header:{"content-type":"application/json"},success:function(a){if(200==a.statusCode&&void 0!=a.data){var e=a.data;c.sortFirst(e),i.sortList("seqNo",e),t&&"1"==t.affiche&&e.unshift(t),c.setData({faqList:e})}},fail:function(t){console.log(t)}}),n.request({url:r+"TYPE_CONTENT_1_1_3.JSON",data:{},method:"GET",header:{"content-type":"application/json"},success:function(t){if(200==t.statusCode&&void 0!=t.data){var a=t.data.TYPES[0].childType;i.sortList("seqNo",a),c.setData({prmList:a})}},fail:function(t){console.log(t)}}),n.request({url:r+"FAQ_CONTENT_1_1_3.JSON",data:{},method:"GET",header:{"content-type":"application/json"},success:function(t){200==t.statusCode&&void 0!=t.data&&c.setData({allFaqList:t.data})},fail:function(t){console.log(t)}}),this.setData({sScreen:e.globalData.sScreen})},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){e.btnRecoverByUnload()},initData:function(){"Y"!=e.globalData.isWhite?a=2:"Y"!=e.globalData.account.active?a=3:"Y"!=e.globalData.account.is_activated?a=4:"Y"==e.globalData.account.is_activated&&(a=5)},sortFirst:function(a){for(var e=0,s=!1,i=0;i<a.length;i++)1==a[i].affiche&&(s=!0,t=a[i],e=i);s&&a.splice(e,1)},bindKeyInput:function(t){this.setData({searchList:[]});var a=[];if(""!=(c=t.detail.value)){for(var e=0;e<this.data.allFaqList.length;e++){var s=this.data.allFaqList[e];s.faqName.indexOf(c)>=0&&a.push(s)}this.setData({searchList:a})}this.data.searchList.length>0?this.setData({searchResult:"db",contShow:!0}):this.setData({contShow:!0,searchResult:"hide"})},bindfocus:function(){o.reportFaqSearchFocus(),this.setData({contShow:!0,searchNoResult:"hide"})},bindblur:function(t){var a=t.detail.value;""!=(a=i.strTrim(a,"g"))?this.setData({contShow:!0}):this.setData({contShow:!1,searchView:"hide",searchBox:"db"})},tapDetail:function(t){var a=t.currentTarget.dataset.index;if(void 0!=a&&a<this.data.faqList.length){var e={faqId:this.data.faqList[a].faqId};s.push("faqDetail",e)}},tapType:function(t){var a=t.currentTarget.dataset.index;if(void 0!=a&&a<this.data.prmList.length){var e={typeId:this.data.prmList[a].typeId};s.push("faqClassify",e)}},tapSearch:function(t){var a=t.currentTarget.dataset.index;if(void 0!=a&&a<this.data.searchList.length){var e={faqId:this.data.searchList[a].faqId,fromSearch:"Y",searchWord:c};s.push("faqDetail",e)}},searchBox:function(){this.setData({searchBox:"hide",searchView:"db",focus:!0})},icon_search:function(){this.setData({contShow:!1})},icon_clear:function(){this.setData({inputValue:"",focus:!0,searchResult:"hide",searchNoResult:"hide"})},search_cancel:function(){o.reportFaqSearchCancel(c),this.setData({contShow:!1,searchView:"hide",searchBox:"db",inputValue:"",searchResult:"hide",searchNoResult:"hide"})},bindconfirm:function(t){t.detail.value;0==this.data.searchList.length?(o.reportFaqSearch(c,0),this.setData({contShow:!0,searchResult:"hide",searchNoResult:"db"})):o.reportFaqSearch(c,1)},tapTickling:function(){var t={faqId:e.runEnvironment.defaultFaqId};s.push("faqDetail",t)}}); 
 			}); 	require("pages/faq/faq.js");
 		__wxRoute = 'pages/faq/faqDetail/faqDetail';__wxRouteBegin = true; 	define("pages/faq/faqDetail/faqDetail.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=getApp(),t=require("../../../utils/pageManager.js"),o=require("../../../utils/requestHelper.js"),i=require("../../../utils/report.js"),e=a.runEnvironment.faqJsonDomain;Page({data:{eventControl:{btnAllowFlag:!0},faqId:"",goodCur:"",badCur:"",clickFlag:"",goodImg:"../../../images/icon_good.png",badImg:"../../../images/icon_bad.png",faqName:"",faqADesc:[],goodAmt:"",badAmt:"",relation:[],imageList:[],sScreen:a.globalData.sScreen,showBadResolution:!1},onLoad:function(o){wx.setNavigationBarTitle({title:"常见问题"}),console.log("faqDetail options: ",o);var e=t.getParams(o);if(void 0!=e&&void 0!=e.faqId){this.setData({faqId:e.faqId});var n=e.fromSearch,d=e.searchWord,s=e.fromType,r="index";void 0!=n?i.reportFromSearch(d,e.faqId):void 0!=s?(r="typeId="+e.typeId,i.reportFaqDetail(e.faqId,r)):i.reportFaqDetail(e.faqId,r),this.detailJson(e.faqId)}this.setData({sScreen:a.globalData.sScreen})},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){a.btnRecoverByUnload()},tapGood:function(){""==this.data.clickFlag&&(i.reportSatisfaction(this.data.faqId,1),this.setData({goodImg:"../../../images/icon_good_cur.png",goodCur:"btn_cur",clickFlag:"1",goodAmt:"amt_img"}))},tapBad:function(){""==this.data.clickFlag&&(i.reportSatisfaction(this.data.faqId,0),this.setData({badImg:"../../../images/icon_bad_cur.png",badCur:"btn_cur",clickFlag:"1",badAmt:"amt_img",showBadResolution:this.data.faqId!=a.runEnvironment.defaultFaqId}))},tapResolution:function(){var o={faqId:a.runEnvironment.defaultFaqId};t.push("faqDetail",o)},tapRelation:function(a){var t=a.currentTarget.dataset.index;if(void 0!=t&&t<this.data.relation.length){var o="faqId="+this.data.faqId;i.reportFaqDetail(this.data.relation[t].faqId,o),this.detailJson(this.data.relation[t].faqId),this.setData({goodImg:"../../../images/icon_good.png",goodCur:"",clickFlag:"",goodAmt:"",badImg:"../../../images/icon_bad.png",badCur:"",badAmt:"",faqId:this.data.relation[t].faqId})}},detailJson:function(t){var i=this;o.request({url:e+"F"+t+".JSON",data:{},method:"GET",header:{"content-type":"application/json"},success:function(t){if(void 0!=t.data){var o;o="ios"==a.globalData.systemInfo.platform?t.data.faqIDesc&&t.data.faqIDesc.split("s-p"):t.data.faqADesc&&t.data.faqADesc.split("s-p");var e=[];void 0!=t.data.picUrl&&(e=t.data.picUrl.split(";"));for(var n=[],d=0;d<e.length;d++)void 0!=e[d]&&""!=e[d]&&n.push(e[d]);i.setData({faqName:t.data.faqName,relation:t.data.relation,faqADesc:o,imageList:n})}},fail:function(a){console.log(a)}})}}); 
 			}); 	require("pages/faq/faqDetail/faqDetail.js");
 		__wxRoute = 'pages/faq/faqClassify/faqClassify';__wxRouteBegin = true; 	define("pages/faq/faqClassify/faqClassify.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t=getApp(),a=require("../../../utils/pageManager.js"),e=require("../../../utils/requestHelper.js"),i=require("../../../utils/util.js"),s=require("../../../utils/report.js"),n=t.runEnvironment.faqJsonDomain;Page({data:{eventControl:{btnAllowFlag:!0},typeId:"",faqList:[],prmList:[],sScreen:t.globalData.sScreen},onLoad:function(o){wx.setNavigationBarTitle({title:"常见问题"});var r=this;console.log("faqClassify options: ",o);var d=a.getParams(o);if(void 0!=d&&void 0!=d.typeId){this.setData({typeId:d.typeId});var p="index";void 0!=d.fromType&&(p="typeId="+d.fatherTypeId),s.reportFaqType(d.typeId,p)}e.request({url:n+"T"+d.typeId+".JSON",data:{},method:"GET",header:{"content-type":"application/json"},success:function(t){if(200==t.statusCode&&void 0!=t.data)if(t.data.childType.length>0){a=t.data.childType;i.sortList("seqNo",a),r.setData({prmList:a})}else if(t.data.faqs.length>0){var a=t.data.faqs;r.setData({faqList:a})}},fail:function(t){console.log(t)}}),this.setData({sScreen:t.globalData.sScreen})},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){t.btnRecoverByUnload()},tapDetail:function(t){var e=t.currentTarget.dataset.index;if(void 0!=e&&e<this.data.faqList.length){var i={faqId:this.data.faqList[e].faqId,fromType:"Y",typeId:this.data.typeId};a.push("faqDetail",i)}},tapType:function(t){var e=t.currentTarget.dataset.index;if(void 0!=e&&e<this.data.prmList.length){var i={typeId:this.data.prmList[e].typeId,fromType:"Y",fatherTypeId:this.data.typeId};a.push("faqClassify",i)}}}); 
 			}); 	require("pages/faq/faqClassify/faqClassify.js");
 		__wxRoute = 'pages/loanAmount/loanAmount';__wxRouteBegin = true; 	define("pages/loanAmount/loanAmount.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../utils/dataManager.js"),t=require("../../utils/pageManager.js"),o=require("../common/alertView/alertView.js"),a=require("../common/loanNotice/loanNotice.js"),n=require("../../utils/report.js"),i=require("../../utils/loading.js"),r=require("../../utils/util"),l=require("../../utils/view.js"),s=require("../../utils/jsApiHelper.js"),c=getApp();Page({data:{pageName:"loanAmount",eventControl:{btnAllowFlag:!0},pageShow:!1,sScreen:c.globalData.sScreen,mct_short_name:c.globalData.mct_short_name,availableAmount:3e5,showRate:null,showOriginRate:null,equity:null,dailyInterestRate:null,warningShow:!1,result:"111",reason:"222222",tel_number:"0755-89468888",operateShow:!1,operateTip:"现在借钱前15天免利息!",equityShow:!1,equityTip:"现在借钱前15天免利息现在借钱前15天免利息现在借钱前15天免利息现在借钱前15天免利息",maintainInfoShow:!1,maintainInfo:{faq:""},L0001InfoShow:!1,videoCheck:!1,videoCheckTip:""},onLoad:function(e){wx.setNavigationBarTitle({title:"微粒贷"}),this.setData({sScreen:c.globalData.sScreen}),this.dataHandler(),this.showPage(!0)},dataHandler:function(){null!=c.globalData.account&&(this.needShowWarning()?t.goto("personalCenter"):this.setData({warningShow:!1}),this.dataRender())},needShowWarning:function(){var e=c.globalData.account;return"Y0001"==e.block_code||"C0001"==e.block_code||"R0001"==e.block_code||"H0005"==e.block_code},dataRender:function(){var e=c.globalData.account;this.equityHandler(e);var t;"L0004"!=e.block_code&&"H0003"!=e.block_code||(t="L0004"==e.block_code?"你有一笔借款需要进行视频审核":"你的换卡申请需进行视频审核，完成后才可借款"),this.setData({videoCheck:"L0004"==e.block_code||"H0003"==e.block_code,videoCheckTip:t,availableAmount:r.centToYuan(e.available_amount,0),operateShow:!1,equityShow:!1,maintainInfoShow:!1,L0001InfoShow:!1});var o=l.remindShow("personcenter");o?this.setData({maintainInfoShow:!0,maintainInfo:o,operateShow:!1}):this.setData({maintainInfoShow:!1}),"L0001"==e.block_code?this.setData({L0001InfoShow:!0,maintainInfoShow:!1,operateShow:!1}):this.setData({L0001InfoShow:!1}),this.data.operateShow?this.setData({equityShow:!1}):e.equity&&e.equity.equity_msg&&"INT_P"!=e.equity.equity_type&&"INT_P_NEW"!=e.equity.equity_type?this.setData({equityShow:!0,equityTip:e.equity.equity_msg}):this.setData({equityShow:!1})},videoCheck:function(e){if(c.btnAllowClick(this.data.eventControl)){var o={caseType:1,appType:"X"},a=c.globalData.account;"H0003"==a.block_code?(o.caseType=2,n.report("","PersonalChangeVideoBut",1)):n.report("","PersonalBorrowVideoBut",1),s.startVoipCall(o,function(e,o,n){if(console.log("loanAmount startVoipCall:",e),e)c.btnRecover(o.data.eventControl),n||o.showDialog(e,"知道了");else{var i={subscribe_info:c.globalData.account.subscribe_info,caseType:"H0003"==a.block_code?3:4,fromPage:"loanAmount"};t.push("voipResult",i)}},this)}},closeMaintainInfo:function(e){this.setData({maintainInfoShow:!1}),l.remindClose(this.data.maintainInfo.id)},onReady:function(){},onShow:function(){n.report("PayLimitPage");var t=c.globalData.pageParam,o=t&&t.comefrom,a=t&&t.needGoToPersonalCenter;if("loanResultCertificate"==o||"appShow"==o||"needvoipcall"==o||"voipResult"==o||"phonecheck"==o){var r=t.refreshDataFlag;t.comefrom="",c.globalData.pageParam=t,0==r?(i.show(),e.queryAccount({outputtype:"json"},function(e,t,o){console.log("loanAmount onshow queryAccount:",e,t),i.hide(),o.handlerRefresh(a)},this)):this.handlerRefresh(a)}},onHide:function(){},onUnload:function(){c.btnRecoverByUnload()},handlerRefresh:function(e){this.needGoToPage()||(e?t.goto("personalCenter"):(this.dataHandler(),this.showPage(!0)))},needGoToPage:function(){return c.exceptionHandler()},callCustomerService:function(){r.phoneCall("075589468888")},showPage:function(e){this.setData({pageShow:e})},tapNext:function(){if(this.checkLend()&&c.btnAllowClick(this.data.eventControl)){n.report("","PayLimitPageNextBut",1);var o=c.globalData.account;o.is_first_loan&&"Y"==o.is_first_loan&&n.report("","PayLimitPageNextBut-firsttime",1);i.show(),e.prenotify({nopwdnosms_flag:0,type:1}),e.queryCard({},function(o,a,n){if(i.hide(),console.log("loanAmount queryCard:",o,a),o)c.btnRecover(n.data.eventControl),n.showDialog(o.msg,"知道了");else{var r=e.getDefaultCard(a.array,a.default_bind_serial);r&&e.shareData.set("defauldCard",r);var l=e.sortCardlist(a.array);e.shareData.set("cardList",l),t.push("instalmentCredit")}},this)}},checkLend:function(){var e=c.globalData.account,t=e.control,a=t&&t.disable;return a&&a.loan_money?(this.showDialog(a.loan_money,"知道了"),!1):"L0005"==e.block_code?(this.showDialog("你有一笔借款正在审核中，暂时无法继续借钱。","知道了"),!1):"L0006"==e.block_code?(this.showDialog("你上一笔借款还在等待银行电话确认，暂时无法继续借钱。","知道了"),!1):"H0004"==e.block_code?(this.showDialog("你的换卡申请正在审核中，暂时无法借钱。","知道了"),!1):"H0001"==e.block_code?(this.showDialog("你已经更换过银行卡，请还清当前借款后再进行借钱。","知道了"),!1):"H0002"==e.block_code?(this.showDialog("你的换卡申请正在审核中，暂时无法借钱。","知道了"),!1):"block_code_unreg"==e.block_code?(n.report("","PayBorrowAddCard",1),o.show(this,{type:0,content:"你的微信尚未绑定银行卡，请绑定你本人（"+e.name+"）的银行卡后继续",cancelText:"取消",confirmText:"立即绑定"},{alertConfirm:this.gotoBindCard,alertClose:function(){n.report("","PayBorrowAddCardCancel",1)}}),!1):"00000"!=e.block_code?(this.showDialog(e.block_msg||"未知错误","知道了"),!1):e.unpaid_loans&&parseInt(e.unpaid_loans)>=20?(this.showDialog("你的未还清借款笔数已达到20笔上限，暂时无法继续借钱","知道了"),!1):!(e.available_amount<5e4)||(this.showDialog("你的可借额度低于单笔最低借款额度500元，暂时无法继续借钱","知道了"),!1)},gotoBindCard:function(){n.report("","PayBorrowAddCardConfirm",1),i.show(),s.bindCard({req_type:4},function(t,a,n){if(console.log("loanAmount bindCard:",t,a),i.hide(),t)return"server-pass-error"==t.type&&n.showDialog(t.msg,"知道了"),void c.btnRecover(n.data.eventControl);i.show(),e.queryAccount({outputtype:"json"},function(e,t,a){console.log("loanAmount bindCard queryAccount:",e,t),i.hide(),o.hide(a),e||a.dataHandler()},n)},this)},equityHandler:function(e){var t,o,a,n,i=e.rate,l="Y"==e.is_first_loan?i[1]:i[2],s=r.equityDataPreHandle(e.equity);s&&"percent"==s.js_equity_type?((t=Math.round(1e6*l.interest_rate*(s.equity_value/100))/1e4)<.02&&(t=.02),t!=(o=Math.round(1e6*l.interest_rate)/1e4)?(a=t,n=o):(a=Math.round(1e6*l.interest_rate)/1e4,n=null,o=null)):(a=Math.round(1e6*l.interest_rate)/1e4,n=null),this.setData({showRate:a,showOriginRate:n,equity:s,dailyInterestRate:a})},showNotice:function(){n.report("","PayTipsBut",1),a.show(this)},navigatorToFAQ:function(){c.btnAllowClick(this.data.eventControl)&&(n.report("","PayFAQBut",1),t.push("faq",null,null,!0))},showDialog:function(e,t){o.show(this,{type:1,content:e,cancelText:t})},gotofaq:function(){var e=this.data.maintainInfo.faq;e.length>0&&t.push("faqDetail",{faqId:e})}}); 
 			}); 	require("pages/loanAmount/loanAmount.js");
 		__wxRoute = 'pages/loan/loan';__wxRouteBegin = true; 	define("pages/loan/loan.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";require("../../utils/view.js");var t=require("../../utils/util.js"),a=(require("../../utils/caculator.js"),require("../../utils/dataManager.js")),e=require("../../utils/pageManager.js"),n=(require("../../utils/loading.js"),require("../../utils/report.js")),i=require("inputView/inputView.js"),o=require("bankCardView/bankCardView.js"),r=(require("cardlist/cardlist.js"),require("../common/alertView/alertView.js")),s=require("loanDetail/loanDetail.js"),l=require("loanStepInfo/loanStepInfo.js"),u=require("loanSteps.js"),d=getApp();Page({data:{eventControl:{btnAllowFlag:!0},sScreen:d.globalData.sScreen,ratio:d.globalData.ratio,iphoneX:d.globalData.iphoneX,isFirstLoan:!1,hadOtherCard:!1,pageShow:!1,auto_focus:!1,maxMoney:4e4,minMoney:500,availableMoney:2e4,formData:{money:0},rateList:[],contract_ver:[],cust_type:"",repayDay:"",new_loan_first_pmt_due_date:"",discount_amount:0,needFillInfo:!1,serverUserInfo:{inputName:"",id:""},anti_fraud_no:"",loanOrderToken:"",isIOS8:d.globalData.isIOS8,oldMoney:"",banks:"微众银行",startDate:(new Date).format("yyyy/MM/dd"),endDate:"",allowLoan:!1,loanState:0,isValidAmount:!1,inputDisabled:!1,loan_status:0,isShowDetail:!1,inputInfoShow:!1,bankViewShow:!1,confirmViewShow:!1,buttonTitle:"下一步",isloading:!1,name_focus:!1,idcard_focus:!1,finish:!0,cardListData:{},couponsData:{},repayPlanData:{},urlSawRepeat:"",urlSawLineRepeat:"",loanABFlag:!1},onLoad:function(t){console.log("loan options: ",t);var a=e.getParams(t),n=d.globalData.account;n&&(n.selectedEquity=a,this.initData(n)),this.setData({sScreen:d.globalData.sScreen,ratio:d.globalData.ratio}),i.bindPage(this),o.bindPage(this),u.bindPage(this),l.bindPage(this),s.bindPage(this)},onReady:function(){this.animation=wx.createAnimation(),this.setData({auto_focus:!0})},onShow:function(){this.setData({pageShow:!0}),this.data.eventControl.tokenData&&(this.submit({staff_token:this.data.eventControl.tokenData}),this.data.eventControl.tokenData=null);var t=d.globalData.account;0==this.data.loanState?(n.report("AmountInput"),t.is_first_loan&&"Y"==t.is_first_loan&&n.report("","AmountInput-firsttime",1)):2==this.data.loanState&&(n.report("ReceiptConfirm"),t.is_first_loan&&"Y"==t.is_first_loan&&n.report("","ReceiptConfirm-firsttime",1))},onHide:function(){},onUnload:function(){d.btnRecoverByUnload()},initData:function(e){var n=this.data.formData,i=this.data.rateList;i=d.globalData.account.rate,n.rate="Y"==e.is_first_loan?i[1]:i[2],n.card=a.shareData.get("defauldCard"),n.equity=t.equityDataPreHandle(e.selectedEquity||e.equity),n.current_date=e.current_date||(new Date).format("yyyyMMdd");var o=n.current_date.slice(0,4)+"/"+n.current_date.slice(4,6)+"/"+n.current_date.slice(6,8),r=a.shareData.get("cardList"),s=this.judgeHadOtherCard(r),l=a.shareData.get("contract_ver"),u=parseInt(e.new_loan_first_pmt_due_date.slice(6,8))||"1",c=e.new_loan_first_pmt_due_date||new Date,h=Math.min(e.available_amount/100,this.data.maxMoney),_="N"==e.is_activated,p=e.loan_status,f=d.globalData.abFlag.split("");this.setData({repayDay:u,loan_status:p,hadOtherCard:s,formData:n,startDate:o,contract_ver:l,needFillInfo:_,cust_type:e.cust_type||"",availableMoney:h,new_loan_first_pmt_due_date:c,isFirstLoan:"Y"==e.is_first_loan,urlSawRepeat:d.runEnvironment.cdnDomain+"/images/bg-saw-repeat@2x.png",urlSawLineRepeat:d.runEnvironment.cdnDomain+"/images/bg-saw-line-repeat@2x.png",loanABFlag:"1"==f[2]&&"Y"==e.is_first_loan}),this.randerRateTip()},showPage:function(t){console.log("loan showPage:",t?"show":"hide"),this.setData({pageShow:t})},judgeHadOtherCard:function(t){var a=!1;for(var e in t)if(!e.forbid_word){a=!0;break}return a},scrollTo:function(t,a,e){var n=this,i=n.data.scrollTop||0;t*=.8;var o=30;o=0==i?30:15;var r=setInterval(function(){if((i+=o)>t)return clearInterval(r),n.setData({toView:a}),void e();n.setData({scrollTop:i})},10)},getMoneyError:function(t){return t<this.data.minMoney?{text:"单笔借钱金额最低 ¥"+this.data.minMoney,type:"tooLittle"}:t>this.data.maxMoney?{text:"单笔借钱金额最高 ¥"+this.data.maxMoney,type:"overflow"}:t>this.data.availableMoney?{text:"当前最多可借 ¥"+this.data.availableMoney,type:"tooMuch"}:t>1e3&&t%10!=0?{text:"借钱金额须为100的整数倍",type:"noHundredMulriple-pre"}:t%100!=0?{text:"借钱金额须为100的整数倍",type:"noHundredMulriple"}:void 0},showDialog:function(t,a){r.show(this,{type:1,content:t,cancelText:a})},randerRateTip:function(){var t,a,e=this.data.formData,n=e.equity,i=e.rate;n&&"percent"==n.js_equity_type?((t=Math.round(1e6*i.interest_rate*(n.equity_value/100))/1e4)<.02&&(t=.02),t!=(a=Math.round(1e6*i.interest_rate)/1e4)?(e.showRate=t,e.showOriginRate=a):(e.showRate=Math.round(1e6*i.interest_rate)/1e4,e.showOriginRate=null,a=null)):(e.showRate=Math.round(1e6*i.interest_rate)/1e4,e.showOriginRate=null),this.setData({formData:e})}}); 
 			}); 	require("pages/loan/loan.js");
 		__wxRoute = 'pages/loan/instalmentCredit';__wxRouteBegin = true; 	define("pages/loan/instalmentCredit.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t=require("../../utils/view.js"),a=require("../../utils/util.js"),e=(require("../../utils/caculator.js"),require("../../utils/dataManager.js")),n=require("../../utils/pageManager.js"),i=(require("../../utils/loading.js"),require("../../utils/report.js")),o=require("inputView/inputView.js"),r=require("bankCardView/bankCardView.js"),s=(require("cardlist/cardlist.js"),require("../common/alertView/alertView.js")),l=require("loanDetail/loanDetail.js"),u=require("loanStepInfo/loanStepInfo.js"),c=require("instalmentSteps.js"),d=require("../common/marketInfo/marketInfo.js"),_=getApp();t.general;Page({data:{eventControl:{btnAllowFlag:!0},sScreen:_.globalData.sScreen,ratio:_.globalData.ratio,isFirstLoan:!1,hadOtherCard:!1,pageShow:!1,auto_focus:!0,maxMoney:4e4,minMoney:500,availableMoney:2e4,formData:{money:0},rateList:[],contract_ver:[],cust_type:"",repayDay:"",new_loan_first_pmt_due_date:"",discount_amount:0,needFillInfo:!1,serverUserInfo:{inputName:"",id:""},anti_fraud_no:"",loanOrderToken:"",isIOS8:_.globalData.isIOS8,oldMoney:"",banks:"微众银行",startDate:(new Date).format("yyyy/MM/dd"),endDate:"",allowLoan:!1,loanState:0,isValidAmount:!1,inputDisabled:!1,loan_status:0,isShowDetail:!1,amountViewShow:!0,inputViewShow:!1,accountViewShow:!1,bankViewShow:!1,inputInfoShow:!1,confirmViewShow:!1,buttonTitle:"下一步",isloading:!1,name_focus:!1,idcard_focus:!1,finish:!0,cardListData:{},couponsData:{},repayPlanData:{},marketInfoData:{},urlSawRepeat:"",urlSawLineRepeat:"",needFillAccount:!0,accountNum:"",marketInfo:{},account_focus:!1},onLoad:function(t){console.log("instalmentCredit options: ",t);var a=n.getParams(t),e=_.globalData.account;e&&(e.selectedEquity=a,this.initData(e)),this.setData({sScreen:_.globalData.sScreen,ratio:_.globalData.ratio}),o.bindPage(this),r.bindPage(this),c.bindPage(this),u.bindPage(this),l.bindPage(this)},onReady:function(){this.animation=wx.createAnimation()},onShow:function(){this.setData({pageShow:!0}),this.data.eventControl.tokenData&&(this.submit({staff_token:this.data.eventControl.tokenData}),this.data.eventControl.tokenData=null);var t=_.globalData.account;0==this.data.loanState?(i.report("PayAmountInput"),t.is_first_loan&&"Y"==t.is_first_loan&&i.report("","PayAmountInput-firsttime",1)):2==this.data.loanState&&(i.report("PayReceiptConfirm"),t.is_first_loan&&"Y"==t.is_first_loan&&i.report("","PayReceiptConfirm-firsttime",1))},onHide:function(){},onUnload:function(){_.btnRecoverByUnload()},initData:function(t){var n=this.data.formData,i=this.data.rateList;i=_.globalData.account.rate,n.rate="Y"==t.is_first_loan?i[1]:i[2],n.card=e.shareData.get("defauldCard"),n.equity=a.equityDataPreHandle(t.selectedEquity||t.equity),n.current_date=t.current_date||(new Date).format("yyyyMMdd");var o=n.current_date.slice(0,4)+"/"+n.current_date.slice(4,6)+"/"+n.current_date.slice(6,8),r=e.shareData.get("cardList"),s=this.judgeHadOtherCard(r),l=e.shareData.get("contract_ver"),u=parseInt(t.new_loan_first_pmt_due_date.slice(6,8))||"1",c=t.new_loan_first_pmt_due_date||new Date,d=Math.min(t.available_amount/100,this.data.maxMoney),m="N"==t.is_activated,h=t.loan_status,f={mct_no:t.mct_no||"",mct_name:t.mct_name||"",mct_bankname:t.mct_bankname||"",mct_acct_no:t.mct_acct_no||"",mct_acct_no_fr:t.mct_acct_no.substring(0,4)||"",mct_acct_no_suffix:t.mct_acct_no.substring(t.mct_acct_no.length-4),mct_acct_name:t.mct_acct_name||""};this.setData({repayDay:u,loan_status:h,hadOtherCard:s,formData:n,startDate:o,contract_ver:l,needFillInfo:m,cust_type:t.cust_type||"",availableMoney:d,new_loan_first_pmt_due_date:c,isFirstLoan:"Y"==t.is_first_loan,urlSawRepeat:_.runEnvironment.cdnDomain+"/images/bg-saw-repeat@2x.png",urlSawLineRepeat:_.runEnvironment.cdnDomain+"/images/bg-saw-line-repeat@2x.png",marketInfo:f}),this.randerRateTip()},showPage:function(t){console.log("instalmentCredit showPage:",t?"show":"hide"),this.setData({pageShow:t})},judgeHadOtherCard:function(t){var a=!1;for(var e in t)if(!e.forbid_word){a=!0;break}return a},inputAccountNum:function(t){var a=t.detail.value;this.setData({accountNum:a,allowLoan:4==a.length})},scrollTo:function(t,a,e){var n=this,i=n.data.scrollTop||0;t*=.8;var o=30;o=0==i?30:15;var r=setInterval(function(){if((i+=o)>t)return clearInterval(r),n.setData({toView:a}),void e();n.setData({scrollTop:i})},10)},getMoneyError:function(t){return t<this.data.minMoney?{text:"单笔借钱金额最低 ¥"+this.data.minMoney,type:"tooLittle"}:t>this.data.maxMoney?{text:"单笔借钱金额最高 ¥"+this.data.maxMoney,type:"overflow"}:t>this.data.availableMoney?{text:"当前最多可借 ¥"+this.data.availableMoney,type:"tooMuch"}:t>1e3&&t%10!=0?{text:"借钱金额须为100的整数倍",type:"noHundredMulriple-pre"}:t%100!=0?{text:"借钱金额须为100的整数倍",type:"noHundredMulriple"}:void 0},showDialog:function(t,a){s.show(this,{type:1,content:t,cancelText:a})},randerRateTip:function(){var t,a,e=this.data.formData,n=e.equity,i=e.rate;n&&"percent"==n.js_equity_type?((t=Math.round(1e6*i.interest_rate*(n.equity_value/100))/1e4)<.02&&(t=.02),t!=(a=Math.round(1e6*i.interest_rate)/1e4)?(e.showRate=t,e.showOriginRate=a):(e.showRate=Math.round(1e6*i.interest_rate)/1e4,e.showOriginRate=null,a=null)):(e.showRate=Math.round(1e6*i.interest_rate)/1e4,e.showOriginRate=null),this.setData({formData:e})},showMarketInfo:function(){d.show(this)}}); 
 			}); 	require("pages/loan/instalmentCredit.js");
 		__wxRoute = 'pages/loan/loanResult/loanResult';__wxRouteBegin = true; 	define("pages/loan/loanResult/loanResult.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";require("../../../utils/view.js");var e=require("../../../utils/dataManager.js"),t=require("../../../utils/pageManager.js"),a=require("../../../utils/loading.js"),o=require("../../../utils/report.js"),i=(require("../../../utils/util.js"),require("../../common/alertView/alertView.js")),n=getApp();Page({data:{eventControl:{btnAllowFlag:!0},pageShow:!1,randerData:{},selected:!0,retcode:"",sScreen:n.globalData.sScreen,iconSize:186*n.globalData.ratio,giconSize:20*n.globalData.ratio,blockSubType:""},onLoad:function(e){console.log("loanResult options: ",e);var a=t.getParams(e);if(a){var o=this.data.randerData,i=o.retcode=a.retcode||"",l=a.block_sub_type;"success"==l?(wx.setNavigationBarTitle({title:"借款申请成功"}),o.status=l,o.title=a.block_title,o.desc=a.block_msg,"Y"==a.block_amt_flag&&(o.money=Number(a.tran_amt/100).toFixed(2)),o.bank_name=a.bank_name,o.bank_logo_url=a.bank_logo_url,o.card_no=a.card_no,o.subscribe_info=a.subscribe_info):"waiting"==l?(wx.setNavigationBarTitle({title:"等待审核"}),o.status=l,o.title=a.block_title,o.desc=a.block_msg,o.subscribe_info=a.subscribe_info,o.phoneNo=a.block_phone||"",o.callTime=a.block_time||"",o.callMeNow=a.call_me_now||"N",o.startTime=o.startTime?o.startTime:new Date):(wx.setNavigationBarTitle({title:"借款申请失败"}),o.status=l,o.title=a.block_title,o.desc=a.block_msg),this.setData({randerData:o,retcode:i,selected:!!o.subscribe_info&&"2"==o.subscribe_info.recommend_level,iconSize:186*n.globalData.ratio,giconSize:20*n.globalData.ratio,sScreen:n.globalData.sScreen})}},onReady:function(){var e=t.getParentPage();e&&e.showPage&&e.showPage(!1)},onShow:function(){a.hide(),n.globalData.pageParam={comefrom:"loanResult",refreshDataFlag:0},this.showPage(!0);var e=this.data.retcode;if("0"==e||"30937113"==e){o.report("LoanApproved");var t=n.globalData.account;t.is_first_loan&&"Y"==t.is_first_loan&&o.report("","LoanApproved-firsttime",1)}else"30937013"==e||"30937063"==e?"30937013"==e?(o.report("LoanPhoneCheck"),"Y"==this.data.randerData.call_me_now?o.report("LoanPhoneCheck - Lined up"):o.report("LoanPhoneCheck-Not lined up")):o.report("LoanPending"):o.report("LoanFailed")},onHide:function(){},onUnload:function(){n.btnRecoverByUnload(),this.data.selected&&"0"!=this.data.randerData.subscribe_info.recommend_level&&e.subscribe({subscribe_token:this.data.randerData.subscribe_info.subscribe_token})},showPage:function(e){console.log("loanResult showPage:",e?"show":"hide"),this.setData({pageShow:e})},selectClick:function(){this.setData({selected:!this.data.selected})},applyCall:function(){if(n.btnAllowClick(this.data.eventControl)){o.report("","CallMeNow",1);var t=this;if(new Date-this.data.randerData.startTime>=18e5)return n.btnRecover(t.data.eventControl),t.showDialog("页面已超时失效，审核电话将在早上8点后打给你，请注意接听","知道了",{alertClose:function(){t.finish(),i.hide(t)}}),void o.report("","ButtonDisable",1);a.show(),e.weehoursphonecall({},function(e,t,l){console.log("loanResult weehoursphonecall: ",e,t),a.hide(),n.btnRecover(l.data.eventControl);var s=t.result_message||e.result.result_message;e?(l.showDialog(s,"知道了",{alertClose:function(){i.hide(l)}}),o.report("","SystemBusy",1)):(l.showDialog(s,"知道了",{alertClose:function(){l.finish(),i.hide(l)}}),o.report("","DialWithin15Minutes",1))},this)}},finish:function(){n.btnAllowClick(this.data.eventControl)&&(a.show(),e.queryAccount({outputtype:"json"},function(e,o,i){if(console.log("loanResult queryAccount: ",e,o),a.hide(),n.btnRecover(i.data.eventControl),!e){var l=t.getParentPage();l.dataHandler(),n.globalData.pageParam.refreshDataFlag=2,l.showPage(!0),t.pop(1,null,!1)}},this))},showDialog:function(e,t,a){i.show(this,{type:1,content:e,cancelText:t},a)}}); 
 			}); 	require("pages/loan/loanResult/loanResult.js");
 		__wxRoute = 'pages/loan/staffToken/staffToken';__wxRouteBegin = true; 	define("pages/loan/staffToken/staffToken.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t=require("../../common/alertView/alertView.js"),e=require("../../../utils/pageManager.js"),n=require("../../../utils/dataManager.js"),a=require("../../../utils/loading.js"),o=(require("../../../utils/view.js"),require("../../../utils/report.js")),i=getApp();Page({data:{eventControl:{btnAllowFlag:!0},sScreen:i.globalData.sScreen,pageShow:!1,allowLoan:!1,name_focus:!0,token_focus:!1,inputInfo:{name:"",token:""}},onLoad:function(t){},onReady:function(){wx.setNavigationBarTitle({title:"微粒贷"})},onShow:function(){this.setData({pageShow:!0,sScreen:i.globalData.sScreen});var t=i.globalData.account;"1"==i.globalData.prod?t.restart&&"Y"==t.restart?o.report("PayOpenTecentToken"):o.report("PayTencentStaff"):t.restart&&"Y"==t.restart?o.report("OpenTecentToken"):o.report("TencentStaff")},onHide:function(){},onUnload:function(){i.btnRecoverByUnload()},inputName:function(t){var e=this.data.inputInfo;e.name=t.detail.value,this.setData({inputInfo:e}),this.checkIsAllowLoan()},inputnameblur:function(t){t.detail.value&&this.setData({token_focus:!0})},inputToken:function(t){var e=this.data.inputInfo;e.token=t.detail.value,this.setData({inputInfo:e}),this.checkIsAllowLoan()},checkIsAllowLoan:function(){this.setData({allowLoan:this.data.inputInfo.name.length>0&&6===this.data.inputInfo.token.length})},nextStep:function(){if(this.data.allowLoan){if(!i.btnAllowClick(this.data.eventControl))return;var t=i.globalData.account;t.restart&&"Y"==t.restart?o.report("","OpenTokenNext",1):"1"==i.globalData.prod?o.report("","PayTencentStaffNextBut",1):o.report("","TencentStaffNextBut",1),this.checkStaffToken(this.data.inputInfo.name,this.data.inputInfo.token)}},checkStaffToken:function(t,o){var r=this;/^[a-zA-Z\/ ]{2,20}$/.test(t)?(a.show(),n.checkStaffToken({staffname:t,oatoken:o},function(t,n){console.log("staffToken checkStaffToken: ",t,n),t?(a.hide(),i.btnRecover(r.data.eventControl),r.showDialog(t.msg||"验证token失败","知道了")):(e.getParentPage().data.eventControl.tokenData=n.staff_token,e.pop(1,null,!0))},this)):(i.btnRecover(this.data.eventControl),r.showDialog("请输入正确的信息","知道了"))},showDialog:function(e,n){t.show(this,{type:1,content:e,cancelText:n})}}); 
 			}); 	require("pages/loan/staffToken/staffToken.js");
 		__wxRoute = 'pages/repay/repay';__wxRouteBegin = true; 	define("pages/repay/repay.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("../common/alertView/alertView.js"),e=require("../../utils/report.js"),t=require("../../utils/pageManager.js"),i=require("../../utils/dataManager.js"),n=require("../../utils/jsApiHelper.js"),r=require("../../utils/loading.js"),s=require("../../utils/util.js"),o=(require("../../utils/view.js").general,getApp());Page({data:{eventControl:{btnAllowFlag:!0},sScreen:o.globalData.sScreen,pageShow:!1,sum:0,sumAsCent:0,repayableNum:0,allSelected:!1,repayabled:!1,isAcruDDPay:!1,isAcruPay:!1,isCurrentDayNbr:!1,maintainInfo:{faq:""},items:[],iconSize:15},onLoad:function(a){wx.setNavigationBarTitle({title:"提前还清借款"}),console.log("repay options: ",a);var e=t.getParams(a);e&&this.dataHandler(e),this.setData({pageShow:!0,sScreen:o.globalData.sScreen})},onReady:function(){},onShow:function(){e.report("PayInAdvance")},onHide:function(){},onUnload:function(){o.btnRecoverByUnload()},dataHandler:function(a){for(var e=[],t=0;t<a.loan.length;t++){var i={};i.name=s.centToYuan(a.loan[t].loan_init_prin),i.value=s.centToYuan(a.loan[t].pay_bal),i.valueAsCent=a.loan[t].pay_bal,i.date=s.formatDate(a.loan[t].register_date,"YYYY/MM/DD"),i.has_equity=a.loan[t].has_equity,i.repayable="Y"==a.loan[t].is_allow_pay,i.loan_receipt_nbr=a.loan[t].loan_receipt_nbr,i.equity_int=s.centToYuan(a.loan[t].equity_int||"0"),i.checked=!1,e.push(i)}if(this.setData({items:e,isAcruDDPay:"Y"==a.is_acru_dd_pay,isAcruPay:"Y"==a.is_acru_pay,isCurrentDayNbr:"Y"==a.current_day_nbr,iconSize:30*o.globalData.ratio}),this.data.isAcruDDPay||this.data.isAcruPay)a.black_tips&&this.setData({maintainInfo:a.black_tips,maintainInfoShow:!0});else{for(var n=0,t=0;t<this.data.items.length;t++)this.data.items[t].repayable&&n++;this.setData({repayableNum:n})}},checkboxChange:function(a){var e=a.currentTarget.dataset.index;if(this.data.items[e].repayable){if(!this.data.isAcruDDPay&&!this.data.isAcruPay){var t=this.data.items;t[e].checked=!t[e].checked,this.setData({items:t});for(var i=0,n=0,r=0;r<t.length;r++)t[r].checked&&(i++,n+=Number(t[r].valueAsCent));n>0?this.setData({sumAsCent:n,sum:s.centToYuan(n),allSelected:i===this.data.repayableNum}):this.setData({sumAsCent:0,sum:Number(0).toFixed(2),allSelected:!1}),this.setData({repayabled:this.data.sumAsCent>0})}}else this.showDialog("当日借款第二天起才可还款","知道了")},taploanDetail:function(a){if(o.btnAllowClick(this.data.eventControl)){var i=a.currentTarget.dataset.index;if(void 0!=i&&i<this.data.items.length){var n={loan_receipt_nbr:this.data.items[i].loan_receipt_nbr};e.report("","LoanDetailBut",1),t.push("loanDetailRepaying",n,null,!0)}}},handleError:function(a,e){o.btnRecover(this.data.eventControl),r.hide(),e||this.showDialog(a.msg||"未知错误","知道了")},repayCommit:function(a){var t=getApp(),n=t.globalData.account,s=n.control,o=s&&s.disable;if(o&&o.repay_money)this.showDialog(n.control.disable.repay_money,"知道了");else if(!this.data.isAcruDDPay&&!this.data.isAcruPay&&this.data.repayabled&&t.btnAllowClick(this.data.eventControl)){e.report("","PayInAdvanceBut",1),r.show();for(var l="",u=0;u<this.data.items.length;u++){var c=this.data.items[u];c.checked&&(l=l+(""==l?"":"#")+c.loan_receipt_nbr)}var h={receipt_nbr:l,tran_amt:this.data.sumAsCent,type:2,token_scene:3};i.repayOrder(h,function(a,e,t){a?t.handleError(a):t.requestCheckoutCounter(e.repay_token)},this)}},requestCheckoutCounter:function(a){var e={req_type:3,repay_token:a};n.getWebPayCheckoutCounterRequst(e,function(n,s,l){if(console.log("repay getWebPayCheckoutCounterRequst:",n,s),n)l.handleError(n,!0);else{var u=o.globalData.account;r.show(),e={token_scene:3,type:2,repay_token:a,cft_token:s.token,bind_serial:s.bind_serial||s.bindSerial,card_no:u.card_no},i.repayConfirm(e,function(a,e,i){a?a.result?(a.result.fromPage="repay",t.goto("repayResult",a.result)):(a.msg="系统繁忙，请重新尝试",i.handleError(a)):(e.fromPage="repay",t.goto("repayResult",e))},l)}},this)},selectAllCheckbox:function(a){if(!this.data.isAcruDDPay&&!this.data.isAcruPay)if(this.data.isCurrentDayNbr)this.showDialog("当日借款第二天起才可还款","知道了");else if(!(this.data.repayableNum<=0)){this.setData({allSelected:!this.data.allSelected});for(var e=0,t=0,i=this.data.items,n=0;n<this.data.items.length;++n)i[n].repayable&&(i[n].checked=this.data.allSelected,this.data.allSelected&&(e+=Number(i[n].value),t+=Number(i[n].valueAsCent)));this.setData({sumAsCent:t,sum:Number(e).toFixed(2)}),this.setData({items:i,repayabled:this.data.sumAsCent>0})}},showDialog:function(e,t){a.show(this,{type:1,content:e,cancelText:t})},gotofaq:function(){var a=this.data.maintainInfo.faq;a.length>0&&t.push("faqDetail",{faqId:a})}}); 
 			}); 	require("pages/repay/repay.js");
 		__wxRoute = 'pages/repay/repayResult/repayResult';__wxRouteBegin = true; 	define("pages/repay/repayResult/repayResult.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var a=require("../../../utils/report.js"),e=require("../../../utils/pageManager.js"),t=require("../../../utils/loading.js"),o=require("../../../utils/util.js"),r=require("../../../utils/dataManager.js"),s=getApp();Page({data:{eventControl:{btnAllowFlag:!0},pageShow:!1,sScreen:s.globalData.sScreen,pageTitle:"",contentTitle:"",money:"",desc:"",status:"",iconSize:186*s.globalData.ratio,fromPage:"repay"},onLoad:function(a){console.log("repayResult options: ",a);var t=e.getParams(a);t&&this.dataHandler(t),this.setData({pageShow:!0,fromPage:t.fromPage,iconSize:186*s.globalData.ratio,sScreen:s.globalData.sScreen}),wx.setNavigationBarTitle({title:this.data.pageTitle})},onReady:function(){},onShow:function(){"success"==this.data.status?"repayCurPeriod"==this.data.fromPage?a.report("DelayPaySucc"):a.report("PaySuccess"):"fail"==this.data.status&&("repayCurPeriod"==this.data.fromPage?a.report("DelayPayFailed"):a.report("PayFail")),s.globalData.pageParam={comefrom:"repayResult",refreshDataFlag:0};var t=e.getParentPage();t&&t.showPage&&t.showPage(!1)},onHide:function(){},onUnload:function(){s.btnRecoverByUnload()},dataHandler:function(a){"0"==a.retcode?this.setData({pageTitle:"还款申请已提交",contentTitle:"还款已提交银行处理",money:o.centToYuan(a.tran_amt),desc:"预计10分钟内处理完成，还款成功后额度将实时恢复",status:"success"}):this.setData({pageTitle:"还款申请失败",contentTitle:a.retmsg||"还款申请提交失败，请稍后再试",status:"fail"})},finish:function(){s.btnAllowClick(this.data.eventControl)&&("repay"==this.data.fromPage?(t.show(),r.queryAccount({outputtype:"json"},function(a,t,o){if(!a){var r=e.getParentPage();r.dataHandler(),s.globalData.pageParam.refreshDataFlag=2,r.showPage(!0),e.pop(1,null,!1)}})):(t.show(),r.queryAccount({outputtype:"json"},function(a,t,o){if(!a){var r=e.getParentPage();"N"!=t.is_overdue?(r.dataHandler(s.globalData.account),s.globalData.pageParam.refreshDataFlag=2,r.showPage(!0)):s.globalData.pageParam.refreshDataFlag=1,e.pop(1,null,!1)}})))}}); 
 			}); 	require("pages/repay/repayResult/repayResult.js");
 		__wxRoute = 'pages/agreement/agreement';__wxRouteBegin = true; 	define("pages/agreement/agreement.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../common/htmlToWxml/html2json"),t=require("../../utils/pageManager.js"),a=require("../../utils/util.js"),n=require("../../utils/loading.js"),o=require("../../utils/dataManager.js"),l=getApp();Page({data:{eventControl:{btnAllowFlag:!0},warningShow:!1,innerWxml:"",sScreen:l.globalData.sScreen,iconSize:200*l.globalData.ratio},onLoad:function(r){console.log("agreement options: ",r),wx.setNavigationBarTitle({title:"借款合同"});var i,s=t.getParams(r);s&&(n.show(),i=a.contractTranslate(s.contractName)+".html",o.getAgreement(i,function(t,a,o){if(console.log("agreement getAgreement: ",t,a),n.hide(),t)o.setData({sScreen:l.globalData.sScreen,iconSize:200*l.globalData.ratio,warningShow:!0});else{var r=a.split('<body class="common limit-protocol">'),i=(0,e.html2json)(r[1].replace(/&nbsp;/gi,"  ")).child;o.setData({innerWxml:i})}},this))},onUnload:function(){l.btnRecoverByUnload()}}); 
 			}); 	require("pages/agreement/agreement.js");
 		__wxRoute = 'pages/voipcall/voipResult/voipResult';__wxRouteBegin = true; 	define("pages/voipcall/voipResult/voipResult.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../../utils/view.js"),a=require("../../../utils/dataManager.js"),t=require("../../../utils/pageManager.js"),i=require("../../../utils/loading.js"),o=require("../../../utils/report.js"),s=(require("../../../utils/util.js"),e.general,getApp());Page({data:{pageName:"voipResult",eventControl:{btnAllowFlag:!0},pageShow:!1,randerData:{},selected:!0,sScreen:s.globalData.sScreen,iconSize:186*s.globalData.ratio,giconSize:20*s.globalData.ratio,caseType:1,fromPage:"",showFinish:!0},onLoad:function(e){console.log("voipResult options: ",e);var a=t.getParams(e);if(a){var i=this.data.randerData;i.retcode=a.retcode||"";wx.setNavigationBarTitle({title:"等待审核结果"}),i.title="本次视频审核已结束",i.desc="本次审核结果请留意公众号通知",i.status="waiting",i.subscribe_info=a.subscribe_info,this.setData({showFinish:"index"!=a.fromPage,fromPage:a.fromPage,caseType:a.caseType,randerData:i,selected:!!i.subscribe_info&&"2"==i.subscribe_info.recommend_level,sScreen:s.globalData.sScreen,iconSize:186*s.globalData.ratio,giconSize:20*s.globalData.ratio})}},onReady:function(){if(s.globalData.pageParam={comefrom:"voipResult",refreshDataFlag:0},"index"!=this.data.fromPage){var e=t.getParentPage();e&&e.showPage&&e.showPage(!1)}},onShow:function(){i.hide(),this.showPage(!0),1==this.data.caseType?"loan"==this.data.fromPage?o.report("BorrowVideoFinish"):"personalCenter"==this.data.fromPage&&o.report("PersonalBorrowVideoFinish"):2==this.data.caseType?"1"==s.globalData.prod?o.report("PayOpenVideoFinish"):o.report("OpenVideoFinish"):3==this.data.caseType?"1"==s.globalData.prod?o.report("PayLimitChangeVideofinish"):o.report("PersonalChangeVideoFinish"):4==this.data.caseType?"instalmentCredit"==this.data.fromPage?o.report("PayVideoCheckFinish"):"loanAmount"==this.data.fromPage&&o.report("PayLimitVideoCheckFinish"):5==this.data.caseType&&o.report("PayReVideoCheckFinish")},onHide:function(){},onUnload:function(){s.btnRecoverByUnload()},selectClick:function(){this.setData({selected:!this.data.selected})},finish:function(){s.btnAllowClick(this.data.eventControl)&&(this.data.selected&&"0"!=this.data.randerData.subscribe_info.recommend_level&&a.subscribe({subscribe_token:this.data.randerData.subscribe_info.subscribe_token}),i.show(),a.queryAccount({outputtype:"json"},function(e,a,o){if(i.hide(),!e){var r=t.getParentPage();r.dataHandler(),s.globalData.pageParam.refreshDataFlag=2,r.showPage(!0),t.pop(1,null,!1)}}))},showPage:function(e){this.setData({pageShow:e})}}); 
 			}); 	require("pages/voipcall/voipResult/voipResult.js");
 		__wxRoute = 'pages/voipcall/needvoipcall/needvoipcall';__wxRouteBegin = true; 	define("pages/voipcall/needvoipcall/needvoipcall.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../../utils/view.js"),a=require("../../../utils/dataManager.js"),t=require("../../../utils/pageManager.js"),o=require("../../../utils/loading.js"),i=require("../../../utils/report.js"),r=require("../../../utils/jsApiHelper.js"),s=require("../../common/alertView/alertView.js"),i=require("../../../utils/report.js"),n=(e.general,getApp());Page({data:{pageName:"needvoipcall",eventControl:{btnAllowFlag:!0},pageShow:!1,sScreen:n.globalData.sScreen,prod:n.globalData.prod,showLater:!1,title:"本次借款需视频审核",desc:"为保证服务质量，本次视频通话记录将会被保存。视频审核通过后即可放款。",content:"请在48小时之内完成视频审核，过期后本次借款将会被撤销",caseType:1,fromPage:""},onLoad:function(e){wx.setNavigationBarTitle({title:"视频审核"}),console.log("needvoipcall options: ",e);var a=t.getParams(e),o=a.caseType||1,i=a.fromPage||"",r="",s="",l="";1==o?(r="本次借款需要视频审核",s="请在48小时之内完成视频审核，过期后本次借款操作将会被撤销",l="请在48小时之内完成视频审核"):2==o?(r="需要视频审核",s="重启微粒贷需要视频审核，请完成后再试",l="请在48小时之内完成视频审核"):3==o?(r="需要视频审核",s="你更换微粒贷收款卡的申请需要视频审核，请完成后再试",l="请在48小时之内完成视频审核"):4==o?(r="本次借款需要视频审核",s="请在48小时之内完成视频审核，过期后本次操作将会被撤销",l="请在48小时之内完成视频审核"):5==o&&(r="你有一笔借款需要视频审核",s="请在48小时之内完成视频审核，过期后本次操作将会被撤销",l="请在48小时之内完成视频审核"),this.setData({sScreen:n.globalData.sScreen,prod:n.globalData.prod,caseType:o,fromPage:i,title:r,desc:s,content:l})},onReady:function(){if(n.globalData.pageParam={comefrom:"needvoipcall",refreshDataFlag:0},"index"!=this.data.fromPage){var e=t.getParentPage();e&&e.showPage&&e.showPage(!1)}},showPage:function(e){!e&&this.data.alertViewData&&this.data.alertViewData.viewShow&&s.hide(this),this.setData({pageShow:e})},onShow:function(){o.hide(),this.showPage(!0),1==this.data.caseType?i.report("BorrowVideo"):2==this.data.caseType?"1"==n.globalData.prod?i.report("PayOpenVideoCheck"):i.report("OpenVideoCheck"):3==this.data.caseType?i.report("PayLimitChangeVideoPage"):4==this.data.caseType?i.report("PayLoanVideoCheck"):5==this.data.caseType&&i.report("PayVideoCheckPage")},onHide:function(){},onUnload:function(){n.btnRecoverByUnload()},startVoipCall:function(){n.btnAllowClick(this.data.eventControl)&&this.jsApiVoipCall()},later:function(){if(n.btnAllowClick(this.data.eventControl)){var e=this;"index"!=this.data.fromPage?s.show(e,{type:0,content:e.data.content,cancelText:"现在验证",confirmText:"我知道了"},{alertConfirm:function(){e.goback(),s.hide(e)},alertClose:function(){e.jsApiVoipCall(),s.hide(e)}}):s.show(e,{type:1,content:e.data.content,cancelText:"现在验证"},{alertClose:function(){e.jsApiVoipCall(),s.hide(e)}})}},goback:function(){o.show(),a.queryAccount({outputtype:"json"},function(e,a,o){if(!e){var i=t.getParentPage();i.dataHandler(),n.globalData.pageParam.refreshDataFlag=2,i.showPage(!0),t.pop(1,null,!1)}})},jsApiVoipCall:function(){1==this.data.caseType?i.report("","BorrowVideoBut",1):2==this.data.caseType?"1"==n.globalData.prod?i.report("","PayOpenVideoBut",1):i.report("","OpenVideoBut",1):3==this.data.caseType?i.report("","PayLimChaVideoBut",1):4==this.data.caseType?i.report("","PayVideoCheckBut",1):5==this.data.caseType&&i.report("","PayReVideoCheckBut",1);var e={caseType:this.data.caseType,appType:"X"};1==this.data.caseType||4==this.data.caseType||5==this.data.caseType?e.caseType=1:e.caseType=2,r.startVoipCall(e,function(e,a,o){if(console.log("needvoipcall startVoipCall:",e),e)n.btnRecover(a.data.eventControl),o||a.showDialog(e,"知道了");else{var i={subscribe_info:n.globalData.account.subscribe_info,caseType:a.data.caseType,fromPage:a.data.fromPage};t.goto("voipResult",i)}},this)},showDialog:function(e,a){s.show(this,{type:1,content:e,cancelText:a})}}); 
 			}); 	require("pages/voipcall/needvoipcall/needvoipcall.js");
 		__wxRoute = 'pages/verifyFourElements/smsVerify/smsVerify';__wxRouteBegin = true; 	define("pages/verifyFourElements/smsVerify/smsVerify.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../common/alertView/alertView.js"),t=require("../../../utils/pageManager.js"),n=require("../../../utils/dataManager.js"),o=require("../../../utils/loading.js"),s=require("../../../utils/report.js"),a=require("smsCodeTips/smsCodeTips.js"),r=require("../../../utils/util.js"),i=getApp();Page({data:{eventControl:{btnAllowFlag:!0},sScreen:i.globalData.sScreen,pageShow:!1,anti_fraud_no:"",sms_scence_token:"",phone_no:"",sms_code:"",startInterval:!0,second:60},onLoad:function(e){console.log("smsVerify options: ",e);var n=t.getParams(e);if(n){var o=n.phone_no.substring(0,3)+"****"+n.phone_no.substring(8,11);this.setData({anti_fraud_no:n.anti_fraud_no||"",sms_scence_token:n.sms_scence_token||"",phone_no:o||""})}this.startInterval()},onShow:function(){s.report("OneTimePassword")},onUnload:function(){i.btnRecoverByUnload()},getSmsCode:function(){if(i.btnAllowClick(this.data.eventControl)){s.report("","OTPonceagain",1);var e={anti_fraud_no:this.data.anti_fraud_no,sms_scence_token:this.data.sms_scence_token};n.smssend(e,function(e,t,n){console.log("smsVerify smssend: ",e,t),e?n.handlerError(e):(i.btnRecover(n.data.eventControl),n.startInterval())},this)}},startInterval:function(){var e=this,t=60;e.setData({second:t}),this.setData({startInterval:!0});var n=setInterval(function(){--t>0?e.setData({second:t}):(e.setData({startInterval:!1}),clearInterval(n))},1e3)},inputSmsCode:function(e){var t=e.detail.value;this.setData({sms_code:t})},smssendTap:function(){if(6==this.data.sms_code.length&&i.btnAllowClick(this.data.eventControl)){s.report("","OTPnextBut",1);var e=this,a={anti_fraud_no:e.data.anti_fraud_no,sms_scence_token:e.data.sms_scence_token,sms_code:e.data.sms_code};o.show(),n.smscheck(a,function(a,r,c){if(console.log("smsVerify smscheck: ",a,r),a)e.handlerError(a);else{i.btnRecover(e.data.eventControl);var l={anti_fraud_no:e.data.anti_fraud_no,open_scence_token:r.open_scence_token};n.namecheckedopenaccount(l,function(n,a,r){if(console.log("smsVerify namecheckedopenaccount: ",n,a),n)e.handlerError(n);else{s.report("","OTPOpenAcct",1),o.hide();var i=t.getParentPage();"welcome"==i.data.pageName&&(i.data.eventControl.smsVerifyData=a,t.pop(1,null,!0))}},e)}},this)}},handlerError:function(e){i.btnRecover(this.data.eventControl),o.hide(),e.result.block_type?"dialog"==e.result.block_sub_type||"dialog"==e.result.block_type?this.showDialog(e.result.block_msg,"知道了"):t.handleBlockCode(e.result):this.showDialog("系统繁忙，请稍后再试","知道了"),"30938210"==e.code?s.report("","OTPerror",1):"30938211"==e.code?s.report("","OTPoverdue",1):"30938212"==e.code&&s.report("","OTPOvertimes",1)},noSmsCodeTap:function(){s.report("","OTPreceivefails",1),a.show(this)},callCustomerService:function(){a.hide(this),r.phoneCall("075589468888")},showDialog:function(t,n){e.show(this,{type:1,content:t,cancelText:n})}}); 
 			}); 	require("pages/verifyFourElements/smsVerify/smsVerify.js");
 		__wxRoute = 'pages/verifyFourElements/verifyFourElements';__wxRouteBegin = true; 	define("pages/verifyFourElements/verifyFourElements.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../common/alertView/alertView.js"),t=require("../../utils/pageManager.js"),r=require("../../utils/dataManager.js"),o=require("../../utils/report.js"),n=require("../common/bankSupport/bankSupport.js"),a=require("phoneTips/phoneTips.js"),s=require("../../utils/loading.js"),i=require("../../utils/util.js"),c=getApp(),d=/^[\u4E00-\u9FA5]/,l=/\s/,u=/^1[34578]\d{9}$/,h="";Page({data:{eventControl:{btnAllowFlag:!0},sScreen:c.globalData.sScreen,pageShow:!1,disabled:!0,anti_fraud_no:"",userInfo:{name:"",idcard:"",bankcard:"",phoneNum:""},errCode:""},onLoad:function(e){wx.setNavigationBarTitle({title:"填写身份信息"})},onShow:function(){o.report("IDidentifyPage")},onUnload:function(){c.btnRecoverByUnload()},inputInfo:function(e){var t=e.detail.value,r=this.data.userInfo;return"name"==e.target.id?r.name=t:"idcard"==e.target.id?r.idcard=t.replace(/\s/g,""):"bankcard"==e.target.id?(r.bankcard=t.replace(/\s/g,""),h.length<=t.length&&(t=t.replace(/\s/g,"").replace(/(.{4})/g,"$1 "))):r.phoneNum=t.replace(/\s/g,""),h=t,this.setData({userInfo:r}),this.checkuserInfo(r),{value:t}},checkuserInfo:function(e){this.setData({disabled:!(e.name.length>0&&e.idcard.length>0&&e.bankcard.length>0&&e.phoneNum.length>0)})},checkTap:function(){o.report("","phonenumdetail",1);var e=this;setTimeout(function(){a.show(e)},500)},submitTap:function(){if(!this.data.disabled&&c.btnAllowClick(this.data.eventControl)&&(o.report("","IDidentifyPage-NextBut",1),this.legalCheck())){s.show();var e=this,t={name:e.data.userInfo.name,id_no:e.data.userInfo.idcard,bank_card_no:e.data.userInfo.bankcard,bank_phone_no:e.data.userInfo.phoneNum};r.checkcustinfo(t,function(t,r,o){if(console.log("verifyFourElemnets checkcustinfo:",t,r),t)return o.setData({anti_fraud_no:t.result.anti_fraud_no||""}),void o.handlerError(t);c.btnRecover(e.data.eventControl),o.smscodeSend(r)},this)}},handlerError:function(n){c.btnRecover(this.data.eventControl);var a=this;if(this.setData({errCode:n.result.retcode||""}),"30938200"==n.result.retcode){if("Y"!=n.result.need_query)return s.hide(),o.report("","timeout",1),void a.showDialog("系统繁忙，请稍后再试","知道了");var i={anti_fraud_no:n.result.anti_fraud_no};setTimeout(function(){r.checkcustquery(i,function(e,t,r){console.log("verifyFourElemnets checkcustquery:",e,t),e?r.handlerError(e):(c.btnRecover(a.data.eventControl),r.smscodeSend(t))},a)},4e3)}else if("30938298"==n.code||"30938299"==n.code||"viewbankdialog"==n.result.block_sub_type){s.hide();var d={cancelText:"返回",confirmText:"查看支持银行"};"30938298"==n.code?(o.report("","systemmaintain",1),d.cancelText="知道了",d.confirmText="查看可用银行"):o.report("","nosupportcard",1),e.show(a,{type:0,content:n.result.block_msg,cancelText:d.cancelText,confirmText:d.confirmText},{alertConfirm:a.checkBankList})}else s.hide(),n.result.block_type?"dialog"==n.result.block_sub_type||"dialog"==n.result.block_type||"verfy_userinfo_invalid_bank_or_card"==n.result.block_type?a.showDialog(n.result.block_msg,"知道了"):t.handleBlockCode(n.result):a.showDialog("系统繁忙，请稍后再试","知道了");"30938201"==n.code?o.report("","namemismatch",1):"30938202"==n.code?o.report("","nameovertimes",1):"30938203"==n.code?o.report("","IDPage-Overtimes",1):"30938204"==n.code?o.report("","overerrortimes",1):"30938205"==n.code?o.report("","policerefuse",1):"30938206"==n.code?o.report("","cardexpired",1):"30938207"==n.code?o.report("","numcardmismatch",1):"30938208"==n.code?o.report("","unknown",1):"30938209"==n.code&&o.report("","novalidationcard",1)},smscodeSend:function(e){var o=this,n={anti_fraud_no:e.anti_fraud_no||o.data.anti_fraud_no,sms_scence_token:e.sms_scence_token||o.data.sms_scence_token};s.show(),r.smssend(n,function(e,r,a){console.log("verifyFourElemnets smssend:",e,r),e?a.handlerError(e):(c.btnRecover(o.data.eventControl),t.goto("smsVerify",{anti_fraud_no:n.anti_fraud_no,sms_scence_token:n.sms_scence_token,phone_no:a.data.userInfo.phoneNum}))},this)},legalCheck:function(){var e="",t=this.data.userInfo;return l.test(t.name)||!d.test(t.name)?(e="姓名输入格式有误，请核对后重试",o.report("","Nameformaterror",1)):i.isCnNewID(t.idcard)?t.bankcard.length<=12?(e="银行卡号输入格式有误，请核对后重试",o.report("","phonenumformaterror",1)):u.test(t.phoneNum)?e="":(e="手机号输入格式有误，请核对后重试",o.report("","cardformaterror",1)):(e=t.idcard.length<18?"请输入18位身份证号":"身份证号输入格式有误，请核对后重试",o.report("","IDformaterror",1)),!(e&&e.length>0)||(c.btnRecover(this.data.eventControl),this.showDialog(e,"知道了"),!1)},checkBankList:function(){"30938298"==this.data.errCode?o.report("","bankingavailable",1):o.report("","nosupportcard-banklist",1),s.show();var t=this;e.hide(t),r.bankcustquery({},function(e,r){console.log("verifyFourElemnets bankcustquery:",e,r),s.hide(),!e&&r.bankinfo.length>0&&n.show(t,r.bankinfo)},t)},showDialog:function(t,r){e.show(this,{type:1,content:t,cancelText:r})}}); 
 			}); 	require("pages/verifyFourElements/verifyFourElements.js");
 		__wxRoute = 'pages/loan/infoWarning/infoWarning';__wxRouteBegin = true; 	define("pages/loan/infoWarning/infoWarning.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../../utils/report.js"),a=getApp();Page({data:{eventControl:{btnAllowFlag:!0},sScreen:a.globalData.sScreen,username:""},onLoad:function(e){var n=a.globalData.account;this.setData({sScreen:a.globalData.sScreen,username:n.name})},onShow:function(){e.report("CancelWXZF")},onUnload:function(){a.btnRecoverByUnload()}}); 
 			}); 	require("pages/loan/infoWarning/infoWarning.js");
 		__wxRoute = 'pages/loan/phonecheck/phonecheck';__wxRouteBegin = true; 	define("pages/loan/phonecheck/phonecheck.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";require("../../../utils/view.js");var e=require("../../../utils/dataManager.js"),a=require("../../../utils/pageManager.js"),t=require("../../common/alertView/alertView.js"),o=require("../../../utils/loading.js"),i=require("../../../utils/report.js"),n=(require("../../../utils/util.js"),getApp());Page({data:{eventControl:{btnAllowFlag:!0},pageShow:!1,randerData:{},selected:!0,retcode:"",sScreen:n.globalData.sScreen,iconSize:186*n.globalData.ratio,giconSize:20*n.globalData.ratio},onLoad:function(e){console.log("phonecheck options: ",e);var t=a.getParams(e);if(t){var o=this.data.randerData,i=o.retcode=t.retcode||"";wx.setNavigationBarTitle({title:"借款申请已提交"}),o.title="借款申请已提交",o.desc=t.retmsg,o.status="waiting",o.biz_seq_no=t.biz_seq_no,o.loan_receipt_nbr=t.receipt_nbr,o.loan_init_prin=t.loan_init_prin,o.subscribe_info=t.subscribe_info||n.globalData.account.subscribe_info,this.setData({randerData:o,selected:!!o.subscribe_info&&"2"==o.subscribe_info.recommend_level})}this.setData({iconSize:186*n.globalData.ratio,giconSize:20*n.globalData.ratio,sScreen:n.globalData.sScreen,retcode:i})},onReady:function(){},onShow:function(){o.hide(),n.globalData.pageParam={comefrom:"phonecheck",refreshDataFlag:0,needGoToPersonalCenter:!1},this.setData({pageShow:!0}),"30937013"==this.data.retcode?i.report("PayLoanPhoneCheck"):i.report("PayLoanPending")},onHide:function(){},onUnload:function(){n.btnRecoverByUnload()},selectClick:function(){this.setData({selected:!this.data.selected})},queryloanstatus:function(){if(n.btnAllowClick(this.data.eventControl)){i.report("","PayPhCheckFinishBut",1),this.data.selected&&"0"!=this.data.randerData.subscribe_info.recommend_level&&e.subscribe({subscribe_token:this.data.randerData.subscribe_info.subscribe_token},function(e,a,t){e||(n.globalData.account.subscribe_info.recommend_level=0)}),o.show();var t={prod:n.globalData.prod,biz_seq_no:this.data.randerData.biz_seq_no};e.queryloanstatus(t,function(e,t,r){console.log("phonecheck queryloanstatus:",e,t),e&&"30938703"!=e.code?(n.btnRecover(r.data.eventControl),o.hide(),i.report("","PayPhCheckWaiting",1),r.showDialog("借款审核中，请稍后再试","知道了")):((t=t||e.result).loan_init_prin=r.data.randerData.loan_init_prin,a.goto("loanResultCertificate",t))},this)}},showDialog:function(e,a){t.show(this,{type:1,content:e,cancelText:a})}}); 
 			}); 	require("pages/loan/phonecheck/phonecheck.js");
 		__wxRoute = 'pages/loan/loanResultCertificate/loanResultCertificate';__wxRouteBegin = true; 	define("pages/loan/loanResultCertificate/loanResultCertificate.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var t=require("../../../utils/report.js"),e=require("../../../utils/pageManager.js"),a=(require("../../../utils/loading.js"),require("../../../utils/util.js")),n=require("../../../utils/dataManager.js"),o=getApp();Page({data:{eventControl:{btnAllowFlag:!0},pageShow:!1,pageTitle:"",contentTitle:"",desc:"",sScreen:o.globalData.sScreen,iconSize:186*o.globalData.ratio,giconSize:20*o.globalData.ratio,isExpand:!1,selected:!0,loan_init_prin:"",mctAcctName:"",mctAcctNo:"",mctInBankname:"",mctOutBankname:"",mctTransRemark:"",mctTransAuthcode:"",subscribe_info:null,retcode:null,retmsg:null},onLoad:function(t){console.log("loanResultCertificate options: ",t);var a=e.getParams(t);a&&this.dataHandler(a),wx.setNavigationBarTitle({title:this.data.pageTitle})},onReady:function(){},onShow:function(){if(o.globalData.pageParam={comefrom:"loanResultCertificate",refreshDataFlag:0,needGoToPersonalCenter:!1},"0"==this.data.retcode||"30937113"==this.data.retcode){o.globalData.pageParam.needGoToPersonalCenter=!0,t.report("PayLoanApproved");var e=o.globalData.account;e.is_first_loan&&"Y"==e.is_first_loan&&t.report("","PayLoanApproved-firsttime",1)}else t.report("PayLoanFailed")},onHide:function(){},onUnload:function(){o.btnRecoverByUnload(),this.data.selected&&"0"!=this.data.subscribe_info.recommend_level&&n.subscribe({subscribe_token:this.data.subscribe_info.subscribe_token})},dataHandler:function(t){var e=t&&t.subscribe_info;null==e&&(e=o.globalData.account.subscribe_info),this.setData({pageShow:!0,pageTitle:"0"==t.retcode||"30937113"==t.retcode?"微众银行已放款":"借款申请未通过",contentTitle:"微众银行已放款",desc:t.block_msg,iconSize:186*o.globalData.ratio,giconSize:20*o.globalData.ratio,sScreen:o.globalData.sScreen,loan_init_prin:a.centToYuan(t.loan_init_prin),mctAcctName:t.mct_acct_name,mctAcctNo:t.mct_acct_no&&t.mct_acct_no.replace(/(.{4})/g,"$1 "),mctInBankname:t.mct_in_bankname,mctOutBankname:t.mct_out_bankname,mctTransRemark:t.mct_trans_remark,mctTransAuthcode:t.mct_trans_authcode,subscribe_info:e,selected:!(!e||"2"!=e.recommend_level),retcode:t.retcode,retmsg:t.retmsg})},tapCertificate:function(){t.report("","  PayCertificate",1),this.setData({isExpand:!this.data.isExpand})},selectClick:function(){this.setData({selected:!this.data.selected})},finish:function(){o.btnAllowClick(this.data.eventControl)&&e.pop(1,null,!1)}}); 
 			}); 	require("pages/loan/loanResultCertificate/loanResultCertificate.js");
 		__wxRoute = 'pages/maintaining/maintaining';__wxRouteBegin = true; 	define("pages/maintaining/maintaining.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e=require("../../utils/dataManager.js"),o=require("../../utils/pageManager.js"),t=require("../../utils/report.js"),a=require("../../utils/loading.js"),n=getApp();Page({data:{eventControl:{btnAllowFlag:!0},retcode:"",retmsg:"",pageShow:!1,sScreen:n.globalData.sScreen},onLoad:function(e){console.log("maintaining options: ",e);var t=o.getParams(e);this.setData({sScreen:n.globalData.sScreen,retcode:t.retcode||"",retmsg:t.retmsg||""})},onShow:function(){this.setData({pageShow:!0}),"30938708"==this.data.retcode||"30938709"==this.data.retcode||"30938726"==this.data.retcode||"30938727"==this.data.retcode?t.report("PaySystemunavailablePage"):t.report("PayBrandrefusePage")},onUnload:function(){n.btnRecoverByUnload()},tapGotoPersonalCenter:function(){1==getCurrentPages().length?this.gotowld():(n.globalData.pageParam={comefrom:"maintaining",refreshDataFlag:0,needGoToPersonalCenter:!0},o.pop(1,null,!1))},gotowld:function(){"30938709"==this.data.retcode||"30938726"==this.data.retcode?t.report("","PaySystemPageCashBut",1):t.report("","PayBorrowCashBut",1),a.show(),e.queryAccount({outputtype:"json"},function(t,r,i){if(console.log("miantaining queryAccount:",t,r),!n.exceptionHandler()){var s=n.globalData.account,c=s.control;c&&c.account_maintain_info;return"Y"==s.active?"Y"==s.is_overdue?void o.goto("repayCurPeriod"):void o.goto("personalCenter"):(a.show(),void e.noopenqueryequity({},function(e,t,a){if(e);else{var n=getApp().globalData.account;n.operate_config?t.operate_config&&t.operate_config.noopen&&(n.operate_config.noopen=t.operate_config.noopen):n.operate_config=t.operate_config}o.goto("welcome")},i))}},this)}}); 
 			}); 	require("pages/maintaining/maintaining.js");
 	